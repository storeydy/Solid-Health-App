<<<<<<< HEAD
/*! For license information please see index.js.LICENSE.txt */
(()=>{var e,t,r={4716:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CordovaIFrameNavigator:()=>n.CordovaIFrameNavigator,CordovaPopupNavigator:()=>n.CordovaPopupNavigator,InMemoryWebStorage:()=>n.InMemoryWebStorage,Log:()=>n.Log,OidcClient:()=>n.OidcClient,SessionMonitor:()=>n.SessionMonitor,User:()=>n.User,UserManager:()=>n.UserManager,Version:()=>n.Version,WebStorageStateStore:()=>n.WebStorageStateStore,clearOidcPersistentStorage:()=>p,getBearerToken:()=>u,getDpopToken:()=>l,refresh:()=>d,registerClient:()=>s,removeOidcQueryParam:()=>h});var n=r(1478),i=r(835);const o=(e,t={})=>{const{sorted:r,skipIndex:n,ignorenull:i,skipBracket:o,useDot:s,whitespace:a="+"}=t,c=e=>String(e).replace(/[^ !'()~*]/gu,encodeURIComponent).replace(/ /g,a).replace(/[!'()~*]/g,(e=>`%${e.charCodeAt().toString(16).slice(-2).toUpperCase()}`)),u=(e,t=Object.keys(e))=>r?t.sort():t,l=e=>e.filter((e=>e)).join("&"),d=(e,t,r=typeof t,a=null)=>(t===a?a=i?a:c(e)+"="+a:/string|number|boolean/.test(r)?a=c(e)+"="+c(t):Array.isArray(t)?a=((e,t,r=(o?"":"[]"))=>t.length?l(t.map(((t,i)=>d(n?e+r:e+"["+i+"]",t)))):c(e+r))(e,t):t instanceof Set?a=((e,t)=>l(Array.from(t).map((t=>d(e,t)))))(e,t):"object"===r&&(a=((e,t)=>l(u(t).map((r=>d(s?`${e}.${r}`:`${e}[${r}]`,t[r])))))(e,t)),a);return e&&l(u(e).map((t=>d(t,e[t]))))};async function s(e,t){var r;if(!t.registrationEndpoint)throw new Error("Dynamic Registration could not be completed because the issuer has no registration endpoint.");if(!Array.isArray(t.idTokenSigningAlgValuesSupported))throw new Error("The OIDC issuer discovery profile is missing the 'id_token_signing_alg_values_supported' value, which is mandatory.");const n=(0,i.determineSigningAlg)(t.idTokenSigningAlgValuesSupported,i.PREFERRED_SIGNING_ALG),o={client_name:e.clientName,application_type:"web",redirect_uris:[null===(r=e.redirectUrl)||void 0===r?void 0:r.toString()],subject_type:"public",token_endpoint_auth_method:"client_secret_basic",id_token_signed_response_alg:n,grant_types:["authorization_code","refresh_token"]},s={"Content-Type":"application/json"};e.registrationAccessToken&&(s.Authorization=`Bearer ${e.registrationAccessToken}`);const a=await fetch(t.registrationEndpoint.toString(),{method:"POST",headers:s,body:JSON.stringify(o)});if(a.ok){const t=await a.json();return function(e,t){if(void 0===e.client_id)throw new Error(`Dynamic client registration failed: no client_id has been found on ${JSON.stringify(e)}`);if(t.redirectUrl&&(void 0===e.redirect_uris||e.redirect_uris[0]!==t.redirectUrl.toString()))throw new Error(`Dynamic client registration failed: the returned redirect URIs ${JSON.stringify(e.redirect_uris)} don't match the provided ${JSON.stringify([t.redirectUrl.toString()])}`)}(t,e),{clientId:t.client_id,clientSecret:t.client_secret,idTokenSignedResponseAlg:t.id_token_signed_response_alg,clientType:"dynamic"}}throw 400===a.status&&function(e,t){var r,n,i,o;if("invalid_redirect_uri"===e.error)throw new Error(`Dynamic client registration failed: the provided redirect uri [${null===(r=t.redirectUrl)||void 0===r?void 0:r.toString()}] is invalid - ${null!==(n=e.error_description)&&void 0!==n?n:""}`);if("invalid_client_metadata"===e.error)throw new Error(`Dynamic client registration failed: the provided client metadata ${JSON.stringify(t)} is invalid - ${null!==(i=e.error_description)&&void 0!==i?i:""}`);throw new Error(`Dynamic client registration failed: ${e.error} - ${null!==(o=e.error_description)&&void 0!==o?o:""}`)}(await a.json(),e),new Error(`Dynamic client registration failed: the server returned ${a.status} ${a.statusText} - ${await a.text()}`)}function a(e){return void 0!==e.error_description&&"string"==typeof e.error_description}function c(e,t){if(void 0!==(r=e).error&&"string"==typeof r.error)throw new i.OidcProviderError(`Token endpoint returned error [${e.error}]${a(e)?`: ${e.error_description}`:""}${function(e){return void 0!==e.error_uri&&"string"==typeof e.error_uri}(e)?` (see ${e.error_uri})`:""}`,e.error,a(e)?e.error_description:void 0);var r;if(!function(e){return void 0!==e.access_token&&"string"==typeof e.access_token}(e))throw new i.InvalidResponseError(["access_token"]);if(!function(e){return void 0!==e.id_token&&"string"==typeof e.id_token}(e))throw new i.InvalidResponseError(["id_token"]);if(!function(e){return void 0!==e.token_type&&"string"==typeof e.token_type}(e))throw new i.InvalidResponseError(["token_type"]);if(!function(e){return void 0===e.expires_in||"number"==typeof e.expires_in}(e))throw new i.InvalidResponseError(["expires_in"]);if(!t&&"bearer"!==e.token_type.toLowerCase())throw new Error(`Invalid token endpoint response: requested a [Bearer] token, but got a 'token_type' value of [${e.token_type}].`);return e}async function u(e){let t;try{const r=new n.OidcClient({response_mode:"query",loadUserInfo:!1});if(t=await r.processSigninResponse(e),void 0===r.settings.metadata)throw new Error("Cannot retrieve issuer metadata from client information in storage.");if(void 0===r.settings.metadata.jwks_uri)throw new Error("Missing some issuer metadata from client information in storage: 'jwks_uri' is undefined");if(void 0===r.settings.metadata.issuer)throw new Error("Missing some issuer metadata from client information in storage: 'issuer' is undefined");if(void 0===r.settings.client_id)throw new Error("Missing some client information in storage: 'client_id' is undefined");const o=await(0,i.getWebidFromTokenPayload)(t.id_token,r.settings.metadata.jwks_uri,r.settings.metadata.issuer,r.settings.client_id);return{accessToken:t.access_token,idToken:t.id_token,webId:o,refreshToken:t.refresh_token}}catch(t){throw new Error(`Problem handling Auth Code Grant (Flow) redirect - URL [${e}]: ${t}`)}}async function l(e,t,r){return async function(e,t,r,n){!function(e,t){if(t.grantType&&(!e.grantTypesSupported||!e.grantTypesSupported.includes(t.grantType)))throw new Error(`The issuer [${e.issuer}] does not support the [${t.grantType}] grant`);if(!e.tokenEndpoint)throw new Error(`This issuer [${e.issuer}] does not have a token endpoint`)}(e,r);const s={"content-type":"application/x-www-form-urlencoded"};let a;n&&(a=await(0,i.generateDpopKeyPair)(),s.DPoP=await(0,i.createDpopHeader)(e.tokenEndpoint,"POST",a)),t.clientSecret&&(s.Authorization=`Basic ${btoa(`${t.clientId}:${t.clientSecret}`)}`);const u={method:"POST",headers:s,body:o({grant_type:r.grantType,redirect_uri:r.redirectUrl,code:r.code,code_verifier:r.codeVerifier,client_id:t.clientId})},l=await await fetch(e.tokenEndpoint,u),d=c(await l.json(),n),h=await(0,i.getWebidFromTokenPayload)(d.id_token,e.jwksUri,e.issuer,t.clientId);return{accessToken:d.access_token,idToken:d.id_token,refreshToken:(p=d,void 0!==p.refresh_token&&"string"==typeof p.refresh_token?d.refresh_token:void 0),webId:h,dpopKey:a,expiresIn:d.expires_in};var p}(e,t,r,!0)}async function d(e,t,r,n){const s={grant_type:"refresh_token",refresh_token:e,scope:"openid offline_access"};let a={};void 0!==n&&(a={DPoP:await(0,i.createDpopHeader)(t.tokenEndpoint,"POST",n)});let u={};void 0!==r.clientSecret&&(u={Authorization:`Basic ${btoa(`${r.clientId}:${r.clientSecret}`)}`});const l=await fetch(t.tokenEndpoint,{method:"POST",body:o(s),headers:{...a,...u,"Content-Type":"application/x-www-form-urlencoded"}});let d;try{d=await l.json()}catch(e){throw new Error(`The token endpoint of issuer ${t.issuer} returned a malformed response.`)}const h=c(d,void 0!==n),p=await(0,i.getWebidFromTokenPayload)(h.id_token,t.jwksUri,t.issuer,r.clientId);return{accessToken:h.access_token,idToken:h.id_token,refreshToken:"string"==typeof h.refresh_token?h.refresh_token:void 0,webId:p,dpopKey:n,expiresIn:h.expires_in}}function h(e){const t=new URL(e);return t.searchParams.delete("code"),t.searchParams.delete("state"),t.hash="",t.toString()}async function p(){const e=new n.OidcClient({response_mode:"query"});await e.clearStaleState(new n.WebStorageStateStore({}));const t=window.localStorage,r=[];for(let e=0;e<=t.length;e+=1){const n=t.key(e);n&&(n.match(/^oidc\..+$/)||n.match(/^solidClientAuthenticationUser:.+$/))&&r.push(n)}r.forEach((e=>t.removeItem(e)))}},1478:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=22)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={debug:function(){},info:function(){},warn:function(){},error:function(){}},o=void 0,s=void 0;(t.Log=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.reset=function(){s=3,o=i},e.debug=function(){if(s>=4){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.debug.apply(o,Array.from(t))}},e.info=function(){if(s>=3){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.info.apply(o,Array.from(t))}},e.warn=function(){if(s>=2){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.warn.apply(o,Array.from(t))}},e.error=function(){if(s>=1){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];o.error.apply(o,Array.from(t))}},n(e,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return s},set:function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");s=e}},{key:"logger",get:function(){return o},set:function(e){if(!e.debug&&e.info&&(e.debug=e.info),!(e.debug&&e.info&&e.warn&&e.error))throw new Error("Invalid logger");o=e}}]),e}()).reset()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i={setInterval:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return setInterval(e,t)})),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return clearInterval(e)}))},o=!1,s=null;t.Global=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e._testing=function(){o=!0},e.setXMLHttpRequest=function(e){s=e},n(e,null,[{key:"location",get:function(){if(!o)return location}},{key:"localStorage",get:function(){if(!o&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!o&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!o&&"undefined"!=typeof window)return s||XMLHttpRequest}},{key:"timer",get:function(){if(!o)return i}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataService=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(7);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=".well-known/openid-configuration";t.MetadataService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.JsonService;if(s(this,e),!t)throw i.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new r(["application/jwk-set+json"])}return e.prototype.resetSigningKeys=function(){this._settings=this._settings||{},this._settings.signingKeys=void 0},e.prototype.getMetadata=function(){var e=this;return this._settings.metadata?(i.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(i.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then((function(t){i.Log.debug("MetadataService.getMetadata: json received");var r=e._settings.metadataSeed||{};return e._settings.metadata=Object.assign({},r,t),e._settings.metadata}))):(i.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},e.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},e.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},e.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},e.prototype.getTokenEndpoint=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._getMetadataProperty("token_endpoint",e)},e.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},e.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},e.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},e.prototype.getKeysEndpoint=function(){return this._getMetadataProperty("jwks_uri",!0)},e.prototype._getMetadataProperty=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i.Log.debug("MetadataService.getMetadataProperty for: "+e),this.getMetadata().then((function(r){if(i.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===r[e]){if(!0===t)return void i.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+e);throw i.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+e),new Error("Metadata does not contain property "+e)}return r[e]}))},e.prototype.getSigningKeys=function(){var e=this;return this._settings.signingKeys?(i.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then((function(t){return i.Log.debug("MetadataService.getSigningKeys: jwks_uri received",t),e._jsonService.getJson(t).then((function(t){if(i.Log.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw i.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return e._settings.signingKeys=t.keys,e._settings.signingKeys}))}))},n(e,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(a)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=a))),this._metadataUrl}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtility=void 0;var n=r(0),i=r(1);t.UrlUtility=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.addQueryParam=function(e,t,r){return e.indexOf("?")<0&&(e+="?"),"?"!==e[e.length-1]&&(e+="&"),e+=encodeURIComponent(t),(e+="=")+encodeURIComponent(r)},e.parseUrlFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.Global;"string"!=typeof e&&(e=r.location.href);var o=e.lastIndexOf(t);o>=0&&(e=e.substr(o+1)),"?"===t&&(o=e.indexOf("#"))>=0&&(e=e.substr(0,o));for(var s,a={},c=/([^&=]+)=([^&]*)/g,u=0;s=c.exec(e);)if(a[decodeURIComponent(s[1])]=decodeURIComponent(s[2].replace(/\+/g," ")),u++>50)return n.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",e),{error:"Response exceeded expected number of parameters"};for(var l in a)return a;return{}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JoseUtil=void 0;var n=r(26),i=function(e){return e&&e.__esModule?e:{default:e}}(r(33));t.JoseUtil=(0,i.default)({jws:n.jws,KeyUtil:n.KeyUtil,X509:n.X509,crypto:n.crypto,hextob64u:n.hextob64u,b64tohex:n.b64tohex,AllowedSigningAlgs:n.AllowedSigningAlgs})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClientSettings=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),s=r(23),a=r(6),c=r(24),u=r(2);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d=".well-known/openid-configuration",h="id_token",p="openid",f="client_secret_post";t.OidcClientSettings=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.authority,i=t.metadataUrl,o=t.metadata,d=t.signingKeys,g=t.metadataSeed,y=t.client_id,m=t.client_secret,v=t.response_type,w=void 0===v?h:v,b=t.scope,_=void 0===b?p:b,S=t.redirect_uri,E=t.post_logout_redirect_uri,x=t.client_authentication,I=void 0===x?f:x,A=t.prompt,k=t.display,F=t.max_age,T=t.ui_locales,R=t.acr_values,C=t.resource,P=t.response_mode,O=t.filterProtocolClaims,j=void 0===O||O,N=t.loadUserInfo,D=void 0===N||N,L=t.staleStateAge,U=void 0===L?900:L,B=t.clockSkew,M=void 0===B?300:B,H=t.clockService,K=void 0===H?new s.ClockService:H,q=t.userInfoJwtIssuer,V=void 0===q?"OP":q,J=t.mergeClaims,W=void 0!==J&&J,$=t.stateStore,z=void 0===$?new a.WebStorageStateStore:$,G=t.ResponseValidatorCtor,Y=void 0===G?c.ResponseValidator:G,Q=t.MetadataServiceCtor,X=void 0===Q?u.MetadataService:Q,Z=t.extraQueryParams,ee=void 0===Z?{}:Z,te=t.extraTokenParams,re=void 0===te?{}:te;l(this,e),this._authority=r,this._metadataUrl=i,this._metadata=o,this._metadataSeed=g,this._signingKeys=d,this._client_id=y,this._client_secret=m,this._response_type=w,this._scope=_,this._redirect_uri=S,this._post_logout_redirect_uri=E,this._client_authentication=I,this._prompt=A,this._display=k,this._max_age=F,this._ui_locales=T,this._acr_values=R,this._resource=C,this._response_mode=P,this._filterProtocolClaims=!!j,this._loadUserInfo=!!D,this._staleStateAge=U,this._clockSkew=M,this._clockService=K,this._userInfoJwtIssuer=V,this._mergeClaims=!!W,this._stateStore=z,this._validator=new Y(this),this._metadataService=new X(this),this._extraQueryParams="object"===(void 0===ee?"undefined":n(ee))?ee:{},this._extraTokenParams="object"===(void 0===re?"undefined":n(re))?re:{}}return e.prototype.getEpochTime=function(){return this._clockService.getEpochTime()},i(e,[{key:"client_id",get:function(){return this._client_id},set:function(e){if(this._client_id)throw o.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=e}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"client_authentication",get:function(){return this._client_authentication}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"response_mode",get:function(){return this._response_mode}},{key:"authority",get:function(){return this._authority},set:function(e){if(this._authority)throw o.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=e}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(d)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=d)),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(e){this._metadata=e}},{key:"metadataSeed",get:function(){return this._metadataSeed},set:function(e){this._metadataSeed=e}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(e){this._signingKeys=e}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"userInfoJwtIssuer",get:function(){return this._userInfoJwtIssuer}},{key:"mergeClaims",get:function(){return this._mergeClaims}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraQueryParams=e:this._extraQueryParams={}}},{key:"extraTokenParams",get:function(){return this._extraTokenParams},set:function(e){"object"===(void 0===e?"undefined":n(e))?this._extraTokenParams=e:this._extraTokenParams={}}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebStorageStateStore=void 0;var n=r(0),i=r(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.WebStorageStateStore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,n=void 0===r?"oidc.":r,s=t.store,a=void 0===s?i.Global.localStorage:s;o(this,e),this._store=a,this._prefix=n}return e.prototype.set=function(e,t){return n.Log.debug("WebStorageStateStore.set",e),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()},e.prototype.get=function(e){n.Log.debug("WebStorageStateStore.get",e),e=this._prefix+e;var t=this._store.getItem(e);return Promise.resolve(t)},e.prototype.remove=function(e){n.Log.debug("WebStorageStateStore.remove",e),e=this._prefix+e;var t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)},e.prototype.getAllKeys=function(){n.Log.debug("WebStorageStateStore.getAllKeys");for(var e=[],t=0;t<this._store.length;t++){var r=this._store.key(t);0===r.indexOf(this._prefix)&&e.push(r.substr(this._prefix.length))}return Promise.resolve(e)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonService=void 0;var n=r(0),i=r(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.JsonService=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Global.XMLHttpRequest,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,e),t&&Array.isArray(t)?this._contentTypes=t.slice():this._contentTypes=[],this._contentTypes.push("application/json"),n&&this._contentTypes.push("application/jwt"),this._XMLHttpRequest=r,this._jwtHandler=n}return e.prototype.getJson=function(e,t){var r=this;if(!e)throw n.Log.error("JsonService.getJson: No url passed"),new Error("url");return n.Log.debug("JsonService.getJson, url: ",e),new Promise((function(i,o){var s=new r._XMLHttpRequest;s.open("GET",e);var a=r._contentTypes,c=r._jwtHandler;s.onload=function(){if(n.Log.debug("JsonService.getJson: HTTP response received, status",s.status),200===s.status){var t=s.getResponseHeader("Content-Type");if(t){var r=a.find((function(e){if(t.startsWith(e))return!0}));if("application/jwt"==r)return void c(s).then(i,o);if(r)try{return void i(JSON.parse(s.responseText))}catch(e){return n.Log.error("JsonService.getJson: Error parsing JSON response",e.message),void o(e)}}o(Error("Invalid response Content-Type: "+t+", from URL: "+e))}else o(Error(s.statusText+" ("+s.status+")"))},s.onerror=function(){n.Log.error("JsonService.getJson: network error"),o(Error("Network Error"))},t&&(n.Log.debug("JsonService.getJson: token passed, setting Authorization header"),s.setRequestHeader("Authorization","Bearer "+t)),s.send()}))},e.prototype.postForm=function(e,t,r){var i=this;if(!e)throw n.Log.error("JsonService.postForm: No url passed"),new Error("url");return n.Log.debug("JsonService.postForm, url: ",e),new Promise((function(o,s){var a=new i._XMLHttpRequest;a.open("POST",e);var c=i._contentTypes;a.onload=function(){if(n.Log.debug("JsonService.postForm: HTTP response received, status",a.status),200!==a.status){if(400===a.status&&(r=a.getResponseHeader("Content-Type"))&&c.find((function(e){if(r.startsWith(e))return!0})))try{var t=JSON.parse(a.responseText);if(t&&t.error)return n.Log.error("JsonService.postForm: Error from server: ",t.error),void s(new Error(t.error))}catch(e){return n.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void s(e)}s(Error(a.statusText+" ("+a.status+")"))}else{var r;if((r=a.getResponseHeader("Content-Type"))&&c.find((function(e){if(r.startsWith(e))return!0})))try{return void o(JSON.parse(a.responseText))}catch(e){return n.Log.error("JsonService.postForm: Error parsing JSON response",e.message),void s(e)}s(Error("Invalid response Content-Type: "+r+", from URL: "+e))}},a.onerror=function(){n.Log.error("JsonService.postForm: network error"),s(Error("Network Error"))};var u="";for(var l in t){var d=t[l];d&&(u.length>0&&(u+="&"),u+=encodeURIComponent(l),u+="=",u+=encodeURIComponent(d))}a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),void 0!==r&&a.setRequestHeader("Authorization","Basic "+btoa(r)),a.send(u)}))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninRequest=void 0;var n=r(0),i=r(3),o=r(13);t.SigninRequest=function(){function e(t){var r=t.url,s=t.client_id,a=t.redirect_uri,c=t.response_type,u=t.scope,l=t.authority,d=t.data,h=t.prompt,p=t.display,f=t.max_age,g=t.ui_locales,y=t.id_token_hint,m=t.login_hint,v=t.acr_values,w=t.resource,b=t.response_mode,_=t.request,S=t.request_uri,E=t.extraQueryParams,x=t.request_type,I=t.client_secret,A=t.extraTokenParams,k=t.skipUserInfo;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!s)throw n.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!a)throw n.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!c)throw n.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!u)throw n.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw n.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var F=e.isOidc(c),T=e.isCode(c);b||(b=e.isCode(c)?"query":null),this.state=new o.SigninState({nonce:F,data:d,client_id:s,authority:l,redirect_uri:a,code_verifier:T,request_type:x,response_mode:b,client_secret:I,scope:u,extraTokenParams:A,skipUserInfo:k}),r=i.UrlUtility.addQueryParam(r,"client_id",s),r=i.UrlUtility.addQueryParam(r,"redirect_uri",a),r=i.UrlUtility.addQueryParam(r,"response_type",c),r=i.UrlUtility.addQueryParam(r,"scope",u),r=i.UrlUtility.addQueryParam(r,"state",this.state.id),F&&(r=i.UrlUtility.addQueryParam(r,"nonce",this.state.nonce)),T&&(r=i.UrlUtility.addQueryParam(r,"code_challenge",this.state.code_challenge),r=i.UrlUtility.addQueryParam(r,"code_challenge_method","S256"));var R={prompt:h,display:p,max_age:f,ui_locales:g,id_token_hint:y,login_hint:m,acr_values:v,resource:w,request:_,request_uri:S,response_mode:b};for(var C in R)R[C]&&(r=i.UrlUtility.addQueryParam(r,C,R[C]));for(var P in E)r=i.UrlUtility.addQueryParam(r,P,E[P]);this.url=r}return e.isOidc=function(e){return!!e.split(/\s+/g).filter((function(e){return"id_token"===e}))[0]},e.isOAuth=function(e){return!!e.split(/\s+/g).filter((function(e){return"token"===e}))[0]},e.isCode=function(e){return!!e.split(/\s+/g).filter((function(e){return"code"===e}))[0]},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r(14));function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.State=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,n=t.data,i=t.created,a=t.request_type;s(this,e),this._id=r||(0,o.default)(),this._data=n,this._created="number"==typeof i&&i>0?i:parseInt(Date.now()/1e3),this._request_type=a}return e.prototype.toStorageString=function(){return i.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type})},e.fromStorageString=function(t){return i.Log.debug("State.fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(t,r){var n=Date.now()/1e3-r;return t.getAllKeys().then((function(r){i.Log.debug("State.clearStaleState: got keys",r);for(var o=[],s=function(s){var a=r[s];c=t.get(a).then((function(r){var o=!1;if(r)try{var s=e.fromStorageString(r);i.Log.debug("State.clearStaleState: got item from key: ",a,s.created),s.created<=n&&(o=!0)}catch(e){i.Log.error("State.clearStaleState: Error parsing state for key",a,e.message),o=!0}else i.Log.debug("State.clearStaleState: no item in storage for key: ",a),o=!0;if(o)return i.Log.debug("State.clearStaleState: removed item for key: ",a),t.remove(a)})),o.push(c)},a=0;a<r.length;a++){var c;s(a)}return i.Log.debug("State.clearStaleState: waiting on promise count:",o.length),Promise.all(o)}))},n(e,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}},{key:"request_type",get:function(){return this._request_type}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClient=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(5),s=r(12),a=r(8),c=r(34),u=r(35),l=r(36),d=r(13),h=r(9);function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.OidcClient=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(this,e),t instanceof o.OidcClientSettings?this._settings=t:this._settings=new o.OidcClientSettings(t)}return e.prototype.createSigninRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response_type,n=t.scope,o=t.redirect_uri,s=t.data,c=t.state,u=t.prompt,l=t.display,d=t.max_age,h=t.ui_locales,p=t.id_token_hint,f=t.login_hint,g=t.acr_values,y=t.resource,m=t.request,v=t.request_uri,w=t.response_mode,b=t.extraQueryParams,_=t.extraTokenParams,S=t.request_type,E=t.skipUserInfo,x=arguments[1];i.Log.debug("OidcClient.createSigninRequest");var I=this._settings.client_id;r=r||this._settings.response_type,n=n||this._settings.scope,o=o||this._settings.redirect_uri,u=u||this._settings.prompt,l=l||this._settings.display,d=d||this._settings.max_age,h=h||this._settings.ui_locales,g=g||this._settings.acr_values,y=y||this._settings.resource,w=w||this._settings.response_mode,b=b||this._settings.extraQueryParams,_=_||this._settings.extraTokenParams;var A=this._settings.authority;return a.SigninRequest.isCode(r)&&"code"!==r?Promise.reject(new Error("OpenID Connect hybrid flow is not supported")):this._metadataService.getAuthorizationEndpoint().then((function(t){i.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",t);var k=new a.SigninRequest({url:t,client_id:I,redirect_uri:o,response_type:r,scope:n,data:s||c,authority:A,prompt:u,display:l,max_age:d,ui_locales:h,id_token_hint:p,login_hint:f,acr_values:g,resource:y,request:m,request_uri:v,extraQueryParams:b,extraTokenParams:_,request_type:S,response_mode:w,client_secret:e._settings.client_secret,skipUserInfo:E}),F=k.state;return(x=x||e._stateStore).set(F.id,F.toStorageString()).then((function(){return k}))}))},e.prototype.readSigninResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSigninResponseState");var n="query"===this._settings.response_mode||!this._settings.response_mode&&a.SigninRequest.isCode(this._settings.response_type),o=n?"?":"#",s=new c.SigninResponse(e,o);if(!s.state)return i.Log.error("OidcClient.readSigninResponseState: No state in response"),Promise.reject(new Error("No state in response"));t=t||this._stateStore;var u=r?t.remove.bind(t):t.get.bind(t);return u(s.state).then((function(e){if(!e)throw i.Log.error("OidcClient.readSigninResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:d.SigninState.fromStorageString(e),response:s}}))},e.prototype.processSigninResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSigninResponse"),this.readSigninResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return i.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),r._validator.validateSigninResponse(t,n)}))},e.prototype.createSignoutRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id_token_hint,n=t.data,o=t.state,s=t.post_logout_redirect_uri,a=t.extraQueryParams,c=t.request_type,l=arguments[1];return i.Log.debug("OidcClient.createSignoutRequest"),s=s||this._settings.post_logout_redirect_uri,a=a||this._settings.extraQueryParams,this._metadataService.getEndSessionEndpoint().then((function(t){if(!t)throw i.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");i.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",t);var d=new u.SignoutRequest({url:t,id_token_hint:r,post_logout_redirect_uri:s,data:n||o,extraQueryParams:a,request_type:c}),h=d.state;return h&&(i.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(l=l||e._stateStore).set(h.id,h.toStorageString())),d}))},e.prototype.readSignoutResponseState=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i.Log.debug("OidcClient.readSignoutResponseState");var n=new l.SignoutResponse(e);if(!n.state)return i.Log.debug("OidcClient.readSignoutResponseState: No state in response"),n.error?(i.Log.warn("OidcClient.readSignoutResponseState: Response was error: ",n.error),Promise.reject(new s.ErrorResponse(n))):Promise.resolve({state:void 0,response:n});var o=n.state;t=t||this._stateStore;var a=r?t.remove.bind(t):t.get.bind(t);return a(o).then((function(e){if(!e)throw i.Log.error("OidcClient.readSignoutResponseState: No matching state found in storage"),new Error("No matching state found in storage");return{state:h.State.fromStorageString(e),response:n}}))},e.prototype.processSignoutResponse=function(e,t){var r=this;return i.Log.debug("OidcClient.processSignoutResponse"),this.readSignoutResponseState(e,t,!0).then((function(e){var t=e.state,n=e.response;return t?(i.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),r._validator.validateSignoutResponse(t,n)):(i.Log.debug("OidcClient.processSignoutResponse: No state from storage; skipping validating response"),n)}))},e.prototype.clearStaleState=function(e){return i.Log.debug("OidcClient.clearStaleState"),e=e||this._stateStore,h.State.clearStaleState(e,this.settings.staleStateAge)},n(e,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenClient=void 0;var n=r(7),i=r(2),o=r(0);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.TokenClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(s(this,e),!t)throw o.Log.error("TokenClient.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r,this._metadataService=new a(this._settings)}return e.prototype.exchangeCode=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).grant_type=t.grant_type||"authorization_code",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret,t.redirect_uri=t.redirect_uri||this._settings.redirect_uri;var r=void 0,n=t._client_authentication||this._settings._client_authentication;return delete t._client_authentication,t.code?t.redirect_uri?t.code_verifier?t.client_id?t.client_secret||"client_secret_basic"!=n?("client_secret_basic"==n&&(r=t.client_id+":"+t.client_secret,delete t.client_id,delete t.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(n){return o.Log.debug("TokenClient.exchangeCode: Received token endpoint"),e._jsonService.postForm(n,t,r).then((function(e){return o.Log.debug("TokenClient.exchangeCode: response received"),e}))}))):(o.Log.error("TokenClient.exchangeCode: No client_secret passed"),Promise.reject(new Error("A client_secret is required"))):(o.Log.error("TokenClient.exchangeCode: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeCode: No code_verifier passed"),Promise.reject(new Error("A code_verifier is required"))):(o.Log.error("TokenClient.exchangeCode: No redirect_uri passed"),Promise.reject(new Error("A redirect_uri is required"))):(o.Log.error("TokenClient.exchangeCode: No code passed"),Promise.reject(new Error("A code is required")))},e.prototype.exchangeRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).grant_type=t.grant_type||"refresh_token",t.client_id=t.client_id||this._settings.client_id,t.client_secret=t.client_secret||this._settings.client_secret;var r=void 0,n=t._client_authentication||this._settings._client_authentication;return delete t._client_authentication,t.refresh_token?t.client_id?("client_secret_basic"==n&&(r=t.client_id+":"+t.client_secret,delete t.client_id,delete t.client_secret),this._metadataService.getTokenEndpoint(!1).then((function(n){return o.Log.debug("TokenClient.exchangeRefreshToken: Received token endpoint"),e._jsonService.postForm(n,t,r).then((function(e){return o.Log.debug("TokenClient.exchangeRefreshToken: response received"),e}))}))):(o.Log.error("TokenClient.exchangeRefreshToken: No client_id passed"),Promise.reject(new Error("A client_id is required"))):(o.Log.error("TokenClient.exchangeRefreshToken: No refresh_token passed"),Promise.reject(new Error("A refresh_token is required")))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorResponse=void 0;var n=r(0);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.ErrorResponse=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=r.error,a=r.error_description,c=r.error_uri,u=r.state,l=r.session_state;if(i(this,t),!s)throw n.Log.error("No error passed to ErrorResponse"),new Error("error");var d=o(this,e.call(this,a||s));return d.name="ErrorResponse",d.error=s,d.error_description=a,d.error_uri=c,d.state=u,d.session_state=l,d}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(Error)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninState=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(9),s=r(4),a=function(e){return e&&e.__esModule?e:{default:e}}(r(14));function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.SigninState=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.nonce,i=r.authority,o=r.client_id,l=r.redirect_uri,d=r.code_verifier,h=r.response_mode,p=r.client_secret,f=r.scope,g=r.extraTokenParams,y=r.skipUserInfo;c(this,t);var m=u(this,e.call(this,arguments[0]));if(!0===n?m._nonce=(0,a.default)():n&&(m._nonce=n),!0===d?m._code_verifier=(0,a.default)()+(0,a.default)()+(0,a.default)():d&&(m._code_verifier=d),m.code_verifier){var v=s.JoseUtil.hashString(m.code_verifier,"SHA256");m._code_challenge=s.JoseUtil.hexToBase64Url(v)}return m._redirect_uri=l,m._authority=i,m._client_id=o,m._response_mode=h,m._client_secret=p,m._scope=f,m._extraTokenParams=g,m._skipUserInfo=y,m}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.toStorageString=function(){return i.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,request_type:this.request_type,nonce:this.nonce,code_verifier:this.code_verifier,redirect_uri:this.redirect_uri,authority:this.authority,client_id:this.client_id,response_mode:this.response_mode,client_secret:this.client_secret,scope:this.scope,extraTokenParams:this.extraTokenParams,skipUserInfo:this.skipUserInfo})},t.fromStorageString=function(e){return i.Log.debug("SigninState.fromStorageString"),new t(JSON.parse(e))},n(t,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"code_verifier",get:function(){return this._code_verifier}},{key:"code_challenge",get:function(){return this._code_challenge}},{key:"response_mode",get:function(){return this._response_mode}},{key:"client_secret",get:function(){return this._client_secret}},{key:"scope",get:function(){return this._scope}},{key:"extraTokenParams",get:function(){return this._extraTokenParams}},{key:"skipUserInfo",get:function(){return this._skipUserInfo}}]),t}(o.State)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return("undefined"!=n&&null!==n&&void 0!==n.getRandomValues?i:o)().replace(/-/g,"")};var n="undefined"!=typeof window?window.crypto||window.msCrypto:null;function i(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^n.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}function o(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^16*Math.random()>>e/4).toString(16)}))}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.User=function(){function e(t){var r=t.id_token,n=t.session_state,i=t.access_token,o=t.refresh_token,s=t.token_type,a=t.scope,c=t.profile,u=t.expires_at,l=t.state;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id_token=r,this.session_state=n,this.access_token=i,this.refresh_token=o,this.token_type=s,this.scope=a,this.profile=c,this.expires_at=u,this.state=l}return e.prototype.toStorageString=function(){return i.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,refresh_token:this.refresh_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return i.Log.debug("User.fromStorageString"),new e(JSON.parse(t))},n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenEvents=void 0;var n=r(0),i=r(46);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.AccessTokenEvents=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accessTokenExpiringNotificationTime,n=void 0===r?60:r,s=t.accessTokenExpiringTimer,a=void 0===s?new i.Timer("Access token expiring"):s,c=t.accessTokenExpiredTimer,u=void 0===c?new i.Timer("Access token expired"):c;o(this,e),this._accessTokenExpiringNotificationTime=n,this._accessTokenExpiring=a,this._accessTokenExpired=u}return e.prototype.load=function(e){if(e.access_token&&void 0!==e.expires_in){var t=e.expires_in;if(n.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",t),t>0){var r=t-this._accessTokenExpiringNotificationTime;r<=0&&(r=1),n.Log.debug("AccessTokenEvents.load: registering expiring timer in:",r),this._accessTokenExpiring.init(r)}else n.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var i=t+1;n.Log.debug("AccessTokenEvents.load: registering expired timer in:",i),this._accessTokenExpired.init(i)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.unload=function(){n.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.addAccessTokenExpiring=function(e){this._accessTokenExpiring.addHandler(e)},e.prototype.removeAccessTokenExpiring=function(e){this._accessTokenExpiring.removeHandler(e)},e.prototype.addAccessTokenExpired=function(e){this._accessTokenExpired.addHandler(e)},e.prototype.removeAccessTokenExpired=function(e){this._accessTokenExpired.removeHandler(e)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=r(0);t.Event=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._callbacks=[]}return e.prototype.addHandler=function(e){this._callbacks.push(e)},e.prototype.removeHandler=function(e){var t=this._callbacks.findIndex((function(t){return t===e}));t>=0&&this._callbacks.splice(t,1)},e.prototype.raise=function(){n.Log.debug("Event: Raising event: "+this._name);for(var e=0;e<this._callbacks.length;e++){var t;(t=this._callbacks)[e].apply(t,arguments)}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMonitor=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(19),s=r(1);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.SessionMonitor=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.CheckSessionIFrame,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.Global.timer;if(a(this,e),!t)throw i.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=n,this._timer=c,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),Promise.resolve(this._userManager.getUser().then((function(e){e?r._start(e):r._settings.monitorAnonymousSession&&r._userManager.querySessionStatus().then((function(e){var t={session_state:e.session_state};e.sub&&e.sid&&(t.profile={sub:e.sub,sid:e.sid}),r._start(t)})).catch((function(e){i.Log.error("SessionMonitor ctor: error from querySessionStatus:",e.message)}))})).catch((function(e){i.Log.error("SessionMonitor ctor: error from getUser:",e.message)})))}return e.prototype._start=function(e){var t=this,r=e.session_state;r&&(e.profile?(this._sub=e.profile.sub,this._sid=e.profile.sid,i.Log.debug("SessionMonitor._start: session_state:",r,", sub:",this._sub)):(this._sub=void 0,this._sid=void 0,i.Log.debug("SessionMonitor._start: session_state:",r,", anonymous user")),this._checkSessionIFrame?this._checkSessionIFrame.start(r):this._metadataService.getCheckSessionIframe().then((function(e){if(e){i.Log.debug("SessionMonitor._start: Initializing check session iframe");var n=t._client_id,o=t._checkSessionInterval,s=t._stopCheckSessionOnError;t._checkSessionIFrame=new t._CheckSessionIFrameCtor(t._callback.bind(t),n,e,o,s),t._checkSessionIFrame.load().then((function(){t._checkSessionIFrame.start(r)}))}else i.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")})).catch((function(e){i.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",e.message)})))},e.prototype._stop=function(){var e=this;if(this._sub=void 0,this._sid=void 0,this._checkSessionIFrame&&(i.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop()),this._settings.monitorAnonymousSession)var t=this._timer.setInterval((function(){e._timer.clearInterval(t),e._userManager.querySessionStatus().then((function(t){var r={session_state:t.session_state};t.sub&&t.sid&&(r.profile={sub:t.sub,sid:t.sid}),e._start(r)})).catch((function(e){i.Log.error("SessionMonitor: error from querySessionStatus:",e.message)}))}),1e3)},e.prototype._callback=function(){var e=this;this._userManager.querySessionStatus().then((function(t){var r=!0;t?t.sub===e._sub?(r=!1,e._checkSessionIFrame.start(t.session_state),t.sid===e._sid?i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(i.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),e._userManager.events._raiseUserSessionChanged())):i.Log.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):i.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),r&&(e._sub?(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),e._userManager.events._raiseUserSignedOut()):(i.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed in event"),e._userManager.events._raiseUserSignedIn()))})).catch((function(t){e._sub&&(i.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),e._userManager.events._raiseUserSignedOut())}))},n(e,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSessionIFrame=void 0;var n=r(0);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.CheckSessionIFrame=function(){function e(t,r,n,o){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];i(this,e),this._callback=t,this._client_id=r,this._url=n,this._interval=o||2e3,this._stopOnError=s;var a=n.indexOf("/",n.indexOf("//")+2);this._frame_origin=n.substr(0,a),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.width=0,this._frame.height=0,this._frame.src=n}return e.prototype.load=function(){var e=this;return new Promise((function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),e._boundMessageEvent=e._message.bind(e),window.addEventListener("message",e._boundMessageEvent,!1)}))},e.prototype._message=function(e){e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(n.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(n.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):n.Log.debug("CheckSessionIFrame: "+e.data+" message from check session op iframe"))},e.prototype.start=function(e){var t=this;if(this._session_state!==e){n.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=window.setInterval(r,this._interval)}},e.prototype.stop=function(){this._session_state=null,this._timer&&(n.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRevocationClient=void 0;var n=r(0),i=r(2),o=r(1);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a="access_token",c="refresh_token";t.TokenRevocationClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.XMLHttpRequest,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService;if(s(this,e),!t)throw n.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=r,this._metadataService=new a(this._settings)}return e.prototype.revoke=function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"access_token";if(!e)throw n.Log.error("TokenRevocationClient.revoke: No token provided"),new Error("No token provided.");if(i!==a&&i!=c)throw n.Log.error("TokenRevocationClient.revoke: Invalid token type"),new Error("Invalid token type.");return this._metadataService.getRevocationEndpoint().then((function(o){if(o){n.Log.debug("TokenRevocationClient.revoke: Revoking "+i);var s=r._settings.client_id,a=r._settings.client_secret;return r._revoke(o,s,a,e,i)}if(t)throw n.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")}))},e.prototype._revoke=function(e,t,r,i,o){var s=this;return new Promise((function(a,c){var u=new s._XMLHttpRequestCtor;u.open("POST",e),u.onload=function(){n.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",u.status),200===u.status?a():c(Error(u.statusText+" ("+u.status+")"))},u.onerror=function(){n.Log.debug("TokenRevocationClient.revoke: Network Error."),c("Network Error")};var l="client_id="+encodeURIComponent(t);r&&(l+="&client_secret="+encodeURIComponent(r)),l+="&token_type_hint="+encodeURIComponent(o),l+="&token="+encodeURIComponent(i),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(l)}))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.CordovaPopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this.features=t.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=t.popupWindowTarget||"_blank",this.redirect_uri=t.startUrl,i.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return e.prototype._isInAppBrowserInstalled=function(e){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some((function(t){return e.hasOwnProperty(t)}))},e.prototype.navigate=function(e){if(e&&e.url){if(!window.cordova)return this._error("cordova is undefined");var t=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(t))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(e.url,this.target,this.features),this._popup?(i.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},e.prototype._loadStartCallback=function(e){0===e.url.indexOf(this.redirect_uri)&&this._success({url:e.url})},e.prototype._exitCallback=function(e){this._error(e)},e.prototype._success=function(e){this._cleanup(),i.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._popup&&(i.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(10),o=r(5),s=r(6),a=r(37),c=r(38),u=r(16),l=r(2),d=r(48),h=r(49),p=r(19),f=r(20),g=r(18),y=r(1),m=r(15),v=r(50);t.default={Version:v.Version,Log:n.Log,OidcClient:i.OidcClient,OidcClientSettings:o.OidcClientSettings,WebStorageStateStore:s.WebStorageStateStore,InMemoryWebStorage:a.InMemoryWebStorage,UserManager:c.UserManager,AccessTokenEvents:u.AccessTokenEvents,MetadataService:l.MetadataService,CordovaPopupNavigator:d.CordovaPopupNavigator,CordovaIFrameNavigator:h.CordovaIFrameNavigator,CheckSessionIFrame:p.CheckSessionIFrame,TokenRevocationClient:f.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:y.Global,User:m.User},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClockService=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.getEpochTime=function(){return Promise.resolve(Date.now()/1e3|0)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseValidator=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(0),o=r(2),s=r(25),a=r(11),c=r(12),u=r(4);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];t.ResponseValidator=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MetadataService,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UserInfoService,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.JoseUtil,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:a.TokenClient;if(l(this,e),!t)throw i.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new r(this._settings),this._userInfoService=new n(this._settings),this._joseUtil=c,this._tokenClient=new d(this._settings)}return e.prototype.validateSigninResponse=function(e,t){var r=this;return i.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: state processed"),r._validateTokens(e,t).then((function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),r._processClaims(e,t).then((function(e){return i.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),e}))}))}))},e.prototype.validateSignoutResponse=function(e,t){return e.id!==t.state?(i.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(i.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",t.error),Promise.reject(new c.ErrorResponse(t))):Promise.resolve(t))},e.prototype._processSigninParams=function(e,t){if(e.id!==t.state)return i.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!e.client_id)return i.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!e.authority)return i.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==e.authority)return i.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=e.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==e.client_id)return i.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=e.client_id;return i.Log.debug("ResponseValidator._processSigninParams: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator._processSigninParams: Response was error",t.error),Promise.reject(new c.ErrorResponse(t))):e.nonce&&!t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!e.nonce&&t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):e.code_verifier&&!t.code?(i.Log.error("ResponseValidator._processSigninParams: Expecting code in response"),Promise.reject(new Error("No code in response"))):!e.code_verifier&&t.code?(i.Log.error("ResponseValidator._processSigninParams: Not expecting code in response"),Promise.reject(new Error("Unexpected code in response"))):(t.scope||(t.scope=e.scope),Promise.resolve(t))},e.prototype._processClaims=function(e,t){var r=this;if(t.isOpenIdConnect){if(i.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),t.profile=this._filterProtocolClaims(t.profile),!0!==e.skipUserInfo&&this._settings.loadUserInfo&&t.access_token)return i.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(t.access_token).then((function(e){return i.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),e.sub!==t.profile.sub?(i.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in id_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in id_token"))):(t.profile=r._mergeClaims(t.profile,e),i.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",t.profile),t)}));i.Log.debug("ResponseValidator._processClaims: not loading user info")}else i.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(t)},e.prototype._mergeClaims=function(e,t){var r=Object.assign({},e);for(var i in t){var o=t[i];Array.isArray(o)||(o=[o]);for(var s=0;s<o.length;s++){var a=o[s];r[i]?Array.isArray(r[i])?r[i].indexOf(a)<0&&r[i].push(a):r[i]!==a&&("object"===(void 0===a?"undefined":n(a))&&this._settings.mergeClaims?r[i]=this._mergeClaims(r[i],a):r[i]=[r[i],a]):r[i]=a}}return r},e.prototype._filterProtocolClaims=function(e){i.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",e);var t=Object.assign({},e);return this._settings._filterProtocolClaims?(d.forEach((function(e){delete t[e]})),i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",t)):i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),t},e.prototype._validateTokens=function(e,t){return t.code?(i.Log.debug("ResponseValidator._validateTokens: Validating code"),this._processCode(e,t)):t.id_token?t.access_token?(i.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: No code to process or id_token to validate"),Promise.resolve(t))},e.prototype._processCode=function(e,t){var r=this,o={client_id:e.client_id,client_secret:e.client_secret,code:t.code,redirect_uri:e.redirect_uri,code_verifier:e.code_verifier};return e.extraTokenParams&&"object"===n(e.extraTokenParams)&&Object.assign(o,e.extraTokenParams),this._tokenClient.exchangeCode(o).then((function(n){for(var o in n)t[o]=n[o];return t.id_token?(i.Log.debug("ResponseValidator._processCode: token response successful, processing id_token"),r._validateIdTokenAttributes(e,t)):(i.Log.debug("ResponseValidator._processCode: token response successful, returning response"),t)}))},e.prototype._validateIdTokenAttributes=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){var o=e.client_id,s=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdTokenAttributes: Validaing JWT attributes; using clock skew (in seconds) of: ",s),r._settings.getEpochTime().then((function(a){return r._joseUtil.validateJwtAttributes(t.id_token,n,o,s,a).then((function(r){return e.nonce&&e.nonce!==r.nonce?(i.Log.error("ResponseValidator._validateIdTokenAttributes: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):r.sub?(t.profile=r,t):(i.Log.error("ResponseValidator._validateIdTokenAttributes: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))}))},e.prototype._validateIdTokenAndAccessToken=function(e,t){var r=this;return this._validateIdToken(e,t).then((function(e){return r._validateAccessToken(e)}))},e.prototype._getSigningKeyForJwt=function(e){var t=this;return this._metadataService.getSigningKeys().then((function(r){var n=e.header.kid;if(!r)return i.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));i.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var o=void 0;if(n)o=r.filter((function(e){return e.kid===n}))[0];else{if((r=t._filterByAlg(r,e.header.alg)).length>1)return i.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));o=r[0]}return Promise.resolve(o)}))},e.prototype._getSigningKeyForJwtWithSingleRetry=function(e){var t=this;return this._getSigningKeyForJwt(e).then((function(r){return r?Promise.resolve(r):(t._metadataService.resetSigningKeys(),t._getSigningKeyForJwt(e))}))},e.prototype._validateIdToken=function(e,t){var r=this;if(!e.nonce)return i.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var n=this._joseUtil.parseJwt(t.id_token);return n&&n.header&&n.payload?e.nonce!==n.payload.nonce?(i.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"))):this._metadataService.getIssuer().then((function(o){return i.Log.debug("ResponseValidator._validateIdToken: Received issuer"),r._getSigningKeyForJwtWithSingleRetry(n).then((function(s){if(!s)return i.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var a=e.client_id,c=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",c),r._joseUtil.validateJwt(t.id_token,s,o,a,c).then((function(){return i.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),n.payload.sub?(t.profile=n.payload,t):(i.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))}))}))})):(i.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",n),Promise.reject(new Error("Failed to parse id_token")))},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return i.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",t),[];r="EC"}return i.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),i.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",r,e.length),e},e.prototype._validateAccessToken=function(e){if(!e.profile)return i.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!e.profile.at_hash)return i.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!e.id_token)return i.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var t=this._joseUtil.parseJwt(e.id_token);if(!t||!t.header)return i.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",t),Promise.reject(new Error("Failed to parse id_token"));var r=t.header.alg;if(!r||5!==r.length)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r),Promise.reject(new Error("Unsupported alg: "+r));var n=r.substr(2,3);if(!n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));if(256!==(n=parseInt(n))&&384!==n&&512!==n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));var o="sha"+n,s=this._joseUtil.hashString(e.access_token,o);if(!s)return i.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",o),Promise.reject(new Error("Failed to validate at_hash"));var a=s.substr(0,s.length/2),c=this._joseUtil.hexToBase64Url(a);return c!==e.profile.at_hash?(i.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",c,e.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(i.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(e))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoService=void 0;var n=r(7),i=r(2),o=r(0),s=r(4);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.UserInfoService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.JsonService,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.MetadataService,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:s.JoseUtil;if(a(this,e),!t)throw o.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r(void 0,void 0,this._getClaimsFromJwt.bind(this)),this._metadataService=new c(this._settings),this._joseUtil=u}return e.prototype.getClaims=function(e){var t=this;return e?this._metadataService.getUserInfoEndpoint().then((function(r){return o.Log.debug("UserInfoService.getClaims: received userinfo url",r),t._jsonService.getJson(r,e).then((function(e){return o.Log.debug("UserInfoService.getClaims: claims received",e),e}))})):(o.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},e.prototype._getClaimsFromJwt=function e(t){var r=this;try{var n=this._joseUtil.parseJwt(t.responseText);if(!n||!n.header||!n.payload)return o.Log.error("UserInfoService._getClaimsFromJwt: Failed to parse JWT",n),Promise.reject(new Error("Failed to parse id_token"));var i=n.header.kid,s=void 0;switch(this._settings.userInfoJwtIssuer){case"OP":s=this._metadataService.getIssuer();break;case"ANY":s=Promise.resolve(n.payload.iss);break;default:s=Promise.resolve(this._settings.userInfoJwtIssuer)}return s.then((function(e){return o.Log.debug("UserInfoService._getClaimsFromJwt: Received issuer:"+e),r._metadataService.getSigningKeys().then((function(s){if(!s)return o.Log.error("UserInfoService._getClaimsFromJwt: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));o.Log.debug("UserInfoService._getClaimsFromJwt: Received signing keys");var a=void 0;if(i)a=s.filter((function(e){return e.kid===i}))[0];else{if((s=r._filterByAlg(s,n.header.alg)).length>1)return o.Log.error("UserInfoService._getClaimsFromJwt: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));a=s[0]}if(!a)return o.Log.error("UserInfoService._getClaimsFromJwt: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var c=r._settings.client_id,u=r._settings.clockSkew;return o.Log.debug("UserInfoService._getClaimsFromJwt: Validaing JWT; using clock skew (in seconds) of: ",u),r._joseUtil.validateJwt(t.responseText,a,e,c,u,void 0,!0).then((function(){return o.Log.debug("UserInfoService._getClaimsFromJwt: JWT validation successful"),n.payload}))}))}))}catch(e){return o.Log.error("UserInfoService._getClaimsFromJwt: Error parsing JWT response",e.message),void reject(e)}},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return o.Log.debug("UserInfoService._filterByAlg: alg not supported: ",t),[];r="EC"}return o.Log.debug("UserInfoService._filterByAlg: Looking for keys that match kty: ",r),e=e.filter((function(e){return e.kty===r})),o.Log.debug("UserInfoService._filterByAlg: Number of keys that match kty: ",r,e.length),e},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedSigningAlgs=t.b64tohex=t.hextob64u=t.crypto=t.X509=t.KeyUtil=t.jws=void 0;var n=r(27);t.jws=n.jws,t.KeyUtil=n.KEYUTIL,t.X509=n.X509,t.crypto=n.crypto,t.hextob64u=n.hextob64u,t.b64tohex=n.b64tohex,t.AllowedSigningAlgs=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"]},function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r,n,i,o,s,a,c,u,l,d,h,p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f={userAgent:!1},g={},y=y||(r=Math,i=(n={}).lib={},o=i.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=r.ceil(t/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(4294967296*r.random()|0);return new s.init(t,e)}}),a=n.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new s.init(r,t/2)}},u=a.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new s.init(r,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,i=t.sigBytes,o=this.blockSize,a=i/(4*o),c=(a=e?r.ceil(a):r.max((0|a)-this._minBufferSize,0))*o,u=r.min(4*c,i);if(c){for(var l=0;l<c;l+=o)this._doProcessBlock(n,l);var d=n.splice(0,c);t.sigBytes-=u}return new s.init(d,u)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),i.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}}),h=n.algo={},n);!function(e){var t,r=(t=y).lib,n=r.Base,i=r.WordArray;(t=t.x64={}).Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return i.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}})}(),function(){var e=y,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<r;s++)e.push(n.charAt(o>>>6*(3-s)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,n=this._map;(i=n.charAt(64))&&-1!=(i=e.indexOf(i))&&(r=i);for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n.indexOf(e.charAt(s-1))<<s%4*2,c=n.indexOf(e.charAt(s))>>>6-s%4*2;i[o>>>2]|=(a|c)<<24-o%4*8,o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var t=y,r=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},c=2,u=0;64>u;){var l;e:{l=c;for(var d=e.sqrt(l),h=2;h<=d;h++)if(!(l%h)){l=!1;break e}l=!0}l&&(8>u&&(o[u]=a(e.pow(c,.5))),s[u]=a(e.pow(c,1/3)),u++),c++}var p=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],c=r[4],u=r[5],l=r[6],d=r[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var f=p[h-15],g=p[h-2];p[h]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+p[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[h-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+s[h]+p[h],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),d=l,l=u,u=c,c=a+f|0,a=o,o=i,i=n,n=f+g|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0,r[5]=r[5]+u|0,r[6]=r[6]+l|0,r[7]=r[7]+d|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),function(){function e(){return n.create.apply(n,arguments)}for(var t=y,r=t.lib.Hasher,n=(o=t.x64).Word,i=o.WordArray,o=t.algo,s=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],c=0;80>c;c++)a[c]=e();o=o.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=(d=this._hash.words)[0],n=d[1],i=d[2],o=d[3],c=d[4],u=d[5],l=d[6],d=d[7],h=r.high,p=r.low,f=n.high,g=n.low,y=i.high,m=i.low,v=o.high,w=o.low,b=c.high,_=c.low,S=u.high,E=u.low,x=l.high,I=l.low,A=d.high,k=d.low,F=h,T=p,R=f,C=g,P=y,O=m,j=v,N=w,D=b,L=_,U=S,B=E,M=x,H=I,K=A,q=k,V=0;80>V;V++){var J=a[V];if(16>V)var W=J.high=0|e[t+2*V],$=J.low=0|e[t+2*V+1];else{W=(($=(W=a[V-15]).high)>>>1|(z=W.low)<<31)^($>>>8|z<<24)^$>>>7;var z=(z>>>1|$<<31)^(z>>>8|$<<24)^(z>>>7|$<<25),G=(($=(G=a[V-2]).high)>>>19|(Y=G.low)<<13)^($<<3|Y>>>29)^$>>>6,Y=(Y>>>19|$<<13)^(Y<<3|$>>>29)^(Y>>>6|$<<26),Q=($=a[V-7]).high,X=(Z=a[V-16]).high,Z=Z.low;W=(W=(W=W+Q+(($=z+$.low)>>>0<z>>>0?1:0))+G+(($+=Y)>>>0<Y>>>0?1:0))+X+(($+=Z)>>>0<Z>>>0?1:0),J.high=W,J.low=$}Q=D&U^~D&M,Z=L&B^~L&H,J=F&R^F&P^R&P;var ee=T&C^T&O^C&O,te=(z=(F>>>28|T<<4)^(F<<30|T>>>2)^(F<<25|T>>>7),G=(T>>>28|F<<4)^(T<<30|F>>>2)^(T<<25|F>>>7),(Y=s[V]).high),re=Y.low;X=K+((D>>>14|L<<18)^(D>>>18|L<<14)^(D<<23|L>>>9))+((Y=q+((L>>>14|D<<18)^(L>>>18|D<<14)^(L<<23|D>>>9)))>>>0<q>>>0?1:0),K=M,q=H,M=U,H=B,U=D,B=L,D=j+(X=(X=(X=X+Q+((Y+=Z)>>>0<Z>>>0?1:0))+te+((Y+=re)>>>0<re>>>0?1:0))+W+((Y+=$)>>>0<$>>>0?1:0))+((L=N+Y|0)>>>0<N>>>0?1:0)|0,j=P,N=O,P=R,O=C,R=F,C=T,F=X+(J=z+J+(($=G+ee)>>>0<G>>>0?1:0))+((T=Y+$|0)>>>0<Y>>>0?1:0)|0}p=r.low=p+T,r.high=h+F+(p>>>0<T>>>0?1:0),g=n.low=g+C,n.high=f+R+(g>>>0<C>>>0?1:0),m=i.low=m+O,i.high=y+P+(m>>>0<O>>>0?1:0),w=o.low=w+N,o.high=v+j+(w>>>0<N>>>0?1:0),_=c.low=_+L,c.high=b+D+(_>>>0<L>>>0?1:0),E=u.low=E+B,u.high=S+U+(E>>>0<B>>>0?1:0),I=l.low=I+H,l.high=x+M+(I>>>0<H>>>0?1:0),k=d.low=k+q,d.high=A+K+(k>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=r._createHelper(o),t.HmacSHA512=r._createHmacHelper(o)}(),function(){var e=y,t=(i=e.x64).Word,r=i.WordArray,n=(i=e.algo).SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)}();var m,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function w(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=v.charAt(r>>6)+v.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=v.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=v.charAt(r>>2)+v.charAt((3&r)<<4));(3&n.length)>0;)n+="=";return n}function b(e){var t,r,n,i="",o=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t)(n=v.indexOf(e.charAt(t)))<0||(0==o?(i+=k(n>>2),r=3&n,o=1):1==o?(i+=k(r<<2|n>>4),r=15&n,o=2):2==o?(i+=k(r),i+=k(n>>2),r=3&n,o=3):(i+=k(r<<2|n>>4),i+=k(15&n),o=0));return 1==o&&(i+=k(r<<2)),i}function _(e){var t,r=b(e),n=new Array;for(t=0;2*t<r.length;++t)n[t]=parseInt(r.substring(2*t,2*t+2),16);return n}function S(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function E(){return new S(null)}"Microsoft Internet Explorer"==f.appName?(S.prototype.am=function(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var c=32767&this[e],u=this[e++]>>15,l=a*c+u*s;i=((c=s*c+((32767&l)<<15)+r[n]+(1073741823&i))>>>30)+(l>>>15)+a*u+(i>>>30),r[n++]=1073741823&c}return i},m=30):"Netscape"!=f.appName?(S.prototype.am=function(e,t,r,n,i,o){for(;--o>=0;){var s=t*this[e++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i},m=26):(S.prototype.am=function(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var c=16383&this[e],u=this[e++]>>14,l=a*c+u*s;i=((c=s*c+((16383&l)<<14)+r[n]+i)>>28)+(l>>14)+a*u,r[n++]=268435455&c}return i},m=28),S.prototype.DB=m,S.prototype.DM=(1<<m)-1,S.prototype.DV=1<<m,S.prototype.FV=Math.pow(2,52),S.prototype.F1=52-m,S.prototype.F2=2*m-52;var x,I,A=new Array;for(x="0".charCodeAt(0),I=0;I<=9;++I)A[x++]=I;for(x="a".charCodeAt(0),I=10;I<36;++I)A[x++]=I;for(x="A".charCodeAt(0),I=10;I<36;++I)A[x++]=I;function k(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function F(e,t){var r=A[e.charCodeAt(t)];return null==r?-1:r}function T(e){var t=E();return t.fromInt(e),t}function R(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function C(e){this.m=e}function P(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function O(e,t){return e&t}function j(e,t){return e|t}function N(e,t){return e^t}function D(e,t){return e&~t}function L(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function U(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function B(){}function M(e){return e}function H(e){this.r2=E(),this.q3=E(),S.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}C.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},C.prototype.revert=function(e){return e},C.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},C.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},C.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},P.prototype.convert=function(e){var t=E();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(S.ZERO)>0&&this.m.subTo(t,t),t},P.prototype.revert=function(e){var t=E();return e.copyTo(t),this.reduce(t),t},P.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},P.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},P.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},S.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},S.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},S.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var s=8==r?255&e[n]:F(e,n);s<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+r>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&S.ZERO.subTo(this,this)},S.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},S.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},S.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},S.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},S.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}},S.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},S.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&S.ZERO.subTo(t,t)},S.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},S.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=E());var o=E(),s=this.s,a=e.s,c=this.DB-R(n[n.t-1]);c>0?(n.lShiftTo(c,o),i.lShiftTo(c,r)):(n.copyTo(o),i.copyTo(r));var u=o.t,l=o[u-1];if(0!=l){var d=l*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,f=1<<this.F2,g=r.t,y=g-u,m=null==t?E():t;for(o.dlShiftTo(y,m),r.compareTo(m)>=0&&(r[r.t++]=1,r.subTo(m,r)),S.ONE.dlShiftTo(u,m),m.subTo(o,o);o.t<u;)o[o.t++]=0;for(;--y>=0;){var v=r[--g]==l?this.DM:Math.floor(r[g]*h+(r[g-1]+f)*p);if((r[g]+=o.am(0,v,r,y,0,u))<v)for(o.dlShiftTo(y,m),r.subTo(m,r);r[g]<--v;)r.subTo(m,r)}null!=t&&(r.drShiftTo(u,t),s!=a&&S.ZERO.subTo(t,t)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),s<0&&S.ZERO.subTo(r,r)}}},S.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},S.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},S.prototype.exp=function(e,t){if(e>4294967295||e<1)return S.ONE;var r=E(),n=E(),i=t.convert(this),o=R(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var s=r;r=n,n=s}return t.revert(r)},S.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=k(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=k(r));return i?o:"0"},S.prototype.negate=function(){var e=E();return S.ZERO.subTo(this,e),e},S.prototype.abs=function(){return this.s<0?this.negate():this},S.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},S.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+R(this[this.t-1]^this.s&this.DM)},S.prototype.mod=function(e){var t=E();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(S.ZERO)>0&&e.subTo(t,t),t},S.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new C(t):new P(t),this.exp(e,r)},S.ZERO=T(0),S.ONE=T(1),B.prototype.convert=M,B.prototype.revert=M,B.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},B.prototype.sqrTo=function(e,t){e.squareTo(t)},H.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=E();return e.copyTo(t),this.reduce(t),t},H.prototype.revert=function(e){return e},H.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},H.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},H.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var K,q,V,J=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],W=(1<<26)/J[J.length-1];function $(){this.i=0,this.j=0,this.S=new Array}function z(){!function(e){q[V++]^=255&e,q[V++]^=e>>8&255,q[V++]^=e>>16&255,q[V++]^=e>>24&255,V>=256&&(V-=256)}((new Date).getTime())}if(S.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},S.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=T(r),i=E(),o=E(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(e)+s},S.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,s=0,a=0;a<e.length;++a){var c=F(e,a);c<0?"-"==e.charAt(a)&&0==this.signum()&&(i=!0):(s=t*s+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&S.ZERO.subTo(this,this)},S.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(S.ONE.shiftLeft(e-1),j,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(S.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},S.prototype.bitwiseTo=function(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},S.prototype.changeBit=function(e,t){var r=S.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},S.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},S.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},S.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},S.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},S.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},S.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},S.prototype.millerRabin=function(e){var t=this.subtract(S.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>J.length&&(e=J.length);for(var i=E(),o=0;o<e;++o){i.fromInt(J[Math.floor(Math.random()*J.length)]);var s=i.modPow(n,this);if(0!=s.compareTo(S.ONE)&&0!=s.compareTo(t)){for(var a=1;a++<r&&0!=s.compareTo(t);)if(0==(s=s.modPowInt(2,this)).compareTo(S.ONE))return!1;if(0!=s.compareTo(t))return!1}}return!0},S.prototype.clone=function(){var e=E();return this.copyTo(e),e},S.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},S.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},S.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},S.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},S.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},S.prototype.equals=function(e){return 0==this.compareTo(e)},S.prototype.min=function(e){return this.compareTo(e)<0?this:e},S.prototype.max=function(e){return this.compareTo(e)>0?this:e},S.prototype.and=function(e){var t=E();return this.bitwiseTo(e,O,t),t},S.prototype.or=function(e){var t=E();return this.bitwiseTo(e,j,t),t},S.prototype.xor=function(e){var t=E();return this.bitwiseTo(e,N,t),t},S.prototype.andNot=function(e){var t=E();return this.bitwiseTo(e,D,t),t},S.prototype.not=function(){for(var e=E(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},S.prototype.shiftLeft=function(e){var t=E();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},S.prototype.shiftRight=function(e){var t=E();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},S.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+L(this[e]);return this.s<0?this.t*this.DB:-1},S.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=U(this[r]^t);return e},S.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},S.prototype.setBit=function(e){return this.changeBit(e,j)},S.prototype.clearBit=function(e){return this.changeBit(e,D)},S.prototype.flipBit=function(e){return this.changeBit(e,N)},S.prototype.add=function(e){var t=E();return this.addTo(e,t),t},S.prototype.subtract=function(e){var t=E();return this.subTo(e,t),t},S.prototype.multiply=function(e){var t=E();return this.multiplyTo(e,t),t},S.prototype.divide=function(e){var t=E();return this.divRemTo(e,t,null),t},S.prototype.remainder=function(e){var t=E();return this.divRemTo(e,null,t),t},S.prototype.divideAndRemainder=function(e){var t=E(),r=E();return this.divRemTo(e,t,r),new Array(t,r)},S.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=T(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new C(t):t.isEven()?new H(t):new P(t);var s=new Array,a=3,c=r-1,u=(1<<r)-1;if(s[1]=n.convert(this),r>1){var l=E();for(n.sqrTo(s[1],l);a<=u;)s[a]=E(),n.mulTo(l,s[a-2],s[a]),a+=2}var d,h,p=e.t-1,f=!0,g=E();for(i=R(e[p])-1;p>=0;){for(i>=c?d=e[p]>>i-c&u:(d=(e[p]&(1<<i+1)-1)<<c-i,p>0&&(d|=e[p-1]>>this.DB+i-c)),a=r;0==(1&d);)d>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),f)s[d].copyTo(o),f=!1;else{for(;a>1;)n.sqrTo(o,g),n.sqrTo(g,o),a-=2;a>0?n.sqrTo(o,g):(h=o,o=g,g=h),n.mulTo(g,s[d],o)}for(;p>=0&&0==(e[p]&1<<i);)n.sqrTo(o,g),h=o,o=g,g=h,--i<0&&(i=this.DB-1,--p)}return n.revert(o)},S.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return S.ZERO;for(var r=e.clone(),n=this.clone(),i=T(1),o=T(0),s=T(0),a=T(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),t&&s.subTo(i,s),a.subTo(o,a))}return 0!=n.compareTo(S.ONE)?S.ZERO:a.compareTo(e)>=0?a.subtract(e):a.signum()<0?(a.addTo(e,a),a.signum()<0?a.add(e):a):a},S.prototype.pow=function(e){return this.exp(e,new B)},S.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},S.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=J[J.length-1]){for(t=0;t<J.length;++t)if(r[0]==J[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<J.length;){for(var n=J[t],i=t+1;i<J.length&&n<W;)n*=J[i++];for(n=r.modInt(n);t<i;)if(n%J[t++]==0)return!1}return r.millerRabin(e)},S.prototype.square=function(){var e=E();return this.squareTo(e),e},$.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},$.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]},null==q){var G;if(q=new Array,V=0,void 0!==g&&(void 0!==g.crypto||void 0!==g.msCrypto)){var Y=g.crypto||g.msCrypto;if(Y.getRandomValues){var Q=new Uint8Array(32);for(Y.getRandomValues(Q),G=0;G<32;++G)q[V++]=Q[G]}else if("Netscape"==f.appName&&f.appVersion<"5"){var X=g.crypto.random(32);for(G=0;G<X.length;++G)q[V++]=255&X.charCodeAt(G)}}for(;V<256;)G=Math.floor(65536*Math.random()),q[V++]=G>>>8,q[V++]=255&G;V=0,z()}function Z(){if(null==K){for(z(),(K=new $).init(q),V=0;V<q.length;++V)q[V]=0;V=0}return K.next()}function ee(){}function te(e,t){return new S(e,t)}function re(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function ne(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ie(e,t){this.x=t,this.q=e}function oe(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?S.ONE:n,this.zinv=null}function se(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new oe(this,null,null)}ee.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=Z()},ne.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},ne.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=te(e,16),this.e=parseInt(t,16)}},ne.prototype.encrypt=function(e){var t=function(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var o=new ee,s=new Array;t>2;){for(s[0]=0;0==s[0];)o.nextBytes(s);r[--t]=s[0]}return r[--t]=2,r[--t]=0,new S(r)}(e,this.n.bitLength()+7>>3);if(null==t)return null;var r=this.doPublic(t);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n},ne.prototype.encryptOAEP=function(e,t,r){var n=function(e,t,r,n){var i=ce.crypto.MessageDigest,o=ce.crypto.Util,s=null;if(r||(r="sha1"),"string"==typeof r&&(s=i.getCanonicalAlgName(r),n=i.getHashLength(s),r=function(e){return Se(o.hashHex(Ee(e),s))}),e.length+2*n+2>t)throw"Message too long for RSA";var a,c="";for(a=0;a<t-e.length-2*n-2;a+=1)c+="\0";var u=r("")+c+""+e,l=new Array(n);(new ee).nextBytes(l);var d=re(l,u.length,r),h=[];for(a=0;a<u.length;a+=1)h[a]=u.charCodeAt(a)^d.charCodeAt(a);var p=re(h,l.length,r),f=[0];for(a=0;a<l.length;a+=1)f[a+1]=l[a]^p.charCodeAt(a);return new S(f.concat(h))}(e,this.n.bitLength()+7>>3,t,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o},ne.prototype.type="RSA",ie.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},ie.prototype.toBigInteger=function(){return this.x},ie.prototype.negate=function(){return new ie(this.q,this.x.negate().mod(this.q))},ie.prototype.add=function(e){return new ie(this.q,this.x.add(e.toBigInteger()).mod(this.q))},ie.prototype.subtract=function(e){return new ie(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},ie.prototype.multiply=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},ie.prototype.square=function(){return new ie(this.q,this.x.square().mod(this.q))},ie.prototype.divide=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},oe.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},oe.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(S.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(S.ZERO))},oe.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(S.ZERO)&&!this.y.toBigInteger().equals(S.ZERO)},oe.prototype.negate=function(){return new oe(this.curve,this.x,this.y.negate(),this.z)},oe.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(S.ZERO.equals(r))return S.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new S("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),s=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),a=s.multiply(r),c=i.multiply(s),u=t.square().multiply(this.z),l=u.subtract(c.shiftLeft(1)).multiply(e.z).subtract(a).multiply(r).mod(this.curve.q),d=c.multiply(n).multiply(t).subtract(o.multiply(a)).subtract(u.multiply(t)).multiply(e.z).add(t.multiply(a)).mod(this.curve.q),h=a.multiply(this.z).multiply(e.z).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(d),h)},oe.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new S("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),o=this.curve.a.toBigInteger(),s=t.square().multiply(e);S.ZERO.equals(o)||(s=s.add(this.z.square().multiply(o)));var a=(s=s.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),c=s.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(s.square().multiply(s)).mod(this.curve.q),u=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new oe(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(c),u)},oe.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new S("3")),i=this.negate(),o=this,s=this.curve.q.subtract(e),a=s.multiply(new S("3")),c=new oe(this.curve,this.x,this.y),u=c.negate();for(t=n.bitLength()-2;t>0;--t){o=o.twice();var l=n.testBit(t);l!=r.testBit(t)&&(o=o.add(l?this:i))}for(t=a.bitLength()-2;t>0;--t){c=c.twice();var d=a.testBit(t);d!=s.testBit(t)&&(c=c.add(d?c:u))}return o},oe.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},se.prototype.getQ=function(){return this.q},se.prototype.getA=function(){return this.a},se.prototype.getB=function(){return this.b},se.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},se.prototype.getInfinity=function(){return this.infinity},se.prototype.fromBigInteger=function(e){return new ie(this.q,e)},se.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:default:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new oe(this,this.fromBigInteger(new S(r,16)),this.fromBigInteger(new S(n,16)))}},ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},oe.prototype.getEncoded=function(e){var t=function(e,t){var r=e.toByteArrayUnsigned();if(t<r.length)r=r.slice(r.length-t);else for(;t>r.length;)r.unshift(0);return r},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i},oe.decodeFrom=function(e,t){t[0];var r=t.length-1,n=t.slice(1,1+r/2),i=t.slice(1+r/2,1+r);n.unshift(0),i.unshift(0);var o=new S(n),s=new S(i);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.decodeFromHex=function(e,t){t.substr(0,2);var r=t.length-2,n=t.substr(2,r/2),i=t.substr(2+r/2,r/2),o=new S(n,16),s=new S(i,16);return new oe(e,e.fromBigInteger(o),e.fromBigInteger(s))},oe.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y).divide(t),n=r.square().subtract(this.x).subtract(e.x),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new oe(this.curve,n,i)},oe.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(S.valueOf(2)),t=this.curve.fromBigInteger(S.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new oe(this.curve,n,i)},oe.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new S("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var s=n.testBit(t);s!=r.testBit(t)&&(o=o.add2D(s?this:i))}return o},oe.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),o=t.multiply(t).mod(i),s=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return o.equals(s)},oe.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},oe.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(S.ONE)<0||t.compareTo(e.subtract(S.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(S.ONE)<0||r.compareTo(e.subtract(S.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var ae=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),r={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function n(e,t,n){return t?r[t]:String.fromCharCode(parseInt(n,16))}var i=new String(""),o=Object.hasOwnProperty;return function(r,s){var a,c,u=r.match(e),l=u[0],d=!1;"{"===l?a={}:"["===l?a=[]:(a=[],d=!0);for(var h=[a],f=1-d,g=u.length;f<g;++f){var y;switch((l=u[f]).charCodeAt(0)){default:(y=h[0])[c||y.length]=+l,c=void 0;break;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(t,n)),y=h[0],!c){if(!(y instanceof Array)){c=l||i;break}c=y.length}y[c]=l,c=void 0;break;case 91:y=h[0],h.unshift(y[c||y.length]=[]),c=void 0;break;case 93:case 125:h.shift();break;case 102:(y=h[0])[c||y.length]=!1,c=void 0;break;case 110:(y=h[0])[c||y.length]=null,c=void 0;break;case 116:(y=h[0])[c||y.length]=!0,c=void 0;break;case 123:y=h[0],h.unshift(y[c||y.length]={}),c=void 0}}if(d){if(1!==h.length)throw new Error;a=a[0]}else if(h.length)throw new Error;return s&&(a=function e(t,r){var n=t[r];if(n&&"object"===(void 0===n?"undefined":p(n))){var i=null;for(var a in n)if(o.call(n,a)&&n!==t){var c=e(n,a);void 0!==c?n[a]=c:(i||(i=[]),i.push(a))}if(i)for(var u=i.length;--u>=0;)delete n[i[u]]}return s.call(t,r,n)}({"":a},"")),a}}();void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.asn1&&ce.asn1||(ce.asn1={}),ce.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",i=0;i<r;i++)n+="f";t=new S(n,16).xor(e).add(S.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return ke(e,t)},this.newObject=function(e){var t=ce.asn1,r=t.ASN1Object,n=t.DERBoolean,i=t.DERInteger,o=t.DERBitString,s=t.DEROctetString,a=t.DERNull,c=t.DERObjectIdentifier,u=t.DEREnumerated,l=t.DERUTF8String,d=t.DERNumericString,h=t.DERPrintableString,p=t.DERTeletexString,f=t.DERIA5String,g=t.DERUTCTime,y=t.DERGeneralizedTime,m=t.DERVisibleString,v=t.DERBMPString,w=t.DERSequence,b=t.DERSet,_=t.DERTaggedObject,S=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var E=Object.keys(e);if(1!=E.length)throw new Error("key of param shall be only one.");var x=E[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+x+":"))throw new Error("undefined key: "+x);if("bool"==x)return new n(e[x]);if("int"==x)return new i(e[x]);if("bitstr"==x)return new o(e[x]);if("octstr"==x)return new s(e[x]);if("null"==x)return new a(e[x]);if("oid"==x)return new c(e[x]);if("enum"==x)return new u(e[x]);if("utf8str"==x)return new l(e[x]);if("numstr"==x)return new d(e[x]);if("prnstr"==x)return new h(e[x]);if("telstr"==x)return new p(e[x]);if("ia5str"==x)return new f(e[x]);if("utctime"==x)return new g(e[x]);if("gentime"==x)return new y(e[x]);if("visstr"==x)return new m(e[x]);if("bmpstr"==x)return new v(e[x]);if("asn1"==x)return new r(e[x]);if("seq"==x){for(var I=e[x],A=[],k=0;k<I.length;k++){var F=S(I[k]);A.push(F)}return new w({array:A})}if("set"==x){for(I=e[x],A=[],k=0;k<I.length;k++)F=S(I[k]),A.push(F);return new b({array:A})}if("tag"==x){var T=e[x];if("[object Array]"===Object.prototype.toString.call(T)&&3==T.length){var R=S(T[2]);return new _({tag:T[0],explicit:T[1],obj:R})}return new _(T)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},ce.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),i=2;i<e.length;i+=2){var o=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);n+=o.substr(1,7),"0"==o.substr(0,1)&&(t=t+"."+new S(n,2).toString(10),n="")}return t},ce.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new S(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),o=40*parseInt(i[0])+parseInt(i[1]);n+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)n+=r(i[s]);return n},ce.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+"".length+",v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},ce.asn1.DERAbstractString=function(e){ce.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=be(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},He(ce.asn1.DERAbstractString,ce.asn1.ASN1Object),ce.asn1.DERAbstractTime=function(e){ce.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,r){var n=this.zeroPadding,i=this.localDateToUTC(e),o=String(i.getFullYear());"utc"==t&&(o=o.substr(2,2));var s=o+n(String(i.getMonth()+1),2)+n(String(i.getDate()),2)+n(String(i.getHours()),2)+n(String(i.getMinutes()),2)+n(String(i.getSeconds()),2);if(!0===r){var a=i.getMilliseconds();if(0!=a){var c=n(String(a),3);s=s+"."+(c=c.replace(/[0]+$/,""))}}return s+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=ge(e)},this.setByDateValue=function(e,t,r,n,i,o){var s=new Date(Date.UTC(e,t-1,r,n,i,o,0));this.setByDate(s)},this.getFreshValueHex=function(){return this.hV}},He(ce.asn1.DERAbstractTime,ce.asn1.ASN1Object),ce.asn1.DERAbstractStructured=function(e){ce.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},He(ce.asn1.DERAbstractStructured,ce.asn1.ASN1Object),ce.asn1.DERBoolean=function(e){ce.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},He(ce.asn1.DERBoolean,ce.asn1.ASN1Object),ce.asn1.DERInteger=function(e){ce.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ce.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new S(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},He(ce.asn1.DERInteger,ce.asn1.ASN1Object),ce.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ce.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}ce.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var r="0"+e;this.hTLV=null,this.isModified=!0,this.hV=r+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var i=e.substr(r,8),o=parseInt(i,2).toString(16);1==o.length&&(o="0"+o),n+=o}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},He(ce.asn1.DERBitString,ce.asn1.ASN1Object),ce.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ce.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}ce.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},He(ce.asn1.DEROctetString,ce.asn1.DERAbstractString),ce.asn1.DERNull=function(){ce.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},He(ce.asn1.DERNull,ce.asn1.ASN1Object),ce.asn1.DERObjectIdentifier=function(e){ce.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=parseInt(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var o="",s=0;s<i;s++)o+="0";for(n=o+n,s=0;s<n.length-1;s+=7){var a=n.substr(s,7);s!=n.length-7&&(a="1"+a),r+=t(parseInt(a,2))}return r};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),o=40*parseInt(i[0],10)+parseInt(i[1],10);n+=t(o),i.splice(0,2);for(var s=0;s<i.length;s++)n+=r(i[s]);return n}catch(e){return null}}(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=ce.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},He(ce.asn1.DERObjectIdentifier,ce.asn1.ASN1Object),ce.asn1.DEREnumerated=function(e){ce.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ce.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new S(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},He(ce.asn1.DEREnumerated,ce.asn1.ASN1Object),ce.asn1.DERUTF8String=function(e){ce.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},He(ce.asn1.DERUTF8String,ce.asn1.DERAbstractString),ce.asn1.DERNumericString=function(e){ce.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},He(ce.asn1.DERNumericString,ce.asn1.DERAbstractString),ce.asn1.DERPrintableString=function(e){ce.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},He(ce.asn1.DERPrintableString,ce.asn1.DERAbstractString),ce.asn1.DERTeletexString=function(e){ce.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},He(ce.asn1.DERTeletexString,ce.asn1.DERAbstractString),ce.asn1.DERIA5String=function(e){ce.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},He(ce.asn1.DERIA5String,ce.asn1.DERAbstractString),ce.asn1.DERVisibleString=function(e){ce.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},He(ce.asn1.DERVisibleString,ce.asn1.DERAbstractString),ce.asn1.DERBMPString=function(e){ce.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},He(ce.asn1.DERBMPString,ce.asn1.DERAbstractString),ce.asn1.DERUTCTime=function(e){ce.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=ge(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=ge(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},He(ce.asn1.DERUTCTime,ce.asn1.DERAbstractTime),ce.asn1.DERGeneralizedTime=function(e){ce.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=ge(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=ge(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},He(ce.asn1.DERGeneralizedTime,ce.asn1.DERAbstractTime),ce.asn1.DERSequence=function(e){ce.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++)e+=this.asn1Array[t].getEncodedHex();return this.hV=e,this.hV}},He(ce.asn1.DERSequence,ce.asn1.DERAbstractStructured),ce.asn1.DERSet=function(e){ce.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},He(ce.asn1.DERSet,ce.asn1.DERAbstractStructured),ce.asn1.DERTaggedObject=function(e){ce.asn1.DERTaggedObject.superclass.constructor.call(this);var t=ce.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){null!=e.tag&&(this.hT=e.tag),null!=e.explicit&&(this.isExplicit=e.explicit),null!=e.tage&&(this.hT=e.tage,this.isExplicit=!0),null!=e.tagi&&(this.hT=e.tagi,this.isExplicit=!1),null!=e.obj&&(e.obj instanceof t.ASN1Object?(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==p(e.obj)&&(this.asn1Object=t.ASN1Util.newObject(e.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=e&&this.setByParam(e)},He(ce.asn1.DERTaggedObject,ce.asn1.ASN1Object);var ce,ue,le,de=new function(){};function he(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function pe(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}function fe(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function ge(e){return fe(he(e))}function ye(e){return(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function me(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function ve(e){return e.length%2==1&&(e="0"+e),ye(w(e))}function we(e){return b(me(e))}function be(e){return Ce(Le(e))}function _e(e){return decodeURIComponent(Pe(e))}function Se(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function Ee(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function xe(e){return w(e)}function Ie(e){return xe(e).replace(/(.{64})/g,"$1\r\n").replace(/\r\n$/,"")}function Ae(e){return b(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function ke(e,t){return"-----BEGIN "+t+"-----\r\n"+Ie(e)+"\r\n-----END "+t+"-----\r\n"}function Fe(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return Ae(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Te(e){var t,r,n,i,o,s,a,c,u,l,d;if(d=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return c=d[1],t=parseInt(c),2===c.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),r=parseInt(d[2])-1,n=parseInt(d[3]),i=parseInt(d[4]),o=parseInt(d[5]),s=parseInt(d[6]),a=0,""!==(u=d[7])&&(l=(u.substr(1)+"00").substr(0,3),a=parseInt(l)),Date.UTC(t,r,n,i,o,s,a);throw"unsupported zulu format: "+e}function Re(e){return~~(Te(e)/1e3)}function Ce(e){return e.replace(/%/g,"")}function Pe(e){return e.replace(/(..)/g,"%$1")}function Oe(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var r=(e=e.toLowerCase()).split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2),i=(e=e.replace("::",n)).split(":");if(8!=i.length)throw t;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function je(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),r=0;r<8;r++)t[r]=t[r].replace(/^0+/,""),""==t[r]&&(t[r]="0");var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);var i="";for(r=0;r<n.length;r++)n[r].length>i.length&&(i=n[r]);return(e=e.replace(i,"::")).slice(1,-1)}function Ne(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?je(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function De(e){return e.match(/.{4}/g).map((function(e){var t=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2),16);if(0==t&r<128)return String.fromCharCode(r);if(t<8){var n=128|63&r;return _e((192|(7&t)<<3|(192&r)>>6).toString(16)+n.toString(16))}n=128|(15&t)<<2|(192&r)>>6;var i=128|63&r;return _e((224|(240&t)>>4).toString(16)+n.toString(16)+i.toString(16))})).join("")}function Le(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)"%"==t[n]?(r+=t.substr(n,3),n+=2):r=r+"%"+ge(t[n]);return r}function Ue(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Be(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}de.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},de.getL=function(e,t){var r=de.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},de.getVblen=function(e,t){var r;return""==(r=de.getL(e,t))?-1:("8"===r.substr(0,1)?new S(r.substr(2),16):new S(r,16)).intValue()},de.getVidx=function(e,t){var r=de.getLblen(e,t);return r<0?r:t+2*(r+1)},de.getV=function(e,t){var r=de.getVidx(e,t),n=de.getVblen(e,t);return e.substr(r,2*n)},de.getTLV=function(e,t){return e.substr(t,2)+de.getL(e,t)+de.getV(e,t)},de.getTLVblen=function(e,t){return 2+2*de.getLblen(e,t)+2*de.getVblen(e,t)},de.getNextSiblingIdx=function(e,t){return de.getVidx(e,t)+2*de.getVblen(e,t)},de.getChildIdx=function(e,t){var r,n,i,o=de,s=[];r=o.getVidx(e,t),n=2*o.getVblen(e,t),"03"==e.substr(t,2)&&(r+=2,n-=2),i=0;for(var a=r;i<=n;){var c=o.getTLVblen(e,a);if((i+=c)<=n&&s.push(a),a+=c,i>=n)break}return s},de.getNthChildIdx=function(e,t,r){return de.getChildIdx(e,t)[r]},de.getIdxbyList=function(e,t,r,n){var i,o,s=de;return 0==r.length?void 0!==n&&e.substr(t,2)!==n?-1:t:(i=r.shift())>=(o=s.getChildIdx(e,t)).length?-1:s.getIdxbyList(e,o[i],r,n)},de.getIdxbyListEx=function(e,t,r,n){var i,o,s=de;if(0==r.length)return void 0!==n&&e.substr(t,2)!==n?-1:t;i=r.shift(),o=s.getChildIdx(e,t);for(var a=0,c=0;c<o.length;c++){var u=e.substr(o[c],2);if("number"==typeof i&&!s.isContextTag(u)&&a==i||"string"==typeof i&&s.isContextTag(u,i))return s.getIdxbyListEx(e,o[c],r,n);s.isContextTag(u)||a++}return-1},de.getTLVbyList=function(e,t,r,n){var i=de,o=i.getIdxbyList(e,t,r,n);return-1==o||o>=e.length?null:i.getTLV(e,o)},de.getTLVbyListEx=function(e,t,r,n){var i=de,o=i.getIdxbyListEx(e,t,r,n);return-1==o?null:i.getTLV(e,o)},de.getVbyList=function(e,t,r,n,i){var o,s,a=de;return-1==(o=a.getIdxbyList(e,t,r,n))||o>=e.length?null:(s=a.getV(e,o),!0===i&&(s=s.substr(2)),s)},de.getVbyListEx=function(e,t,r,n,i){var o,s,a=de;return-1==(o=a.getIdxbyListEx(e,t,r,n))?null:(s=a.getV(e,o),"03"==e.substr(o,2)&&!1!==i&&(s=s.substr(2)),s)},de.getInt=function(e,t,r){null==r&&(r=-1);try{var n=e.substr(t,2);if("02"!=n&&"03"!=n)return r;var i=de.getV(e,t);return"02"==n?parseInt(i,16):function(e){try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var r=parseInt(t,16),n=e.substr(2),i=parseInt(n,16).toString(2);return"0"==i&&(i="00000000"),i=i.slice(0,0-r),parseInt(i,2)}catch(e){return-1}}(i)}catch(e){return r}},de.getOID=function(e,t,r){null==r&&(r=null);try{return"06"!=e.substr(t,2)?r:function(e){if(!Ue(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),o=[],s=0;s<i.length/2;s++)o.push(parseInt(i.substr(2*s,2),16));var a=[],c="";for(s=0;s<o.length;s++)128&o[s]?c+=Me((127&o[s]).toString(2),7):(c+=Me((127&o[s]).toString(2),7),a.push(new String(parseInt(c,2))),c="");var u=t.join(".");return a.length>0&&(u=u+"."+a.join(".")),u}catch(e){return null}}(de.getV(e,t))}catch(e){return r}},de.getOIDName=function(e,t,r){null==r&&(r=null);try{var n=de.getOID(e,t,r);if(n==r)return r;var i=ce.asn1.x509.OID.oid2name(n);return""==i?n:i}catch(e){return r}},de.getString=function(e,t,r){null==r&&(r=null);try{return Se(de.getV(e,t))}catch(e){return r}},de.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var o=e.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));var c=[],u="";for(a=0;a<s.length;a++)128&s[a]?u+=t((127&s[a]).toString(2),7):(u+=t((127&s[a]).toString(2),7),c.push(new String(parseInt(u,2))),u="");var l=r.join(".");return c.length>0&&(l=l+"."+c.join(".")),l},de.dump=function(e,t,r,n){var i=de,o=i.getV,s=i.dump,a=i.getChildIdx,c=e;e instanceof ce.asn1.ASN1Object&&(c=e.getEncodedHex());var u=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===r&&(r=0),void 0===n&&(n="");var l,d=t.ommit_long_octet;if("01"==(l=c.substr(r,2)))return"00"==(h=o(c,r))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==l)return n+"INTEGER "+u(h=o(c,r),d)+"\n";if("03"==l){var h=o(c,r);return i.isASN1HEX(h.substr(2))?(_=n+"BITSTRING, encapsulates\n")+s(h.substr(2),t,0,n+"  "):n+"BITSTRING "+u(h,d)+"\n"}if("04"==l)return h=o(c,r),i.isASN1HEX(h)?(_=n+"OCTETSTRING, encapsulates\n")+s(h,t,0,n+"  "):n+"OCTETSTRING "+u(h,d)+"\n";if("05"==l)return n+"NULL\n";if("06"==l){var p=o(c,r),f=ce.asn1.ASN1Util.oidHexToInt(p),g=ce.asn1.x509.OID.oid2name(f),y=f.replace(/\./g," ");return""!=g?n+"ObjectIdentifier "+g+" ("+y+")\n":n+"ObjectIdentifier ("+y+")\n"}if("0a"==l)return n+"ENUMERATED "+parseInt(o(c,r))+"\n";if("0c"==l)return n+"UTF8String '"+_e(o(c,r))+"'\n";if("13"==l)return n+"PrintableString '"+_e(o(c,r))+"'\n";if("14"==l)return n+"TeletexString '"+_e(o(c,r))+"'\n";if("16"==l)return n+"IA5String '"+_e(o(c,r))+"'\n";if("17"==l)return n+"UTCTime "+_e(o(c,r))+"\n";if("18"==l)return n+"GeneralizedTime "+_e(o(c,r))+"\n";if("1a"==l)return n+"VisualString '"+_e(o(c,r))+"'\n";if("1e"==l)return n+"BMPString '"+De(o(c,r))+"'\n";if("30"==l){if("3000"==c.substr(r,4))return n+"SEQUENCE {}\n";_=n+"SEQUENCE\n";var m=t;if((2==(b=a(c,r)).length||3==b.length)&&"06"==c.substr(b[0],2)&&"04"==c.substr(b[b.length-1],2)){g=i.oidname(o(c,b[0]));var v=JSON.parse(JSON.stringify(t));v.x509ExtName=g,m=v}for(var w=0;w<b.length;w++)_+=s(c,m,b[w],n+"  ");return _}if("31"==l){_=n+"SET\n";var b=a(c,r);for(w=0;w<b.length;w++)_+=s(c,t,b[w],n+"  ");return _}if(0!=(128&(l=parseInt(l,16)))){var _,S=31&l;if(0!=(32&l)){for(_=n+"["+S+"]\n",b=a(c,r),w=0;w<b.length;w++)_+=s(c,t,b[w],n+"  ");return _}return h=o(c,r),de.isASN1HEX(h)?(_=n+"["+S+"]\n")+s(h,t,0,n+"  "):(("68747470"==h.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==S)&&(h=_e(h)),n+"["+S+"] "+h+"\n")}return n+"UNKNOWN("+l+") "+o(c,r)+"\n"},de.isContextTag=function(e,t){var r,n;e=e.toLowerCase();try{r=parseInt(e,16)}catch(e){return-1}if(void 0===t)return 128==(192&r);try{return null!=t.match(/^\[[0-9]+\]$/)&&!((n=parseInt(t.substr(1,t.length-1),10))>31)&&128==(192&r)&&(31&r)==n}catch(e){return!1}},de.isASN1HEX=function(e){var t=de;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0);return e.length-n.length-i.length==2*r},de.checkStrictDER=function(e,t,r,n,i){var o=de;if(void 0===r){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!ce.lang.String.isHex(e))throw new Error("not hex string");r=e.length,i=(n=e.length/2)<128?1:Math.ceil(n.toString(16))+1}if(o.getL(e,t).length>2*i)throw new Error("L of TLV too long: idx="+t);var s=o.getVblen(e,t);if(s>n)throw new Error("value of L too long than hex: idx="+t);var a=o.getTLV(e,t),c=a.length-2-o.getL(e,t).length;if(c!==2*s)throw new Error("V string length and L's value not the same:"+c+"/"+2*s);if(0===t&&e.length!=a.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+a.length);var u=e.substr(t,2);if("02"===u){var l=o.getVidx(e,t);if("00"==e.substr(l,2)&&e.charCodeAt(l+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(u,16)){for(var d=o.getVblen(e,t),h=0,p=o.getChildIdx(e,t),f=0;f<p.length;f++)h+=o.getTLV(e,p[f]).length,o.checkStrictDER(e,p[f],r,n,i);if(2*d!=h)throw new Error("sum of children's TLV length and L unmatch: "+2*d+"!="+h)}},de.oidname=function(e){var t=ce.asn1;ce.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return""===r&&(r=e),r},void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.lang&&ce.lang||(ce.lang={}),ce.lang.String=function(){},"function"==typeof e?(t.utf8tob64u=ue=function(t){return ye(e.from(t,"utf8").toString("base64"))},t.b64utoutf8=le=function(t){return e.from(me(t),"base64").toString("utf8")}):(t.utf8tob64u=ue=function(e){return ve(Ce(Le(e)))},t.b64utoutf8=le=function(e){return decodeURIComponent(Pe(we(e)))}),ce.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},ce.lang.String.isHex=function(e){return Ue(e)},ce.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},ce.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=me(e),ce.lang.String.isBase64(e))},ce.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},ce.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},ce.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},ce.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};var Me=function(e,t,r){return null==r&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function He(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.crypto&&ce.crypto||(ce.crypto={}),ce.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:y.algo.MD5,sha1:y.algo.SHA1,sha224:y.algo.SHA224,sha256:y.algo.SHA256,sha384:y.algo.SHA384,sha512:y.algo.SHA512,ripemd160:y.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var o="0001",s="00"+n,a="",c=i-o.length-s.length,u=0;u<c;u+=2)a+="ff";return o+a+s},this.hashString=function(e,t){return new ce.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new ce.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof ne||e instanceof ce.crypto.DSA||e instanceof ce.crypto.ECDSA}},ce.crypto.Util.md5=function(e){return new ce.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},ce.crypto.Util.ripemd160=function(e){return new ce.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},ce.crypto.Util.SECURERANDOMGEN=new ee,ce.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return ce.crypto.Util.SECURERANDOMGEN.nextBytes(t),fe(t)},ce.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new S(ce.crypto.Util.getRandomHexOfNbytes(e),16)},ce.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=new Array((e-t)/8+1);return ce.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<t&255^255)&r[0],fe(r)},ce.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new S(ce.crypto.Util.getRandomHexOfNbits(e),16)},ce.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=ce.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(r))return r}},ce.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(1==r)throw"biMin is greater than biMax";if(0==r)return e;var n=t.subtract(e);return ce.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},ce.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=ce.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=ce.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=ce.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=y.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(y.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ce.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ce.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},ce.crypto.MessageDigest.getHashLength=function(e){var t=ce.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[r])throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},ce.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ce.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=ce.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var r=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==t){try{var n=ce.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=y.algo.HMAC.create(n,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=y.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(y.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=Ee(e)),void(this.pass=y.enc.Hex.parse(t))}if("object"!=(void 0===e?"undefined":p(e)))throw"KJUR.crypto.Mac unsupported password type: "+e;if(t=null,void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=be(e.utf8)),void 0!==e.rstr&&(t=Ee(e.rstr)),void 0!==e.b64&&(t=b(e.b64)),void 0!==e.b64u&&(t=we(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=y.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ce.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ce.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ce.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e)}this.init=function(e,t){var r=null;try{r=void 0===t?Ke.getKey(e):Ke.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ce.crypto.ECDSA&&(this.prvKey=new ce.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof ne&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ne&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ce.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ce.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ce.crypto.ECDSA&&(this.pubKey=new ce.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof ne&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ne&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ce.crypto.ECDSA&&this.pubKey instanceof ce.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ce.crypto.DSA&&this.pubKey instanceof ce.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=ce.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=Ke.getKey(e.prvkeypem),this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},ce.crypto.Cipher=function(e){},ce.crypto.Cipher.encrypt=function(e,t,r){if(t instanceof ne&&t.isPublic){var n=ce.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.encryptOAEP(e,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},ce.crypto.Cipher.decrypt=function(e,t,r){if(t instanceof ne&&t.isPrivate){var n=ce.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.decryptOAEP(e,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},ce.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof ne){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},ce.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.crypto&&ce.crypto||(ce.crypto={}),ce.crypto.ECDSA=function(e){var t=Error,r=S,n=oe,i=ce.crypto.ECDSA,o=ce.crypto.ECParameterDB,s=i.getName,a=de,c=a.getVbyListEx,u=a.isASN1HEX,l=new ee;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new r(e.bitLength(),l).mod(e.subtract(r.ONE)).add(r.ONE)},this.setNamedCurve=function(e){this.ecparams=o.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),r=this.ecparams.G.multiply(t),n=r.getX().toBigInteger(),i=r.getY().toBigInteger(),o=this.ecparams.keylen/4,s=("0000000000"+t.toString(16)).slice(-o),a="04"+("0000000000"+n.toString(16)).slice(-o)+("0000000000"+i.toString(16)).slice(-o);return this.setPrivateKeyHex(s),this.setPublicKeyHex(a),{ecprvhex:s,ecpubhex:a}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var n=new r(t,16),o=this.ecparams.n,s=new r(e.substring(0,this.ecparams.keylen/4),16);do{var a=this.getBigRandom(o),c=this.ecparams.G.multiply(a).getX().toBigInteger().mod(o)}while(c.compareTo(r.ZERO)<=0);var u=a.modInverse(o).multiply(s.add(n.multiply(c))).mod(o);return i.biRSSigToASN1Sig(c,u)},this.sign=function(e,t){var n=t,i=this.ecparams.n,o=r.fromByteArrayUnsigned(e);do{var s=this.getBigRandom(i),a=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(a.compareTo(S.ZERO)<=0);var c=s.modInverse(i).multiply(o.add(n.multiply(a))).mod(i);return this.serializeSig(a,c)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,o){try{var s,a,c=i.parseSigHex(t);s=c.r,a=c.s;var u=n.decodeFromHex(this.ecparams.curve,o),l=new r(e.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(l,s,a,u)}catch(e){return!1}},this.verify=function(e,t,i){var o,s,a;if(Bitcoin.Util.isArray(t)){var c=this.parseSig(t);o=c.r,s=c.s}else{if("object"!==(void 0===t?"undefined":p(t))||!t.r||!t.s)throw"Invalid value for signature";o=t.r,s=t.s}if(i instanceof oe)a=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=n.decodeFrom(this.ecparams.curve,i)}var u=r.fromByteArrayUnsigned(e);return this.verifyRaw(u,o,s,a)},this.verifyRaw=function(e,t,n,i){var o=this.ecparams.n,s=this.ecparams.G;if(t.compareTo(r.ONE)<0||t.compareTo(o)>=0)return!1;if(n.compareTo(r.ONE)<0||n.compareTo(o)>=0)return!1;var a=n.modInverse(o),c=e.multiply(a).mod(o),u=t.multiply(a).mod(o);return s.multiply(c).add(i.multiply(u)).getX().toBigInteger().mod(o).equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),n=t.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),(i=i.concat(r)).push(2),i.push(n.length),(i=i.concat(n)).unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var n=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:r.fromByteArrayUnsigned(n),s:r.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:r.fromByteArrayUnsigned(e.slice(1,33)).mod(n),s:r.fromByteArrayUnsigned(e.slice(33,65)).mod(n),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===u(e))throw new Error("not ASN.1 hex string");var t,r,n;try{t=c(e,0,["[0]",0],"06"),r=c(e,0,[1],"04");try{n=c(e,0,["[1]",0],"03")}catch(e){}}catch(e){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=s(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===u(e))throw new t("not ASN.1 hex string");var r,n,i;try{c(e,0,[1,0],"06"),r=c(e,0,[1,1],"06"),n=c(e,0,[2,0,1],"04");try{i=c(e,0,[2,0,"[1]",0],"03")}catch(e){}}catch(e){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=s(r),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===u(e))throw new t("not ASN.1 hex string");var r,n;try{c(e,0,[0,0],"06"),r=c(e,0,[0,1],"06"),n=c(e,0,[1],"03")}catch(e){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=s(r),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(e,r){if(!1===u(e))throw new t("not ASN.1 hex string");var n,i;try{n=c(e,0,[0,5,0,1],"06"),i=c(e,0,[0,5,1],"03")}catch(e){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=s(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},ce.crypto.ECDSA.parseSigHex=function(e){var t=ce.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new S(t.r,16),s:new S(t.s,16)}},ce.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=de,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(2!=i.length)throw new Error("signature shall have two elements");var o=i[0],s=i[1];if("02"!=e.substr(o,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(s,2))throw new Error("2nd item not ASN.1 integer");return{r:n(e,o),s:n(e,s)}},ce.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=ce.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return r+n},ce.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return ce.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},ce.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new S(e,16),n=new S(t,16);return ce.crypto.ECDSA.biRSSigToASN1Sig(r,n)},ce.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=ce.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t});return new r.DERSequence({array:[n,i]}).getEncodedHex()},ce.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.crypto&&ce.crypto||(ce.crypto={}),ce.crypto.ECParameterDB=new function(){var e={},t={};function r(e){return new S(e,16)}this.getByName=function(r){var n=r;if(void 0!==t[n]&&(n=t[r]),void 0!==e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,o,s,a,c,u,l,d,h,p,f){e[n]={};var g=r(o),y=r(s),m=r(a),v=r(c),w=r(u),b=new se(g,y,m),_=b.decodePointHex("04"+l+d);e[n].name=n,e[n].keylen=i,e[n].curve=b,e[n].G=_,e[n].n=v,e[n].h=w,e[n].oid=p,e[n].info=f;for(var S=0;S<h.length;S++)t[h[S]]=n}},ce.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ce.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ce.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ce.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ce.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ce.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ce.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ce.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ce.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ce.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Ke=function(){var e=function(e,r,n){return t(y.AES,e,r,n)},t=function(e,t,r,n){var i=y.enc.Hex.parse(t),o=y.enc.Hex.parse(r),s=y.enc.Hex.parse(n),a={};a.key=o,a.iv=s,a.ciphertext=i;var c=e.decrypt(a,o,{iv:s});return y.enc.Hex.stringify(c)},r=function(e,t,r){return n(y.AES,e,t,r)},n=function(e,t,r,n){var i=y.enc.Hex.parse(t),o=y.enc.Hex.parse(r),s=y.enc.Hex.parse(n),a=e.encrypt(i,o,{iv:s}),c=y.enc.Hex.parse(a.toString());return y.enc.Base64.stringify(c)},i={"AES-256-CBC":{proc:e,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,r,n){return t(y.TripleDES,e,r,n)},eproc:function(e,t,r){return n(y.TripleDES,e,t,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,r,n){return t(y.DES,e,r,n)},eproc:function(e,t,r){return n(y.DES,e,t,r)},keylen:8,ivlen:8}},o=function(e){var t={},r=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(t.cipher=r[1],t.ivsalt=r[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var i=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),o=1);var s=e.indexOf("-----END");if(-1!=i&&-1!=s){var a=e.substring(i+2*o,s-o);a=a.replace(/\s+/g,""),t.data=a}return t},s=function(e,t,r){for(var n=r.substring(0,16),o=y.enc.Hex.parse(n),s=y.enc.Utf8.parse(t),a=i[e].keylen+i[e].ivlen,c="",u=null;;){var l=y.algo.MD5.create();if(null!=u&&l.update(u),l.update(s),l.update(o),u=l.finalize(),(c+=y.enc.Hex.stringify(u)).length>=2*a)break}var d={};return d.keyhex=c.substr(0,2*i[e].keylen),d.ivhex=c.substr(2*i[e].keylen,2*i[e].ivlen),d},a=function(e,t,r,n){var o=y.enc.Base64.parse(e),s=y.enc.Hex.stringify(o);return(0,i[t].proc)(s,r,n)};return{version:"1.0.0",parsePKCS5PEM:function(e){return o(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,r){return s(e,t,r)},decryptKeyB64:function(e,t,r,n){return a(e,t,r,n)},getDecryptedKeyHex:function(e,t){var r=o(e),n=(r.type,r.cipher),i=r.ivsalt,c=r.data,u=s(n,t,i).keyhex;return a(c,n,u,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,r,n,o){var a="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===i[n])throw new Error("KEYUTIL unsupported algorithm: "+n);void 0!==o&&null!=o||(o=function(e){var t=y.lib.WordArray.random(e);return y.enc.Hex.stringify(t)}(i[n].ivlen).toUpperCase());var c=function(e,t,r,n){return(0,i[t].eproc)(e,r,n)}(t,n,s(n,r,o).keyhex,o);return a="-----BEGIN "+e+" PRIVATE KEY-----\r\n",a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+n+","+o+"\r\n",a+="\r\n",(a+=c.replace(/(.{64})/g,"$1\r\n"))+"\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={},o=r(e,0);if(2!=o.length)throw new Error("malformed format: SEQUENCE(0).items != 2: "+o.length);i.ciphertext=n(e,o[1]);var s=r(e,o[0]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+s.length);if("2a864886f70d01050d"!=n(e,s[0]))throw new Error("this only supports pkcs5PBES2");var a=r(e,s[1]);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+a.length);var c=r(e,a[1]);if(2!=c.length)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+c.length);if("2a864886f70d0307"!=n(e,c[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=n(e,c[1]);var u=r(e,a[0]);if(2!=u.length)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+u.length);if("2a864886f70d01050c"!=n(e,u[0]))throw new Error("this only supports pkcs5PBKDF2");var l=r(e,u[1]);if(l.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length);i.pbkdf2Salt=n(e,l[0]);var d=n(e,l[1]);try{i.pbkdf2Iter=parseInt(d,16)}catch(e){throw new Error("malformed format pbkdf2Iter: "+d)}return i},getPBKDF2KeyHexFromParam:function(e,t){var r=y.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,i=y.PBKDF2(t,r,{keySize:6,iterations:n});return y.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var r=Fe(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=Ke.getPBKDF2KeyHexFromParam(n,t),o={};o.ciphertext=y.enc.Hex.parse(n.ciphertext);var s=y.enc.Hex.parse(i),a=y.enc.Hex.parse(n.encryptionSchemeIV),c=y.TripleDES.decrypt(o,s,{iv:a});return y.enc.Hex.stringify(c)},getKeyFromEncryptedPKCS8PEM:function(e,t){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={algparam:null};if("30"!=e.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var o=r(e,0);if(o.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=e.substr(o[1],2))throw new Error("malformed PKCS8 private key(code:003)");var s=r(e,o[1]);if(2!=s.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=e.substr(s[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(i.algoid=n(e,s[0]),"06"==e.substr(s[1],2)&&(i.algparam=n(e,s[1])),"04"!=e.substr(o[2],2))throw new Error("malformed PKCS8 private key(code:006)");return i.keyidx=t.getVidx(e,o[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=Fe(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,r=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==r.algoid)t=new ne;else if("2a8648ce380401"==r.algoid)t=new ce.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw new Error("unsupported private key algorithm");t=new ce.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,r=de.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===r)t=new ne;else if("2a8648ce380401"===r)t=new ce.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw new Error("unsupported PKCS#8 public key hex");t=new ce.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={};if("30"!=e.substr(0,2))throw new Error("malformed RSA key(code:001)");var o=r(e,0);if(2!=o.length)throw new Error("malformed RSA key(code:002)");if("02"!=e.substr(o[0],2))throw new Error("malformed RSA key(code:003)");if(i.n=n(e,o[0]),"02"!=e.substr(o[1],2))throw new Error("malformed RSA key(code:004)");return i.e=n(e,o[1]),i},parsePublicPKCS8Hex:function(e){var t=de,r=t.getChildIdx,n=t.getV,i={algparam:null},o=r(e,0);if(2!=o.length)throw new Error("outer DERSequence shall have 2 elements: "+o.length);var s=o[0];if("30"!=e.substr(s,2))throw new Error("malformed PKCS8 public key(code:001)");var a=r(e,s);if(2!=a.length)throw new Error("malformed PKCS8 public key(code:002)");if("06"!=e.substr(a[0],2))throw new Error("malformed PKCS8 public key(code:003)");if(i.algoid=n(e,a[0]),"06"==e.substr(a[1],2)?i.algparam=n(e,a[1]):"30"==e.substr(a[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,a[1],[0],"02"),i.algparam.q=t.getVbyList(e,a[1],[1],"02"),i.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(o[1],2))throw new Error("malformed PKCS8 public key(code:004)");return i.key=n(e,o[1]).substr(2),i}}}();function qe(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e}function Ve(e,t,r){for(var n="",i=0;n.length<t;)n+=Se(r(Ee(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function Je(e){for(var t in ce.crypto.Util.DIGESTINFOHEAD){var r=ce.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r)return[t,e.substring(n)]}return[]}function We(e){var t,r=de,n=r.getChildIdx,i=r.getV,o=r.getTLV,s=r.getVbyList,a=r.getVbyListEx,c=r.getTLVbyList,u=r.getTLVbyListEx,l=r.getIdxbyList,d=r.getIdxbyListEx,h=r.getVidx,p=r.getInt,f=r.oidname,g=r.hextooidstr,y=Fe;try{t=ce.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(e){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var e=c(this.hex,0,[0,0]);if("a0"==e.substr(0,2)){var t=c(e,0,[0]),r=p(t,0);if(r<0||2<r)throw new Error("malformed version field");return this.version=r+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return a(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=u(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var r in t)if(e===t[r])return r;return f(a(e,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return c(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return c(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var e=s(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getNotAfter=function(){var e=s(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),decodeURIComponent(e)},this.getPublicKeyHex=function(){return r.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return l(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return Ke.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=c(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return s(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),r=this.getSignatureValueHex(),n=c(this.hex,0,[0],"30"),i=new ce.crypto.Signature({alg:t});return i.init(e),i.updateHex(n),i.verify(r)},this.parseExt=function(e){var t,o,a;if(void 0===e){if(a=this.hex,3!==this.version)return-1;t=l(a,0,[0,7,0],"30"),o=n(a,t)}else{a=Fe(e);var c=l(a,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=i(a,c))return void(this.aExtInfo=new Array);t=l(a,0,[0,3,0,1,0],"30"),o=n(a,t),this.hex=a}this.aExtInfo=new Array;for(var u=0;u<o.length;u++){var d={critical:!1},p=0;3===n(a,o[u]).length&&(d.critical=!0,p=1),d.oid=r.hextooidstr(s(a,o[u],[0],"06"));var f=l(a,o[u],[1+p]);d.vidx=h(a,f),this.aExtInfo.push(d)}},this.getExtInfo=function(e){var t=this.aExtInfo,r=e;if(e.match(/^[0-9.]+$/)||(r=ce.asn1.x509.OID.name2oid(e)),""!==r)for(var n=0;n<t.length;n++)if(t[n].oid===r)return t[n]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("basicConstraints");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"basicConstraints"};if(t&&(n.critical=!0),"3000"===e)return n;if("30030101ff"===e)return n.cA=!0,n;if("30060101ff02"===e.substr(0,12)){var s=i(e,10),a=parseInt(s,16);return n.cA=!0,n.pathLen=a,n}throw new Error("hExtV parse error: "+e)},this.getExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("keyUsage");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"keyUsage"};return t&&(n.critical=!0),n.names=this.getExtKeyUsageString(e).split(","),n},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=o(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var r="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(r=r.slice(-8)),10==e.length&&(r=r.slice(-16)),""==(r=r.replace(/0+$/,""))&&(r="0"),r},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),r=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&r.push(We.KEYUSAGE_NAME[n]);return r.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectKeyIdentifier");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"subjectKeyIdentifier"};t&&(n.critical=!0);var s=i(e,0);return n.kid={hex:s},n},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityKeyIdentifier");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var s={extname:"authorityKeyIdentifier"};t&&(s.critical=!0);for(var a=n(e,0),c=0;c<a.length;c++){var u=e.substr(a[c],2);if("80"===u&&(s.kid={hex:i(e,a[c])}),"a1"===u){var l=o(e,a[c]),d=this.getGeneralNames(l);s.issuer=d[0].dn}"82"===u&&(s.sn={hex:i(e,a[c])})}return s},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("extKeyUsage");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var s={extname:"extKeyUsage",array:[]};t&&(s.critical=!0);for(var a=n(e,0),c=0;c<a.length;c++)s.array.push(f(i(e,a[c])));return s},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,r=o(this.hex,e.vidx);if(""===r)return t;for(var s=n(r,0),a=0;a<s.length;a++)t.push(f(i(r,s[a])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectAltName");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"subjectAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("issuerAltName");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var n={extname:"issuerAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getGeneralNames=function(e){for(var t=n(e,0),r=[],i=0;i<t.length;i++){var s=this.getGeneralName(o(e,t[i]));void 0!==s&&r.push(s)}return r},this.getGeneralName=function(e){var t=e.substr(0,2),r=i(e,0),n=Se(r);return"81"==t?{rfc822:n}:"82"==t?{dns:n}:"86"==t?{uri:n}:"87"==t?{ip:Ne(r)}:"a4"==t?{dn:this.getX500Name(r)}:void 0},this.getExtSubjectAltName2=function(){var e,t,r,s=this.getExtInfo("subjectAltName");if(void 0===s)return s;for(var a=new Array,c=o(this.hex,s.vidx),u=n(c,0),l=0;l<u.length;l++)r=c.substr(u[l],2),e=i(c,u[l]),"81"===r&&(t=_e(e),a.push(["MAIL",t])),"82"===r&&(t=_e(e),a.push(["DNS",t])),"84"===r&&(t=We.hex2dn(e,0),a.push(["DN",t])),"86"===r&&(t=_e(e),a.push(["URI",t])),"87"===r&&(t=Ne(e),a.push(["IP",t]));return a},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("cRLDistributionPoints");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"cRLDistributionPoints",array:[]};t&&(i.critical=!0);for(var s=n(e,0),a=0;a<s.length;a++){var c=o(e,s[a]);i.array.push(this.getDistributionPoint(c))}return i},this.getDistributionPoint=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var s=e.substr(r[i],2),a=o(e,r[i]);"a0"==s&&(t.dpname=this.getDistributionPointName(a))}return t},this.getDistributionPointName=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var s=e.substr(r[i],2),a=o(e,r[i]);"a0"==s&&(t.full=this.getGeneralNames(a))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var t=new Array,r=n(this.hex,e.vidx),i=0;i<r.length;i++)try{var o=_e(s(this.hex,r[i],[0,0,0],"86"));t.push(o)}catch(e){}return t},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},r=n(this.hex,e.vidx),i=0;i<r.length;i++){var o=s(this.hex,r[i],[0],"06"),a=s(this.hex,r[i],[1],"86");"2b06010505073001"===o&&t.ocsp.push(_e(a)),"2b06010505073002"===o&&t.caissuer.push(_e(a))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityInfoAccess");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"authorityInfoAccess",array:[]};t&&(i.critical=!0);for(var c=n(e,0),u=0;u<c.length;u++){var l=a(e,c[u],[0],"06"),d=_e(s(e,c[u],[1],"86"));if("2b06010505073001"==l)i.array.push({ocsp:d});else{if("2b06010505073002"!=l)throw new Error("unknown method: "+l);i.array.push({caissuer:d})}}return i},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("certificatePolicies");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"certificatePolicies",array:[]};t&&(i.critical=!0);for(var s=n(e,0),a=0;a<s.length;a++){var c=o(e,s[a]),u=this.getPolicyInformation(c);i.array.push(u)}return i},this.getPolicyInformation=function(e){var t={},r=s(e,0,[0],"06");t.policyoid=f(r);var i=d(e,0,[1],"30");if(-1!=i){t.array=[];for(var a=n(e,i),c=0;c<a.length;c++){var u=o(e,a[c]),l=this.getPolicyQualifierInfo(u);t.array.push(l)}}return t},this.getPolicyQualifierInfo=function(e){var t={},r=s(e,0,[0],"06");if("2b06010505070201"===r){var n=a(e,0,[1],"16");t.cps=Se(n)}else if("2b06010505070202"===r){var i=c(e,0,[1],"30");t.unotice=this.getUserNotice(i)}return t},this.getUserNotice=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var s=o(e,r[i]);"30"!=s.substr(0,2)&&(t.exptext=this.getDisplayText(s))}return t},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=Se(i(e,0)),t},this.getExtCRLNumber=function(e,t){var r={extname:"cRLNumber"};if(t&&(r.critical=!0),"02"==e.substr(0,2))return r.num={hex:i(e,0)},r;throw new Error("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var r={extname:"cRLReason"};if(t&&(r.critical=!0),"0a"==e.substr(0,2))return r.code=parseInt(i(e,0),16),r;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var r={extname:"ocspNonce"};t&&(r.critical=!0);var n=i(e,0);return r.hex=n,r},this.getExtOcspNoCheck=function(e,t){var r={extname:"ocspNoCheck"};return t&&(r.critical=!0),r},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("adobeTimeStamp");if(void 0===r)return;e=o(this.hex,r.vidx),t=r.critical}var i={extname:"adobeTimeStamp"};t&&(i.critical=!0);var s=n(e,0);if(s.length>1){var a=o(e,s[1]),c=this.getGeneralName(a);null!=c.uri&&(i.uri=c.uri)}if(s.length>2){var u=o(e,s[2]);"0101ff"==u&&(i.reqauth=!0),"010100"==u&&(i.reqauth=!1)}return i},this.getX500NameRule=function(e){for(var t=null,r=[],n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.length;o++)r.push(i[o]);for(n=0;n<r.length;n++){var s=r[n],a=s.ds,c=s.value,u=s.type;if("prn"!=a&&"utf8"!=a&&"ia5"!=a)return"mixed";if("ia5"==a){if("CN"!=u)return"mixed";if(ce.lang.String.isMail(c))continue;return"mixed"}if("C"==u){if("prn"==a)continue;return"mixed"}if(null==t)t=a;else if(t!==a)return"mixed"}return null==t?"prn":t},this.getX500Name=function(e){var t=this.getX500NameArray(e);return{array:t,str:this.dnarraytostr(t)}},this.getX500NameArray=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getRDN(o(e,r[i])));return t},this.getRDN=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getAttrTypeAndValue(o(e,r[i])));return t},this.getAttrTypeAndValue=function(e){var t={type:null,value:null,ds:null},r=n(e,0),i=s(e,r[0],[],"06"),o=s(e,r[1],[]),a=ce.asn1.ASN1Util.oidHexToInt(i);return t.type=ce.asn1.x509.OID.oid2atype(a),t.ds=this.HEX2STAG[e.substr(r[1],2)],"bmp"!=t.ds?t.value=_e(o):t.value=De(o),t},this.readCertPEM=function(e){this.readCertHex(y(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{l(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getParam=function(){var e={};return e.version=this.getVersion(),e.serial={hex:this.getSerialNumberHex()},e.sigalg=this.getSignatureAlgorithmField(),e.issuer=this.getIssuer(),e.notbefore=this.getNotBefore(),e.notafter=this.getNotAfter(),e.subject=this.getSubject(),e.sbjpubkey=ke(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(e.ext=this.getExtParamArray()),e.sighex=this.getSignatureValueHex(),e},this.getExtParamArray=function(e){null==e&&-1!=d(this.hex,0,[0,"[3]"])&&(e=u(this.hex,0,[0,"[3]",0],"30"));for(var t=[],r=n(e,0),i=0;i<r.length;i++){var s=o(e,r[i]),a=this.getExtParam(s);null!=a&&t.push(a)}return t},this.getExtParam=function(e){var t=n(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var r=g(s(e,0,[0],"06")),i=!1;3==t&&"0101ff"==c(e,0,[1])&&(i=!0);var o=c(e,0,[t-1,0]),a=void 0;if("2.5.29.14"==r?a=this.getExtSubjectKeyIdentifier(o,i):"2.5.29.15"==r?a=this.getExtKeyUsage(o,i):"2.5.29.17"==r?a=this.getExtSubjectAltName(o,i):"2.5.29.18"==r?a=this.getExtIssuerAltName(o,i):"2.5.29.19"==r?a=this.getExtBasicConstraints(o,i):"2.5.29.31"==r?a=this.getExtCRLDistributionPoints(o,i):"2.5.29.32"==r?a=this.getExtCertificatePolicies(o,i):"2.5.29.35"==r?a=this.getExtAuthorityKeyIdentifier(o,i):"2.5.29.37"==r?a=this.getExtExtKeyUsage(o,i):"1.3.6.1.5.5.7.1.1"==r?a=this.getExtAuthorityInfoAccess(o,i):"2.5.29.20"==r?a=this.getExtCRLNumber(o,i):"2.5.29.21"==r?a=this.getExtCRLReason(o,i):"1.3.6.1.5.5.7.48.1.2"==r?a=this.getExtOcspNonce(o,i):"1.3.6.1.5.5.7.48.1.5"==r?a=this.getExtOcspNoCheck(o,i):"1.2.840.113583.1.1.9.1"==r&&(a=this.getExtAdobeTimeStamp(o,i)),null!=a)return a;var u={extname:r,extn:o};return i&&(u.critical=!0),u},this.findExt=function(e,t){for(var r=0;r<e.length;r++)if(e[r].extname==t)return e[r];return null},this.updateExtCDPFullURI=function(e,t){var r=this.findExt(e,"cRLDistributionPoints");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)if(null!=n[i].dpname&&null!=n[i].dpname.full)for(var o=n[i].dpname.full,s=0;s<o.length;s++){var a=o[i];null!=a.uri&&(a.uri=t)}},this.updateExtAIAOCSP=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].ocsp&&(n[i].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].caissuer&&(n[i].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return function(e){return e.map((function(e){return function(e){return e.type+"="+e.value}(e).replace(/\+/,"\\+")})).join("+")}(e).replace(/\//,"\\/")})).join("/")},this.getInfo=function(){var e,t,r,n=function(e){return JSON.stringify(e.array).replace(/[\[\]\{\}\"]/g,"")},i=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];if(t+="    policy oid: "+i.policyoid+"\n",void 0!==i.array)for(var o=0;o<i.array.length;o++){var s=i.array[o];void 0!==s.cps&&(t+="    cps: "+s.cps+"\n")}}return t},o=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];try{void 0!==i.dpname.full[0].uri&&(t+="    "+i.dpname.full[0].uri+"\n")}catch(e){}try{void 0!==i.dname.full[0].dn.hex&&(t+="    "+We.hex2dn(i.dpname.full[0].dn.hex)+"\n")}catch(e){}}return t},s=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];void 0!==i.caissuer&&(t+="    caissuer: "+i.caissuer+"\n"),void 0!==i.ocsp&&(t+="    ocsp: "+i.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Be(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Be(t.e.toString(16))+"\n"),null!=(r=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var a=0;a<r.length;a++){var c=r[a],u=ce.asn1.x509.OID.oid2name(c.oid);""===u&&(u=c.oid);var l="";if(!0===c.critical&&(l="CRITICAL"),e+="  "+u+" "+l+":\n","basicConstraints"===u){var d=this.getExtBasicConstraints();void 0===d.cA?e+="    {}\n":(e+="    cA=true",void 0!==d.pathLen&&(e+=", pathLen="+d.pathLen),e+="\n")}else if("keyUsage"===u)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===u)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===u){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(e+="    kid="+h.kid.hex+"\n")}else"extKeyUsage"===u?e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"===u?e+="    "+n(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"===u?e+=o(this.getExtCRLDistributionPoints()):"authorityInfoAccess"===u?e+=s(this.getExtAuthorityInfoAccess()):"certificatePolicies"===u&&(e+=i(this.getExtCertificatePolicies()))}}return(e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n")+"signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):ce.lang.String.isHex(e)&&this.readCertHex(e))}Ke.getKey=function(e,t,r){var n,i=(m=de).getChildIdx,o=(m.getV,m.getVbyList),s=ce.crypto,a=s.ECDSA,c=s.DSA,u=ne,l=Fe,d=Ke;if(void 0!==u&&e instanceof u)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==c&&e instanceof c)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(T=new u).setPublic(e.n,e.e),T;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(T=new u).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),T;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(T=new u).setPrivate(e.n,e.e,e.d),T;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(T=new c).setPublic(e.p,e.q,e.g,e.y),T;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(T=new c).setPrivate(e.p,e.q,e.g,e.y,e.x),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(T=new u).setPublic(we(e.n),we(e.e)),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(T=new u).setPrivateEx(we(e.n),we(e.e),we(e.d),we(e.p),we(e.q),we(e.dp),we(e.dq),we(e.qi)),T;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(T=new u).setPrivate(we(e.n),we(e.e),we(e.d)),T;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var h=(F=new a({curve:e.crv})).ecparams.keylen/4,p="04"+("0000000000"+we(e.x)).slice(-h)+("0000000000"+we(e.y)).slice(-h);return F.setPublicKeyHex(p),F}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){h=(F=new a({curve:e.crv})).ecparams.keylen/4,p="04"+("0000000000"+we(e.x)).slice(-h)+("0000000000"+we(e.y)).slice(-h);var f=("0000000000"+we(e.d)).slice(-h);return F.setPublicKeyHex(p),F.setPrivateKeyHex(f),F}if("pkcs5prv"===r){var g,y=e,m=de;if(9===(g=i(y,0)).length)(T=new u).readPKCS5PrvKeyHex(y);else if(6===g.length)(T=new c).readPKCS5PrvKeyHex(y);else{if(!(g.length>2&&"04"===y.substr(g[1],2)))throw new Error("unsupported PKCS#1/5 hexadecimal key");(T=new a).readPKCS5PrvKeyHex(y)}return T}if("pkcs8prv"===r)return d.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===r)return d._getKeyFromPublicPKCS8Hex(e);if("x509pub"===r)return We.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return We.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var v=Fe(e,"PUBLIC KEY");return d._getKeyFromPublicPKCS8Hex(v)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var w=l(e,"RSA PRIVATE KEY");return d.getKey(w,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=o(n=l(e,"DSA PRIVATE KEY"),0,[1],"02"),_=o(n,0,[2],"02"),E=o(n,0,[3],"02"),x=o(n,0,[4],"02"),I=o(n,0,[5],"02");return(T=new c).setPrivate(new S(b,16),new S(_,16),new S(E,16),new S(x,16),new S(I,16)),T}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED"))return w=l(e,"EC PRIVATE KEY"),d.getKey(w,null,"pkcs5prv");if(-1!=e.indexOf("-END PRIVATE KEY-"))return d.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var A=d.getDecryptedKeyHex(e,t),k=new ne;return k.readPKCS5PrvKeyHex(A),k}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var F,T=o(n=d.getDecryptedKeyHex(e,t),0,[1],"04"),R=o(n,0,[2,0],"06"),C=o(n,0,[3,0],"03").substr(2);if(void 0===ce.crypto.OID.oidhex2name[R])throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+R);return(F=new a({curve:ce.crypto.OID.oidhex2name[R]})).setPublicKeyHex(C),F.setPrivateKeyHex(T),F.isPublic=!1,F}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED"))return b=o(n=d.getDecryptedKeyHex(e,t),0,[1],"02"),_=o(n,0,[2],"02"),E=o(n,0,[3],"02"),x=o(n,0,[4],"02"),I=o(n,0,[5],"02"),(T=new c).setPrivate(new S(b,16),new S(_,16),new S(E,16),new S(x,16),new S(I,16)),T;if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return d.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},Ke.generateKeypair=function(e,t){if("RSA"==e){var r=t;(s=new ne).generate(r,"10001"),s.isPrivate=!0,s.isPublic=!0;var n=new ne,i=s.n.toString(16),o=s.e.toString(16);return n.setPublic(i,o),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=n,a}if("EC"==e){var s,a,c=t,u=new ce.crypto.ECDSA({curve:c}).generateKeyPairHex();return(s=new ce.crypto.ECDSA({curve:c})).setPublicKeyHex(u.ecpubhex),s.setPrivateKeyHex(u.ecprvhex),s.isPrivate=!0,s.isPublic=!1,(n=new ce.crypto.ECDSA({curve:c})).setPublicKeyHex(u.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=s,a.pubKeyObj=n,a}throw new Error("unknown algorithm: "+e)},Ke.getPEM=function(e,t,r,n,i,o){var s=ce,a=s.asn1,c=a.DERObjectIdentifier,u=a.DERInteger,l=a.ASN1Util.newObject,d=a.x509.SubjectPublicKeyInfo,h=s.crypto,p=h.DSA,f=h.ECDSA,g=ne;function m(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function w(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==g&&e instanceof g||void 0!==p&&e instanceof p||void 0!==f&&e instanceof f)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return ke(E=new d(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===r||null==r)&&1==e.isPrivate)return ke(E=m(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==f&&e instanceof f&&(void 0===r||null==r)&&1==e.isPrivate){var b=new c({name:e.curveName}).getEncodedHex(),_=v(e).getEncodedHex(),S="";return(S+=ke(b,"EC PARAMETERS"))+ke(_,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==p&&e instanceof p&&(void 0===r||null==r)&&1==e.isPrivate)return ke(E=w(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==r&&null!=r&&1==e.isPrivate){var E=m(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,r,n,o)}if("PKCS5PRV"==t&&void 0!==f&&e instanceof f&&void 0!==r&&null!=r&&1==e.isPrivate)return E=v(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,r,n,o);if("PKCS5PRV"==t&&void 0!==p&&e instanceof p&&void 0!==r&&null!=r&&1==e.isPrivate)return E=w(e).getEncodedHex(),void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,r,n,o);var x=function(e,t){var r=I(e,t);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},I=function(e,t){var r=y.lib.WordArray.random(8),n=y.lib.WordArray.random(8),i=y.PBKDF2(t,r,{keySize:6,iterations:100}),o=y.enc.Hex.parse(e),s=y.TripleDES.encrypt(o,i,{iv:n})+"",a={};return a.ciphertext=s,a.pbkdf2Salt=y.enc.Hex.stringify(r),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=y.enc.Hex.stringify(n),a};if("PKCS8PRV"==t&&null!=g&&e instanceof g&&1==e.isPrivate){var A=m(e).getEncodedHex();return E=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex(),void 0===r||null==r?ke(E,"PRIVATE KEY"):ke(_=x(E,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==f&&e instanceof f&&1==e.isPrivate)return A=new l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),E=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex(),void 0===r||null==r?ke(E,"PRIVATE KEY"):ke(_=x(E,r),"ENCRYPTED PRIVATE KEY");if("PKCS8PRV"==t&&void 0!==p&&e instanceof p&&1==e.isPrivate)return A=new u({bigint:e.x}).getEncodedHex(),E=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex(),void 0===r||null==r?ke(E,"PRIVATE KEY"):ke(_=x(E,r),"ENCRYPTED PRIVATE KEY");throw new Error("unsupported object nor format")},Ke.getKeyFromCSRPEM=function(e){var t=Fe(e,"CERTIFICATE REQUEST");return Ke.getKeyFromCSRHex(t)},Ke.getKeyFromCSRHex=function(e){var t=Ke.parseCSRHex(e);return Ke.getKey(t.p8pubkeyhex,null,"pkcs8pub")},Ke.parseCSRHex=function(e){var t=de,r=t.getChildIdx,n=t.getTLV,i={},o=e;if("30"!=o.substr(0,2))throw new Error("malformed CSR(code:001)");var s=r(o,0);if(s.length<1)throw new Error("malformed CSR(code:002)");if("30"!=o.substr(s[0],2))throw new Error("malformed CSR(code:003)");var a=r(o,s[0]);if(a.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=n(o,a[2]),i},Ke.getKeyID=function(e){var t=Ke,r=de;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var n=Fe(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),o=r.getV(n,i).substring(2);return ce.crypto.Util.hashHex(o,"sha1")},Ke.getJWKFromKey=function(e){var t={};if(e instanceof ne&&e.isPrivate)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t.d=ve(e.d.toString(16)),t.p=ve(e.p.toString(16)),t.q=ve(e.q.toString(16)),t.dp=ve(e.dmp1.toString(16)),t.dq=ve(e.dmq1.toString(16)),t.qi=ve(e.coeff.toString(16)),t;if(e instanceof ne&&e.isPublic)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t;if(e instanceof ce.crypto.ECDSA&&e.isPrivate){if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw new Error("unsupported curve name for JWT: "+n);var r=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t.d=ve(e.prvKeyHex),t}if(e instanceof ce.crypto.ECDSA&&e.isPublic){var n;if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw new Error("unsupported curve name for JWT: "+n);return r=e.getPublicKeyXYHex(),t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t}throw new Error("not supported key object")},ne.getPosArrayOfChildrenFromHex=function(e){return de.getChildIdx(e,0)},ne.getHexValueArrayOfChildrenFromHex=function(e){var t,r=de.getV,n=r(e,(t=ne.getPosArrayOfChildrenFromHex(e))[0]),i=r(e,t[1]),o=r(e,t[2]),s=r(e,t[3]),a=r(e,t[4]),c=r(e,t[5]),u=r(e,t[6]),l=r(e,t[7]),d=r(e,t[8]);return(t=new Array).push(n,i,o,s,a,c,u,l,d),t},ne.prototype.readPrivateKeyFromPEMString=function(e){var t=Fe(e),r=ne.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},ne.prototype.readPKCS5PrvKeyHex=function(e){var t=ne.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},ne.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,o,s,a,c,u=de,l=u.getVbyListEx;if(!1===u.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=l(e,0,[2,0,1],"02"),r=l(e,0,[2,0,2],"02"),n=l(e,0,[2,0,3],"02"),i=l(e,0,[2,0,4],"02"),o=l(e,0,[2,0,5],"02"),s=l(e,0,[2,0,6],"02"),a=l(e,0,[2,0,7],"02"),c=l(e,0,[2,0,8],"02")}catch(e){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,o,s,a,c)},ne.prototype.readPKCS5PubKeyHex=function(e){var t=de,r=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),o=r(e,n[1]);this.setPublic(i,o)},ne.prototype.readPKCS8PubKeyHex=function(e){var t=de;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},ne.prototype.readCertPubKeyHex=function(e,t){var r,n;(r=new We).readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)},new RegExp("[^0-9a-f]","gi"),ne.prototype.sign=function(e,t){var r=function(e){return ce.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(r,t)},ne.prototype.signWithMessageHash=function(e,t){var r=te(ce.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return qe(this.doPrivate(r).toString(16),this.n.bitLength())},ne.prototype.signPSS=function(e,t,r){var n=function(e){return ce.crypto.Util.hashHex(e,t)}(Ee(e));return void 0===r&&(r=-1),this.signWithMessageHashPSS(n,t,r)},ne.prototype.signWithMessageHashPSS=function(e,t,r){var n,i=Se(e),o=i.length,s=this.n.bitLength()-1,a=Math.ceil(s/8),c=function(e){return ce.crypto.Util.hashHex(e,t)};if(-1===r||void 0===r)r=o;else if(-2===r)r=a-o-2;else if(r<-2)throw new Error("invalid salt length");if(a<o+r+2)throw new Error("data too long");var u="";r>0&&(u=new Array(r),(new ee).nextBytes(u),u=String.fromCharCode.apply(String,u));var l=Se(c(Ee("\0\0\0\0\0\0\0\0"+i+u))),d=[];for(n=0;n<a-r-o-2;n+=1)d[n]=0;var h=String.fromCharCode.apply(String,d)+""+u,p=Ve(l,h.length,c),f=[];for(n=0;n<h.length;n+=1)f[n]=h.charCodeAt(n)^p.charCodeAt(n);var g=65280>>8*a-s&255;for(f[0]&=~g,n=0;n<o;n++)f.push(l.charCodeAt(n));return f.push(188),qe(this.doPrivate(new S(f)).toString(16),this.n.bitLength())},ne.prototype.verify=function(e,t){if(null==(t=t.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var r=te(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var i=this.doPublic(r).toString(16);if(i.length+3!=n/4)return!1;var o=Je(i.replace(/^1f+00/,""));if(0==o.length)return!1;var s=o[0];return o[1]==function(e){return ce.crypto.Util.hashString(e,s)}(e)},ne.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=te(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=Je(this.doPublic(r).toString(16).replace(/^1f+00/,""));return 0!=n.length&&(n[0],n[1]==e)},ne.prototype.verifyPSS=function(e,t,r,n){var i=function(e){return ce.crypto.Util.hashHex(e,r)}(Ee(e));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(i,t,r,n)},ne.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i,o=new S(t,16),s=function(e){return ce.crypto.Util.hashHex(e,r)},a=Se(e),c=a.length,u=this.n.bitLength()-1,l=Math.ceil(u/8);if(-1===n||void 0===n)n=c;else if(-2===n)n=l-c-2;else if(n<-2)throw new Error("invalid salt length");if(l<c+n+2)throw new Error("data too long");var d=this.doPublic(o).toByteArray();for(i=0;i<d.length;i+=1)d[i]&=255;for(;d.length<l;)d.unshift(0);if(188!==d[l-1])throw new Error("encoded message does not end in 0xbc");var h=(d=String.fromCharCode.apply(String,d)).substr(0,l-c-1),p=d.substr(h.length,c),f=65280>>8*l-u&255;if(0!=(h.charCodeAt(0)&f))throw new Error("bits beyond keysize not zero");var g=Ve(p,h.length,s),y=[];for(i=0;i<h.length;i+=1)y[i]=h.charCodeAt(i)^g.charCodeAt(i);y[0]&=~f;var m=l-c-n-2;for(i=0;i<m;i+=1)if(0!==y[i])throw new Error("leftmost octets not zero");if(1!==y[m])throw new Error("0x01 marker not found");return p===Se(s(Ee("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,y.slice(-n)))))},ne.SALT_LEN_HLEN=-1,ne.SALT_LEN_MAX=-2,ne.SALT_LEN_RECOVER=-2,We.hex2dn=function(e,t){void 0===t&&(t=0);var r=new We;return de.getTLV(e,t),r.getX500Name(e).str},We.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var r=new Array,n=de.getChildIdx(e,t),i=0;i<n.length;i++)r.push(We.hex2attrTypeValue(e,n[i]));return(r=r.map((function(e){return e.replace("+","\\+")}))).join("+")},We.hex2attrTypeValue=function(e,t){var r=de,n=r.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var o=n(e,i[0]),s=ce.asn1.ASN1Util.oidHexToInt(o);return ce.asn1.x509.OID.oid2atype(s)+"="+Se(n(e,i[1]))},We.getPublicKeyFromCertHex=function(e){var t=new We;return t.readCertHex(e),t.getPublicKey()},We.getPublicKeyFromCertPEM=function(e){var t=new We;return t.readCertPEM(e),t.getPublicKey()},We.getPublicKeyInfoPropOfCertPEM=function(e){var t,r,n=de.getVbyList,i={algparam:null};return(t=new We).readCertPEM(e),r=t.getPublicKeyHex(),i.keyhex=n(r,0,[1],"03").substr(2),i.algoid=n(r,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=n(r,0,[0,1],"06")),i},We.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==ce&&ce||(t.KJUR=ce={}),void 0!==ce.jws&&ce.jws||(ce.jws={}),ce.jws.JWS=function(){var e=ce.jws.JWS.isSafeJSONString;this.parseJWS=function(t,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var n=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],o=n[2],s=n[3],a=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!r){var c=we(s),u=te(c,16);this.parsedJWS.sigvalH=c,this.parsedJWS.sigvalBI=u}var l=le(i),d=le(o);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=d,!e(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},ce.jws.JWS.sign=function(e,t,r,n,i){var o,s,a,c=ce,u=c.jws.JWS,l=u.readSafeJSONString,d=u.isSafeJSONString,h=c.crypto,f=(h.ECDSA,h.Mac),g=h.Signature,y=JSON;if("string"!=typeof t&&"object"!=(void 0===t?"undefined":p(t)))throw"spHeader must be JSON string or object: "+t;if("object"==(void 0===t?"undefined":p(t))&&(s=t,o=y.stringify(s)),"string"==typeof t){if(!d(o=t))throw"JWS Head is not safe JSON string: "+o;s=l(o)}if(a=r,"object"==(void 0===r?"undefined":p(r))&&(a=y.stringify(r)),""!=e&&null!=e||void 0===s.alg||(e=s.alg),""!=e&&null!=e&&void 0===s.alg&&(s.alg=e,o=y.stringify(s)),e!==s.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+s.alg;var m=null;if(void 0===u.jwsalg2sigalg[e])throw"unsupported alg name: "+e;m=u.jwsalg2sigalg[e];var v=ue(o)+"."+ue(a),w="";if("Hmac"==m.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var b=new f({alg:m,prov:"cryptojs",pass:n});b.updateString(v),w=b.doFinal()}else if(-1!=m.indexOf("withECDSA")){(S=new g({alg:m})).init(n,i),S.updateString(v);var _=S.sign();w=ce.crypto.ECDSA.asn1SigToConcatSig(_)}else{var S;"none"!=m&&((S=new g({alg:m})).init(n,i),S.updateString(v),w=S.sign())}return v+"."+ve(w)},ce.jws.JWS.verify=function(e,t,r){var n,i=ce,o=i.jws.JWS,s=o.readSafeJSONString,a=i.crypto,c=a.ECDSA,u=a.Mac,l=a.Signature;void 0!==p(ne)&&(n=ne);var d=e.split(".");if(3!==d.length)return!1;var h,f=d[0]+"."+d[1],g=we(d[2]),y=s(le(d[0])),m=null;if(void 0===y.alg)throw"algorithm not specified in header";if(h=(m=y.alg).substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0&&-1==(":"+r.join(":")+":").indexOf(":"+m+":"))throw"algorithm '"+m+"' not accepted in the list";if("none"!=m&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=Ke.getKey(t)),!("RS"!=h&&"PS"!=h||t instanceof n))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==h&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";var v=null;if(void 0===o.jwsalg2sigalg[y.alg])throw"unsupported alg name: "+m;if("none"==(v=o.jwsalg2sigalg[m]))throw"not supported";if("Hmac"==v.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var w=new u({alg:v,pass:t});return w.updateString(f),g==w.doFinal()}if(-1!=v.indexOf("withECDSA")){var b,_=null;try{_=c.concatSigToASN1Sig(g)}catch(e){return!1}return(b=new l({alg:v})).init(t),b.updateString(f),b.verify(_)}return(b=new l({alg:v})).init(t),b.updateString(f),b.verify(g)},ce.jws.JWS.parse=function(e){var t,r,n,i=e.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],r=i[1],3==i.length&&(n=i[2]),o.headerObj=ce.jws.JWS.readSafeJSONString(le(t)),o.payloadObj=ce.jws.JWS.readSafeJSONString(le(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=le(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==n&&(o.sigHex=we(n)),o},ce.jws.JWS.verifyJWT=function(e,t,r){var n=ce.jws,i=n.JWS,o=i.readSafeJSONString,s=i.inArray,a=i.includedArray,c=e.split("."),u=c[0],l=c[1],d=(we(c[2]),o(le(u))),h=o(le(l));if(void 0===d.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!s(d.alg,r.alg))return!1;if(void 0!==h.iss&&"object"===p(r.iss)&&!s(h.iss,r.iss))return!1;if(void 0!==h.sub&&"object"===p(r.sub)&&!s(h.sub,r.sub))return!1;if(void 0!==h.aud&&"object"===p(r.aud))if("string"==typeof h.aud){if(!s(h.aud,r.aud))return!1}else if("object"==p(h.aud)&&!a(h.aud,r.aud))return!1;var f=n.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(f=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==h.exp&&"number"==typeof h.exp&&h.exp+r.gracePeriod<f||void 0!==h.nbf&&"number"==typeof h.nbf&&f<h.nbf-r.gracePeriod||void 0!==h.iat&&"number"==typeof h.iat&&f<h.iat-r.gracePeriod||void 0!==h.jti&&void 0!==r.jti&&h.jti!==r.jti||!i.verify(e,t,r.alg))},ce.jws.JWS.includedArray=function(e,t){var r=ce.jws.JWS.inArray;if(null===e)return!1;if("object"!==(void 0===e?"undefined":p(e)))return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0},ce.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!==(void 0===t?"undefined":p(t)))return!1;if("number"!=typeof t.length)return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1},ce.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ce.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return"object"!=(void 0===(n=ae(e))?"undefined":p(n))||n.constructor===Array?0:(t&&(t[r]=n),1)}catch(e){return 0}},ce.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=(void 0===(t=ae(e))?"undefined":p(t))||t.constructor===Array?null:t}catch(e){return null}},ce.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},ce.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=Ee(t);return ve(ce.crypto.Util.hashHex(r,"sha256"))},ce.jws.IntDate={},ce.jws.IntDate.get=function(e){var t=ce.jws.IntDate,r=t.getNow,n=t.getZulu;if("now"==e)return r();if("now + 1hour"==e)return r()+3600;if("now + 1day"==e)return r()+86400;if("now + 1month"==e)return r()+2592e3;if("now + 1year"==e)return r()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},ce.jws.IntDate.getZulu=function(e){return Re(e)},ce.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ce.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},ce.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},t.SecureRandom=ee,t.rng_seed_time=z,t.BigInteger=S,t.RSAKey=ne;var $e=ce.crypto.EDSA;t.EDSA=$e;var ze=ce.crypto.DSA;t.DSA=ze;var Ge=ce.crypto.Signature;t.Signature=Ge;var Ye=ce.crypto.MessageDigest;t.MessageDigest=Ye;var Qe=ce.crypto.Mac;t.Mac=Qe;var Xe=ce.crypto.Cipher;t.Cipher=Xe,t.KEYUTIL=Ke,t.ASN1HEX=de,t.X509=We,t.CryptoJS=y,t.b64tohex=b,t.b64toBA=_,t.stoBA=he,t.BAtos=pe,t.BAtohex=fe,t.stohex=ge,t.stob64=function(e){return w(ge(e))},t.stob64u=function(e){return ye(w(ge(e)))},t.b64utos=function(e){return pe(_(me(e)))},t.b64tob64u=ye,t.b64utob64=me,t.hex2b64=w,t.hextob64u=ve,t.b64utohex=we,t.utf8tob64u=ue,t.b64utoutf8=le,t.utf8tob64=function(e){return w(Ce(Le(e)))},t.b64toutf8=function(e){return decodeURIComponent(Pe(b(e)))},t.utf8tohex=be,t.hextoutf8=_e,t.hextorstr=Se,t.rstrtohex=Ee,t.hextob64=xe,t.hextob64nl=Ie,t.b64nltohex=Ae,t.hextopem=ke,t.pemtohex=Fe,t.hextoArrayBuffer=function(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(2*n,2),16));return t},t.ArrayBuffertohex=function(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t},t.zulutomsec=Te,t.zulutosec=Re,t.zulutodate=function(e){return new Date(Te(e))},t.datetozulu=function(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var o=e.getUTCMilliseconds();0!==o&&(n+="."+(o=(o=("00"+o).slice(-3)).replace(/0+$/g,"")))}return n+"Z"},t.uricmptohex=Ce,t.hextouricmp=Pe,t.ipv6tohex=Oe,t.hextoipv6=je,t.hextoip=Ne,t.iptohex=function(e){var t="malformed IP address";if(!(e=e.toLowerCase(e)).match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return Oe(e);throw t}var r=e.split(".");if(4!==r.length)throw t;var n="";try{for(var i=0;i<4;i++)n+=("0"+parseInt(r[i]).toString(16)).slice(-2);return n}catch(e){throw t}},t.encodeURIComponentAll=Le,t.newline_toUnix=function(e){return e.replace(/\r\n/gm,"\n")},t.newline_toDos=function(e){return(e=e.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},t.hextoposhex=Be,t.intarystrtohex=function(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(e,t,r){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)})).join("")}catch(e){throw"malformed integer array string: "+e}},t.strdiffidx=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1},t.KJUR=ce;var Ze=ce.crypto;t.crypto=Ze;var et=ce.asn1;t.asn1=et;var tt=ce.jws;t.jws=tt;var rt=ce.lang;t.lang=rt}).call(this,r(28).Buffer)},function(e,t,r){"use strict";(function(e){var n=r(30),i=r(31),o=r(32);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,r){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t),e}(e,t,r,n):"string"==typeof t?function(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!c.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(t,r),i=(e=a(e,n)).write(t,r);return i!==n&&(e=e.slice(0,i)),e}(e,t,r):function(e,t){if(c.isBuffer(t)){var r=0|p(t.length);return 0===(e=a(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t){var r=t.length<0?0:0|p(t.length);e=a(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return K(e).length;default:if(n)return H(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return A(this,t,r);case"ascii":return F(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:v(e,t,r,n,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,n,i){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var d=!0,h=0;h<c;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function b(e,t,r,n){return q(H(t,e.length-r),e,r,n)}function _(e,t,r,n){return q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function S(e,t,r,n){return _(e,t,r,n)}function E(e,t,r,n){return q(K(t),e,r,n)}function x(e,t,r,n){return q(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function I(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function A(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=d}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,r){return u(null,e,t,r)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,r){return function(e,t,r,n){return l(t),t<=0?a(e,t):void 0!==r?"string"==typeof n?a(e,t).fill(r,n):a(e,t).fill(r):a(e,t)}(null,e,t,r)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?A(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,r,n,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),l=e.slice(t,r),d=0;d<a;++d)if(u[d]!==l[d]){o=u[d],s=l[d];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return _(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return E(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function F(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=M(e[o]);return i}function C(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function j(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function N(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function D(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,n,o){return o||D(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function U(e,t,r,n,o){return o||D(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;r=new c(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+e]}return r},c.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},c.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||P(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},c.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},c.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,o=n-r;if(this===e&&r<t&&t<n)for(i=o-1;i>=0;--i)e[i+t]=this[i+r];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=c.isBuffer(e)?e:H(new c(e,n).toString()),a=s.length;for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function M(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function K(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}}).call(this,r(29))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),s=n[0],a=n[1],c=new o(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),l=0,d=a>0?s-4:s;for(r=0;r<d;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;return 2===a&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,c[l++]=255&t),1===a&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],s=16383,a=0,c=r-i;a<c;a+=s)o.push(l(e,a,a+s>c?c:a+s));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)n[a]=s[a],i[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,r){for(var i,o,s=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?i-1:0,h=r?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+d],d+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+d],d+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+p]=255&s,p+=f,s/=256,u-=8);e[r+p-f]|=128*g}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.jws,r=e.KeyUtil,i=e.X509,o=e.crypto,s=e.hextob64u,a=e.b64tohex,c=e.AllowedSigningAlgs;return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.parseJwt=function e(r){n.Log.debug("JoseUtil.parseJwt");try{var i=t.JWS.parse(r);return{header:i.headerObj,payload:i.payloadObj}}catch(e){n.Log.error(e)}},e.validateJwt=function(t,o,s,c,u,l,d){n.Log.debug("JoseUtil.validateJwt");try{if("RSA"===o.kty)if(o.e&&o.n)o=r.getKey(o);else{if(!o.x5c||!o.x5c.length)return n.Log.error("JoseUtil.validateJwt: RSA key missing key material",o),Promise.reject(new Error("RSA key missing key material"));var h=a(o.x5c[0]);o=i.getPublicKeyFromCertHex(h)}else{if("EC"!==o.kty)return n.Log.error("JoseUtil.validateJwt: Unsupported key type",o&&o.kty),Promise.reject(new Error(o.kty));if(!(o.crv&&o.x&&o.y))return n.Log.error("JoseUtil.validateJwt: EC key missing key material",o),Promise.reject(new Error("EC key missing key material"));o=r.getKey(o)}return e._validateJwt(t,o,s,c,u,l,d)}catch(e){return n.Log.error(e&&e.message||e),Promise.reject("JWT validation failed")}},e.validateJwtAttributes=function(t,r,i,o,s,a){o||(o=0),s||(s=parseInt(Date.now()/1e3));var c=e.parseJwt(t).payload;if(!c.iss)return n.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(c.iss!==r)return n.Log.error("JoseUtil._validateJwt: Invalid issuer in token",c.iss),Promise.reject(new Error("Invalid issuer in token: "+c.iss));if(!c.aud)return n.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(c.aud===i||Array.isArray(c.aud)&&c.aud.indexOf(i)>=0))return n.Log.error("JoseUtil._validateJwt: Invalid audience in token",c.aud),Promise.reject(new Error("Invalid audience in token: "+c.aud));if(c.azp&&c.azp!==i)return n.Log.error("JoseUtil._validateJwt: Invalid azp in token",c.azp),Promise.reject(new Error("Invalid azp in token: "+c.azp));if(!a){var u=s+o,l=s-o;if(!c.iat)return n.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(u<c.iat)return n.Log.error("JoseUtil._validateJwt: iat is in the future",c.iat),Promise.reject(new Error("iat is in the future: "+c.iat));if(c.nbf&&u<c.nbf)return n.Log.error("JoseUtil._validateJwt: nbf is in the future",c.nbf),Promise.reject(new Error("nbf is in the future: "+c.nbf));if(!c.exp)return n.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(c.exp<l)return n.Log.error("JoseUtil._validateJwt: exp is in the past",c.exp),Promise.reject(new Error("exp is in the past:"+c.exp))}return Promise.resolve(c)},e._validateJwt=function(r,i,o,s,a,u,l){return e.validateJwtAttributes(r,o,s,a,u,l).then((function(e){try{return t.JWS.verify(r,i,c)?e:(n.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed")))}catch(e){return n.Log.error(e&&e.message||e),Promise.reject(new Error("signature validation failed"))}}))},e.hashString=function e(t,r){try{return o.Util.hashString(t,r)}catch(e){n.Log.error(e)}},e.hexToBase64Url=function e(t){try{return s(t)}catch(e){n.Log.error(e)}},e}()};var n=r(0);e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SigninResponse=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(3);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.SigninResponse=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";o(this,e);var n=i.UrlUtility.parseUrlFragment(t,r);this.error=n.error,this.error_description=n.error_description,this.error_uri=n.error_uri,this.code=n.code,this.state=n.state,this.id_token=n.id_token,this.session_state=n.session_state,this.access_token=n.access_token,this.token_type=n.token_type,this.scope=n.scope,this.profile=void 0,this.expires_in=n.expires_in}return n(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}},set:function(e){var t=parseInt(e);if("number"==typeof t&&t>0){var r=parseInt(Date.now()/1e3);this.expires_at=r+t}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutRequest=void 0;var n=r(0),i=r(3),o=r(9);t.SignoutRequest=function e(t){var r=t.url,s=t.id_token_hint,a=t.post_logout_redirect_uri,c=t.data,u=t.extraQueryParams,l=t.request_type;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!r)throw n.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");for(var d in s&&(r=i.UrlUtility.addQueryParam(r,"id_token_hint",s)),a&&(r=i.UrlUtility.addQueryParam(r,"post_logout_redirect_uri",a),c&&(this.state=new o.State({data:c,request_type:l}),r=i.UrlUtility.addQueryParam(r,"state",this.state.id))),u)r=i.UrlUtility.addQueryParam(r,d,u[d]);this.url=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutResponse=void 0;var n=r(3);t.SignoutResponse=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=n.UrlUtility.parseUrlFragment(t,"?");this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.state=r.state}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryWebStorage=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.InMemoryWebStorage=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._data={}}return e.prototype.getItem=function(e){return i.Log.debug("InMemoryWebStorage.getItem",e),this._data[e]},e.prototype.setItem=function(e,t){i.Log.debug("InMemoryWebStorage.setItem",e),this._data[e]=t},e.prototype.removeItem=function(e){i.Log.debug("InMemoryWebStorage.removeItem",e),delete this._data[e]},e.prototype.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},n(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(10),s=r(39),a=r(15),c=r(45),u=r(47),l=r(18),d=r(8),h=r(20),p=r(11),f=r(4);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.UserManager=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.SilentRenewService,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.SessionMonitor,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.TokenRevocationClient,d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p.TokenClient,m=arguments.length>5&&void 0!==arguments[5]?arguments[5]:f.JoseUtil;g(this,t),r instanceof s.UserManagerSettings||(r=new s.UserManagerSettings(r));var v=y(this,e.call(this,r));return v._events=new c.UserManagerEvents(r),v._silentRenewService=new n(v),v.settings.automaticSilentRenew&&(i.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),v.startSilentRenew()),v.settings.monitorSession&&(i.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),v._sessionMonitor=new o(v)),v._tokenRevocationClient=new a(v._settings),v._tokenClient=new d(v._settings),v._joseUtil=m,v}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getUser=function(){var e=this;return this._loadUser().then((function(t){return t?(i.Log.info("UserManager.getUser: user loaded"),e._events.load(t,!1),t):(i.Log.info("UserManager.getUser: user not found in storage"),null)}))},t.prototype.removeUser=function(){var e=this;return this.storeUser(null).then((function(){i.Log.info("UserManager.removeUser: user removed from storage"),e._events.unload()}))},t.prototype.signinRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:r";var t={useReplaceToNavigate:e.useReplaceToNavigate};return this._signinStart(e,this._redirectNavigator,t).then((function(){i.Log.info("UserManager.signinRedirect: successful")}))},t.prototype.signinRedirectCallback=function(e){return this._signinEnd(e||this._redirectNavigator.url).then((function(e){return e.profile&&e.profile.sub?i.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinRedirectCallback: no sub"),e}))},t.prototype.signinPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="si:p";var t=e.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.display="popup",this._signin(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopup: no sub")),e}))):(i.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},t.prototype.signinPopupCallback=function(e){return this._signinCallback(e,this._popupNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinPopupCallback: no sub")),e})).catch((function(e){i.Log.error(e.message)}))},t.prototype.signinSilent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=Object.assign({},t),this._loadUser().then((function(r){return r&&r.refresh_token?(t.refresh_token=r.refresh_token,e._useRefreshToken(t)):(t.request_type="si:s",t.id_token_hint=t.id_token_hint||e.settings.includeIdTokenInSilentRenew&&r&&r.id_token,r&&e._settings.validateSubOnSilentRenew&&(i.Log.debug("UserManager.signinSilent, subject prior to silent renew: ",r.profile.sub),t.current_sub=r.profile.sub),e._signinSilentIframe(t))}))},t.prototype._useRefreshToken=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._tokenClient.exchangeRefreshToken(t).then((function(t){return t?t.access_token?e._loadUser().then((function(r){if(r){var n=Promise.resolve();return t.id_token&&(n=e._validateIdTokenFromTokenRefreshToken(r.profile,t.id_token)),n.then((function(){return i.Log.debug("UserManager._useRefreshToken: refresh token response success"),r.id_token=t.id_token||r.id_token,r.access_token=t.access_token,r.refresh_token=t.refresh_token||r.refresh_token,r.expires_in=t.expires_in,e.storeUser(r).then((function(){return e._events.load(r),r}))}))}return null})):(i.Log.error("UserManager._useRefreshToken: No access token returned from token endpoint"),Promise.reject("No access token returned from token endpoint")):(i.Log.error("UserManager._useRefreshToken: No response returned from token endpoint"),Promise.reject("No response returned from token endpoint"))}))},t.prototype._validateIdTokenFromTokenRefreshToken=function(e,t){var r=this;return this._metadataService.getIssuer().then((function(n){return r.settings.getEpochTime().then((function(o){return r._joseUtil.validateJwtAttributes(t,n,r._settings.client_id,r._settings.clockSkew,o).then((function(t){return t?t.sub!==e.sub?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: sub in id_token does not match current sub"),Promise.reject(new Error("sub in id_token does not match current sub"))):t.auth_time&&t.auth_time!==e.auth_time?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: auth_time in id_token does not match original auth_time"),Promise.reject(new Error("auth_time in id_token does not match original auth_time"))):t.azp&&t.azp!==e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp in id_token does not match original azp"),Promise.reject(new Error("azp in id_token does not match original azp"))):!t.azp&&e.azp?(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: azp not in id_token, but present in original id_token"),Promise.reject(new Error("azp not in id_token, but present in original id_token"))):void 0:(i.Log.error("UserManager._validateIdTokenFromTokenRefreshToken: Failed to validate id_token"),Promise.reject(new Error("Failed to validate id_token")))}))}))}))},t.prototype._signinSilentIframe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.prompt=e.prompt||"none",this._signin(e,this._iframeNavigator,{startUrl:t,silentRequestTimeout:e.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilent: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilent: no sub")),e}))):(i.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype.signinSilentCallback=function(e){return this._signinCallback(e,this._iframeNavigator).then((function(e){return e&&(e.profile&&e.profile.sub?i.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",e.profile.sub):i.Log.info("UserManager.signinSilentCallback: no sub")),e}))},t.prototype.signinCallback=function(e){var t=this;return this.readSigninResponseState(e).then((function(r){var n=r.state;return r.response,"si:r"===n.request_type?t.signinRedirectCallback(e):"si:p"===n.request_type?t.signinPopupCallback(e):"si:s"===n.request_type?t.signinSilentCallback(e):Promise.reject(new Error("invalid response_type in state"))}))},t.prototype.signoutCallback=function(e,t){var r=this;return this.readSignoutResponseState(e).then((function(n){var i=n.state,o=n.response;return i?"so:r"===i.request_type?r.signoutRedirectCallback(e):"so:p"===i.request_type?r.signoutPopupCallback(e,t):Promise.reject(new Error("invalid response_type in state")):o}))},t.prototype.querySessionStatus=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t=Object.assign({},t)).request_type="si:s";var r=t.redirect_uri||this.settings.silent_redirect_uri||this.settings.redirect_uri;return r?(t.redirect_uri=r,t.prompt="none",t.response_type=t.response_type||this.settings.query_status_response_type,t.scope=t.scope||"openid",t.skipUserInfo=!0,this._signinStart(t,this._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then((function(t){return e.processSigninResponse(t.url).then((function(e){if(i.Log.debug("UserManager.querySessionStatus: got signin response"),e.session_state&&e.profile.sub)return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid};i.Log.info("querySessionStatus successful, user not authenticated")})).catch((function(t){if(t.session_state&&e.settings.monitorAnonymousSession&&("login_required"==t.message||"consent_required"==t.message||"interaction_required"==t.message||"account_selection_required"==t.message))return i.Log.info("UserManager.querySessionStatus: querySessionStatus success for anonymous user"),{session_state:t.session_state};throw t}))}))):(i.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype._signin=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(e,t,n).then((function(t){return r._signinEnd(t.url,e)}))},t.prototype._signinStart=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.prepare(n).then((function(t){return i.Log.debug("UserManager._signinStart: got navigator window handle"),r.createSigninRequest(e).then((function(e){return i.Log.debug("UserManager._signinStart: got signin request"),n.url=e.url,n.id=e.state.id,t.navigate(n)})).catch((function(e){throw t.close&&(i.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),t.close()),e}))}))},t.prototype._signinEnd=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.processSigninResponse(e).then((function(e){i.Log.debug("UserManager._signinEnd: got signin response");var n=new a.User(e);if(r.current_sub){if(r.current_sub!==n.profile.sub)return i.Log.debug("UserManager._signinEnd: current user does not match user returned from signin. sub from signin: ",n.profile.sub),Promise.reject(new Error("login_required"));i.Log.debug("UserManager._signinEnd: current user matches user returned from signin")}return t.storeUser(n).then((function(){return i.Log.debug("UserManager._signinEnd: user stored"),t._events.load(n),n}))}))},t.prototype._signinCallback=function(e,t){i.Log.debug("UserManager._signinCallback");var r="query"===this._settings.response_mode||!this._settings.response_mode&&d.SigninRequest.isCode(this._settings.response_type)?"?":"#";return t.callback(e,void 0,r)},t.prototype.signoutRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:r";var t=e.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;t&&(e.post_logout_redirect_uri=t);var r={useReplaceToNavigate:e.useReplaceToNavigate};return this._signoutStart(e,this._redirectNavigator,r).then((function(){i.Log.info("UserManager.signoutRedirect: successful")}))},t.prototype.signoutRedirectCallback=function(e){return this._signoutEnd(e||this._redirectNavigator.url).then((function(e){return i.Log.info("UserManager.signoutRedirectCallback: successful"),e}))},t.prototype.signoutPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(e=Object.assign({},e)).request_type="so:p";var t=e.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e.post_logout_redirect_uri=t,e.display="popup",e.post_logout_redirect_uri&&(e.state=e.state||{}),this._signout(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then((function(){i.Log.info("UserManager.signoutPopup: successful")}))},t.prototype.signoutPopupCallback=function(e,t){return void 0===t&&"boolean"==typeof e&&(t=e,e=null),this._popupNavigator.callback(e,t,"?").then((function(){i.Log.info("UserManager.signoutPopupCallback: successful")}))},t.prototype._signout=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(e,t,n).then((function(e){return r._signoutEnd(e.url)}))},t.prototype._signoutStart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.prepare(n).then((function(r){return i.Log.debug("UserManager._signoutStart: got navigator window handle"),t._loadUser().then((function(o){return i.Log.debug("UserManager._signoutStart: loaded current user from storage"),(t._settings.revokeAccessTokenOnSignout?t._revokeInternal(o):Promise.resolve()).then((function(){var s=e.id_token_hint||o&&o.id_token;return s&&(i.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),e.id_token_hint=s),t.removeUser().then((function(){return i.Log.debug("UserManager._signoutStart: user removed, creating signout request"),t.createSignoutRequest(e).then((function(e){return i.Log.debug("UserManager._signoutStart: got signout request"),n.url=e.url,e.state&&(n.id=e.state.id),r.navigate(n)}))}))}))})).catch((function(e){throw r.close&&(i.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),r.close()),e}))}))},t.prototype._signoutEnd=function(e){return this.processSignoutResponse(e).then((function(e){return i.Log.debug("UserManager._signoutEnd: got signout response"),e}))},t.prototype.revokeAccessToken=function(){var e=this;return this._loadUser().then((function(t){return e._revokeInternal(t,!0).then((function(r){if(r)return i.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.refresh_token=null,t.expires_at=null,t.token_type=null,e.storeUser(t).then((function(){i.Log.debug("UserManager.revokeAccessToken: user stored"),e._events.load(t)}))}))})).then((function(){i.Log.info("UserManager.revokeAccessToken: access token revoked successfully")}))},t.prototype._revokeInternal=function(e,t){var r=this;if(e){var n=e.access_token,o=e.refresh_token;return this._revokeAccessTokenInternal(n,t).then((function(e){return r._revokeRefreshTokenInternal(o,t).then((function(t){return e||t||i.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no token(s), or JWT format"),e||t}))}))}return Promise.resolve(!1)},t.prototype._revokeAccessTokenInternal=function(e,t){return!e||e.indexOf(".")>=0?Promise.resolve(!1):this._tokenRevocationClient.revoke(e,t).then((function(){return!0}))},t.prototype._revokeRefreshTokenInternal=function(e,t){return e?this._tokenRevocationClient.revoke(e,t,"refresh_token").then((function(){return!0})):Promise.resolve(!1)},t.prototype.startSilentRenew=function(){this._silentRenewService.start()},t.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},t.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then((function(e){return e?(i.Log.debug("UserManager._loadUser: user storageString loaded"),a.User.fromStorageString(e)):(i.Log.debug("UserManager._loadUser: no user storageString"),null)}))},t.prototype.storeUser=function(e){if(e){i.Log.debug("UserManager.storeUser: storing user");var t=e.toStorageString();return this._userStore.set(this._userStoreKey,t)}return i.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},n(t,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),t}(o.OidcClient)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerSettings=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=(r(0),r(5)),o=r(40),s=r(41),a=r(43),c=r(6),u=r(1),l=r(8);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.UserManagerSettings=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.popup_redirect_uri,i=r.popup_post_logout_redirect_uri,p=r.popupWindowFeatures,f=r.popupWindowTarget,g=r.silent_redirect_uri,y=r.silentRequestTimeout,m=r.automaticSilentRenew,v=void 0!==m&&m,w=r.validateSubOnSilentRenew,b=void 0!==w&&w,_=r.includeIdTokenInSilentRenew,S=void 0===_||_,E=r.monitorSession,x=void 0===E||E,I=r.monitorAnonymousSession,A=void 0!==I&&I,k=r.checkSessionInterval,F=void 0===k?2e3:k,T=r.stopCheckSessionOnError,R=void 0===T||T,C=r.query_status_response_type,P=r.revokeAccessTokenOnSignout,O=void 0!==P&&P,j=r.accessTokenExpiringNotificationTime,N=void 0===j?60:j,D=r.redirectNavigator,L=void 0===D?new o.RedirectNavigator:D,U=r.popupNavigator,B=void 0===U?new s.PopupNavigator:U,M=r.iframeNavigator,H=void 0===M?new a.IFrameNavigator:M,K=r.userStore,q=void 0===K?new c.WebStorageStateStore({store:u.Global.sessionStorage}):K;d(this,t);var V=h(this,e.call(this,arguments[0]));return V._popup_redirect_uri=n,V._popup_post_logout_redirect_uri=i,V._popupWindowFeatures=p,V._popupWindowTarget=f,V._silent_redirect_uri=g,V._silentRequestTimeout=y,V._automaticSilentRenew=v,V._validateSubOnSilentRenew=b,V._includeIdTokenInSilentRenew=S,V._accessTokenExpiringNotificationTime=N,V._monitorSession=x,V._monitorAnonymousSession=A,V._checkSessionInterval=F,V._stopCheckSessionOnError=R,C?V._query_status_response_type=C:arguments[0]&&arguments[0].response_type?V._query_status_response_type=l.SigninRequest.isOidc(arguments[0].response_type)?"id_token":"code":V._query_status_response_type="id_token",V._revokeAccessTokenOnSignout=O,V._redirectNavigator=L,V._popupNavigator=B,V._iframeNavigator=H,V._userStore=q,V}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return this._automaticSilentRenew}},{key:"validateSubOnSilentRenew",get:function(){return this._validateSubOnSilentRenew}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"monitorAnonymousSession",get:function(){return this._monitorAnonymousSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"query_status_response_type",get:function(){return this._query_status_response_type}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),t}(i.OidcClientSettings)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectNavigator=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.RedirectNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(){return Promise.resolve(this)},e.prototype.navigate=function(e){return e&&e.url?(e.useReplaceToNavigate?window.location.replace(e.url):window.location=e.url,Promise.resolve()):(i.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},n(e,[{key:"url",get:function(){return window.location.href}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupNavigator=void 0;var n=r(0),i=r(42);t.PopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.PopupWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t,r,o){n.Log.debug("PopupNavigator.callback");try{return i.PopupWindow.notifyOpener(t,r,o),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(3);t.PopupWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t}));var n=t.popupWindowTarget||"_blank",o=t.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",n,o),this._popup&&(i.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return e.prototype.navigate=function(e){return this._popup?e&&e.url?(i.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=e.id,this._id&&(window["popupCallback_"+e.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=e.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},e.prototype._success=function(e){i.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(e)},e.prototype._error=function(e){i.Log.error("PopupWindow.error: ",e),this._cleanup(),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup(!1)},e.prototype._cleanup=function(e){i.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!e&&this._popup.close(),this._popup=null},e.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},e.prototype._callback=function(e,t){this._cleanup(t),e?(i.Log.debug("PopupWindow.callback success"),this._success({url:e})):(i.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},e.notifyOpener=function(e,t,r){if(window.opener){if(e=e||window.location.href){var n=o.UrlUtility.parseUrlFragment(e,r);if(n.state){var s="popupCallback_"+n.state,a=window.opener[s];a?(i.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),a(e,t)):i.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else i.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else i.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},n(e,[{key:"promise",get:function(){return this._promise}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameNavigator=void 0;var n=r(0),i=r(44);t.IFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new i.IFrameWindow(e);return Promise.resolve(t)},e.prototype.callback=function e(t){n.Log.debug("IFrameNavigator.callback");try{return i.IFrameWindow.notifyParent(t),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameWindow=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0);t.IFrameWindow=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t})),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.width=0,this._frame.height=0,window.document.body.appendChild(this._frame)}return e.prototype.navigate=function(e){if(e&&e.url){var t=e.silentRequestTimeout||1e4;i.Log.debug("IFrameWindow.navigate: Using timeout of:",t),this._timer=window.setTimeout(this._timeout.bind(this),t),this._frame.src=e.url}else this._error("No url provided");return this.promise},e.prototype._success=function(e){this._cleanup(),i.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),i.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._frame&&(i.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},e.prototype._timeout=function(){i.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},e.prototype._message=function(e){if(i.Log.debug("IFrameWindow.message"),this._timer&&e.origin===this._origin&&e.source===this._frame.contentWindow&&"string"==typeof e.data&&(e.data.startsWith("http://")||e.data.startsWith("https://"))){var t=e.data;t?this._success({url:t}):this._error("Invalid response from frame")}},e.notifyParent=function(e){i.Log.debug("IFrameWindow.notifyParent"),(e=e||window.location.href)&&(i.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(e,location.protocol+"//"+location.host))},n(e,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerEvents=void 0;var n=r(0),i=r(16),o=r(17);t.UserManagerEvents=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n._userLoaded=new o.Event("User loaded"),n._userUnloaded=new o.Event("User unloaded"),n._silentRenewError=new o.Event("Silent renew error"),n._userSignedIn=new o.Event("User signed in"),n._userSignedOut=new o.Event("User signed out"),n._userSessionChanged=new o.Event("User session changed"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.load=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n.Log.debug("UserManagerEvents.load"),e.prototype.load.call(this,t),r&&this._userLoaded.raise(t)},t.prototype.unload=function(){n.Log.debug("UserManagerEvents.unload"),e.prototype.unload.call(this),this._userUnloaded.raise()},t.prototype.addUserLoaded=function(e){this._userLoaded.addHandler(e)},t.prototype.removeUserLoaded=function(e){this._userLoaded.removeHandler(e)},t.prototype.addUserUnloaded=function(e){this._userUnloaded.addHandler(e)},t.prototype.removeUserUnloaded=function(e){this._userUnloaded.removeHandler(e)},t.prototype.addSilentRenewError=function(e){this._silentRenewError.addHandler(e)},t.prototype.removeSilentRenewError=function(e){this._silentRenewError.removeHandler(e)},t.prototype._raiseSilentRenewError=function(e){n.Log.debug("UserManagerEvents._raiseSilentRenewError",e.message),this._silentRenewError.raise(e)},t.prototype.addUserSignedIn=function(e){this._userSignedIn.addHandler(e)},t.prototype.removeUserSignedIn=function(e){this._userSignedIn.removeHandler(e)},t.prototype._raiseUserSignedIn=function(){n.Log.debug("UserManagerEvents._raiseUserSignedIn"),this._userSignedIn.raise()},t.prototype.addUserSignedOut=function(e){this._userSignedOut.addHandler(e)},t.prototype.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},t.prototype._raiseUserSignedOut=function(){n.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise()},t.prototype.addUserSessionChanged=function(e){this._userSessionChanged.addHandler(e)},t.prototype.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},t.prototype._raiseUserSessionChanged=function(){n.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise()},t}(i.AccessTokenEvents)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(1),s=r(17);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.Timer=function(e){function t(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.timer,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;a(this,t);var s=c(this,e.call(this,r));return s._timer=n,s._nowFunc=i||function(){return Date.now()/1e3},s}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.init=function(e){e<=0&&(e=1),e=parseInt(e);var t=this.now+e;if(this.expiration===t&&this._timerHandle)i.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),i.Log.debug("Timer.init timer "+this._name+" for duration:",e),this._expiration=t;var r=5;e<r&&(r=e),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*r)}},t.prototype.cancel=function(){this._timerHandle&&(i.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},t.prototype._callback=function(){var t=this._expiration-this.now;i.Log.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),e.prototype.raise.call(this))},n(t,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),t}(s.Event)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SilentRenewService=void 0;var n=r(0);t.SilentRenewService=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userManager=t}return e.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then((function(e){})).catch((function(e){n.Log.error("SilentRenewService.start: Error from getUser:",e.message)})))},e.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},e.prototype._tokenExpiring=function(){var e=this;this._userManager.signinSilent().then((function(e){n.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")}),(function(t){n.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),e._userManager.events._raiseSilentRenewError(t)}))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupNavigator=void 0;var n=r(21);t.CordovaPopupNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaIFrameNavigator=void 0;var n=r(21);t.CordovaIFrameNavigator=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.prepare=function(e){e.popupWindowFeatures="hidden=yes";var t=new n.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.11.6"}])},e.exports=t()},143:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4716),i=r(3783),o=(e,t)=>window.fetch(e,t);t.default=class{constructor(e,t,r,s,a){this.loginHandler=e,this.redirectHandler=t,this.logoutHandler=r,this.sessionInfoManager=s,this.issuerConfigFetcher=a,this.login=async(e,t)=>{var r,i;await this.sessionInfoManager.clear(e.sessionId);const o=(0,n.removeOidcQueryParam)(null!==(r=e.redirectUrl)&&void 0!==r?r:window.location.href);await this.loginHandler.handle({...e,redirectUrl:o,clientName:null!==(i=e.clientName)&&void 0!==i?i:e.clientId,eventEmitter:t})},this.fetch=o,this.logout=async e=>{await this.logoutHandler.handle(e),this.fetch=o},this.getSessionInfo=async e=>this.sessionInfoManager.get(e),this.getAllSessionInfo=async()=>this.sessionInfoManager.getAll(),this.validateCurrentSession=async()=>{const e=window.localStorage.getItem(i.KEY_CURRENT_SESSION);if(null===e)return null;const t=await this.sessionInfoManager.get(e);return void 0===t||void 0===t.clientAppId||void 0===t.issuer?null:t},this.handleIncomingRedirect=async(e,t)=>{const r=await this.redirectHandler.handle(e,t);this.fetch=r.fetch.bind(window);const n=new URL(e);return n.searchParams.delete("state"),n.searchParams.delete("code"),n.searchParams.delete("id_token"),n.searchParams.delete("access_token"),n.searchParams.delete("error"),n.searchParams.delete("error_description"),window.history.replaceState(null,"",n.toString()),{isLoggedIn:r.isLoggedIn,webId:r.webId,sessionId:r.sessionId,expirationDate:r.expirationDate}}}}},3598:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Session=t.silentlyAuthenticate=void 0;const n=r(7187),i=r(835),o=r(1614),s=r(3537),a=r(3783),c=r(2464);async function u(e,t,r={inIframe:!1},n){var i;const o=await t.validateCurrentSession();return null!==o&&(window.localStorage.setItem(a.KEY_CURRENT_URL,window.location.href),await t.login({sessionId:e,prompt:"none",oidcIssuer:o.issuer,redirectUrl:o.redirectUrl,clientId:o.clientAppId,clientSecret:o.clientAppSecret,tokenType:null!==(i=o.tokenType)&&void 0!==i?i:"DPoP",inIframe:r.inIframe},n),!0)}function l(e){return!!(null==e?void 0:e.isLoggedIn)}t.silentlyAuthenticate=u;class d extends n.EventEmitter{constructor(e={},t){super(),this.tokenRequestInProgress=!1,this.tmpFetchWithCookies=!1,this.login=async e=>{var t;return await this.clientAuthentication.login({sessionId:this.info.sessionId,...e,tokenType:null!==(t=e.tokenType)&&void 0!==t?t:"DPoP"},this),new Promise((()=>{}))},this.fetch=async(e,t)=>this.clientAuthentication.fetch(e,{...t,credentials:this.tmpFetchWithCookies?"include":null==t?void 0:t.credentials}),this.logout=async()=>{await this.clientAuthentication.logout(this.info.sessionId),this.info.isLoggedIn=!1,this.tmpFetchWithCookies=!1,this.emit("logout")},this.handleIncomingRedirect=async(e={})=>{var t;if(this.info.isLoggedIn)return this.info;if(this.tokenRequestInProgress)return;const r="string"==typeof e?{url:e}:e,n=null!==(t=r.url)&&void 0!==t?t:window.location.href;if(null!==window.frameElement)return void(0,c.postRedirectUrlToParent)(n);!0!==r.useEssSession||!0===r.restorePreviousSession?window.localStorage.setItem("tmp-resource-server-session-enabled","false"):window.localStorage.setItem("tmp-resource-server-session-enabled","true");const i=window.localStorage.getItem("tmp-resource-server-session-info");if("string"==typeof i&&!0!==r.restorePreviousSession&&!0===r.useEssSession){function e(e){var t;const r=Object.keys(null!==(t=e.sessions)&&void 0!==t?t:{});return"string"==typeof e.webId&&r.length>0&&"number"==typeof e.sessions[r[0]].expiration}const t=JSON.parse(i);if(e(t)){const e=Object.keys(t.sessions),r=new URL(t.webId).hostname,n=e.find((e=>new URL(e).hostname===r)),i=null!=n?n:e[0];if(t.sessions[i].expiration-Date.now()>3e5)return this.info.isLoggedIn=!0,this.info.webId=t.webId,this.tmpFetchWithCookies=!0,this.info}}this.tokenRequestInProgress=!0;const o=await this.clientAuthentication.handleIncomingRedirect(n,this);if(l(o)){this.setSessionInfo(o);const e=window.localStorage.getItem(a.KEY_CURRENT_URL);null===e?this.emit("login"):(window.localStorage.removeItem(a.KEY_CURRENT_URL),this.emit("sessionRestore",e))}else if(!0===r.restorePreviousSession){const e=window.localStorage.getItem(a.KEY_CURRENT_SESSION);if(null!==e&&await u(e,this.clientAuthentication,void 0,this))return new Promise((()=>{}))}return this.tokenRequestInProgress=!1,o},e.clientAuthentication?this.clientAuthentication=e.clientAuthentication:e.secureStorage&&e.insecureStorage?this.clientAuthentication=(0,s.getClientAuthenticationWithDependencies)({secureStorage:e.secureStorage,insecureStorage:e.insecureStorage}):this.clientAuthentication=(0,s.getClientAuthenticationWithDependencies)({}),e.sessionInfo?this.info={sessionId:e.sessionInfo.sessionId,isLoggedIn:!1,webId:e.sessionInfo.webId}:this.info={sessionId:null!=t?t:(0,o.v4)(),isLoggedIn:!1},(0,c.setupIframeListener)((async e=>{const t=await this.clientAuthentication.handleIncomingRedirect(e,this);l(t)&&this.setSessionInfo(t)})),this.on("tokenRenewal",(()=>u(this.info.sessionId,this.clientAuthentication,{inIframe:!0},this)))}onLogin(e){this.on("login",e)}onLogout(e){this.on("logout",e)}onError(e){this.on(i.EVENTS.ERROR,e)}onSessionRestore(e){this.on("sessionRestore",e)}onSessionExpiration(e){this.on(i.EVENTS.SESSION_EXPIRED,e)}setSessionInfo(e){this.info.isLoggedIn=e.isLoggedIn,this.info.webId=e.webId,this.info.sessionId=e.sessionId,this.info.expirationDate=e.expirationDate,this.on(i.EVENTS.SESSION_EXTENDED,(e=>{this.info.expirationDate=Date.now()+1e3*e}))}}t.Session=d},3783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CURRENT_URL=t.KEY_CURRENT_SESSION=void 0;const n=r(835);t.KEY_CURRENT_SESSION=`${n.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentSession`,t.KEY_CURRENT_URL=`${n.SOLID_CLIENT_AUTHN_KEY_PREFIX}currentUrl`},7814:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onSessionRestore=t.onLogout=t.onLogin=t.handleIncomingRedirect=t.logout=t.login=t.fetch=t.getDefaultSession=void 0;const n=r(3598);let i;function o(){return void 0===i&&(i=new n.Session),i}t.getDefaultSession=o,t.fetch=(...e)=>o().fetch(...e),t.login=(...e)=>o().login(...e),t.logout=(...e)=>o().logout(...e),t.handleIncomingRedirect=(...e)=>o().handleIncomingRedirect(...e),t.onLogin=(...e)=>o().onLogin(...e),t.onLogout=(...e)=>o().onLogout(...e),t.onSessionRestore=(...e)=>o().onSessionRestore(...e)},3537:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClientAuthenticationWithDependencies=void 0;const i=r(835),o=n(r(437)),s=n(r(143)),a=n(r(2018)),c=n(r(1590)),u=n(r(4377)),l=r(5220),d=n(r(2186)),h=r(3624),p=r(4520),f=n(r(5912)),g=n(r(5394)),y=n(r(2536)),m=n(r(7826)),v=r(1446),w=n(r(3144));t.getClientAuthenticationWithDependencies=function(e){const t=new i.InMemoryStorage,r=e.secureStorage||t,n=e.insecureStorage||new g.default,b=new o.default(r,n),_=new u.default(b),S=new m.default(b),E=new h.SessionInfoManager(b),x=new w.default(b,_,S),I=new a.default(b,new c.default(b,new y.default),_,S),A=new f.default([new v.ErrorOidcHandler,new p.AuthCodeRedirectHandler(b,E,_,S,x),new l.FallbackRedirectHandler]);return new s.default(I,A,new d.default(E),E,_)}},2464:(e,t)=>{"use strict";let r;function n(){return void 0===r&&(r=window.document.createElement("iframe"),r.setAttribute("hidden","true"),r.setAttribute("sandbox","allow-scripts allow-same-origin")),r}Object.defineProperty(t,"__esModule",{value:!0}),t.postRedirectUrlToParent=t.setupIframeListener=t.redirectInIframe=void 0,t.redirectInIframe=function(e){const t=n();window.document.body.appendChild(t),t.src=e},t.setupIframeListener=function(e){"undefined"!=typeof window&&window.addEventListener("message",(async t=>{const r=n();t.origin===window.location.origin&&t.source===r.contentWindow&&"string"==typeof t.data.redirectUrl&&await e(t.data.redirectUrl),window.document.body.contains(r)&&window.document.body.removeChild(r)}))},t.postRedirectUrlToParent=function(e){window.top.postMessage({redirectUrl:e},window.location.origin)}},4305:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryStorage=t.ConfigurationError=t.NotImplementedError=t.getClientAuthenticationWithDependencies=t.Session=void 0;var o=r(3598);Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return o.Session}});var s=r(3537);Object.defineProperty(t,"getClientAuthenticationWithDependencies",{enumerable:!0,get:function(){return s.getClientAuthenticationWithDependencies}}),i(r(7814),t);var a=r(835);Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return a.NotImplementedError}}),Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return a.ConfigurationError}}),Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return a.InMemoryStorage}})},7826:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4716);t.default=class{constructor(e){this.storageUtility=e}async getClient(e,t){var r;const[i,o]=await Promise.all([this.storageUtility.getForUser(e.sessionId,"clientId",{secure:!1}),this.storageUtility.getForUser(e.sessionId,"clientSecret",{secure:!1})]);if(i)return{clientId:i,clientSecret:o,clientType:"dynamic"};const s={...e};s.registrationAccessToken=null!==(r=s.registrationAccessToken)&&void 0!==r?r:await this.storageUtility.getForUser(e.sessionId,"registrationAccessToken");try{const e=await(0,n.registerClient)(s,t),r={clientId:e.clientId};return e.clientSecret&&(r.clientSecret=e.clientSecret),e.idTokenSignedResponseAlg&&(r.idTokenSignedResponseAlg=e.idTokenSignedResponseAlg),await this.storageUtility.setForUser(s.sessionId,r,{secure:!1}),e}catch(e){throw new Error(`Client registration failed: [${e}]`)}}}},4377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WELL_KNOWN_OPENID_CONFIG=void 0;const n=r(835),i=r(7226);t.WELL_KNOWN_OPENID_CONFIG=".well-known/openid-configuration";const o={issuer:{toKey:"issuer",convertToUrl:!0},authorization_endpoint:{toKey:"authorizationEndpoint",convertToUrl:!0},token_endpoint:{toKey:"tokenEndpoint",convertToUrl:!0},userinfo_endpoint:{toKey:"userinfoEndpoint",convertToUrl:!0},jwks_uri:{toKey:"jwksUri",convertToUrl:!0},registration_endpoint:{toKey:"registrationEndpoint",convertToUrl:!0},scopes_supported:{toKey:"scopesSupported"},response_types_supported:{toKey:"responseTypesSupported"},response_modes_supported:{toKey:"responseModesSupported"},grant_types_supported:{toKey:"grantTypesSupported"},acr_values_supported:{toKey:"acrValuesSupported"},subject_types_supported:{toKey:"subjectTypesSupported"},id_token_signing_alg_values_supported:{toKey:"idTokenSigningAlgValuesSupported"},id_token_encryption_alg_values_supported:{toKey:"idTokenEncryptionAlgValuesSupported"},id_token_encryption_enc_values_supported:{toKey:"idTokenEncryptionEncValuesSupported"},userinfo_signing_alg_values_supported:{toKey:"userinfoSigningAlgValuesSupported"},userinfo_encryption_alg_values_supported:{toKey:"userinfoEncryptionAlgValuesSupported"},userinfo_encryption_enc_values_supported:{toKey:"userinfoEncryptionEncValuesSupported"},request_object_signing_alg_values_supported:{toKey:"requestObjectSigningAlgValuesSupported"},request_object_encryption_alg_values_supported:{toKey:"requestObjectEncryptionAlgValuesSupported"},request_object_encryption_enc_values_supported:{toKey:"requestObjectEncryptionEncValuesSupported"},token_endpoint_auth_methods_supported:{toKey:"tokenEndpointAuthMethodsSupported"},token_endpoint_auth_signing_alg_values_supported:{toKey:"tokenEndpointAuthSigningAlgValuesSupported"},display_values_supported:{toKey:"displayValuesSupported"},claim_types_supported:{toKey:"claimTypesSupported"},claims_supported:{toKey:"claimsSupported"},service_documentation:{toKey:"serviceDocumentation"},claims_locales_supported:{toKey:"claimsLocalesSupported"},ui_locales_supported:{toKey:"uiLocalesSupported"},claims_parameter_supported:{toKey:"claimsParameterSupported"},request_parameter_supported:{toKey:"requestParameterSupported"},request_uri_parameter_supported:{toKey:"requestUriParameterSupported"},require_request_uri_registration:{toKey:"requireRequestUriRegistration"},op_policy_uri:{toKey:"opPolicyUri",convertToUrl:!0},op_tos_uri:{toKey:"opTosUri",convertToUrl:!0}};class s{constructor(e){this.storageUtility=e}static getLocalStorageKey(e){return`issuerConfig:${e}`}async fetchConfig(e){let r;const a=(0,i.appendToUrlPathname)(e,t.WELL_KNOWN_OPENID_CONFIG),c=await window.fetch(a);try{r=function(e){const t={};return Object.keys(e).forEach((r=>{o[r]&&(t[o[r].toKey]=e[r])})),t}(await c.json())}catch(t){throw new n.ConfigurationError(`[${e.toString()}] has an invalid configuration: ${t.message}`)}return await this.storageUtility.set(s.getLocalStorageKey(e),JSON.stringify(r)),r}}t.default=s},2018:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(835);function i(e){return"string"==typeof e.oidcIssuer}function o(e){return"string"==typeof e.redirectUrl}t.default=class{constructor(e,t,r,n){this.storageUtility=e,this.oidcHandler=t,this.issuerConfigFetcher=r,this.clientRegistrar=n}async canHandle(e){return i(e)&&o(e)}async handle(e){if(!i(e))throw new n.ConfigurationError(`OidcLoginHandler requires an OIDC issuer: missing property 'oidcIssuer' in ${JSON.stringify(e)}`);if(!o(e))throw new n.ConfigurationError(`OidcLoginHandler requires a redirect URL: missing property 'redirectUrl' in ${JSON.stringify(e)}`);const t=await this.issuerConfigFetcher.fetchConfig(e.oidcIssuer),r=await(0,n.handleRegistration)(e,t,this.storageUtility,this.clientRegistrar),s={issuer:t.issuer,dpop:"dpop"===e.tokenType.toLowerCase(),...e,issuerConfiguration:t,client:r};return this.oidcHandler.handle(s)}}},2536:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2464);t.default=class{redirect(e,t){t&&t.handleRedirect?t.handleRedirect(e):t&&t.redirectByReplacingState?window.history.replaceState({},"",e):(null==t?void 0:t.redirectInIframe)?(0,n.redirectInIframe)(e):window.location.href=e}}},1590:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4716);t.default=class{constructor(e,t){this.storageUtility=e,this.redirector=t}async canHandle(e){return!!(e.issuerConfiguration.grantTypesSupported&&e.issuerConfiguration.grantTypesSupported.indexOf("authorization_code")>-1)}async handle(e){var t;const r={authority:e.issuer.toString(),client_id:e.client.clientId,client_secret:e.client.clientSecret,redirect_uri:e.redirectUrl.toString(),post_logout_redirect_uri:e.redirectUrl.toString(),response_type:"code",scope:"openid offline_access webid",filterProtocolClaims:!0,loadUserInfo:!1,code_verifier:!0,prompt:null!==(t=e.prompt)&&void 0!==t?t:"consent"},i=new n.OidcClient(r),{redirector:o}=this,s=this.storageUtility;try{const t=await i.createSigninRequest();await Promise.all([s.setForUser(t.state._id,{sessionId:e.sessionId}),s.setForUser(e.sessionId,{codeVerifier:t.state._code_verifier,issuer:e.issuer.toString(),redirectUrl:e.redirectUrl,dpop:e.dpop?"true":"false"})]),o.redirect(t.url.toString(),{handleRedirect:e.handleRedirect,redirectInIframe:e.inIframe})}catch(e){console.error(e)}}}},5912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(835);class i extends n.AggregateHandler{constructor(e){super(e)}}t.default=i},4520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AuthCodeRedirectHandler=t.DEFAULT_LIFESPAN=void 0;const n=r(835),i=r(4716),o=r(3783);t.DEFAULT_LIFESPAN=18e5,t.AuthCodeRedirectHandler=class{constructor(e,t,r,n,i){this.storageUtility=e,this.sessionInfoManager=t,this.issuerConfigFetcher=r,this.clientRegistrar=n,this.tokerRefresher=i}async canHandle(e){try{const t=new URL(e);return null!==t.searchParams.get("code")&&null!==t.searchParams.get("state")}catch(t){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e,r){if(!await this.canHandle(e))throw new Error(`AuthCodeRedirectHandler cannot handle [${e}]: it is missing one of [code, state].`);const s=new URL(e),a=s.searchParams.get("state"),c=await this.storageUtility.getForUser(a,"sessionId",{errorIfNull:!0}),u="true"===await this.storageUtility.getForUser(c,"dpop"),l=await this.storageUtility.getForUser(c,"issuer",{errorIfNull:!0});window.localStorage.setItem(o.KEY_CURRENT_SESSION,c);const d=await this.issuerConfigFetcher.fetchConfig(l),h=await this.clientRegistrar.getClient({sessionId:c},d);let p;const f=Date.now();if(u){const e=await this.storageUtility.getForUser(c,"codeVerifier",{errorIfNull:!0}),t=await this.storageUtility.getForUser(c,"redirectUrl",{errorIfNull:!0});p=await(0,i.getDpopToken)(d,h,{grantType:"authorization_code",code:s.searchParams.get("code"),codeVerifier:e,redirectUrl:t})}else p=await(0,i.getBearerToken)(s.toString());let g;void 0!==p.refreshToken&&(g={sessionId:c,refreshToken:p.refreshToken,tokenRefresher:this.tokerRefresher});const y=await(0,n.buildAuthenticatedFetch)(fetch,p.accessToken,{dpopKey:p.dpopKey,refreshOptions:g,eventEmitter:r,expiresIn:p.expiresIn});await this.storageUtility.setForUser(c,{webId:p.webId,isLoggedIn:"true"},{secure:!0}),s.searchParams.delete("code"),await this.storageUtility.setForUser(c,{redirectUrl:s.toString()},{secure:!1}),"false"===window.localStorage.getItem("tmp-resource-server-session-enabled")||await async function(e,r,n){const i=new URL(e).origin;await r(e);try{if(200===(await r(`${i}/session`)).status)return void await n.storeResourceServerSessionInfo(e,i,Date.now()+t.DEFAULT_LIFESPAN);await n.clearResourceServerSessionInfo(i)}catch(e){await n.clearResourceServerSessionInfo(i)}}(p.webId,y,this.storageUtility);const m=await this.sessionInfoManager.get(c);if(!m)throw new Error(`Could not retrieve session: [${c}].`);return Object.assign(m,{fetch:y,expirationDate:"number"==typeof p.expiresIn?f+1e3*p.expiresIn:null})}}},1446:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorOidcHandler=void 0;const n=r(835),i=r(3624);t.ErrorOidcHandler=class{async canHandle(e){try{return new URL(e).searchParams.has("error")}catch(t){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e,t){if(void 0!==t){const r=new URL(e),i=r.searchParams.get("error"),o=r.searchParams.get("error_description");t.emit(n.EVENTS.ERROR,i,o)}return(0,i.getUnauthenticatedSession)()}}},5220:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FallbackRedirectHandler=void 0;const n=r(3624);t.FallbackRedirectHandler=class{async canHandle(e){try{return new URL(e),!0}catch(t){throw new Error(`[${e}] is not a valid URL, and cannot be used as a redirect URL: ${t}`)}}async handle(e){return(0,n.getUnauthenticatedSession)()}}},3144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(835),i=r(4716);t.default=class{constructor(e,t,r){this.storageUtility=e,this.issuerConfigFetcher=t,this.clientRegistrar=r}async refresh(e,t,r,o){const s=await(0,n.loadOidcContextFromStorage)(e,this.storageUtility,this.issuerConfigFetcher),a=await this.clientRegistrar.getClient({sessionId:e},s.issuerConfig);if(void 0===t)throw new Error(`Session [${e}] has no refresh token to allow it to refresh its access token.`);if(s.dpop&&void 0===r)throw new Error(`For session [${e}], the key bound to the DPoP access token must be provided to refresh said access token.`);const c=await(0,i.refresh)(t,s.issuerConfig,a,r);return void 0!==c.refreshToken&&(null==o||o.emit(n.EVENTS.NEW_REFRESH_TOKEN,c.refreshToken),await this.storageUtility.setForUser(e,{refreshToken:c.refreshToken})),c}}},2186:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.sessionInfoManager=e}async canHandle(){return!0}async handle(e){await this.sessionInfoManager.clear(e)}}},3624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionInfoManager=t.clear=t.getUnauthenticatedSession=void 0;const n=r(835),i=r(1614),o=r(4716);async function s(e,t){const r=await t.get("tmp-resource-server-session-info"),n=JSON.parse(null!=r?r:"{}"),{webId:i}=n;if(void 0!==i){const e=new URL(i).origin;await t.clearResourceServerSessionInfo(e)}await Promise.all([t.deleteAllUserData(e,{secure:!1}),t.deleteAllUserData(e,{secure:!0}),t.delete("clientKey",{secure:!1})]),await(0,o.clearOidcPersistentStorage)()}t.getUnauthenticatedSession=function(){return{isLoggedIn:!1,sessionId:(0,i.v4)(),fetch}},t.clear=s,t.SessionInfoManager=class{constructor(e){this.storageUtility=e}update(e,t){throw new Error("Not Implemented")}async get(e){var t;const r=await this.storageUtility.getForUser(e,"isLoggedIn",{secure:!0}),i=await this.storageUtility.getForUser(e,"webId",{secure:!0}),o=await this.storageUtility.getForUser(e,"clientId",{secure:!1}),s=await this.storageUtility.getForUser(e,"clientSecret",{secure:!1}),a=await this.storageUtility.getForUser(e,"redirectUrl",{secure:!1}),c=await this.storageUtility.getForUser(e,"refreshToken",{secure:!0}),u=await this.storageUtility.getForUser(e,"issuer",{secure:!1}),l=null!==(t=await this.storageUtility.getForUser(e,"tokenType",{secure:!1}))&&void 0!==t?t:"DPoP";if(!(0,n.isSupportedTokenType)(l))throw new Error(`Tokens of type [${l}] are not supported.`);if(void 0!==o||void 0!==r||void 0!==i||void 0!==c)return{sessionId:e,webId:i,isLoggedIn:"true"===r,redirectUrl:a,refreshToken:c,issuer:u,clientAppId:o,clientAppSecret:s,tokenType:l}}async getAll(){throw new Error("Not implemented")}async clear(e){return s(e,this.storageUtility)}async register(e){throw new Error("Not implemented")}async getRegisteredSessionIdAll(){throw new Error("Not implemented")}async clearAll(){throw new Error("Not implemented")}}},5394:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{get storage(){return window.localStorage}async get(e){return this.storage.getItem(e)||void 0}async set(e,t){this.storage.setItem(e,t)}async delete(e){this.storage.removeItem(e)}}},437:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(835);class i extends n.StorageUtility{constructor(e,t){super(e,t)}}t.default=i},7226:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.appendToUrlPathname=void 0,t.appendToUrlPathname=function(e,t){const r=new URL(e),n=r.pathname;return r.pathname=`${n}${n.endsWith("/")?"":"/"}${t.startsWith("/")?t.substring(1):t}`,r.toString()}},2155:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateDpopKeyPair=t.createDpopHeader=void 0;const n=r(7289),i=r(1614),o=r(4672);function s(e){const t=new URL(e);return new URL(t.pathname,t.origin).toString()}t.createDpopHeader=async function(e,t,r){return new n.SignJWT({htu:s(e),htm:t.toUpperCase(),jti:(0,i.v4)()}).setProtectedHeader({alg:o.PREFERRED_SIGNING_ALG[0],jwk:r.publicKey,typ:"dpop+jwt"}).setIssuedAt().sign(r.privateKey,{})},t.generateDpopKeyPair=async function(){const{privateKey:e,publicKey:t}=await(0,n.generateKeyPair)(o.PREFERRED_SIGNING_ALG[0]),r={privateKey:e,publicKey:await(0,n.exportJWK)(t)};return[r.publicKey.alg]=o.PREFERRED_SIGNING_ALG,r}},8687:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAuthenticatedFetch=t.DEFAULT_EXPIRATION_TIME_SECONDS=void 0;const n=r(4098),i=r(4672),o=r(2155),s=r(6904),a=r(6583);async function c(e,t,r,i,s){return e(r,await async function(e,t,r,i){if(void 0!==r)return async function(e,t,r,i){var s;const a=new n.Headers(null==i?void 0:i.headers);return a.set("Authorization",`DPoP ${t}`),a.set("DPoP",await(0,o.createDpopHeader)(e,null!==(s=null==i?void 0:i.method)&&void 0!==s?s:"get",r)),{...i,headers:a}}(e,t,r,i);const s=new n.Headers(null==i?void 0:i.headers);return s.set("Authorization",`Bearer ${t}`),{...i,headers:s}}(r.toString(),t,s,i))}t.DEFAULT_EXPIRATION_TIME_SECONDS=600;const u=e=>void 0!==e?e-i.REFRESH_BEFORE_EXPIRATION_SECONDS>0?e-i.REFRESH_BEFORE_EXPIRATION_SECONDS:e:t.DEFAULT_EXPIRATION_TIME_SECONDS;t.buildAuthenticatedFetch=async function(e,r,n){var o;let l,d=r;const h=null==n?void 0:n.refreshOptions;if(void 0!==h){const e=async()=>{var r,o,c,p;try{const{accessToken:o,refreshToken:s,expiresIn:a}=await async function(e,r,n){var o;const s=await e.tokenRefresher.refresh(e.sessionId,e.refreshToken,r);return null==n||n.emit(i.EVENTS.SESSION_EXTENDED,null!==(o=s.expiresIn)&&void 0!==o?o:t.DEFAULT_EXPIRATION_TIME_SECONDS),"string"==typeof s.refreshToken&&(null==n||n.emit(i.EVENTS.NEW_REFRESH_TOKEN,s.refreshToken)),{accessToken:s.accessToken,refreshToken:s.refreshToken,expiresIn:s.expiresIn}}(h,n.dpopKey,n.eventEmitter);d=o,void 0!==s&&(h.refreshToken=s),clearTimeout(l),l=setTimeout(e,1e3*u(a)),null===(r=n.eventEmitter)||void 0===r||r.emit(i.EVENTS.TIMEOUT_SET,l)}catch(e){e instanceof s.OidcProviderError&&(null===(o=null==n?void 0:n.eventEmitter)||void 0===o||o.emit(i.EVENTS.ERROR,e.error,e.errorDescription),null===(c=null==n?void 0:n.eventEmitter)||void 0===c||c.emit(i.EVENTS.SESSION_EXPIRED)),e instanceof a.InvalidResponseError&&e.missingFields.includes("access_token")&&(null===(p=null==n?void 0:n.eventEmitter)||void 0===p||p.emit(i.EVENTS.SESSION_EXPIRED))}};l=setTimeout(e,1e3*u(n.expiresIn)),null===(o=n.eventEmitter)||void 0===o||o.emit(i.EVENTS.TIMEOUT_SET,l)}else if(void 0!==n&&void 0!==n.eventEmitter){const e=setTimeout((()=>{n.eventEmitter.emit(i.EVENTS.SESSION_EXPIRED)}),1e3*u(n.expiresIn));n.eventEmitter.emit(i.EVENTS.TIMEOUT_SET,e)}return async(t,r)=>{let i=await c(e,d,t,r,null==n?void 0:n.dpopKey);const o=!i.ok&&(s=i.status,![401,403].includes(s));var s;return i.ok||o||i.url!==t&&void 0!==(null==n?void 0:n.dpopKey)&&(i=await c(e,d,i.url,r,n.dpopKey)),i}}},4672:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REFRESH_BEFORE_EXPIRATION_SECONDS=t.EVENTS=t.PREFERRED_SIGNING_ALG=t.SOLID_CLIENT_AUTHN_KEY_PREFIX=void 0,t.SOLID_CLIENT_AUTHN_KEY_PREFIX="solidClientAuthn:",t.PREFERRED_SIGNING_ALG=["ES256","RS256"],t.EVENTS={NEW_REFRESH_TOKEN:"newRefreshToken",ERROR:"onError",SESSION_EXPIRED:"sessionExpired",SESSION_EXTENDED:"sessionExtended",TIMEOUT_SET:"timeoutSet"},t.REFRESH_BEFORE_EXPIRATION_SECONDS=5},7117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e)}}t.default=r},2029:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e,t,n=!0){super("string"==typeof e?r.substituteParams(e,t):r.appendErrorIri(r.lookupErrorIri(e,t),e,n))}httpResponse(e,t=!0){return this.message=r.appendHttpResponseDetails(this.message,e,t),this.httpErrorResponse=e,this}hasHttpResponse(){return void 0!==this.httpErrorResponse}getHttpResponse(){return this.httpErrorResponse}getHttpStatusCode(){if(void 0===this.httpErrorResponse)throw new r("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Code.");return this.httpErrorResponse.status}getHttpStatusText(){if(void 0===this.httpErrorResponse)throw new r("This InruptError was not provided with a HTTP response - so we can't get its HTTP Status Text!");return this.httpErrorResponse.statusText}static determineIfVocabTerm(e){return void 0!==e.strict}static lookupErrorIri(e,t){if(r.determineIfVocabTerm(e)){const r=void 0===t?e.message:e.messageParams(...t);return void 0===r?`Looked up error message IRI [${e.value}], but found no message value.`:r}return`Error message looked up at: [${e.value}]${void 0===t?"":`, with params [${t.toString()}]`}`}static appendHttpResponseDetails(e,t,r){return r&&void 0!==t?`${e} HTTP details: status code [${t.status}], status text [${t.statusText}].`:e}static appendErrorIri(e,t,r){return r?`${e} Error IRI: [${t.value}].`:e}static substituteParams(e,t){let r=e;if(void 0!==t){const n=e.split("{{").length-1;if(n!==t.length)throw new Error(`Setting parameters on message [${e}], but it requires [${n}] params and we received [${t.length}].`);for(let e=0;e<t.length;e+=1){const n=`{{${e}}}`;r=r.replace(n,t[e])}}return r}}t.default=r},6583:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidResponseError=void 0;class r extends Error{constructor(e){super(`Invalid response from OIDC provider: missing fields ${e}`),this.missingFields=e}}t.InvalidResponseError=r},7073:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(`[${e}] is not implemented`)}}t.default=r},6904:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OidcProviderError=void 0;class r extends Error{constructor(e,t,r){super(e),this.error=t,this.errorDescription=r}}t.OidcProviderError=r},835:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageUtilityGetResponse=t.StorageUtilityMock=t.mockStorageUtility=t.mockStorage=t.buildAuthenticatedFetch=t.generateDpopKeyPair=t.createDpopHeader=t.OidcProviderError=t.InvalidResponseError=t.NotImplementedError=t.ConfigurationError=t.InMemoryStorage=t.getSessionIdFromOauthState=t.saveSessionInfoToStorage=t.loadOidcContextFromStorage=t.StorageUtility=t.determineSigningAlg=t.handleRegistration=t.USER_SESSION_PREFIX=t.isSupportedTokenType=t.fetchJwks=t.getWebidFromTokenPayload=t.AggregateHandler=void 0,i(r(4672),t);var s=r(5024);Object.defineProperty(t,"AggregateHandler",{enumerable:!0,get:function(){return o(s).default}});var a=r(3528);Object.defineProperty(t,"getWebidFromTokenPayload",{enumerable:!0,get:function(){return a.getWebidFromTokenPayload}}),Object.defineProperty(t,"fetchJwks",{enumerable:!0,get:function(){return a.fetchJwks}});var c=r(1168);Object.defineProperty(t,"isSupportedTokenType",{enumerable:!0,get:function(){return c.isSupportedTokenType}});var u=r(1645);Object.defineProperty(t,"USER_SESSION_PREFIX",{enumerable:!0,get:function(){return u.USER_SESSION_PREFIX}});var l=r(4725);Object.defineProperty(t,"handleRegistration",{enumerable:!0,get:function(){return l.handleRegistration}}),Object.defineProperty(t,"determineSigningAlg",{enumerable:!0,get:function(){return l.determineSigningAlg}});var d=r(4574);Object.defineProperty(t,"StorageUtility",{enumerable:!0,get:function(){return o(d).default}}),Object.defineProperty(t,"loadOidcContextFromStorage",{enumerable:!0,get:function(){return d.loadOidcContextFromStorage}}),Object.defineProperty(t,"saveSessionInfoToStorage",{enumerable:!0,get:function(){return d.saveSessionInfoToStorage}}),Object.defineProperty(t,"getSessionIdFromOauthState",{enumerable:!0,get:function(){return d.getSessionIdFromOauthState}});var h=r(2244);Object.defineProperty(t,"InMemoryStorage",{enumerable:!0,get:function(){return o(h).default}});var p=r(7117);Object.defineProperty(t,"ConfigurationError",{enumerable:!0,get:function(){return o(p).default}});var f=r(7073);Object.defineProperty(t,"NotImplementedError",{enumerable:!0,get:function(){return o(f).default}});var g=r(6583);Object.defineProperty(t,"InvalidResponseError",{enumerable:!0,get:function(){return g.InvalidResponseError}});var y=r(6904);Object.defineProperty(t,"OidcProviderError",{enumerable:!0,get:function(){return y.OidcProviderError}});var m=r(2155);Object.defineProperty(t,"createDpopHeader",{enumerable:!0,get:function(){return m.createDpopHeader}}),Object.defineProperty(t,"generateDpopKeyPair",{enumerable:!0,get:function(){return m.generateDpopKeyPair}});var v=r(8687);Object.defineProperty(t,"buildAuthenticatedFetch",{enumerable:!0,get:function(){return v.buildAuthenticatedFetch}});var w=r(7478);Object.defineProperty(t,"mockStorage",{enumerable:!0,get:function(){return w.mockStorage}}),Object.defineProperty(t,"mockStorageUtility",{enumerable:!0,get:function(){return w.mockStorageUtility}}),Object.defineProperty(t,"StorageUtilityMock",{enumerable:!0,get:function(){return w.StorageUtilityMock}}),Object.defineProperty(t,"StorageUtilityGetResponse",{enumerable:!0,get:function(){return w.StorageUtilityGetResponse}})},4725:(e,t)=>{"use strict";function r(e){try{return new URL(e),!0}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegistration=t.determineSigningAlg=void 0,t.determineSigningAlg=function(e,t){var r;return null!==(r=t.find((t=>e.includes(t))))&&void 0!==r?r:null},t.handleRegistration=async function(e,t,n,i){const o=function(e,t){return void 0===e.clientId||r(e.clientId)?t.scopesSupported.includes("webid")&&void 0!==e.clientId&&r(e.clientId)?"solid-oidc":"dynamic":"static"}(e,t);return"dynamic"===o?i.getClient({sessionId:e.sessionId,clientName:e.clientName,redirectUrl:e.redirectUrl},t):(await n.setForUser(e.sessionId,{clientId:e.clientId}),e.clientSecret&&await n.setForUser(e.sessionId,{clientSecret:e.clientSecret}),e.clientName&&await n.setForUser(e.sessionId,{clientName:e.clientName}),{clientId:e.clientId,clientSecret:e.clientSecret,clientName:e.clientName,clientType:o})}},3528:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWebidFromTokenPayload=t.fetchJwks=void 0;const n=r(4098),i=r(7289);async function o(e,t){const r=await(0,n.fetch)(e);if(200!==r.status)throw new Error(`Could not fetch JWKS for [${t}] at [${e}]: ${r.status} ${r.statusText}`);let i;try{i=(await r.json()).keys[0]}catch(r){throw new Error(`Malformed JWKS for [${t}] at [${e}]: ${r.message}`)}return i}t.fetchJwks=o,t.getWebidFromTokenPayload=async function(e,t,r,n){const s=await o(t,r);let a;try{const{payload:t}=await(0,i.jwtVerify)(e,await(0,i.importJWK)(s),{issuer:r,audience:n});a=t}catch(e){throw new Error(`ID token verification failed: ${e.stack}`)}if("string"==typeof a.webid)return a.webid;if("string"!=typeof a.sub)throw new Error(`The ID token ${JSON.stringify(a)} is invalid: it has no 'webid' claim and no 'sub' claim.`);try{return new URL(a.sub),a.sub}catch(e){throw new Error(`The ID token has no 'webid' claim, and its 'sub' claim of [${a.sub}] is invalid as a URL - error [${e}].`)}}},1168:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupportedTokenType=void 0,t.isSupportedTokenType=function(e){return"string"==typeof e&&["DPoP","Bearer"].includes(e)}},1645:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_SESSION_PREFIX=void 0,t.USER_SESSION_PREFIX="solidClientAuthenticationUser"},2244:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.map={}}async get(e){return this.map[e]||void 0}async set(e,t){this.map[e]=t}async delete(e){delete this.map[e]}}},4574:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.saveSessionInfoToStorage=t.loadOidcContextFromStorage=t.getSessionIdFromOauthState=void 0;const i=r(7289),o=n(r(2029));t.getSessionIdFromOauthState=async function(e,t){return e.getForUser(t,"sessionId")},t.loadOidcContextFromStorage=async function(e,t,r){try{const[n,i,o,s]=await Promise.all([t.getForUser(e,"issuer",{errorIfNull:!0}),t.getForUser(e,"codeVerifier"),t.getForUser(e,"redirectUrl"),t.getForUser(e,"dpop",{errorIfNull:!0})]);return{codeVerifier:i,redirectUrl:o,issuerConfig:await r.fetchConfig(n),dpop:"true"===s}}catch(t){throw new Error(`Failed to retrieve OIDC context from storage associated with session [${e}]: ${t}`)}},t.saveSessionInfoToStorage=async function(e,t,r,n,o,s,a){void 0!==o&&await e.setForUser(t,{refreshToken:o},{secure:s}),void 0!==r&&await e.setForUser(t,{webId:r},{secure:s}),void 0!==n&&await e.setForUser(t,{isLoggedIn:n},{secure:s}),void 0!==a&&await e.setForUser(t,{publicKey:JSON.stringify(a.publicKey),privateKey:JSON.stringify(await(0,i.exportJWK)(a.privateKey))},{secure:s})},t.default=class{constructor(e,t){this.secureStorage=e,this.insecureStorage=t,this.RESOURCE_SERVER_SESSION_INFORMATION_KEY="tmp-resource-server-session-info"}getKey(e){return`solidClientAuthenticationUser:${e}`}async getUserData(e,t){const r=await(t?this.secureStorage:this.insecureStorage).get(this.getKey(e));if(void 0===r)return{};try{return JSON.parse(r)}catch(n){throw new o.default(`Data for user [${e}] in [${t?"secure":"unsecure"}] storage is corrupted - expected valid JSON, but got: ${r}`)}}async setUserData(e,t,r){await(r?this.secureStorage:this.insecureStorage).set(this.getKey(e),JSON.stringify(t))}async get(e,t){const r=await((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).get(e);if(void 0===r&&(null==t?void 0:t.errorIfNull))throw new o.default(`[${e}] is not stored`);return r}async set(e,t,r){return((null==r?void 0:r.secure)?this.secureStorage:this.insecureStorage).set(e,t)}async delete(e,t){return((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(e)}async getForUser(e,t,r){const n=await this.getUserData(e,null==r?void 0:r.secure);let i;if(n&&n[t]||(i=void 0),i=n[t],void 0===i&&(null==r?void 0:r.errorIfNull))throw new o.default(`Field [${t}] for user [${e}] is not stored`);return i||void 0}async setForUser(e,t,r){let n;try{n=await this.getUserData(e,null==r?void 0:r.secure)}catch(e){n={}}await this.setUserData(e,{...n,...t},null==r?void 0:r.secure)}async deleteForUser(e,t,r){const n=await this.getUserData(e,null==r?void 0:r.secure);delete n[t],await this.setUserData(e,n,null==r?void 0:r.secure)}async deleteAllUserData(e,t){await((null==t?void 0:t.secure)?this.secureStorage:this.insecureStorage).delete(this.getKey(e))}async storeResourceServerSessionInfo(e,t,r){var n;const i=JSON.parse(null!==(n=await this.insecureStorage.get(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY))&&void 0!==n?n:"{}");i.webId!==e&&(i.sessions={}),i.webId=e,i.sessions[t]={expiration:r},await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,JSON.stringify(i))}async clearResourceServerSessionInfo(e){var t;const r=JSON.parse(null!==(t=await this.insecureStorage.get(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY))&&void 0!==t?t:"{}");void 0!==r.sessions&&(delete r.sessions[e],0===Object.keys(r.sessions).length?await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,"{}"):await this.insecureStorage.set(this.RESOURCE_SERVER_SESSION_INFORMATION_KEY,JSON.stringify(r)))}}},7478:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockStorageUtility=t.mockStorage=t.StorageUtilityMock=t.StorageUtilityGetResponse=void 0;const n=r(835);t.StorageUtilityGetResponse="getResponse",t.StorageUtilityMock={get:async(e,r)=>t.StorageUtilityGetResponse,set:async(e,t)=>{},delete:async e=>{},getForUser:async(e,r,n)=>t.StorageUtilityGetResponse,setForUser:async(e,t,r)=>{},deleteForUser:async(e,t,r)=>{},deleteAllUserData:async(e,t)=>{},storeResourceServerSessionInfo:async(e,t,r)=>{},clearResourceServerSessionInfo:async e=>{}},t.mockStorage=e=>{const t=e;return{get:async e=>{if(void 0!==t[e])return"string"==typeof t[e]?t[e]:JSON.stringify(t[e])},set:async(e,r)=>{t[e]=r},delete:async e=>{delete t[e]}}},t.mockStorageUtility=(e,r=!1)=>r?new n.StorageUtility((0,t.mockStorage)(e),(0,t.mockStorage)({})):new n.StorageUtility((0,t.mockStorage)({}),(0,t.mockStorage)(e))},5024:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(r(2029));t.default=class{constructor(e){this.handleables=e}async getProperHandler(e){const t=await Promise.all(this.handleables.map((t=>t.canHandle(...e))));for(let e=0;e<t.length;e+=1)if(t[e])return this.handleables[e];return null}async canHandle(...e){return null!==await this.getProperHandler(e)}async handle(...e){const t=await this.getProperHandler(e);if(t)return t.handle(...e);throw new i.default(`[${this.constructor.name}] cannot find a suitable handler for: ${e.map((e=>{try{return JSON.stringify(e)}catch(t){return e.toString()}})).join(", ")}`)}}},8825:(e,t,r)=>{const n=r(8295);e.exports=n},2225:e=>{class t{constructor(e){this.value=e||"b"+ ++t.nextId}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}t.prototype.termType="BlankNode",t.nextId=0,e.exports=t},8295:(e,t,r)=>{const n=r(2225),i=r(5805),o=r(2542),s=r(1694),a=r(1358),c=r(8790),u=r(5895),l={namedNode:function(e){return new a(e)},blankNode:function(e){return new n(e)},literal:function(e,t){return"string"==typeof t?-1===t.indexOf(":")?new s(e,t):new s(e,null,l.namedNode(t)):new s(e,null,t)},variable:function(e){return new u(e)},defaultGraph:function(){return l.defaultGraphInstance},triple:function(e,t,r){return l.quad(e,t,r)},quad:function(e,t,r,n){return new c(e,t,r,n||l.defaultGraphInstance)},fromTerm:function(e){return o.call(l,e)},fromQuad:function(e){return o.call(l,e)},defaultGraphInstance:new i};e.exports=l},5805:e=>{class t{equals(e){return!!e&&e.termType===this.termType}}t.prototype.termType="DefaultGraph",t.prototype.value="",e.exports=t},1694:(e,t,r)=>{const n=r(1358);class i{constructor(e,t,r){this.value=e,this.datatype=i.stringDatatype,this.language="",t?(this.language=t,this.datatype=i.langStringDatatype):r&&(this.datatype=r)}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)}}i.prototype.termType="Literal",i.langStringDatatype=new n("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.stringDatatype=new n("http://www.w3.org/2001/XMLSchema#string"),e.exports=i},1358:e=>{class t{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}t.prototype.termType="NamedNode",e.exports=t},8790:(e,t,r)=>{const n=r(5805);class i{constructor(e,t,r,i){this.subject=e,this.predicate=t,this.object=r,this.graph=i||new n}equals(e){return!!e&&("Quad"===e.termType||!e.termType)&&e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)}}i.prototype.termType="Quad",i.prototype.value="",e.exports=i},5895:e=>{class t{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}t.prototype.termType="Variable",e.exports=t},2542:e=>{e.exports=function(e){if(!e)return null;if("BlankNode"===e.termType)return this.blankNode(e.value);if("DefaultGraph"===e.termType)return this.defaultGraph();if("Literal"===e.termType)return this.literal(e.value,e.language||this.namedNode(e.datatype.value));if("NamedNode"===e.termType)return this.namedNode(e.value);if("Quad"===e.termType){const t=this.fromTerm(e.subject),r=this.fromTerm(e.predicate),n=this.fromTerm(e.object),i=this.fromTerm(e.graph);return this.quad(t,r,n,i)}if("Variable"===e.termType)return this.variable(e.value);throw new Error(`unknown termType ${e.termType}`)}},1963:e=>{function t(e){return"string"==typeof e||e instanceof String}function r(e){if("string"==typeof e)return e;if(!e)return"";if(void 0!==e.id&&"Quad"!==e.termType)return e.id;let t,n,o,s;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return e.language?`"${e.value}"@${e.language}`:`"${e.value}"${e.datatype&&"http://www.w3.org/2001/XMLSchema#string"!==e.datatype.value?`^^${e.datatype.value}`:""}`;case"Quad":return t=i(r(e.subject)),n=i(r(e.predicate)),o=i(r(e.object)),s="DefaultGraph"===e.graph.termType?"":` ${r(e.graph)}`,`<<${t} ${n} ${o}${s}>>`;default:throw new Error(`Unexpected termType: ${e.termType}`)}}const n=/^"(.*".*)(?="[^"]*$)/;function i(e){return e.replace(n,((e,t)=>`"${t.replace(/"/g,'""')}`))}class o{constructor(e){if(this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._quads=new Map,e)for(const t of e)this.add(t)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let r,n;for(const i in t)for(const o in r=t[i].subjects)for(const t in n=r[o])e+=Object.keys(n[t]).length;return this._size=e,this._size}add(e){let t=r(e.subject),n=r(e.predicate),i=r(e.object);const o=r(e.graph);let s=this._graphs[o];s||(s=this._graphs[o]={subjects:{},predicates:{},objects:{}},Object.freeze(s));const a=this._ids,c=this._entities;return t=a[t]||(a[c[++this._id]=t]=this._id),n=a[n]||(a[c[++this._id]=n]=this._id),i=a[i]||(a[c[++this._id]=i]=this._id),this._addToIndex(s.subjects,t,n,i),this._addToIndex(s.predicates,n,i,t),this._addToIndex(s.objects,i,t,n),this._setQuad(t,n,i,o,e),this._size=null,this}delete(e){let t=r(e.subject),n=r(e.predicate),i=r(e.object);const o=r(e.graph),s=this._ids,a=this._graphs;let c,u,l;if(!((t=s[t])&&(n=s[n])&&(i=s[i])&&(c=a[o])&&(u=c.subjects[t])&&(l=u[n])&&i in l))return this;for(t in this._removeFromIndex(c.subjects,t,n,i),this._removeFromIndex(c.predicates,n,i,t),this._removeFromIndex(c.objects,i,t,n),null!==this._size&&this._size--,this._deleteQuad(t,n,i,o),c.subjects)return this;return delete a[o],this}has(e){const n=r(e.subject),i=r(e.predicate),o=r(e.object),s=r(e.graph),a=this._graphs[s];if(!a)return!1;const c=this._ids;let u,l,d;return!(t(n)&&!(u=c[n])||t(i)&&!(l=c[i])||t(o)&&!(d=c[o]))&&1===this._countInIndex(a.objects,d,u,l)}match(e,t,r,n){return this._createDataset(this._match(e,t,r,n))}[Symbol.iterator](){return this._match()[Symbol.iterator]()}_addToIndex(e,t,r,n){const i=e[t]||(e[t]={}),o=i[r]||(i[r]={}),s=n in o;return s||(o[n]=null),!s}_removeFromIndex(e,t,r,n){const i=e[t],o=i[r];delete o[n];for(const e in o)return;delete i[r];for(const e in i)return;delete e[t]}_findInIndex(e,t,r,n,i,o,s,a,c,u){let l,d,h;t&&((l=e,e={})[t]=l[t]);for(const t in e)if(d=e[t],d){r&&((l=d,d={})[r]=l[r]);for(const e in d)if(h=d[e],h){const r=n?n in h?[n]:[]:Object.keys(h);for(let n=0;n<r.length;n++){const l={[i]:t,[o]:e,[s]:r[n]},d=this._getQuad(l.subject,l.predicate,l.object,a);if(u)u.push(d);else if(c(d))return!0}}}return u}_countInIndex(e,t,r,n){let i,o,s,a=0;t&&((i=e,e={})[t]=i[t]);for(const t in e)if(o=e[t],o){r&&((i=o,o={})[r]=i[r]);for(const e in o)s=o[e],s&&(n?n in s&&a++:a+=Object.keys(s).length)}return a}_getGraphs(e){return t(e)?{[e]:this._graphs[e]}:this._graphs}_match(e,n,i,o){e=e&&r(e),n=n&&r(n),i=i&&r(i),o=o&&r(o);const s=[],a=this._getGraphs(o),c=this._ids;let u,l,d,h;if(t(e)&&!(l=c[e])||t(n)&&!(d=c[n])||t(i)&&!(h=c[i]))return s;for(const e in a)u=a[e],u&&(l?h?this._findInIndex(u.objects,h,l,d,"object","subject","predicate",e,null,s):this._findInIndex(u.subjects,l,d,null,"subject","predicate","object",e,null,s):d?this._findInIndex(u.predicates,d,h,null,"predicate","object","subject",e,null,s):h?this._findInIndex(u.objects,h,null,null,"object","subject","predicate",e,null,s):this._findInIndex(u.subjects,null,null,null,"subject","predicate","object",e,null,s));return s}_getQuad(e,t,r,n){return this._quads.get(this._toId(e,t,r,n))}_setQuad(e,t,r,n,i){this._quads.set(this._toId(e,t,r,n),i)}_deleteQuad(e,t,r,n){this._quads.delete(this._toId(e,t,r,n))}_createDataset(e){return new this.constructor(e)}_toId(e,t,r,n){return`${e}:${t}:${r}:${n}`}}e.exports=o},6521:(e,t,r)=>{const n=r(8825),i=r(1963);e.exports=Object.assign({dataset:function(e){return new i(e)}},n)},5456:e=>{"use strict";e.exports=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce(((t,r,n)=>t+(0===n?"":",")+e(void 0===r||"symbol"==typeof r?null:r)),"")+"]":"{"+Object.keys(t).sort().reduce(((r,n,i)=>void 0===t[n]||"symbol"==typeof t[n]?r:r+(0===r.length?"":",")+e(n)+":"+e(t[n])),"")+"}"}},4098:function(e,t){var r="undefined"!=typeof self?self:this,n=function(){function e(){this.fetch=!1,this.DOMException=r.DOMException}return e.prototype=r,new e}();!function(e){!function(t){var r="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function g(e){var t=new FileReader,r=f(t);return t.readAsArrayBuffer(e),r}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&i&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,r,n=p(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=f(t=new FileReader),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=u(e),t=l(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[u(e)]},h.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},h.prototype.set=function(e,t){this.map[u(e)]=l(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),d(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),d(e)},n&&(h.prototype[Symbol.iterator]=h.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(e,t){var r,n,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(n=(r=t.method||this.method||"GET").toUpperCase(),v.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function _(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},m.call(w.prototype),m.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];_.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function E(e,r){return new Promise((function(n,o){var s=new w(e,r);if(s.signal&&s.signal.aborted)return o(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,r={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new _(i,r))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}E.polyfill=!0,e.fetch||(e.fetch=E,e.Headers=h,e.Request=w,e.Response=_),t.Headers=h,t.Request=w,t.Response=_,t.fetch=E,Object.defineProperty(t,"__esModule",{value:!0})}({})}(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(t=i.fetch).default=i.fetch,t.fetch=i.fetch,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,e.exports=t},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,o,s,u;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=c(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,u=l,console&&console.warn&&console.warn(u)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var u=c.length,l=f(c,u);for(r=0;r<u;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},2475:e=>{"use strict";var t=/^utf-?8|ascii|utf-?16-?le|ucs-?2|base-?64|latin-?1$/i,r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,n=/\s|\uFEFF|\xA0/,i=/\r?\n[\x20\x09]+/g,o=/[;,"]/,s=/[;,"]|\s/,a=/^[!#$%&'*+\-\.^_`|~\da-zA-Z]+$/;function c(e){return e.replace(r,"")}function u(e){return n.test(e)}function l(e,t){for(;u(e[t]);)t++;return t}function d(e){return s.test(e)||!a.test(e)}class h{constructor(e){this.refs=[],e&&this.parse(e)}rel(e){for(var t=[],r=e.toLowerCase(),n=0;n<this.refs.length;n++)this.refs[n].rel.toLowerCase()===r&&t.push(this.refs[n]);return t}get(e,t){e=e.toLowerCase();for(var r=[],n=0;n<this.refs.length;n++)this.refs[n][e]===t&&r.push(this.refs[n]);return r}set(e){return this.refs.push(e),this}has(e,t){e=e.toLowerCase();for(var r=0;r<this.refs.length;r++)if(this.refs[r][e]===t)return!0;return!1}parse(e,t){for(var r=1,n=(e=c(e=(t=t||0)?e.slice(t):e).replace(i,"")).length,s=(t=0,null);t<n;)if(1===r){if(u(e[t])){t++;continue}if("<"!==e[t])throw new Error('Unexpected character "'+e[t]+'" at offset '+t);if(null!=s&&(null!=s.rel?this.refs.push(...h.expandRelations(s)):this.refs.push(s)),-1===(p=e.indexOf(">",t)))throw new Error("Expected end of URI delimiter at offset "+t);s={uri:e.slice(t+1,p)},t=p,r=2,t++}else if(2===r){if(u(e[t])){t++;continue}if(";"===e[t])r=4,t++;else{if(","!==e[t])throw new Error('Unexpected character "'+e[t]+'" at offset '+t);r=1,t++}}else{if(4!==r)throw new Error('Unknown parser state "'+r+'"');if(";"===e[t]||u(e[t])){t++;continue}if(-1===(p=e.indexOf("=",t)))throw new Error("Expected attribute delimiter at offset "+t);var a=c(e.slice(t,p)).toLowerCase(),d="";if('"'===e[t=l(e,t=p+1)])for(t++;t<n;){if('"'===e[t]){t++;break}"\\"===e[t]&&t++,d+=e[t],t++}else{for(var p=t+1;!o.test(e[p])&&p<n;)p++;d=e.slice(t,p),t=p}switch(s[a]&&h.isSingleOccurenceAttr(a)||("*"===a[a.length-1]?s[a]=h.parseExtendedValue(d):(d="type"===a?d.toLowerCase():d,null!=s[a]?Array.isArray(s[a])?s[a].push(d):s[a]=[s[a],d]:s[a]=d)),e[t]){case",":r=1;break;case";":r=4}t++}return null!=s&&(null!=s.rel?this.refs.push(...h.expandRelations(s)):this.refs.push(s)),s=null,this}toString(){for(var e=[],t="",r=null,n=0;n<this.refs.length;n++)r=this.refs[n],t=Object.keys(this.refs[n]).reduce((function(e,t){return"uri"===t?e:e+"; "+h.formatAttribute(t,r[t])}),"<"+r.uri+">"),e.push(t);return e.join(", ")}}h.isCompatibleEncoding=function(e){return t.test(e)},h.parse=function(e,t){return(new h).parse(e,t)},h.isSingleOccurenceAttr=function(e){return"rel"===e||"type"===e||"media"===e||"title"===e||"title*"===e},h.isTokenAttr=function(e){return"rel"===e||"type"===e||"anchor"===e},h.escapeQuotes=function(e){return e.replace(/"/g,'\\"')},h.expandRelations=function(e){return e.rel.split(" ").map((function(t){var r=Object.assign({},e);return r.rel=t,r}))},h.parseExtendedValue=function(e){var t=/([^']+)?(?:'([^']+)')?(.+)/.exec(e);return{language:t[2].toLowerCase(),encoding:h.isCompatibleEncoding(t[1])?null:t[1].toLowerCase(),value:h.isCompatibleEncoding(t[1])?decodeURIComponent(t[3]):t[3]}},h.formatExtendedAttribute=function(e,t){var r=(t.encoding||"utf-8").toUpperCase();return e+"="+r+"'"+(t.language||"en")+"'"+(Buffer.isBuffer(t.value)&&h.isCompatibleEncoding(r)?t.value.toString(r):Buffer.isBuffer(t.value)?t.value.toString("hex").replace(/[0-9a-f]{2}/gi,"%$1"):encodeURIComponent(t.value))},h.formatAttribute=function(e,t){return Array.isArray(t)?t.map((t=>h.formatAttribute(e,t))).join("; "):"*"===e[e.length-1]||"string"!=typeof t?h.formatExtendedAttribute(e,t):(h.isTokenAttr(e)?t=d(t)?'"'+h.escapeQuotes(t)+'"':h.escapeQuotes(t):d(t)&&(t='"'+(t=(t=encodeURIComponent(t)).replace(/%20/g," ").replace(/%2C/g,",").replace(/%3B/g,";"))+'"'),e+"="+t)},e.exports=h},8058:(e,t,r)=>{"use strict";const{isArray:n,isObject:i,isString:o}=r(832),{asArray:s}=r(1055),{prependBase:a}=r(2278),c=r(4093),u=r(6767);function l(e){throw new c("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function d({context:e,base:t}){if(!e)return;const r=e["@context"];if(o(r))e["@context"]=a(t,r);else if(n(r))for(let e=0;e<r.length;++e){const n=r[e];o(n)?r[e]=a(t,n):i(n)&&d({context:{"@context":n},base:t})}else if(i(r))for(const e in r)d({context:r[e],base:t})}e.exports=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:t,documentLoader:r,base:a,cycles:c=new Set}){t&&i(t)&&t["@context"]&&(t=t["@context"]),t=s(t);const d=[];for(const s of t){if(o(s)){let t=this._get(s);t||(t=await this._resolveRemoteContext({activeCtx:e,url:s,documentLoader:r,base:a,cycles:c})),n(t)?d.push(...t):d.push(t);continue}if(null===s){d.push(new u({document:null}));continue}i(s)||l(t);const h=JSON.stringify(s);let p=this._get(h);p||(p=new u({document:s}),this._cacheResolvedContext({key:h,resolved:p,tag:"static"})),d.push(p)}return d}_get(e){let t=this.perOpCache.get(e);if(!t){const r=this.sharedCache.get(e);r&&(t=r.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:r}){if(this.perOpCache.set(e,t),void 0!==r){let n=this.sharedCache.get(e);n||(n=new Map,this.sharedCache.set(e,n)),n.set(r,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:r,base:n,cycles:i}){t=a(n,t);const{context:o,remoteDoc:s}=await this._fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:i});d({context:o,base:n=s.documentUrl||t});const c=await this.resolve({activeCtx:e,context:o,documentLoader:r,base:n,cycles:i});return this._cacheResolvedContext({key:t,resolved:c,tag:s.tag}),c}async _fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:s}){if(s.size>10)throw new c("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"loading remote context failed":"context overflow",max:10});if(s.has(t))throw new c("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"recursive context inclusion":"context overflow",url:t});let a,u;s.add(t);try{u=await r(t),a=u.document||null,o(a)&&(a=JSON.parse(a))}catch(e){throw new c("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:t,cause:e})}if(!i(a))throw new c("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:t});return a="@context"in a?{"@context":a["@context"]}:{"@context":{}},u.contextUrl&&(n(a["@context"])||(a["@context"]=[a["@context"]]),a["@context"].push(u.contextUrl)),{context:a,remoteDoc:u}}}},4093:e=>{"use strict";e.exports=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",r={}){super(e),this.name=t,this.message=e,this.details=r}}},731:e=>{"use strict";e.exports=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,r)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},9048:(e,t,r)=>{"use strict";e.exports=r(7055).NQuads},533:e=>{"use strict";e.exports=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}},6767:(e,t,r)=>{"use strict";const n=r(9593);e.exports=class{constructor({document:e}){this.document=e,this.cache=new n({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}}},3251:(e,t,r)=>{"use strict";const n=r(4093),{isArray:i,isObject:o,isString:s,isUndefined:a}=r(832),{isList:c,isValue:u,isGraph:l,isSimpleGraph:d,isSubjectReference:h}=r(8463),{expandIri:p,getContextValue:f,isKeyword:g,process:y,processingMode:m}=r(4131),{removeBase:v,prependBase:w}=r(2278),{addValue:b,asArray:_,compareShortestLeast:S}=r(1055),E={};function x(e,t,r){if("@nest"!==p(e,t,{vocab:!0},r))throw new n("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}e.exports=E,E.compact=async({activeCtx:e,activeProperty:t=null,element:r,options:p={},compactionMap:v=(()=>{})})=>{if(i(r)){let n=[];for(let i=0;i<r.length;++i){let o=await E.compact({activeCtx:e,activeProperty:t,element:r[i],options:p,compactionMap:v});null===o&&(o=await v({unmappedValue:r[i],activeCtx:e,activeProperty:t,parent:r,index:i,options:p}),void 0===o)||n.push(o)}return p.compactArrays&&1===n.length&&0===(f(e,t,"@container")||[]).length&&(n=n[0]),n}const w=f(e,t,"@context");if(a(w)||(e=await y({activeCtx:e,localCtx:w,propagate:!0,overrideProtected:!0,options:p})),o(r)){if(p.link&&"@id"in r&&p.link.hasOwnProperty(r["@id"])){const e=p.link[r["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===r)return e[t].compacted}if(u(r)||h(r)){const n=E.compactValue({activeCtx:e,activeProperty:t,value:r,options:p});return p.link&&h(r)&&(p.link.hasOwnProperty(r["@id"])||(p.link[r["@id"]]=[]),p.link[r["@id"]].push({expanded:r,compacted:n})),n}if(c(r)&&(f(e,t,"@container")||[]).includes("@list"))return E.compact({activeCtx:e,activeProperty:t,element:r["@list"],options:p,compactionMap:v});const w="@reverse"===t,S={},I=e;u(r)||h(r)||(e=e.revertToPreviousContext());const A=f(I,t,"@context");a(A)||(e=await y({activeCtx:e,localCtx:A,propagate:!0,overrideProtected:!0,options:p})),p.link&&"@id"in r&&(p.link.hasOwnProperty(r["@id"])||(p.link[r["@id"]]=[]),p.link[r["@id"]].push({expanded:r,compacted:S}));let k=r["@type"]||[];k.length>1&&(k=Array.from(k).sort());const F=e;for(const t of k){const r=E.compactIri({activeCtx:F,iri:t,relativeTo:{vocab:!0}}),n=f(I,r,"@context");a(n)||(e=await y({activeCtx:e,localCtx:n,options:p,propagate:!1}))}const T=Object.keys(r).sort();for(const a of T){const h=r[a];if("@id"!==a)if("@type"!==a)if("@reverse"!==a)if("@preserve"!==a)if("@index"!==a)if("@graph"!==a&&"@list"!==a&&"@included"!==a&&g(a)){const t=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});b(S,t,h)}else{if(!i(h))throw new n("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===h.length){const t=E.compactIri({activeCtx:e,iri:a,value:h,relativeTo:{vocab:!0},reverse:w}),r=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let n=S;r&&(x(e,r,p),o(S[r])||(S[r]={}),n=S[r]),b(n,t,h,{propertyIsArray:!0})}for(const t of h){const r=E.compactIri({activeCtx:e,iri:a,value:t,relativeTo:{vocab:!0},reverse:w}),n=e.mappings.has(r)?e.mappings.get(r)["@nest"]:null;let h=S;n&&(x(e,n,p),o(S[n])||(S[n]={}),h=S[n]);const g=f(e,r,"@container")||[],y=l(t),m=c(t);let I;m?I=t["@list"]:y&&(I=t["@graph"]);let A=await E.compact({activeCtx:e,activeProperty:r,element:m||y?I:t,options:p,compactionMap:v});if(m){if(i(A)||(A=[A]),g.includes("@list")){b(h,r,A,{valueIsArray:!0,allowDuplicate:!0});continue}A={[E.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:A},"@index"in t&&(A[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"])}if(y)if(g.includes("@graph")&&(g.includes("@id")||g.includes("@index")&&d(t))){let n;h.hasOwnProperty(r)?n=h[r]:h[r]=n={};const i=(g.includes("@id")?t["@id"]:t["@index"])||E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});b(n,i,A,{propertyIsArray:!p.compactArrays||g.includes("@set")})}else g.includes("@graph")&&d(t)?(i(A)&&A.length>1&&(A={"@included":A}),b(h,r,A,{propertyIsArray:!p.compactArrays||g.includes("@set")})):(i(A)&&1===A.length&&p.compactArrays&&(A=A[0]),A={[E.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:A},"@id"in t&&(A[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(A[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),b(h,r,A,{propertyIsArray:!p.compactArrays||g.includes("@set")}));else if(g.includes("@language")||g.includes("@index")||g.includes("@id")||g.includes("@type")){let n,i;if(h.hasOwnProperty(r)?n=h[r]:h[r]=n={},g.includes("@language"))u(A)&&(A=A["@value"]),i=t["@language"];else if(g.includes("@index")){const n=f(e,r,"@index")||"@index",o=E.compactIri({activeCtx:e,iri:n,relativeTo:{vocab:!0}});if("@index"===n)i=t["@index"],delete A[o];else{let e;if([i,...e]=_(A[n]||[]),s(i))switch(e.length){case 0:delete A[n];break;case 1:A[n]=e[0];break;default:A[n]=e}else i=null}}else if(g.includes("@id")){const t=E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});i=A[t],delete A[t]}else if(g.includes("@type")){const n=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let o;switch([i,...o]=_(A[n]||[]),o.length){case 0:delete A[n];break;case 1:A[n]=o[0];break;default:A[n]=o}1===Object.keys(A).length&&"@id"in t&&(A=await E.compact({activeCtx:e,activeProperty:r,element:{"@id":t["@id"]},options:p,compactionMap:v}))}i||(i=E.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),b(n,i,A,{propertyIsArray:g.includes("@set")})}else{const e=!p.compactArrays||g.includes("@set")||g.includes("@list")||i(A)&&0===A.length||"@list"===a||"@graph"===a;b(h,r,A,{propertyIsArray:e})}}}else{if((f(e,t,"@container")||[]).includes("@index"))continue;const r=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});b(S,r,h)}else{const r=await E.compact({activeCtx:e,activeProperty:t,element:h,options:p,compactionMap:v});i(r)&&0===r.length||b(S,a,r)}else{const t=await E.compact({activeCtx:e,activeProperty:"@reverse",element:h,options:p,compactionMap:v});for(const r in t)if(e.mappings.has(r)&&e.mappings.get(r).reverse){const n=t[r],i=(f(e,r,"@container")||[]).includes("@set")||!p.compactArrays;b(S,r,n,{propertyIsArray:i}),delete t[r]}if(Object.keys(t).length>0){const r=E.compactIri({activeCtx:e,iri:a,relativeTo:{vocab:!0}});b(S,r,t)}}else{let t=_(h).map((e=>E.compactIri({activeCtx:I,iri:e,relativeTo:{vocab:!0}})));1===t.length&&(t=t[0]);const r=E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),n=(f(e,r,"@container")||[]).includes("@set")&&m(e,1.1)||i(t)&&0===h.length;b(S,r,t,{propertyIsArray:n})}else{let t=_(h).map((t=>E.compactIri({activeCtx:e,iri:t,relativeTo:{vocab:!1},base:p.base})));1===t.length&&(t=t[0]),S[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t}}return S}return r},E.compactIri=({activeCtx:e,iri:t,value:r=null,relativeTo:i={vocab:!1},reverse:s=!1,base:a=null})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const d=e.getInverse();if(g(t)&&t in d&&"@none"in d[t]&&"@type"in d[t]["@none"]&&"@none"in d[t]["@none"]["@type"])return d[t]["@none"]["@type"]["@none"];if(i.vocab&&t in d){const n=e["@language"]||"@none",i=[];o(r)&&"@index"in r&&!("@graph"in r)&&i.push("@index","@index@set"),o(r)&&"@preserve"in r&&(r=r["@preserve"][0]),l(r)?("@index"in r&&i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&i.push("@graph@id","@graph@id@set"),i.push("@graph","@graph@set","@set"),"@index"in r||i.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||i.push("@graph@id","@graph@id@set")):o(r)&&!u(r)&&i.push("@id","@id@set","@type","@set@type");let a="@language",d="@null";if(s)a="@type",d="@reverse",i.push("@set");else if(c(r)){"@index"in r||i.push("@list");const e=r["@list"];if(0===e.length)a="@any",d="@none";else{let t=0===e.length?n:null,r=null;for(let n=0;n<e.length;++n){const i=e[n];let o="@none",s="@none";if(u(i)?"@direction"in i?o=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`:"@language"in i?o=i["@language"].toLowerCase():"@type"in i?s=i["@type"]:o="@null":s="@id",null===t?t=o:o!==t&&u(i)&&(t="@none"),null===r?r=s:s!==r&&(r="@none"),"@none"===t&&"@none"===r)break}t=t||"@none",r=r||"@none","@none"!==r?(a="@type",d=r):d=t}}else{if(u(r))if("@language"in r&&!("@index"in r)){i.push("@language","@language@set"),d=r["@language"];const e=r["@direction"];e&&(d=`${d}_${e}`)}else"@direction"in r&&!("@index"in r)?d=`_${r["@direction"]}`:"@type"in r&&(a="@type",d=r["@type"]);else a="@type",d="@id";i.push("@set")}i.push("@none"),o(r)&&!("@index"in r)&&i.push("@index","@index@set"),u(r)&&1===Object.keys(r).length&&i.push("@language","@language@set");const h=function(e,t,r,n,i,s){null===s&&(s="@null");const a=[];if(("@id"===s||"@reverse"===s)&&o(r)&&"@id"in r){"@reverse"===s&&a.push("@reverse");const t=E.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===r["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(s);const e=a.find((e=>e.includes("_")));e&&a.push(e.replace(/^[^_]+_/,"_"))}a.push("@none");const c=e.inverse[t];for(const e of n){if(!(e in c))continue;const t=c[e][i];for(const e of a)if(e in t)return t[e]}return null}(e,t,r,i,a,d);if(null!==h)return h}if(i.vocab&&"@vocab"in e){const r=e["@vocab"];if(0===t.indexOf(r)&&t!==r){const n=t.substr(r.length);if(!e.mappings.has(n))return n}}let h=null;const p=[];let f=e.fastCurieMap;const y=t.length-1;for(let e=0;e<y&&t[e]in f;++e)f=f[t[e]],""in f&&p.push(f[""][0]);for(let n=p.length-1;n>=0;--n){const i=p[n],o=i.terms;for(const n of o){const o=n+":"+t.substr(i.iri.length);e.mappings.get(n)._prefix&&(!e.mappings.has(o)||null===r&&e.mappings.get(o)["@id"]===t)&&(null===h||S(o,h)<0)&&(h=o)}}if(null!==h)return h;for(const[r,i]of e.mappings)if(i&&i._prefix&&t.startsWith(r+":"))throw new n(`Absolute IRI "${t}" confused with prefix "${r}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});return i.vocab?t:"@base"in e?e["@base"]?v(w(a,e["@base"]),t):t:v(a,t)},E.compactValue=({activeCtx:e,activeProperty:t,value:r,options:n})=>{if(u(r)){const n=f(e,t,"@type"),i=f(e,t,"@language"),o=f(e,t,"@direction"),a=f(e,t,"@container")||[],c="@index"in r&&!a.includes("@index");if(!c&&"@none"!==n){if(r["@type"]===n)return r["@value"];if("@language"in r&&r["@language"]===i&&"@direction"in r&&r["@direction"]===o)return r["@value"];if("@language"in r&&r["@language"]===i)return r["@value"];if("@direction"in r&&r["@direction"]===o)return r["@value"]}const u=Object.keys(r).length,l=1===u||2===u&&"@index"in r&&!c,d="@language"in e,h=s(r["@value"]),p=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(l&&"@none"!==n&&(!d||!h||p))return r["@value"];const g={};return c&&(g[E.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?g[E.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=E.compactIri({activeCtx:e,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(g[E.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),"@direction"in r&&(g[E.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=r["@direction"]),g[E.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],g}const i=p(e,t,{vocab:!0},n),o=f(e,t,"@type"),a=E.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:"@vocab"===o},base:n.base});return"@id"===o||"@vocab"===o||"@graph"===i?a:{[E.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:a}}},3770:e=>{"use strict";const t="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r="http://www.w3.org/2001/XMLSchema#";e.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:t,RDF_LIST:t+"List",RDF_FIRST:t+"first",RDF_REST:t+"rest",RDF_NIL:t+"nil",RDF_TYPE:t+"type",RDF_PLAIN_LITERAL:t+"PlainLiteral",RDF_XML_LITERAL:t+"XMLLiteral",RDF_JSON_LITERAL:t+"JSON",RDF_OBJECT:t+"object",RDF_LANGSTRING:t+"langString",XSD:r,XSD_BOOLEAN:r+"boolean",XSD_DOUBLE:r+"double",XSD_INTEGER:r+"integer",XSD_STRING:r+"string"}},4131:(e,t,r)=>{"use strict";const n=r(1055),i=r(4093),{isArray:o,isObject:s,isString:a,isUndefined:c}=r(832),{isAbsolute:u,isRelative:l,prependBase:d}=r(2278),{asArray:h,compareShortestLeast:p}=r(1055),f=new Map,g=/^@[a-zA-Z]+$/,y={};function m(e,t,r,n,i,o){if(null===t||!a(t)||y.isKeyword(t))return t;if(t.match(g))return null;if(n&&n.hasOwnProperty(t)&&!0!==i.get(t)&&y.createTermDefinition({activeCtx:e,localCtx:n,term:t,defined:i,options:o}),(r=r||{}).vocab){const r=e.mappings.get(t);if(null===r)return null;if(s(r)&&"@id"in r)return r["@id"]}const c=t.indexOf(":");if(c>0){const r=t.substr(0,c),s=t.substr(c+1);if("_"===r||0===s.indexOf("//"))return t;n&&n.hasOwnProperty(r)&&y.createTermDefinition({activeCtx:e,localCtx:n,term:r,defined:i,options:o});const a=e.mappings.get(r);if(a&&a._prefix)return a["@id"]+s;if(u(t))return t}if(r.vocab&&"@vocab"in e)return e["@vocab"]+t;if(r.base&&"@base"in e){if(e["@base"])return d(d(o.base,e["@base"]),t)}else if(r.base)return d(o.base,t);return t}function v(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const r=Array.isArray(e);if(r!==Array.isArray(t))return!1;if(r){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!v(e[r],t[r]))return!1;return!0}const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r in e){let n=e[r],i=t[r];if("@container"===r&&Array.isArray(n)&&Array.isArray(i)&&(n=n.slice().sort(),i=i.slice().sort()),!v(n,i))return!1}return!0}e.exports=y,y.process=async({activeCtx:e,localCtx:t,options:r,propagate:c=!0,overrideProtected:p=!1,cycles:f=new Set})=>{if(s(t)&&"@context"in t&&o(t["@context"])&&(t=t["@context"]),0===h(t).length)return e;const g=await r.contextResolver.resolve({activeCtx:e,context:t,documentLoader:r.documentLoader,base:r.base});s(g[0].document)&&"boolean"==typeof g[0].document["@propagate"]&&(c=g[0].document["@propagate"]);let v=e;c||v.previousContext||(v=v.clone(),v.previousContext=e);for(const o of g){let{document:c}=o;if(e=v,null===c){if(!p&&0!==Object.keys(e.protected).length){const s=r&&r.protectedMode||"error";if("error"===s)throw new i("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===s){console.warn("WARNING: invalid context nullification");const t=o.getProcessed(e);if(t){v=e=t;continue}const i=e;v=e=y.getInitialContext(r).clone();for(const[t,r]of Object.entries(i.protected))r&&(e.mappings[t]=n.clone(i.mappings[t]));e.protected=n.clone(i.protected),o.setProcessed(i,v);continue}throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,protectedMode:s})}v=e=y.getInitialContext(r).clone();continue}const h=o.getProcessed(e);if(h){v=e=h;continue}if(s(c)&&"@context"in c&&(c=c["@context"]),!s(c))throw new i("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:c});v=v.clone();const g=new Map;if("@version"in c){if(1.1!==c["@version"])throw new i("Unsupported JSON-LD version: "+c["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:c});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new i("@version: "+c["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:c});v.processingMode="json-ld-1.1",v["@version"]=c["@version"],g.set("@version",!0)}if(v.processingMode=v.processingMode||e.processingMode,"@base"in c){let e=c["@base"];if(null===e||u(e));else{if(!l(e))throw new i('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:c});e=d(v["@base"],e)}v["@base"]=e,g.set("@base",!0)}if("@vocab"in c){const e=c["@vocab"];if(null===e)delete v["@vocab"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:c});if(!u(e)&&y.processingMode(v,1))throw new i('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:c});v["@vocab"]=m(v,e,{vocab:!0,base:!0},void 0,void 0,r)}g.set("@vocab",!0)}if("@language"in c){const e=c["@language"];if(null===e)delete v["@language"];else{if(!a(e))throw new i('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:c});v["@language"]=e.toLowerCase()}g.set("@language",!0)}if("@direction"in c){const t=c["@direction"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:c});if(null===t)delete v["@direction"];else{if("ltr"!==t&&"rtl"!==t)throw new i('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:c});v["@direction"]=t}g.set("@direction",!0)}if("@propagate"in c){const r=c["@propagate"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:c});if("boolean"!=typeof r)throw new i("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});g.set("@propagate",!0)}if("@import"in c){const n=c["@import"];if("json-ld-1.0"===e.processingMode)throw new i("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:c});if(!a(n))throw new i("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const o=await r.contextResolver.resolve({activeCtx:e,context:n,documentLoader:r.documentLoader,base:r.base});if(1!==o.length)throw new i("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const s=o[0].getProcessed(e);if(s)c=s;else{const r=o[0].document;if("@import"in r)throw new i("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const e in r)c.hasOwnProperty(e)||(c[e]=r[e]);o[0].setProcessed(e,c)}g.set("@import",!0)}g.set("@protected",c["@protected"]||!1);for(const e in c)if(y.createTermDefinition({activeCtx:v,localCtx:c,term:e,defined:g,options:r,overrideProtected:p}),s(c[e])&&"@context"in c[e]){const t=c[e]["@context"];let n=!0;if(a(t)){const e=d(r.base,t);f.has(e)?n=!1:f.add(e)}if(n)try{await y.process({activeCtx:v.clone(),localCtx:c[e]["@context"],overrideProtected:!0,options:r,cycles:f})}catch(t){throw new i("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:c[e]["@context"],term:e})}}o.setProcessed(e,v)}return v},y.createTermDefinition=({activeCtx:e,localCtx:t,term:r,defined:n,options:c,overrideProtected:l=!1})=>{if(n.has(r)){if(n.get(r))return;throw new i("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}let d;if(n.set(r,!1),t.hasOwnProperty(r)&&(d=t[r]),"@type"===r&&s(d)&&"@set"===(d["@container"]||"@set")&&y.processingMode(e,1.1)){const e=["@container","@id","@protected"],n=Object.keys(d);if(0===n.length||n.some((t=>!e.includes(t))))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r})}else{if(y.isKeyword(r))throw new i("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(r.match(g))return void console.warn('WARNING: terms beginning with "@" are reserved for future use and ignored',{term:r});if(""===r)throw new i("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const h=e.mappings.get(r);e.mappings.has(r)&&e.mappings.delete(r);let p=!1;if((a(d)||null===d)&&(p=!0,d={"@id":d}),!s(d))throw new i("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const f={};e.mappings.set(r,f),f.reverse=!1;const w=["@container","@id","@language","@reverse","@type"];y.processingMode(e,1.1)&&w.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in d)if(!w.includes(e))throw new i("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const b=r.indexOf(":");if(f._termHasColon=b>0,"@reverse"in d){if("@id"in d)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in d)throw new i("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const o=d["@reverse"];if(!a(o))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!y.isKeyword(o)&&o.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{reverse:o}),void(h?e.mappings.set(r,h):e.mappings.delete(r));const s=m(e,o,{vocab:!0,base:!1},t,n,c);if(!u(s))throw new i("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});f["@id"]=s,f.reverse=!0}else if("@id"in d){let o=d["@id"];if(o&&!a(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(null===o)f["@id"]=null;else{if(!y.isKeyword(o)&&o.match(g))return console.warn('WARNING: values beginning with "@" are reserved for future use and ignored',{id:o}),void(h?e.mappings.set(r,h):e.mappings.delete(r));if(o!==r){if(o=m(e,o,{vocab:!0,base:!1},t,n,c),!u(o)&&!y.isKeyword(o))throw new i("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(r.match(/(?::[^:])|\//)&&m(e,r,{vocab:!0,base:!1},t,new Map(n).set(r,!0),c)!==o)throw new i("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});f["@id"]=o,f._prefix=p&&!f._termHasColon&&o.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in f))if(f._termHasColon){const i=r.substr(0,b);if(t.hasOwnProperty(i)&&y.createTermDefinition({activeCtx:e,localCtx:t,term:i,defined:n,options:c}),e.mappings.has(i)){const t=r.substr(b+1);f["@id"]=e.mappings.get(i)["@id"]+t}else f["@id"]=r}else if("@type"===r)f["@id"]=r;else{if(!("@vocab"in e))throw new i("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});f["@id"]=e["@vocab"]+r}if((!0===d["@protected"]||!0===n.get("@protected")&&!1!==d["@protected"])&&(e.protected[r]=!0,f.protected=!0),n.set(r,!0),"@type"in d){let r=d["@type"];if(!a(r))throw new i("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@json"===r||"@none"===r){if(y.processingMode(e,1))throw new i(`Invalid JSON-LD syntax; an @context @type value must not be "${r}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if("@id"!==r&&"@vocab"!==r){if(r=m(e,r,{vocab:!0,base:!1},t,n,c),!u(r))throw new i("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new i("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}f["@type"]=r}if("@container"in d){const r=a(d["@container"])?[d["@container"]]:d["@container"]||[],n=["@list","@set","@index","@language"];let s=!0;const c=r.includes("@set");if(y.processingMode(e,1.1)){if(n.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new i("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(r.includes("@graph")){if(r.some((e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e)))throw new i("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else s&=r.length<=(c?2:1);if(r.includes("@type")&&(f["@type"]=f["@type"]||"@id",!["@id","@vocab"].includes(f["@type"])))throw new i("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else s&=!o(d["@container"]),s&=r.length<=1;if(s&=r.every((e=>n.includes(e))),s&=!(c&&r.includes("@list")),!s)throw new i("Invalid JSON-LD syntax; @context @container value must be one of the following: "+n.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(f.reverse&&!r.every((e=>["@index","@set"].includes(e))))throw new i("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});f["@container"]=r}if("@index"in d){if(!("@container"in d)||!f["@container"].includes("@index"))throw new i(`Invalid JSON-LD syntax; @index without @index in @container: "${d["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!a(d["@index"])||0===d["@index"].indexOf("@"))throw new i(`Invalid JSON-LD syntax; @index must expand to an IRI: "${d["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});f["@index"]=d["@index"]}if("@context"in d&&(f["@context"]=d["@context"]),"@language"in d&&!("@type"in d)){let e=d["@language"];if(null!==e&&!a(e))throw new i("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),f["@language"]=e}if("@prefix"in d){if(r.match(/:|\//))throw new i("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(y.isKeyword(f["@id"]))throw new i("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof d["@prefix"])throw new i("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});f._prefix=!0===d["@prefix"]}if("@direction"in d){const e=d["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new i('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});f["@direction"]=e}if("@nest"in d){const e=d["@nest"];if(!a(e)||"@nest"!==e&&0===e.indexOf("@"))throw new i("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});f["@nest"]=e}const _=f["@id"];if("@context"===_||"@preserve"===_)throw new i("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(h&&h.protected&&!l&&(e.protected[r]=!0,f.protected=!0,!v(h,f))){const e=c&&c.protectedMode||"error";if("error"===e)throw new i(`Invalid JSON-LD syntax; tried to redefine "${r}" which is a protected term.`,"jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:r});if("warn"===e)return void console.warn("WARNING: protected term redefinition",{term:r});throw new i("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:r,protectedMode:e})}},y.expandIri=(e,t,r,n)=>m(e,t,r,void 0,void 0,n),y.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),r=f.get(t);if(r)return r;const i={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},r=e.fastCurieMap={},n={},i=(e["@language"]||"@none").toLowerCase(),a=e["@direction"],c=e.mappings,u=[...c.keys()].sort(p);for(const e of u){const o=c.get(e);if(null===o)continue;let u=o["@container"]||"@none";if(u=[].concat(u).sort().join(""),null===o["@id"])continue;const l=h(o["@id"]);for(const c of l){let l=t[c];const d=y.isKeyword(c);if(l)d||o._termHasColon||n[c].push(e);else if(t[c]=l={},!d&&!o._termHasColon){n[c]=[e];const t={iri:c,terms:n[c]};c[0]in r?r[c[0]].push(t):r[c[0]]=[t]}if(l[u]||(l[u]={"@language":{},"@type":{},"@any":{}}),l=l[u],s(e,l["@any"],"@none"),o.reverse)s(e,l["@type"],"@reverse");else if("@none"===o["@type"])s(e,l["@any"],"@none"),s(e,l["@language"],"@none"),s(e,l["@type"],"@none");else if("@type"in o)s(e,l["@type"],o["@type"]);else if("@language"in o&&"@direction"in o){const t=o["@language"],r=o["@direction"];s(e,l["@language"],t&&r?`${t}_${r}`.toLowerCase():t?t.toLowerCase():r?`_${r}`:"@null")}else"@language"in o?s(e,l["@language"],(o["@language"]||"@null").toLowerCase()):"@direction"in o?o["@direction"]?s(e,l["@language"],`_${o["@direction"]}`):s(e,l["@language"],"@none"):a?(s(e,l["@language"],`_${a}`),s(e,l["@language"],"@none"),s(e,l["@type"],"@none")):(s(e,l["@language"],i),s(e,l["@language"],"@none"),s(e,l["@type"],"@none"))}}for(const e in r)o(r,e,1);return t},clone:function(){const e={};return e.mappings=n.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=n.clone(this.protected),this.previousContext&&(e.previousContext=this.previousContext.clone()),e.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(e["@base"]=this["@base"]),"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===f.size&&f.clear(),f.set(t,i),i;function o(e,t,r){const n=e[t],i=e[t]={};let s,a;for(const e of n)s=e.iri,a=r>=s.length?"":s[r],a in i?i[a].push(e):i[a]=[e];for(const e in i)""!==e&&o(i,e,r+1)}function s(e,t,r){t.hasOwnProperty(r)||(t[r]=e)}},y.getContextValue=(e,t,r)=>{if(null===t){if("@context"===r)return;return null}if(e.mappings.has(t)){const n=e.mappings.get(t);if(c(r))return n;if(n.hasOwnProperty(r))return n[r]}return"@language"===r&&r in e||"@direction"===r&&r in e?e[r]:"@context"!==r?null:void 0},y.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,y.isKeyword=e=>{if(!a(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},8831:(e,t,r)=>{"use strict";const{parseLinkHeader:n,buildHeaders:i}=r(1055),{LINK_HEADER_CONTEXT:o}=r(3770),s=r(4093),a=r(533),{prependBase:c}=r(2278),u=/(^|(\r\n))link:/i;e.exports=({secure:e,headers:t={},xhr:r}={headers:{}})=>(t=i(t),(new a).wrapLoader((async function i(a){if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))throw new s('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(e&&0!==a.indexOf("https"))throw new s('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a});let l;try{l=await function(e,t,r){const n=new(e=e||XMLHttpRequest);return new Promise(((e,i)=>{n.onload=()=>e(n),n.onerror=e=>i(e),n.open("GET",t,!0);for(const e in r)n.setRequestHeader(e,r[e]);n.send()}))}(r,a,t)}catch(e){throw new s("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:e})}if(l.status>=400)throw new s("URL could not be dereferenced: "+l.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:l.status});let d={contextUrl:null,documentUrl:a,document:l.response},h=null;const p=l.getResponseHeader("Content-Type");let f;if(u.test(l.getAllResponseHeaders())&&(f=l.getResponseHeader("Link")),f&&"application/ld+json"!==p){const e=n(f),t=e[o];if(Array.isArray(t))throw new s("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});t&&(d.contextUrl=t.target),h=e.alternate,h&&"application/ld+json"==h.type&&!(p||"").match(/^application\/(\w*\+)?json$/)&&(d=await i(c(a,h.target)))}return d})))},2759:(e,t,r)=>{"use strict";const n=r(4093),{isArray:i,isObject:o,isEmptyObject:s,isString:a,isUndefined:c}=r(832),{isList:u,isValue:l,isGraph:d,isSubject:h}=r(8463),{expandIri:p,getContextValue:f,isKeyword:g,process:y,processingMode:m}=r(4131),{isAbsolute:v}=r(2278),{addValue:w,asArray:b,getValues:_,validateTypeValue:S}=r(1055),E={};e.exports=E;const x=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/;async function I({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:d,expandedParent:_,options:A={},insideList:T,typeKey:R,typeScopedContext:C,expansionMap:P}){const O=Object.keys(d).sort(),j=[];let N;const D=d[R]&&"@json"===p(e,i(d[R])?d[R][0]:d[R],{vocab:!0},A);for(const I of O){let R,O=d[I];if("@context"===I)continue;let L=p(e,I,{vocab:!0},A);if((null===L||!v(L)&&!g(L))&&(L=P({unmappedProperty:I,activeCtx:e,activeProperty:t,parent:d,options:A,insideList:T,value:O,expandedParent:_}),void 0===L))continue;if(g(L)){if("@reverse"===r)throw new n("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:O});if(L in _&&"@included"!==L&&"@type"!==L)throw new n("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:L})}if("@id"===L){if(!a(O)){if(!A.isFrame)throw new n('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:O});if(o(O)){if(!s(O))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:O})}else{if(!i(O))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:O});if(!O.every((e=>a(e))))throw new n('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:O})}}w(_,"@id",b(O).map((t=>a(t)?p(e,t,{base:!0},A):t)),{propertyIsArray:A.isFrame});continue}if("@type"===L){o(O)&&(O=Object.fromEntries(Object.entries(O).map((([e,t])=>[p(C,e,{vocab:!0}),b(t).map((e=>p(C,e,{base:!0,vocab:!0})))])))),S(O,A.isFrame),w(_,"@type",b(O).map((e=>a(e)?p(C,e,{base:!0,vocab:!0},A):e)),{propertyIsArray:A.isFrame});continue}if("@included"===L&&m(e,1.1)){const r=b(await E.expand({activeCtx:e,activeProperty:t,element:O,options:A,expansionMap:P}));if(!r.every((e=>h(e))))throw new n("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:O});w(_,"@included",r,{propertyIsArray:!0});continue}if("@graph"===L&&!o(O)&&!i(O))throw new n('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:O});if("@value"===L){N=O,D&&m(e,1.1)?_["@value"]=O:w(_,"@value",O,{propertyIsArray:A.isFrame});continue}if("@language"===L){if(null===O)continue;if(!a(O)&&!A.isFrame)throw new n('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:O});O=b(O).map((e=>a(e)?e.toLowerCase():e));for(const e of O)a(e)&&!e.match(x)&&console.warn(`@language must be valid BCP47: ${e}`);w(_,"@language",O,{propertyIsArray:A.isFrame});continue}if("@direction"===L){if(!a(O)&&!A.isFrame)throw new n('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:O});O=b(O);for(const e of O)if(a(e)&&"ltr"!==e&&"rtl"!==e)throw new n('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:O});w(_,"@direction",O,{propertyIsArray:A.isFrame});continue}if("@index"===L){if(!a(O))throw new n('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:O});w(_,"@index",O);continue}if("@reverse"===L){if(!o(O))throw new n('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:O});if(R=await E.expand({activeCtx:e,activeProperty:"@reverse",element:O,options:A,expansionMap:P}),"@reverse"in R)for(const e in R["@reverse"])w(_,e,R["@reverse"][e],{propertyIsArray:!0});let t=_["@reverse"]||null;for(const e in R){if("@reverse"===e)continue;null===t&&(t=_["@reverse"]={}),w(t,e,[],{propertyIsArray:!0});const r=R[e];for(let i=0;i<r.length;++i){const o=r[i];if(l(o)||u(o))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:R});w(t,e,o,{propertyIsArray:!0})}}continue}if("@nest"===L){j.push(I);continue}let U=e;const B=f(e,I,"@context");c(B)||(U=await y({activeCtx:e,localCtx:B,propagate:!0,overrideProtected:!0,options:A}));const M=f(U,I,"@container")||[];if(M.includes("@language")&&o(O))R=k(U,O,f(U,I,"@direction"),A);else if(M.includes("@index")&&o(O)){const t=M.includes("@graph"),r=f(U,I,"@index")||"@index",n="@index"!==r&&p(e,r,{vocab:!0},A);R=await F({activeCtx:U,options:A,activeProperty:I,value:O,expansionMap:P,asGraph:t,indexKey:r,propertyIndex:n})}else if(M.includes("@id")&&o(O)){const e=M.includes("@graph");R=await F({activeCtx:U,options:A,activeProperty:I,value:O,expansionMap:P,asGraph:e,indexKey:"@id"})}else if(M.includes("@type")&&o(O))R=await F({activeCtx:U.revertToPreviousContext(),options:A,activeProperty:I,value:O,expansionMap:P,asGraph:!1,indexKey:"@type"});else{const n="@list"===L;if(n||"@set"===L){let e=t;n&&"@graph"===r&&(e=null),R=await E.expand({activeCtx:U,activeProperty:e,element:O,options:A,insideList:n,expansionMap:P})}else R="@json"===f(e,I,"@type")?{"@type":"@json","@value":O}:await E.expand({activeCtx:U,activeProperty:I,element:O,options:A,insideList:!1,expansionMap:P})}if(null!==R||"@value"===L||(R=P({unmappedValue:O,expandedProperty:L,activeCtx:U,activeProperty:t,parent:d,options:A,insideList:T,key:I,expandedParent:_}),void 0!==R))if("@list"!==L&&!u(R)&&M.includes("@list")&&(R={"@list":b(R)}),M.includes("@graph")&&!M.some((e=>"@id"===e||"@index"===e))&&(R=b(R).map((e=>({"@graph":b(e)})))),U.mappings.has(I)&&U.mappings.get(I).reverse){const e=_["@reverse"]=_["@reverse"]||{};R=b(R);for(let t=0;t<R.length;++t){const r=R[t];if(l(r)||u(r))throw new n('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:R});w(e,L,r,{propertyIsArray:!0})}}else w(_,L,R,{propertyIsArray:!0})}if("@value"in _)if("@json"===_["@type"]&&m(e,1.1));else if((o(N)||i(N))&&!A.isFrame)throw new n('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:N});for(const s of j){const a=i(d[s])?d[s]:[d[s]];for(const i of a){if(!o(i)||Object.keys(i).some((t=>"@value"===p(e,t,{vocab:!0},A))))throw new n("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:i});await I({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:i,expandedParent:_,options:A,insideList:T,typeScopedContext:C,typeKey:R,expansionMap:P})}}}function A({activeCtx:e,activeProperty:t,value:r,options:n}){if(null==r)return null;const i=p(e,t,{vocab:!0},n);if("@id"===i)return p(e,r,{base:!0},n);if("@type"===i)return p(e,r,{vocab:!0,base:!0},n);const o=f(e,t,"@type");if(("@id"===o||"@graph"===i)&&a(r))return{"@id":p(e,r,{base:!0},n)};if("@vocab"===o&&a(r))return{"@id":p(e,r,{vocab:!0,base:!0},n)};if(g(i))return r;const s={};if(o&&!["@id","@vocab","@none"].includes(o))s["@type"]=o;else if(a(r)){const r=f(e,t,"@language");null!==r&&(s["@language"]=r);const n=f(e,t,"@direction");null!==n&&(s["@direction"]=n)}return["boolean","number","string"].includes(typeof r)||(r=r.toString()),s["@value"]=r,s}function k(e,t,r,o){const s=[],c=Object.keys(t).sort();for(const u of c){const c=p(e,u,{vocab:!0},o);let l=t[u];i(l)||(l=[l]);for(const e of l){if(null===e)continue;if(!a(e))throw new n("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const i={"@value":e};"@none"!==c&&(i["@language"]=u.toLowerCase()),r&&(i["@direction"]=r),s.push(i)}}return s}async function F({activeCtx:e,options:t,activeProperty:r,value:o,expansionMap:s,asGraph:a,indexKey:u,propertyIndex:h}){const g=[],m=Object.keys(o).sort(),v="@type"===u;for(let b of m){if(v){const r=f(e,b,"@context");c(r)||(e=await y({activeCtx:e,localCtx:r,propagate:!1,options:t}))}let m,_=o[b];i(_)||(_=[_]),_=await E.expand({activeCtx:e,activeProperty:r,element:_,options:t,insideList:!1,insideIndex:!0,expansionMap:s}),m=h?"@none"===b?"@none":A({activeCtx:e,activeProperty:u,value:b,options:t}):p(e,b,{vocab:!0},t),"@id"===u?b=p(e,b,{base:!0},t):v&&(b=m);for(let e of _){if(a&&!d(e)&&(e={"@graph":[e]}),"@type"===u)"@none"===m||(e["@type"]?e["@type"]=[b].concat(e["@type"]):e["@type"]=[b]);else{if(l(e)&&!["@language","@type","@index"].includes(u))throw new n(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${u}".`,"jsonld.SyntaxError",{code:"invalid value object",value:e});h?"@none"!==m&&w(e,h,m,{propertyIsArray:!0,prependValue:!0}):"@none"===m||u in e||(e[u]=b)}g.push(e)}}return g}E.expand=async({activeCtx:e,activeProperty:t=null,element:r,options:u={},insideList:l=!1,insideIndex:d=!1,typeScopedContext:h=null,expansionMap:g=(()=>{})})=>{if(null==r)return null;if("@default"===t&&(u=Object.assign({},u,{isFrame:!1})),!i(r)&&!o(r)){if(!l&&(null===t||"@graph"===p(e,t,{vocab:!0},u))){const n=await g({unmappedValue:r,activeCtx:e,activeProperty:t,options:u,insideList:l});return void 0===n?null:n}return A({activeCtx:e,activeProperty:t,value:r,options:u})}if(i(r)){let n=[];const o=f(e,t,"@container")||[];l=l||o.includes("@list");for(let o=0;o<r.length;++o){let s=await E.expand({activeCtx:e,activeProperty:t,element:r[o],options:u,expansionMap:g,insideIndex:d,typeScopedContext:h});l&&i(s)&&(s={"@list":s}),null===s&&(s=await g({unmappedValue:r[o],activeCtx:e,activeProperty:t,parent:r,index:o,options:u,expandedParent:n,insideList:l}),void 0===s)||(i(s)?n=n.concat(s):n.push(s))}return n}const w=p(e,t,{vocab:!0},u),S=f(e,t,"@context");h=h||(e.previousContext?e:null);let x=Object.keys(r).sort(),k=!d;if(k&&h&&x.length<=2&&!x.includes("@context"))for(const t of x){const r=p(h,t,{vocab:!0},u);if("@value"===r){k=!1,e=h;break}if("@id"===r&&1===x.length){k=!1;break}}k&&(e=e.revertToPreviousContext()),c(S)||(e=await y({activeCtx:e,localCtx:S,propagate:!0,overrideProtected:!0,options:u})),"@context"in r&&(e=await y({activeCtx:e,localCtx:r["@context"],options:u})),h=e;let F=null;for(const t of x)if("@type"===p(e,t,{vocab:!0},u)){F=F||t;const n=r[t],i=Array.isArray(n)?n.length>1?n.slice().sort():n:[n];for(const t of i){const r=f(h,t,"@context");c(r)||(e=await y({activeCtx:e,localCtx:r,options:u,propagate:!1}))}}let T={};await I({activeCtx:e,activeProperty:t,expandedActiveProperty:w,element:r,expandedParent:T,options:u,insideList:l,typeKey:F,typeScopedContext:h,expansionMap:g}),x=Object.keys(T);let R=x.length;if("@value"in T){if("@type"in T&&("@language"in T||"@direction"in T))throw new n('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:T});let i=R-1;if("@type"in T&&(i-=1),"@index"in T&&(i-=1),"@language"in T&&(i-=1),"@direction"in T&&(i-=1),0!==i)throw new n('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:T});const o=null===T["@value"]?[]:b(T["@value"]),c=_(T,"@type");if(m(e,1.1)&&c.includes("@json")&&1===c.length);else if(0===o.length){const n=await g({unmappedValue:T,activeCtx:e,activeProperty:t,element:r,options:u,insideList:l});T=void 0!==n?n:null}else{if(!o.every((e=>a(e)||s(e)))&&"@language"in T)throw new n("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:T});if(!c.every((e=>v(e)&&!(a(e)&&0===e.indexOf("_:"))||s(e))))throw new n('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:T})}}else if("@type"in T&&!i(T["@type"]))T["@type"]=[T["@type"]];else if("@set"in T||"@list"in T){if(R>1&&(2!==R||!("@index"in T)))throw new n('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:T});"@set"in T&&(T=T["@set"],x=Object.keys(T),R=x.length)}else if(1===R&&"@language"in T){const n=await g(T,{unmappedValue:T,activeCtx:e,activeProperty:t,element:r,options:u,insideList:l});T=void 0!==n?n:null}if(o(T)&&!u.keepFreeFloatingNodes&&!l&&(null===t||"@graph"===w)&&(0===R||"@value"in T||"@list"in T||1===R&&"@id"in T)){const n=await g({unmappedValue:T,activeCtx:e,activeProperty:t,element:r,options:u,insideList:l});T=void 0!==n?n:null}return T}},1565:(e,t,r)=>{"use strict";const{isSubjectReference:n}=r(8463),{createMergedNodeMap:i}=r(2664),o={};e.exports=o,o.flatten=e=>{const t=i(e),r=[],o=Object.keys(t).sort();for(let e=0;e<o.length;++e){const i=t[o[e]];n(i)||r.push(i)}return r}},3859:(e,t,r)=>{"use strict";const{isKeyword:n}=r(4131),i=r(8463),o=r(832),s=r(1055),a=r(2278),c=r(4093),{createNodeMap:u,mergeNodeMapGraphs:l}=r(2664),d={};function h(e){const t={};for(const r in e)void 0!==e[r]&&(t["@"+r]=[e[r]]);return[t]}function p(e,t,r){for(let n=r.length-1;n>=0;--n){const i=r[n];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function f(e,t,r){const n="@"+r;let i=n in e?e[n][0]:t[r];if("embed"===r)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new c("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return i}function g(e){if(!o.isArray(e)||1!==e.length||!o.isObject(e[0]))throw new c("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of s.asArray(e[0]["@id"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new c("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of s.asArray(e[0]["@type"]))if(!o.isObject(t)&&!a.isAbsolute(t)||o.isString(t)&&0===t.indexOf("_:"))throw new c("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function y(e,t,r,a){let c=!0,u=!1;for(const l in r){let d=!1;const h=s.getValues(t,l),p=0===s.getValues(r,l).length;if("@id"===l){if(o.isEmptyObject(r["@id"][0]||{})?d=!0:r["@id"].length>=0&&(d=r["@id"].includes(h[0])),!a.requireAll)return d}else if("@type"===l){if(c=!1,p){if(h.length>0)return!1;d=!0}else if(1===r["@type"].length&&o.isEmptyObject(r["@type"][0]))d=h.length>0;else for(const e of r["@type"])d=!(!o.isObject(e)||!("@default"in e))||d||h.some((t=>t===e));if(!a.requireAll)return d}else{if(n(l))continue;{const t=s.getValues(r,l)[0];let n=!1;if(t&&(g([t]),n="@default"in t),c=!1,0===h.length&&n)continue;if(h.length>0&&p)return!1;if(void 0===t){if(h.length>0)return!1;d=!0}else if(i.isList(t)){const r=t["@list"][0];if(i.isList(h[0])){const t=h[0]["@list"];i.isValue(r)?d=t.some((e=>_(r,e))):(i.isSubject(r)||i.isSubjectReference(r))&&(d=t.some((t=>b(e,r,t,a))))}}else d=i.isValue(t)?h.some((e=>_(t,e))):i.isSubjectReference(t)?h.some((r=>b(e,t,r,a))):!!o.isObject(t)&&h.length>0}}if(!d&&a.requireAll)return!1;u=u||d}return c||u}function m(e,t){const r=e.uniqueEmbeds[e.graph],n=r[t],i=n.parent,a=n.property,c={"@id":t};if(o.isArray(i)){for(let e=0;e<i.length;++e)if(s.compareValues(i[e],c)){i[e]=c;break}}else{const e=o.isArray(i[a]);s.removeValue(i,a,c,{propertyIsArray:e}),s.addValue(i,a,c,{propertyIsArray:e})}const u=e=>{const t=Object.keys(r);for(const n of t)n in r&&o.isObject(r[n].parent)&&r[n].parent["@id"]===e&&(delete r[n],u(n))};u(t)}function v(e,t){if(o.isArray(e))return e.map((e=>v(e,t)));if(o.isObject(e)){if("@preserve"in e)return e["@preserve"][0];if(i.isValue(e))return e;if(i.isList(e))return e["@list"]=v(e["@list"],t),e;if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)"@id"===r&&t.bnodesToClear.includes(e[r])?delete e["@id"]:e[r]=v(e[r],t)}return e}function w(e,t,r){o.isObject(e)?s.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function b(e,t,r,n){if(!("@id"in r))return!1;const i=e.subjects[r["@id"]];return i&&y(e,i,t,n)}function _(e,t){const r=t["@value"],n=t["@type"],i=t["@language"],s=e["@value"]?o.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],a=e["@type"]?o.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],c=e["@language"]?o.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===s.length&&0===a.length&&0===c.length||!(!s.includes(r)&&!o.isEmptyObject(s[0]))&&!!(!n&&0===a.length||a.includes(n)||n&&o.isEmptyObject(a[0]))&&!!(!i&&0===c.length||c.includes(i)||i&&o.isEmptyObject(c[0]))}e.exports=d,d.frameMergedOrDefault=(e,t,r)=>{const n={options:r,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new s.IdentifierIssuer("_:b");u(e,n.graphMap,"@default",i),r.merged&&(n.graphMap["@merged"]=l(n.graphMap),n.graph="@merged"),n.subjects=n.graphMap[n.graph];const o=[];return d.frame(n,Object.keys(n.subjects).sort(),t,o),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(n.bnodeMap).filter((e=>1===n.bnodeMap[e].length))),r.link={},v(o,r)},d.frame=(e,t,r,a,u=null)=>{g(r),r=r[0];const l=e.options,v={embed:f(r,l,"embed"),explicit:f(r,l,"explicit"),requireAll:f(r,l,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const b=e.link[e.graph],S=function(e,t,r,n){const i={};for(const o of t){const t=e.graphMap[e.graph][o];y(e,t,r,n)&&(i[o]=t)}return i}(e,t,r,v),E=Object.keys(S).sort();for(const g of E){const y=S[g];if(null===u?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},"@link"===v.embed&&g in b){w(a,u,b[g]);continue}const E={"@id":g};if(0===g.indexOf("_:")&&s.addValue(e.bnodeMap,g,E,{propertyIsArray:!0}),b[g]=E,("@first"===v.embed||"@last"===v.embed)&&e.is11)throw new c("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:r});if(e.embedded||!e.uniqueEmbeds[e.graph].hasOwnProperty(g))if(!e.embedded||"@never"!==v.embed&&!p(y,e.graph,e.subjectStack))if(!e.embedded||"@first"!=v.embed&&"@once"!=v.embed||!e.uniqueEmbeds[e.graph].hasOwnProperty(g)){if("@last"===v.embed&&g in e.uniqueEmbeds[e.graph]&&m(e,g),e.uniqueEmbeds[e.graph][g]={parent:a,property:u},e.subjectStack.push({subject:y,graph:e.graph}),g in e.graphMap){let t=!1,n=null;"@graph"in r?(n=r["@graph"][0],t=!("@merged"===g||"@default"===g),o.isObject(n)||(n={})):(t="@merged"!==e.graph,n={}),t&&d.frame({...e,graph:g,embedded:!1},Object.keys(e.graphMap[g]).sort(),[n],E,"@graph")}"@included"in r&&d.frame({...e,embedded:!1},t,r["@included"],E,"@included");for(const t of Object.keys(y).sort())if(n(t)){if(E[t]=s.clone(y[t]),"@type"===t)for(const t of y["@type"])0===t.indexOf("_:")&&s.addValue(e.bnodeMap,t,E,{propertyIsArray:!0})}else if(!v.explicit||t in r)for(const n of y[t]){const o=t in r?r[t]:h(v);if(i.isList(n)){const o=r[t]&&r[t][0]&&r[t][0]["@list"]?r[t][0]["@list"]:h(v),a={"@list":[]};w(E,t,a);const c=n["@list"];for(const t of c)i.isSubjectReference(t)?d.frame({...e,embedded:!0},[t["@id"]],o,a,"@list"):w(a,"@list",s.clone(t))}else i.isSubjectReference(n)?d.frame({...e,embedded:!0},[n["@id"]],o,E,t):_(o[0],n)&&w(E,t,s.clone(n))}for(const e of Object.keys(r).sort()){if("@type"===e){if(!o.isObject(r[e][0])||!("@default"in r[e][0]))continue}else if(n(e))continue;const t=r[e][0]||{};if(!f(t,l,"omitDefault")&&!(e in E)){let r="@null";"@default"in t&&(r=s.clone(t["@default"])),o.isArray(r)||(r=[r]),E[e]=[{"@preserve":r}]}}for(const t of Object.keys(r["@reverse"]||{}).sort()){const n=r["@reverse"][t];for(const r of Object.keys(e.subjects))s.getValues(e.subjects[r],t).some((e=>e["@id"]===g))&&(E["@reverse"]=E["@reverse"]||{},s.addValue(E["@reverse"],t,[],{propertyIsArray:!0}),d.frame({...e,embedded:!0},[r],n,E["@reverse"][t],u))}w(a,u,E),e.subjectStack.pop()}else w(a,u,E);else w(a,u,E)}},d.cleanupNull=(e,t)=>{if(o.isArray(e))return e.map((e=>d.cleanupNull(e,t))).filter((e=>e));if("@null"===e)return null;if(o.isObject(e)){if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)e[r]=d.cleanupNull(e[r],t)}return e}},5076:(e,t,r)=>{"use strict";const n=r(4093),i=r(8463),o=r(832),s=r(1055),{RDF_LIST:a,RDF_FIRST:c,RDF_REST:u,RDF_NIL:l,RDF_TYPE:d,RDF_JSON_LITERAL:h,XSD_BOOLEAN:p,XSD_DOUBLE:f,XSD_INTEGER:g,XSD_STRING:y}=r(3770),m=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,v={};function w(e,t,r){if(e.termType.endsWith("Node"))return{"@id":e.value};const i={"@value":e.value};if(e.language)i["@language"]=e.language;else{let s=e.datatype.value;if(s||(s=y),s===h){s="@json";try{i["@value"]=JSON.parse(i["@value"])}catch(e){throw new n("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:i["@value"],cause:e})}}if(t){if(s===p)"true"===i["@value"]?i["@value"]=!0:"false"===i["@value"]&&(i["@value"]=!1);else if(o.isNumeric(i["@value"]))if(s===g){const e=parseInt(i["@value"],10);e.toFixed(0)===i["@value"]&&(i["@value"]=e)}else s===f&&(i["@value"]=parseFloat(i["@value"]));[p,g,f,y].includes(s)||(i["@type"]=s)}else if("i18n-datatype"===r&&s.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=s.split(/[#_]/);e.length>0&&(i["@language"]=e,e.match(m)||console.warn(`@language must be valid BCP47: ${e}`)),i["@direction"]=t}else s!==y&&(i["@type"]=s)}return i}e.exports=v,v.fromRDF=async(e,{useRdfType:t=!1,useNativeTypes:r=!1,rdfDirection:n=null})=>{const h={},p={"@default":h},f={};for(const i of e){const e="DefaultGraph"===i.graph.termType?"@default":i.graph.value;e in p||(p[e]={}),"@default"===e||e in h||(h[e]={"@id":e});const o=p[e],a=i.subject.value,c=i.predicate.value,u=i.object;a in o||(o[a]={"@id":a});const g=o[a],y=u.termType.endsWith("Node");if(y&&!(u.value in o)&&(o[u.value]={"@id":u.value}),c===d&&!t&&y){s.addValue(g,"@type",u.value,{propertyIsArray:!0});continue}const m=w(u,r,n);if(s.addValue(g,c,m,{propertyIsArray:!0}),y)if(u.value===l){const e=o[u.value];"usages"in e||(e.usages=[]),e.usages.push({node:g,property:c,value:m})}else u.value in f?f[u.value]=!1:f[u.value]={node:g,property:c,value:m}}for(const e in p){const t=p[e];if(!(l in t))continue;const r=t[l];if(r.usages){for(let e of r.usages){let r=e.node,n=e.property,s=e.value;const l=[],d=[];let h=Object.keys(r).length;for(;n===u&&o.isObject(f[r["@id"]])&&o.isArray(r[c])&&1===r[c].length&&o.isArray(r[u])&&1===r[u].length&&(3===h||4===h&&o.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===a)&&(l.push(r[c][0]),d.push(r["@id"]),e=f[r["@id"]],r=e.node,n=e.property,s=e.value,h=Object.keys(r).length,i.isBlankNode(r)););delete s["@id"],s["@list"]=l.reverse();for(const e of d)delete t[e]}delete r.usages}}const g=[],y=Object.keys(h).sort();for(const e of y){const t=h[e];if(e in p){const r=t["@graph"]=[],n=p[e],o=Object.keys(n).sort();for(const e of o){const t=n[e];i.isSubjectReference(t)||r.push(t)}}i.isSubjectReference(t)||g.push(t)}return g}},8463:(e,t,r)=>{"use strict";const n=r(832),i={};e.exports=i,i.isSubject=e=>!(!n.isObject(e)||"@value"in e||"@set"in e||"@list"in e)&&(Object.keys(e).length>1||!("@id"in e)),i.isSubjectReference=e=>n.isObject(e)&&1===Object.keys(e).length&&"@id"in e,i.isValue=e=>n.isObject(e)&&"@value"in e,i.isList=e=>n.isObject(e)&&"@list"in e,i.isGraph=e=>n.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter((e=>"@id"!==e&&"@index"!==e)).length,i.isSimpleGraph=e=>i.isGraph(e)&&!("@id"in e),i.isBlankNode=e=>!!n.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e))},6805:(e,t,r)=>{const n=r(7055),i=r(7222),o=r(1055),s=r(8058),a=o.IdentifierIssuer,c=r(4093),u=r(9593),l=r(9048),{expand:d}=r(2759),{flatten:h}=r(1565),{fromRDF:p}=r(5076),{toRDF:f}=r(9382),{frameMergedOrDefault:g,cleanupNull:y}=r(3859),{isArray:m,isObject:v,isString:w}=r(832),{isSubjectReference:b}=r(8463),{expandIri:_,getInitialContext:S,process:E,processingMode:x}=r(4131),{compact:I,compactIri:A}=r(3251),{createNodeMap:k,createMergedNodeMap:F,mergeNodeMaps:T}=r(2664),R=function(e){const t={},R=new u({max:100});function C(t,{documentLoader:r=e.documentLoader,...n}){return Object.assign({},{documentLoader:r},n,t)}return e.compact=async function(t,r,n){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===r)throw new c("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let i;(n=C(n,{base:w(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new a("_:b"),contextResolver:new s({sharedCache:R})})).link&&(n.skipExpansion=!0),n.compactToRelative||delete n.base,i=n.skipExpansion?t:await e.expand(t,n);const u=await e.processContext(S(n),r,n);let l=await I({activeCtx:u,element:i,options:n,compactionMap:n.compactionMap});n.compactArrays&&!n.graph&&m(l)?1===l.length?l=l[0]:0===l.length&&(l={}):n.graph&&v(l)&&(l=[l]),v(r)&&"@context"in r&&(r=r["@context"]),r=o.clone(r),m(r)||(r=[r]);const d=r;r=[];for(let e=0;e<d.length;++e)(!v(d[e])||Object.keys(d[e]).length>0)&&r.push(d[e]);const h=r.length>0;if(1===r.length&&(r=r[0]),m(l)){const e=A({activeCtx:u,iri:"@graph",relativeTo:{vocab:!0}}),t=l;l={},h&&(l["@context"]=r),l[e]=t}else if(v(l)&&h){const e=l;l={"@context":r};for(const t in e)l[t]=e[t]}return l},e.expand=async function(t,r){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");!1===(r=C(r,{keepFreeFloatingNodes:!1,contextResolver:new s({sharedCache:R})})).expansionMap&&(r.expansionMap=void 0);const n={},i=[];if("expandContext"in r){const e=o.clone(r.expandContext);v(e)&&"@context"in e?n.expandContext=e:n.expandContext={"@context":e},i.push(n.expandContext)}let a;if(w(t)){const o=await e.get(t,r);a=o.documentUrl,n.input=o.document,o.contextUrl&&(n.remoteContext={"@context":o.contextUrl},i.push(n.remoteContext))}else n.input=o.clone(t);"base"in r||(r.base=a||"");let c=S(r);for(const e of i)c=await E({activeCtx:c,localCtx:e,options:r});let u=await d({activeCtx:c,element:n.input,options:r,expansionMap:r.expansionMap});return v(u)&&"@graph"in u&&1===Object.keys(u).length?u=u["@graph"]:null===u&&(u=[]),m(u)||(u=[u]),u},e.flatten=async function(t,r,n){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");r="function"==typeof r?null:r||null,n=C(n,{base:w(t)?t:"",contextResolver:new s({sharedCache:R})});const i=await e.expand(t,n),o=h(i);if(null===r)return o;n.graph=!0,n.skipExpansion=!0;const a=await e.compact(o,r,n);return a},e.frame=async function(t,r,n){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(n=C(n,{base:w(t)?t:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new s({sharedCache:R})}),w(r)){const t=await e.get(r,n);if(r=t.document,t.contextUrl){let e=r["@context"];e?m(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,r["@context"]=e}}const i=r&&r["@context"]||{},o=await e.processContext(S(n),i,n);n.hasOwnProperty("omitGraph")||(n.omitGraph=x(o,1.1)),n.hasOwnProperty("pruneBlankNodeIdentifiers")||(n.pruneBlankNodeIdentifiers=x(o,1.1));const a=await e.expand(t,n),c={...n};c.isFrame=!0,c.keepFreeFloatingNodes=!0;const u=await e.expand(r,c),l=Object.keys(r).map((e=>_(o,e,{vocab:!0})));c.merged=!l.includes("@graph"),c.is11=x(o,1.1);const d=g(a,u,c);c.graph=!n.omitGraph,c.skipExpansion=!0,c.link={},c.framing=!0;let h=await e.compact(d,i,c);return c.link={},h=y(h,c),h},e.link=async function(t,r,n){const i={};return r&&(i["@context"]=r),i["@embed"]="@link",e.frame(t,i,n)},e.normalize=e.canonize=async function(t,r){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(r=C(r,{base:w(t)?t:"",algorithm:"URDNA2015",skipExpansion:!1,contextResolver:new s({sharedCache:R})}))){if("application/n-quads"!==r.inputFormat&&"application/nquads"!==r.inputFormat)throw new c("Unknown canonicalization input format.","jsonld.CanonizeError");const e=l.parse(t);return n.canonize(e,r)}const i={...r};delete i.format,i.produceGeneralizedRdf=!1;const o=await e.toRDF(t,i);return n.canonize(o,r)},e.fromRDF=async function(e,r){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");r=C(r,{format:w(e)?"application/n-quads":void 0});const{format:n}=r;let{rdfParser:i}=r;if(n){if(i=i||t[n],!i)throw new c("Unknown input format.","jsonld.UnknownFormat",{format:n})}else i=()=>e;const o=await i(e);return p(o,r)},e.toRDF=async function(t,r){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let n;n=(r=C(r,{base:w(t)?t:"",skipExpansion:!1,contextResolver:new s({sharedCache:R})})).skipExpansion?t:await e.expand(t,r);const i=f(n,r);if(r.format){if("application/n-quads"===r.format||"application/nquads"===r.format)return l.serialize(i);throw new c("Unknown output format.","jsonld.UnknownFormat",{format:r.format})}return i},e.createNodeMap=async function(t,r){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");r=C(r,{base:w(t)?t:"",contextResolver:new s({sharedCache:R})});const n=await e.expand(t,r);return F(n,r)},e.merge=async function(t,r,n){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!m(t))throw new TypeError('Could not merge, "docs" must be an array.');r="function"==typeof r?null:r||null,n=C(n,{contextResolver:new s({sharedCache:R})});const i=await Promise.all(t.map((t=>{const r={...n};return e.expand(t,r)})));let c=!0;"mergeNodes"in n&&(c=n.mergeNodes);const u=n.issuer||new a("_:b"),l={"@default":{}};for(let e=0;e<i.length;++e){const t=o.relabelBlankNodes(i[e],{issuer:new a("_:b"+e+"-")}),r=c||0===e?l:{"@default":{}};if(k(t,r,"@default",u),r!==l)for(const e in r){const t=r[e];if(!(e in l)){l[e]=t;continue}const n=l[e];for(const e in t)e in n||(n[e]=t[e])}}const d=T(l),h=[],p=Object.keys(d).sort();for(let e=0;e<p.length;++e){const t=d[p[e]];b(t)||h.push(t)}if(null===r)return h;n.graph=!0,n.skipExpansion=!0;const f=await e.compact(h,r,n);return f},Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=t}),e.documentLoader=async e=>{throw new c("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},e.get=async function(t,r){let n;n="function"==typeof r.documentLoader?r.documentLoader:e.documentLoader;const i=await n(t);try{if(!i.document)throw new c("No remote document found at the given URL.","jsonld.NullRemoteDocument");w(i.document)&&(i.document=JSON.parse(i.document))}catch(e){throw new c("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:i})}return i},e.processContext=async function(e,t,r){return r=C(r,{base:"",contextResolver:new s({sharedCache:R})}),null===t?S(r):(t=o.clone(t),v(t)&&"@context"in t||(t={"@context":t}),E({activeCtx:e,localCtx:t,options:r}))},e.getContextValue=r(4131).getContextValue,e.documentLoaders={},e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new c('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(e,r){t[e]=r},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",l.parse),e.registerRDFParser("application/nquads",l.parse),e.url=r(2278),e.util=o,Object.assign(e,o),e.promises=e,e.RequestQueue=r(533),e.JsonLdProcessor=r(731)(e),i.setupGlobals(e),i.setupDocumentLoaders(e),e},C=function(){return R((function(){return C()}))};R(C),e.exports=C},2664:(e,t,r)=>{"use strict";const{isKeyword:n}=r(4131),i=r(8463),o=r(832),s=r(1055),a=r(4093),c={};e.exports=c,c.createMergedNodeMap=(e,t)=>{const r=(t=t||{}).issuer||new s.IdentifierIssuer("_:b"),n={"@default":{}};return c.createNodeMap(e,n,"@default",r),c.mergeNodeMaps(n)},c.createNodeMap=(e,t,r,u,l,d)=>{if(o.isArray(e)){for(const n of e)c.createNodeMap(n,t,r,u,void 0,d);return}if(!o.isObject(e))return void(d&&d.push(e));if(i.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=u.getId(t))}return void(d&&d.push(e))}if(d&&i.isList(e)){const n=[];return c.createNodeMap(e["@list"],t,r,u,l,n),void d.push({"@list":n})}if("@type"in e){const t=e["@type"];for(const e of t)0===e.indexOf("_:")&&u.getId(e)}o.isUndefined(l)&&(l=i.isBlankNode(e)?u.getId(e["@id"]):e["@id"]),d&&d.push({"@id":l});const h=t[r],p=h[l]=h[l]||{};p["@id"]=l;const f=Object.keys(e).sort();for(let o of f){if("@id"===o)continue;if("@reverse"===o){const n={"@id":l},o=e["@reverse"];for(const e in o){const a=o[e];for(const o of a){let a=o["@id"];i.isBlankNode(o)&&(a=u.getId(a)),c.createNodeMap(o,t,r,u,a),s.addValue(h[a],e,n,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===o){l in t||(t[l]={}),c.createNodeMap(e[o],t,l,u);continue}if("@included"===o){c.createNodeMap(e[o],t,r,u);continue}if("@type"!==o&&n(o)){if("@index"===o&&o in p&&(e[o]!==p[o]||e[o]["@id"]!==p[o]["@id"]))throw new a("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:p});p[o]=e[o];continue}const d=e[o];if(0===o.indexOf("_:")&&(o=u.getId(o)),0!==d.length)for(let e of d)if("@type"===o&&(e=0===e.indexOf("_:")?u.getId(e):e),i.isSubject(e)||i.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const n=i.isBlankNode(e)?u.getId(e["@id"]):e["@id"];s.addValue(p,o,{"@id":n},{propertyIsArray:!0,allowDuplicate:!1}),c.createNodeMap(e,t,r,u,n)}else if(i.isValue(e))s.addValue(p,o,e,{propertyIsArray:!0,allowDuplicate:!1});else if(i.isList(e)){const n=[];c.createNodeMap(e["@list"],t,r,u,l,n),e={"@list":n},s.addValue(p,o,e,{propertyIsArray:!0,allowDuplicate:!1})}else c.createNodeMap(e,t,r,u,l),s.addValue(p,o,e,{propertyIsArray:!0,allowDuplicate:!1});else s.addValue(p,o,[],{propertyIsArray:!0})}},c.mergeNodeMapGraphs=e=>{const t={};for(const r of Object.keys(e).sort())for(const i of Object.keys(e[r]).sort()){const o=e[r][i];i in t||(t[i]={"@id":i});const a=t[i];for(const e of Object.keys(o).sort())if(n(e)&&"@type"!==e)a[e]=s.clone(o[e]);else for(const t of o[e])s.addValue(a,e,s.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},c.mergeNodeMaps=e=>{const t=e["@default"],r=Object.keys(e).sort();for(const n of r){if("@default"===n)continue;const r=e[n];let o=t[n];o?"@graph"in o||(o["@graph"]=[]):t[n]=o={"@id":n,"@graph":[]};const s=o["@graph"];for(const e of Object.keys(r).sort()){const t=r[e];i.isSubjectReference(t)||s.push(t)}}return t}},7222:(e,t,r)=>{"use strict";const n=r(8831),i={};e.exports=i,i.setupDocumentLoaders=function(e){"undefined"!=typeof XMLHttpRequest&&(e.documentLoaders.xhr=n,e.useDocumentLoader("xhr"))},i.setupGlobals=function(e){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})}},9382:(e,t,r)=>{"use strict";const{createNodeMap:n}=r(2664),{isKeyword:i}=r(4131),o=r(8463),s=r(5456),a=r(832),c=r(1055),{RDF_FIRST:u,RDF_REST:l,RDF_NIL:d,RDF_TYPE:h,RDF_JSON_LITERAL:p,RDF_LANGSTRING:f,XSD_BOOLEAN:g,XSD_DOUBLE:y,XSD_INTEGER:m,XSD_STRING:v}=r(3770),{isAbsolute:w}=r(2278),b={};function _(e,t,r,n,o){const s=Object.keys(t).sort();for(const a of s){const s=t[a],c=Object.keys(s).sort();for(let t of c){const c=s[t];if("@type"===t)t=h;else if(i(t))continue;for(const i of c){const s={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!w(a))continue;const c={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(!w(t))continue;if("BlankNode"===c.termType&&!o.produceGeneralizedRdf)continue;const u=S(i,n,e,r,o.rdfDirection);u&&e.push({subject:s,predicate:c,object:u,graph:r})}}}}function S(e,t,r,n,i){const c={};if(o.isValue(e)){c.termType="Literal",c.value=void 0,c.datatype={termType:"NamedNode"};let t=e["@value"];const r=e["@type"]||null;if("@json"===r)c.value=s(t),c.datatype.value=p;else if(a.isBoolean(t))c.value=t.toString(),c.datatype.value=r||g;else if(a.isDouble(t)||r===y)a.isDouble(t)||(t=parseFloat(t)),c.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),c.datatype.value=r||y;else if(a.isNumber(t))c.value=t.toFixed(0),c.datatype.value=r||m;else if("i18n-datatype"===i&&"@direction"in e){const r="https://www.w3.org/ns/i18n#"+(e["@language"]||"")+`_${e["@direction"]}`;c.datatype.value=r,c.value=t}else"@language"in e?(c.value=t,c.datatype.value=r||f,c.language=e["@language"]):(c.value=t,c.datatype.value=r||v)}else if(o.isList(e)){const o=function(e,t,r,n,i){const o={termType:"NamedNode",value:u},s={termType:"NamedNode",value:l},a={termType:"NamedNode",value:d},c=e.pop(),h=c?{termType:"BlankNode",value:t.getId()}:a;let p=h;for(const a of e){const e=S(a,t,r,n,i),c={termType:"BlankNode",value:t.getId()};r.push({subject:p,predicate:o,object:e,graph:n}),r.push({subject:p,predicate:s,object:c,graph:n}),p=c}if(c){const e=S(c,t,r,n,i);r.push({subject:p,predicate:o,object:e,graph:n}),r.push({subject:p,predicate:s,object:a,graph:n})}return h}(e["@list"],t,r,n,i);c.termType=o.termType,c.value=o.value}else{const t=a.isObject(e)?e["@id"]:e;c.termType=t.startsWith("_:")?"BlankNode":"NamedNode",c.value=t}return"NamedNode"!==c.termType||w(c.value)?c:null}e.exports=b,b.toRDF=(e,t)=>{const r=new c.IdentifierIssuer("_:b"),i={"@default":{}};n(e,i,"@default",r);const o=[],s=Object.keys(i).sort();for(const e of s){let n;if("@default"===e)n={termType:"DefaultGraph",value:""};else{if(!w(e))continue;n=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},n.value=e}_(o,i[e],n,r,t)}return o}},832:e=>{"use strict";const t={};e.exports=t,t.isArray=Array.isArray,t.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),t.isDouble=e=>t.isNumber(e)&&(-1!==String(e).indexOf(".")||Math.abs(e)>=1e21),t.isEmptyObject=e=>t.isObject(e)&&0===Object.keys(e).length,t.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),t.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),t.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),t.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),t.isUndefined=e=>void 0===e},2278:(e,t,r)=>{"use strict";const n=r(832),i={};e.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=(e,t)=>{const r={},n=i.parsers[t||"full"],o=n.regex.exec(e);let s=n.keys.length;for(;s--;)r[n.keys[s]]=void 0===o[s]?null:o[s];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=i.removeDotSegments(r.path),r},i.prependBase=(e,t)=>{if(null===e)return t;if(i.isAbsolute(t))return t;e&&!n.isString(e)||(e=i.parse(e||""));const r=i.parse(t),o={protocol:e.protocol||""};if(null!==r.authority)o.authority=r.authority,o.path=r.path,o.query=r.query;else if(o.authority=e.authority,""===r.path)o.path=e.path,null!==r.query?o.query=r.query:o.query=e.query;else{if(0===r.path.indexOf("/"))o.path=r.path;else{let t=e.path;t=t.substr(0,t.lastIndexOf("/")+1),(t.length>0||e.authority)&&"/"!==t.substr(-1)&&(t+="/"),t+=r.path,o.path=t}o.query=r.query}""!==r.path&&(o.path=i.removeDotSegments(o.path));let s=o.protocol;return null!==o.authority&&(s+="//"+o.authority),s+=o.path,null!==o.query&&(s+="?"+o.query),null!==r.fragment&&(s+="#"+r.fragment),""===s&&(s="./"),s},i.removeBase=(e,t)=>{if(null===e)return t;e&&!n.isString(e)||(e=i.parse(e||""));let r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;const o=i.parse(t.substr(r.length)),s=e.normalizedPath.split("/"),a=o.normalizedPath.split("/"),c=o.fragment||o.query?0:1;for(;s.length>0&&a.length>c&&s[0]===a[0];)s.shift(),a.shift();let u="";if(s.length>0){s.pop();for(let e=0;e<s.length;++e)u+="../"}return u+=a.join("/"),null!==o.query&&(u+="?"+o.query),null!==o.fragment&&(u+="#"+o.fragment),""===u&&(u="./"),u},i.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),r=[];for(;t.length>0;){const e=t.shift(),n=0===t.length;"."!==e?".."!==e?r.push(e):(r.pop(),n&&r.push("")):n&&r.push("")}return"/"===e[0]&&r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0]?"/":r.join("/")};const o=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;i.isAbsolute=e=>n.isString(e)&&o.test(e),i.isRelative=e=>n.isString(e)},1055:(e,t,r)=>{"use strict";const n=r(8463),i=r(832),o=r(7055).IdentifierIssuer,s=r(4093),a=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,c=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,u=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,l="application/ld+json, application/json",d={};function h(e,t){if(i.isArray(t))for(let r=0;r<t.length;++r)t[r]=h(e,t[r]);else if(n.isList(t))t["@list"]=h(e,t["@list"]);else if(i.isObject(t)){n.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const r=Object.keys(t).sort();for(let n=0;n<r.length;++n){const i=r[n];"@id"!==i&&(t[i]=h(e,t[i]))}}return t}e.exports=d,d.IdentifierIssuer=o,d.clone=function(e){if(e&&"object"==typeof e){let t;if(i.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=d.clone(e[r])}else if(e instanceof Map){t=new Map;for(const[r,n]of e)t.set(r,d.clone(n))}else if(e instanceof Set){t=new Set;for(const r of e)t.add(d.clone(r))}else if(i.isObject(e)){t={};for(const r in e)t[r]=d.clone(e[r])}else t=e.toString();return t}return e},d.asArray=function(e){return Array.isArray(e)?e:[e]},d.buildHeaders=(e={})=>{if(Object.keys(e).some((e=>"accept"===e.toLowerCase())))throw new RangeError('Accept header may not be specified; only "'+l+'" is supported.');return Object.assign({Accept:l},e)},d.parseLinkHeader=e=>{const t={},r=e.match(a);for(let e=0;e<r.length;++e){let n=r[e].match(c);if(!n)continue;const i={target:n[1]},o=n[2];for(;n=u.exec(o);)i[n[1]]=void 0===n[2]?n[3]:n[2];const s=i.rel||"";Array.isArray(t[s])?t[s].push(i):t.hasOwnProperty(s)?t[s]=[t[s],i]:t[s]=i}return t},d.validateTypeValue=(e,t)=>{if(!(i.isString(e)||i.isArray(e)&&e.every((e=>i.isString(e))))){if(t&&i.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&d.asArray(e["@default"]).every((e=>i.isString(e))))return}throw new s('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},d.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const r=e[t];return!i.isArray(r)||r.length>0}return!1},d.hasValue=(e,t,r)=>{if(d.hasProperty(e,t)){let o=e[t];const s=n.isList(o);if(i.isArray(o)||s){s&&(o=o["@list"]);for(let e=0;e<o.length;++e)if(d.compareValues(r,o[e]))return!0}else if(!i.isArray(r))return d.compareValues(r,o)}return!1},d.addValue=(e,t,r,n)=>{if("propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1),"valueIsArray"in n||(n.valueIsArray=!1),"allowDuplicate"in n||(n.allowDuplicate=!0),"prependValue"in n||(n.prependValue=!1),n.valueIsArray)e[t]=r;else if(i.isArray(r)){0===r.length&&n.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),n.prependValue&&(r=r.concat(e[t]),e[t]=[]);for(let i=0;i<r.length;++i)d.addValue(e,t,r[i],n)}else if(e.hasOwnProperty(t)){const o=!n.allowDuplicate&&d.hasValue(e,t,r);i.isArray(e[t])||o&&!n.propertyIsArray||(e[t]=[e[t]]),o||(n.prependValue?e[t].unshift(r):e[t].push(r))}else e[t]=n.propertyIsArray?[r]:r},d.getValues=(e,t)=>[].concat(e[t]||[]),d.removeProperty=(e,t)=>{delete e[t]},d.removeValue=(e,t,r,n)=>{"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);const i=d.getValues(e,t).filter((e=>!d.compareValues(e,r)));0===i.length?d.removeProperty(e,t):1!==i.length||n.propertyIsArray?e[t]=i:e[t]=i[0]},d.relabelBlankNodes=(e,t)=>h((t=t||{}).issuer||new o("_:b"),e),d.compareValues=(e,t)=>e===t||!(!n.isValue(e)||!n.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(i.isObject(e)&&"@id"in e&&i.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"],d.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1},6486:function(e,t,r){var n;e=r.nmd(e),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",c=32,u=128,l=1/0,d=9007199254740991,h=NaN,p=4294967295,f=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],g="[object Arguments]",y="[object Array]",m="[object Boolean]",v="[object Date]",w="[object Error]",b="[object Function]",_="[object GeneratorFunction]",S="[object Map]",E="[object Number]",x="[object Object]",I="[object Promise]",A="[object RegExp]",k="[object Set]",F="[object String]",T="[object Symbol]",R="[object WeakMap]",C="[object ArrayBuffer]",P="[object DataView]",O="[object Float32Array]",j="[object Float64Array]",N="[object Int8Array]",D="[object Int16Array]",L="[object Int32Array]",U="[object Uint8Array]",B="[object Uint8ClampedArray]",M="[object Uint16Array]",H="[object Uint32Array]",K=/\b__p \+= '';/g,q=/\b(__p \+=) '' \+/g,V=/(__e\(.*?\)|\b__t\)) \+\n'';/g,J=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,$=RegExp(J.source),z=RegExp(W.source),G=/<%-([\s\S]+?)%>/g,Y=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,re=RegExp(te.source),ne=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,ae=/,? & /,ce=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ue=/[()=,{}\[\]\/\s]/,le=/\\(\\)?/g,de=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,he=/\w*$/,pe=/^[-+]0x[0-9a-f]+$/i,fe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,ye=/^0o[0-7]+$/i,me=/^(?:0|[1-9]\d*)$/,ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,we=/($^)/,be=/['\n\r\u2028\u2029\\]/g,_e="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Se="a-z\\xdf-\\xf6\\xf8-\\xff",Ee="A-Z\\xc0-\\xd6\\xd8-\\xde",xe="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ie="["+xe+"]",Ae="["+_e+"]",ke="\\d+",Fe="["+Se+"]",Te="[^\\ud800-\\udfff"+xe+ke+"\\u2700-\\u27bf"+Se+Ee+"]",Re="\\ud83c[\\udffb-\\udfff]",Ce="[^\\ud800-\\udfff]",Pe="(?:\\ud83c[\\udde6-\\uddff]){2}",Oe="[\\ud800-\\udbff][\\udc00-\\udfff]",je="["+Ee+"]",Ne="(?:"+Fe+"|"+Te+")",De="(?:"+je+"|"+Te+")",Le="(?:['’](?:d|ll|m|re|s|t|ve))?",Ue="(?:['’](?:D|LL|M|RE|S|T|VE))?",Be="(?:"+Ae+"|"+Re+")?",Me="[\\ufe0e\\ufe0f]?",He=Me+Be+"(?:\\u200d(?:"+[Ce,Pe,Oe].join("|")+")"+Me+Be+")*",Ke="(?:"+["[\\u2700-\\u27bf]",Pe,Oe].join("|")+")"+He,qe="(?:"+[Ce+Ae+"?",Ae,Pe,Oe,"[\\ud800-\\udfff]"].join("|")+")",Ve=RegExp("['’]","g"),Je=RegExp(Ae,"g"),We=RegExp(Re+"(?="+Re+")|"+qe+He,"g"),$e=RegExp([je+"?"+Fe+"+"+Le+"(?="+[Ie,je,"$"].join("|")+")",De+"+"+Ue+"(?="+[Ie,je+Ne,"$"].join("|")+")",je+"?"+Ne+"+"+Le,je+"+"+Ue,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ke,Ke].join("|"),"g"),ze=RegExp("[\\u200d\\ud800-\\udfff"+_e+"\\ufe0e\\ufe0f]"),Ge=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ye=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qe=-1,Xe={};Xe[O]=Xe[j]=Xe[N]=Xe[D]=Xe[L]=Xe[U]=Xe[B]=Xe[M]=Xe[H]=!0,Xe[g]=Xe[y]=Xe[C]=Xe[m]=Xe[P]=Xe[v]=Xe[w]=Xe[b]=Xe[S]=Xe[E]=Xe[x]=Xe[A]=Xe[k]=Xe[F]=Xe[R]=!1;var Ze={};Ze[g]=Ze[y]=Ze[C]=Ze[P]=Ze[m]=Ze[v]=Ze[O]=Ze[j]=Ze[N]=Ze[D]=Ze[L]=Ze[S]=Ze[E]=Ze[x]=Ze[A]=Ze[k]=Ze[F]=Ze[T]=Ze[U]=Ze[B]=Ze[M]=Ze[H]=!0,Ze[w]=Ze[b]=Ze[R]=!1;var et={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},tt=parseFloat,rt=parseInt,nt="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,it="object"==typeof self&&self&&self.Object===Object&&self,ot=nt||it||Function("return this")(),st=t&&!t.nodeType&&t,at=st&&e&&!e.nodeType&&e,ct=at&&at.exports===st,ut=ct&&nt.process,lt=function(){try{return at&&at.require&&at.require("util").types||ut&&ut.binding&&ut.binding("util")}catch(e){}}(),dt=lt&&lt.isArrayBuffer,ht=lt&&lt.isDate,pt=lt&&lt.isMap,ft=lt&&lt.isRegExp,gt=lt&&lt.isSet,yt=lt&&lt.isTypedArray;function mt(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function vt(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n}function wt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}function bt(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e}function _t(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}function St(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}function Et(e,t){return!(null==e||!e.length)&&Ot(e,t,0)>-1}function xt(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}function It(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}function At(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}function kt(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}function Ft(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r}function Tt(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Rt=Lt("length");function Ct(e,t,r){var n;return r(e,(function(e,r,i){if(t(e,r,i))return n=r,!1})),n}function Pt(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function Ot(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):Pt(e,Nt,r)}function jt(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1}function Nt(e){return e!=e}function Dt(e,t){var r=null==e?0:e.length;return r?Mt(e,t)/r:h}function Lt(e){return function(t){return null==t?i:t[e]}}function Ut(e){return function(t){return null==e?i:e[t]}}function Bt(e,t,r,n,i){return i(e,(function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)})),r}function Mt(e,t){for(var r,n=-1,o=e.length;++n<o;){var s=t(e[n]);s!==i&&(r=r===i?s:r+s)}return r}function Ht(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}function Kt(e){return e?e.slice(0,sr(e)+1).replace(ne,""):e}function qt(e){return function(t){return e(t)}}function Vt(e,t){return It(t,(function(t){return e[t]}))}function Jt(e,t){return e.has(t)}function Wt(e,t){for(var r=-1,n=e.length;++r<n&&Ot(t,e[r],0)>-1;);return r}function $t(e,t){for(var r=e.length;r--&&Ot(t,e[r],0)>-1;);return r}function zt(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}var Gt=Ut({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),Yt=Ut({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Qt(e){return"\\"+et[e]}function Xt(e){return ze.test(e)}function Zt(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function er(e,t){return function(r){return e(t(r))}}function tr(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r];s!==t&&s!==a||(e[r]=a,o[i++]=r)}return o}function rr(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}function nr(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=[e,e]})),r}function ir(e){return Xt(e)?function(e){for(var t=We.lastIndex=0;We.test(e);)++t;return t}(e):Rt(e)}function or(e){return Xt(e)?function(e){return e.match(We)||[]}(e):function(e){return e.split("")}(e)}function sr(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var ar=Ut({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),cr=function e(t){var r,n=(t=null==t?ot:cr.defaults(ot.Object(),t,cr.pick(ot,Ye))).Array,ie=t.Date,_e=t.Error,Se=t.Function,Ee=t.Math,xe=t.Object,Ie=t.RegExp,Ae=t.String,ke=t.TypeError,Fe=n.prototype,Te=Se.prototype,Re=xe.prototype,Ce=t["__core-js_shared__"],Pe=Te.toString,Oe=Re.hasOwnProperty,je=0,Ne=(r=/[^.]+$/.exec(Ce&&Ce.keys&&Ce.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",De=Re.toString,Le=Pe.call(xe),Ue=ot._,Be=Ie("^"+Pe.call(Oe).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Me=ct?t.Buffer:i,He=t.Symbol,Ke=t.Uint8Array,qe=Me?Me.allocUnsafe:i,We=er(xe.getPrototypeOf,xe),ze=xe.create,et=Re.propertyIsEnumerable,nt=Fe.splice,it=He?He.isConcatSpreadable:i,st=He?He.iterator:i,at=He?He.toStringTag:i,ut=function(){try{var e=uo(xe,"defineProperty");return e({},"",{}),e}catch(e){}}(),lt=t.clearTimeout!==ot.clearTimeout&&t.clearTimeout,Rt=ie&&ie.now!==ot.Date.now&&ie.now,Ut=t.setTimeout!==ot.setTimeout&&t.setTimeout,ur=Ee.ceil,lr=Ee.floor,dr=xe.getOwnPropertySymbols,hr=Me?Me.isBuffer:i,pr=t.isFinite,fr=Fe.join,gr=er(xe.keys,xe),yr=Ee.max,mr=Ee.min,vr=ie.now,wr=t.parseInt,br=Ee.random,_r=Fe.reverse,Sr=uo(t,"DataView"),Er=uo(t,"Map"),xr=uo(t,"Promise"),Ir=uo(t,"Set"),Ar=uo(t,"WeakMap"),kr=uo(xe,"create"),Fr=Ar&&new Ar,Tr={},Rr=Bo(Sr),Cr=Bo(Er),Pr=Bo(xr),Or=Bo(Ir),jr=Bo(Ar),Nr=He?He.prototype:i,Dr=Nr?Nr.valueOf:i,Lr=Nr?Nr.toString:i;function Ur(e){if(ra(e)&&!Js(e)&&!(e instanceof Kr)){if(e instanceof Hr)return e;if(Oe.call(e,"__wrapped__"))return Mo(e)}return new Hr(e)}var Br=function(){function e(){}return function(t){if(!ta(t))return{};if(ze)return ze(t);e.prototype=t;var r=new e;return e.prototype=i,r}}();function Mr(){}function Hr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Kr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function qr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Vr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Jr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Wr(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Jr;++t<r;)this.add(e[t])}function $r(e){var t=this.__data__=new Vr(e);this.size=t.size}function zr(e,t){var r=Js(e),n=!r&&Vs(e),i=!r&&!n&&Gs(e),o=!r&&!n&&!i&&la(e),s=r||n||i||o,a=s?Ht(e.length,Ae):[],c=a.length;for(var u in e)!t&&!Oe.call(e,u)||s&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||mo(u,c))||a.push(u);return a}function Gr(e){var t=e.length;return t?e[Wn(0,t-1)]:i}function Yr(e,t){return jo(ki(e),sn(t,0,e.length))}function Qr(e){return jo(ki(e))}function Xr(e,t,r){(r!==i&&!Hs(e[t],r)||r===i&&!(t in e))&&nn(e,t,r)}function Zr(e,t,r){var n=e[t];Oe.call(e,t)&&Hs(n,r)&&(r!==i||t in e)||nn(e,t,r)}function en(e,t){for(var r=e.length;r--;)if(Hs(e[r][0],t))return r;return-1}function tn(e,t,r,n){return dn(e,(function(e,i,o){t(n,e,r(e),o)})),n}function rn(e,t){return e&&Fi(t,Pa(t),e)}function nn(e,t,r){"__proto__"==t&&ut?ut(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function on(e,t){for(var r=-1,o=t.length,s=n(o),a=null==e;++r<o;)s[r]=a?i:ka(e,t[r]);return s}function sn(e,t,r){return e==e&&(r!==i&&(e=e<=r?e:r),t!==i&&(e=e>=t?e:t)),e}function an(e,t,r,n,o,s){var a,c=1&t,u=2&t,l=4&t;if(r&&(a=o?r(e,n,o,s):r(e)),a!==i)return a;if(!ta(e))return e;var d=Js(e);if(d){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Oe.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!c)return ki(e,a)}else{var h=po(e),p=h==b||h==_;if(Gs(e))return _i(e,c);if(h==x||h==g||p&&!o){if(a=u||p?{}:go(e),!c)return u?function(e,t){return Fi(e,ho(e),t)}(e,function(e,t){return e&&Fi(t,Oa(t),e)}(a,e)):function(e,t){return Fi(e,lo(e),t)}(e,rn(a,e))}else{if(!Ze[h])return o?e:{};a=function(e,t,r){var n,i=e.constructor;switch(t){case C:return Si(e);case m:case v:return new i(+e);case P:return function(e,t){var r=t?Si(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case O:case j:case N:case D:case L:case U:case B:case M:case H:return Ei(e,r);case S:return new i;case E:case F:return new i(e);case A:return function(e){var t=new e.constructor(e.source,he.exec(e));return t.lastIndex=e.lastIndex,t}(e);case k:return new i;case T:return n=e,Dr?xe(Dr.call(n)):{}}}(e,h,c)}}s||(s=new $r);var f=s.get(e);if(f)return f;s.set(e,a),aa(e)?e.forEach((function(n){a.add(an(n,t,r,n,e,s))})):na(e)&&e.forEach((function(n,i){a.set(i,an(n,t,r,i,e,s))}));var y=d?i:(l?u?ro:to:u?Oa:Pa)(e);return wt(y||e,(function(n,i){y&&(n=e[i=n]),Zr(a,i,an(n,t,r,i,e,s))})),a}function cn(e,t,r){var n=r.length;if(null==e)return!n;for(e=xe(e);n--;){var o=r[n],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function un(e,t,r){if("function"!=typeof e)throw new ke(o);return Ro((function(){e.apply(i,r)}),t)}function ln(e,t,r,n){var i=-1,o=Et,s=!0,a=e.length,c=[],u=t.length;if(!a)return c;r&&(t=It(t,qt(r))),n?(o=xt,s=!1):t.length>=200&&(o=Jt,s=!1,t=new Wr(t));e:for(;++i<a;){var l=e[i],d=null==r?l:r(l);if(l=n||0!==l?l:0,s&&d==d){for(var h=u;h--;)if(t[h]===d)continue e;c.push(l)}else o(t,d,n)||c.push(l)}return c}Ur.templateSettings={escape:G,evaluate:Y,interpolate:Q,variable:"",imports:{_:Ur}},Ur.prototype=Mr.prototype,Ur.prototype.constructor=Ur,Hr.prototype=Br(Mr.prototype),Hr.prototype.constructor=Hr,Kr.prototype=Br(Mr.prototype),Kr.prototype.constructor=Kr,qr.prototype.clear=function(){this.__data__=kr?kr(null):{},this.size=0},qr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},qr.prototype.get=function(e){var t=this.__data__;if(kr){var r=t[e];return r===s?i:r}return Oe.call(t,e)?t[e]:i},qr.prototype.has=function(e){var t=this.__data__;return kr?t[e]!==i:Oe.call(t,e)},qr.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=kr&&t===i?s:t,this},Vr.prototype.clear=function(){this.__data__=[],this.size=0},Vr.prototype.delete=function(e){var t=this.__data__,r=en(t,e);return!(r<0||(r==t.length-1?t.pop():nt.call(t,r,1),--this.size,0))},Vr.prototype.get=function(e){var t=this.__data__,r=en(t,e);return r<0?i:t[r][1]},Vr.prototype.has=function(e){return en(this.__data__,e)>-1},Vr.prototype.set=function(e,t){var r=this.__data__,n=en(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},Jr.prototype.clear=function(){this.size=0,this.__data__={hash:new qr,map:new(Er||Vr),string:new qr}},Jr.prototype.delete=function(e){var t=ao(this,e).delete(e);return this.size-=t?1:0,t},Jr.prototype.get=function(e){return ao(this,e).get(e)},Jr.prototype.has=function(e){return ao(this,e).has(e)},Jr.prototype.set=function(e,t){var r=ao(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Wr.prototype.add=Wr.prototype.push=function(e){return this.__data__.set(e,s),this},Wr.prototype.has=function(e){return this.__data__.has(e)},$r.prototype.clear=function(){this.__data__=new Vr,this.size=0},$r.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},$r.prototype.get=function(e){return this.__data__.get(e)},$r.prototype.has=function(e){return this.__data__.has(e)},$r.prototype.set=function(e,t){var r=this.__data__;if(r instanceof Vr){var n=r.__data__;if(!Er||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Jr(n)}return r.set(e,t),this.size=r.size,this};var dn=Ci(wn),hn=Ci(bn,!0);function pn(e,t){var r=!0;return dn(e,(function(e,n,i){return r=!!t(e,n,i)})),r}function fn(e,t,r){for(var n=-1,o=e.length;++n<o;){var s=e[n],a=t(s);if(null!=a&&(c===i?a==a&&!ua(a):r(a,c)))var c=a,u=s}return u}function gn(e,t){var r=[];return dn(e,(function(e,n,i){t(e,n,i)&&r.push(e)})),r}function yn(e,t,r,n,i){var o=-1,s=e.length;for(r||(r=yo),i||(i=[]);++o<s;){var a=e[o];t>0&&r(a)?t>1?yn(a,t-1,r,n,i):At(i,a):n||(i[i.length]=a)}return i}var mn=Pi(),vn=Pi(!0);function wn(e,t){return e&&mn(e,t,Pa)}function bn(e,t){return e&&vn(e,t,Pa)}function _n(e,t){return St(t,(function(t){return Xs(e[t])}))}function Sn(e,t){for(var r=0,n=(t=mi(t,e)).length;null!=e&&r<n;)e=e[Uo(t[r++])];return r&&r==n?e:i}function En(e,t,r){var n=t(e);return Js(e)?n:At(n,r(e))}function xn(e){return null==e?e===i?"[object Undefined]":"[object Null]":at&&at in xe(e)?function(e){var t=Oe.call(e,at),r=e[at];try{e[at]=i;var n=!0}catch(e){}var o=De.call(e);return n&&(t?e[at]=r:delete e[at]),o}(e):function(e){return De.call(e)}(e)}function In(e,t){return e>t}function An(e,t){return null!=e&&Oe.call(e,t)}function kn(e,t){return null!=e&&t in xe(e)}function Fn(e,t,r){for(var o=r?xt:Et,s=e[0].length,a=e.length,c=a,u=n(a),l=1/0,d=[];c--;){var h=e[c];c&&t&&(h=It(h,qt(t))),l=mr(h.length,l),u[c]=!r&&(t||s>=120&&h.length>=120)?new Wr(c&&h):i}h=e[0];var p=-1,f=u[0];e:for(;++p<s&&d.length<l;){var g=h[p],y=t?t(g):g;if(g=r||0!==g?g:0,!(f?Jt(f,y):o(d,y,r))){for(c=a;--c;){var m=u[c];if(!(m?Jt(m,y):o(e[c],y,r)))continue e}f&&f.push(y),d.push(g)}}return d}function Tn(e,t,r){var n=null==(e=Ao(e,t=mi(t,e)))?e:e[Uo(Qo(t))];return null==n?i:mt(n,e,r)}function Rn(e){return ra(e)&&xn(e)==g}function Cn(e,t,r,n,o){return e===t||(null==e||null==t||!ra(e)&&!ra(t)?e!=e&&t!=t:function(e,t,r,n,o,s){var a=Js(e),c=Js(t),u=a?y:po(e),l=c?y:po(t),d=(u=u==g?x:u)==x,h=(l=l==g?x:l)==x,p=u==l;if(p&&Gs(e)){if(!Gs(t))return!1;a=!0,d=!1}if(p&&!d)return s||(s=new $r),a||la(e)?Zi(e,t,r,n,o,s):function(e,t,r,n,i,o,s){switch(r){case P:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case C:return!(e.byteLength!=t.byteLength||!o(new Ke(e),new Ke(t)));case m:case v:case E:return Hs(+e,+t);case w:return e.name==t.name&&e.message==t.message;case A:case F:return e==t+"";case S:var a=Zt;case k:var c=1&n;if(a||(a=rr),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;n|=2,s.set(e,t);var l=Zi(a(e),a(t),n,i,o,s);return s.delete(e),l;case T:if(Dr)return Dr.call(e)==Dr.call(t)}return!1}(e,t,u,r,n,o,s);if(!(1&r)){var f=d&&Oe.call(e,"__wrapped__"),b=h&&Oe.call(t,"__wrapped__");if(f||b){var _=f?e.value():e,I=b?t.value():t;return s||(s=new $r),o(_,I,r,n,s)}}return!!p&&(s||(s=new $r),function(e,t,r,n,o,s){var a=1&r,c=to(e),u=c.length;if(u!=to(t).length&&!a)return!1;for(var l=u;l--;){var d=c[l];if(!(a?d in t:Oe.call(t,d)))return!1}var h=s.get(e),p=s.get(t);if(h&&p)return h==t&&p==e;var f=!0;s.set(e,t),s.set(t,e);for(var g=a;++l<u;){var y=e[d=c[l]],m=t[d];if(n)var v=a?n(m,y,d,t,e,s):n(y,m,d,e,t,s);if(!(v===i?y===m||o(y,m,r,n,s):v)){f=!1;break}g||(g="constructor"==d)}if(f&&!g){var w=e.constructor,b=t.constructor;w==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(f=!1)}return s.delete(e),s.delete(t),f}(e,t,r,n,o,s))}(e,t,r,n,Cn,o))}function Pn(e,t,r,n){var o=r.length,s=o,a=!n;if(null==e)return!s;for(e=xe(e);o--;){var c=r[o];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<s;){var u=(c=r[o])[0],l=e[u],d=c[1];if(a&&c[2]){if(l===i&&!(u in e))return!1}else{var h=new $r;if(n)var p=n(l,d,u,e,t,h);if(!(p===i?Cn(d,l,3,n,h):p))return!1}}return!0}function On(e){return!(!ta(e)||(t=e,Ne&&Ne in t))&&(Xs(e)?Be:ge).test(Bo(e));var t}function jn(e){return"function"==typeof e?e:null==e?ic:"object"==typeof e?Js(e)?Bn(e[0],e[1]):Un(e):pc(e)}function Nn(e){if(!So(e))return gr(e);var t=[];for(var r in xe(e))Oe.call(e,r)&&"constructor"!=r&&t.push(r);return t}function Dn(e,t){return e<t}function Ln(e,t){var r=-1,i=$s(e)?n(e.length):[];return dn(e,(function(e,n,o){i[++r]=t(e,n,o)})),i}function Un(e){var t=co(e);return 1==t.length&&t[0][2]?xo(t[0][0],t[0][1]):function(r){return r===e||Pn(r,e,t)}}function Bn(e,t){return wo(e)&&Eo(t)?xo(Uo(e),t):function(r){var n=ka(r,e);return n===i&&n===t?Fa(r,e):Cn(t,n,3)}}function Mn(e,t,r,n,o){e!==t&&mn(t,(function(s,a){if(o||(o=new $r),ta(s))!function(e,t,r,n,o,s,a){var c=Fo(e,r),u=Fo(t,r),l=a.get(u);if(l)Xr(e,r,l);else{var d=s?s(c,u,r+"",e,t,a):i,h=d===i;if(h){var p=Js(u),f=!p&&Gs(u),g=!p&&!f&&la(u);d=u,p||f||g?Js(c)?d=c:zs(c)?d=ki(c):f?(h=!1,d=_i(u,!0)):g?(h=!1,d=Ei(u,!0)):d=[]:oa(u)||Vs(u)?(d=c,Vs(c)?d=va(c):ta(c)&&!Xs(c)||(d=go(u))):h=!1}h&&(a.set(u,d),o(d,u,n,s,a),a.delete(u)),Xr(e,r,d)}}(e,t,a,r,Mn,n,o);else{var c=n?n(Fo(e,a),s,a+"",e,t,o):i;c===i&&(c=s),Xr(e,a,c)}}),Oa)}function Hn(e,t){var r=e.length;if(r)return mo(t+=t<0?r:0,r)?e[t]:i}function Kn(e,t,r){t=t.length?It(t,(function(e){return Js(e)?function(t){return Sn(t,1===e.length?e[0]:e)}:e})):[ic];var n=-1;t=It(t,qt(so()));var i=Ln(e,(function(e,r,i){var o=It(t,(function(t){return t(e)}));return{criteria:o,index:++n,value:e}}));return function(e,t){var n=e.length;for(e.sort((function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,s=i.length,a=r.length;++n<s;){var c=xi(i[n],o[n]);if(c)return n>=a?c:c*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)}));n--;)e[n]=e[n].value;return e}(i)}function qn(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=Sn(e,s);r(a,s)&&Qn(o,mi(s,e),a)}return o}function Vn(e,t,r,n){var i=n?jt:Ot,o=-1,s=t.length,a=e;for(e===t&&(t=ki(t)),r&&(a=It(e,qt(r)));++o<s;)for(var c=0,u=t[o],l=r?r(u):u;(c=i(a,l,c,n))>-1;)a!==e&&nt.call(a,c,1),nt.call(e,c,1);return e}function Jn(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;mo(i)?nt.call(e,i,1):ui(e,i)}}return e}function Wn(e,t){return e+lr(br()*(t-e+1))}function $n(e,t){var r="";if(!e||t<1||t>d)return r;do{t%2&&(r+=e),(t=lr(t/2))&&(e+=e)}while(t);return r}function zn(e,t){return Co(Io(e,t,ic),e+"")}function Gn(e){return Gr(Ha(e))}function Yn(e,t){var r=Ha(e);return jo(r,sn(t,0,r.length))}function Qn(e,t,r,n){if(!ta(e))return e;for(var o=-1,s=(t=mi(t,e)).length,a=s-1,c=e;null!=c&&++o<s;){var u=Uo(t[o]),l=r;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(o!=a){var d=c[u];(l=n?n(d,u,c):i)===i&&(l=ta(d)?d:mo(t[o+1])?[]:{})}Zr(c,u,l),c=c[u]}return e}var Xn=Fr?function(e,t){return Fr.set(e,t),e}:ic,Zn=ut?function(e,t){return ut(e,"toString",{configurable:!0,enumerable:!1,value:tc(t),writable:!0})}:ic;function ei(e){return jo(Ha(e))}function ti(e,t,r){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var s=n(o);++i<o;)s[i]=e[i+t];return s}function ri(e,t){var r;return dn(e,(function(e,n,i){return!(r=t(e,n,i))})),!!r}function ni(e,t,r){var n=0,i=null==e?n:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;n<i;){var o=n+i>>>1,s=e[o];null!==s&&!ua(s)&&(r?s<=t:s<t)?n=o+1:i=o}return i}return ii(e,t,ic,r)}function ii(e,t,r,n){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=r(t))!=t,c=null===t,u=ua(t),l=t===i;o<s;){var d=lr((o+s)/2),h=r(e[d]),p=h!==i,f=null===h,g=h==h,y=ua(h);if(a)var m=n||g;else m=l?g&&(n||p):c?g&&p&&(n||!f):u?g&&p&&!f&&(n||!y):!f&&!y&&(n?h<=t:h<t);m?o=d+1:s=d}return mr(s,4294967294)}function oi(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r],a=t?t(s):s;if(!r||!Hs(a,c)){var c=a;o[i++]=0===s?0:s}}return o}function si(e){return"number"==typeof e?e:ua(e)?h:+e}function ai(e){if("string"==typeof e)return e;if(Js(e))return It(e,ai)+"";if(ua(e))return Lr?Lr.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ci(e,t,r){var n=-1,i=Et,o=e.length,s=!0,a=[],c=a;if(r)s=!1,i=xt;else if(o>=200){var u=t?null:$i(e);if(u)return rr(u);s=!1,i=Jt,c=new Wr}else c=t?[]:a;e:for(;++n<o;){var l=e[n],d=t?t(l):l;if(l=r||0!==l?l:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),a.push(l)}else i(c,d,r)||(c!==a&&c.push(d),a.push(l))}return a}function ui(e,t){return null==(e=Ao(e,t=mi(t,e)))||delete e[Uo(Qo(t))]}function li(e,t,r,n){return Qn(e,t,r(Sn(e,t)),n)}function di(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?ti(e,n?0:o,n?o+1:i):ti(e,n?o+1:0,n?i:o)}function hi(e,t){var r=e;return r instanceof Kr&&(r=r.value()),kt(t,(function(e,t){return t.func.apply(t.thisArg,At([e],t.args))}),r)}function pi(e,t,r){var i=e.length;if(i<2)return i?ci(e[0]):[];for(var o=-1,s=n(i);++o<i;)for(var a=e[o],c=-1;++c<i;)c!=o&&(s[o]=ln(s[o]||a,e[c],t,r));return ci(yn(s,1),t,r)}function fi(e,t,r){for(var n=-1,o=e.length,s=t.length,a={};++n<o;){var c=n<s?t[n]:i;r(a,e[n],c)}return a}function gi(e){return zs(e)?e:[]}function yi(e){return"function"==typeof e?e:ic}function mi(e,t){return Js(e)?e:wo(e,t)?[e]:Lo(wa(e))}var vi=zn;function wi(e,t,r){var n=e.length;return r=r===i?n:r,!t&&r>=n?e:ti(e,t,r)}var bi=lt||function(e){return ot.clearTimeout(e)};function _i(e,t){if(t)return e.slice();var r=e.length,n=qe?qe(r):new e.constructor(r);return e.copy(n),n}function Si(e){var t=new e.constructor(e.byteLength);return new Ke(t).set(new Ke(e)),t}function Ei(e,t){var r=t?Si(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function xi(e,t){if(e!==t){var r=e!==i,n=null===e,o=e==e,s=ua(e),a=t!==i,c=null===t,u=t==t,l=ua(t);if(!c&&!l&&!s&&e>t||s&&a&&u&&!c&&!l||n&&a&&u||!r&&u||!o)return 1;if(!n&&!s&&!l&&e<t||l&&r&&o&&!n&&!s||c&&r&&o||!a&&o||!u)return-1}return 0}function Ii(e,t,r,i){for(var o=-1,s=e.length,a=r.length,c=-1,u=t.length,l=yr(s-a,0),d=n(u+l),h=!i;++c<u;)d[c]=t[c];for(;++o<a;)(h||o<s)&&(d[r[o]]=e[o]);for(;l--;)d[c++]=e[o++];return d}function Ai(e,t,r,i){for(var o=-1,s=e.length,a=-1,c=r.length,u=-1,l=t.length,d=yr(s-c,0),h=n(d+l),p=!i;++o<d;)h[o]=e[o];for(var f=o;++u<l;)h[f+u]=t[u];for(;++a<c;)(p||o<s)&&(h[f+r[a]]=e[o++]);return h}function ki(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function Fi(e,t,r,n){var o=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var c=t[s],u=n?n(r[c],e[c],c,r,e):i;u===i&&(u=e[c]),o?nn(r,c,u):Zr(r,c,u)}return r}function Ti(e,t){return function(r,n){var i=Js(r)?vt:tn,o=t?t():{};return i(r,e,so(n,2),o)}}function Ri(e){return zn((function(t,r){var n=-1,o=r.length,s=o>1?r[o-1]:i,a=o>2?r[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&vo(r[0],r[1],a)&&(s=o<3?i:s,o=1),t=xe(t);++n<o;){var c=r[n];c&&e(t,c,n,s)}return t}))}function Ci(e,t){return function(r,n){if(null==r)return r;if(!$s(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=xe(r);(t?o--:++o<i)&&!1!==n(s[o],o,s););return r}}function Pi(e){return function(t,r,n){for(var i=-1,o=xe(t),s=n(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===r(o[c],c,o))break}return t}}function Oi(e){return function(t){var r=Xt(t=wa(t))?or(t):i,n=r?r[0]:t.charAt(0),o=r?wi(r,1).join(""):t.slice(1);return n[e]()+o}}function ji(e){return function(t){return kt(Xa(Va(t).replace(Ve,"")),e,"")}}function Ni(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Br(e.prototype),n=e.apply(r,t);return ta(n)?n:r}}function Di(e){return function(t,r,n){var o=xe(t);if(!$s(t)){var s=so(r,3);t=Pa(t),r=function(e){return s(o[e],e,o)}}var a=e(t,r,n);return a>-1?o[s?t[a]:a]:i}}function Li(e){return eo((function(t){var r=t.length,n=r,s=Hr.prototype.thru;for(e&&t.reverse();n--;){var a=t[n];if("function"!=typeof a)throw new ke(o);if(s&&!c&&"wrapper"==io(a))var c=new Hr([],!0)}for(n=c?n:r;++n<r;){var u=io(a=t[n]),l="wrapper"==u?no(a):i;c=l&&bo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[io(l[0])].apply(c,l[3]):1==a.length&&bo(a)?c[u]():c.thru(a)}return function(){var e=arguments,n=e[0];if(c&&1==e.length&&Js(n))return c.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}}))}function Ui(e,t,r,o,s,a,c,l,d,h){var p=t&u,f=1&t,g=2&t,y=24&t,m=512&t,v=g?i:Ni(e);return function i(){for(var u=arguments.length,w=n(u),b=u;b--;)w[b]=arguments[b];if(y)var _=oo(i),S=zt(w,_);if(o&&(w=Ii(w,o,s,y)),a&&(w=Ai(w,a,c,y)),u-=S,y&&u<h){var E=tr(w,_);return Ji(e,t,Ui,i.placeholder,r,w,E,l,d,h-u)}var x=f?r:this,I=g?x[e]:e;return u=w.length,l?w=ko(w,l):m&&u>1&&w.reverse(),p&&d<u&&(w.length=d),this&&this!==ot&&this instanceof i&&(I=v||Ni(I)),I.apply(x,w)}}function Bi(e,t){return function(r,n){return function(e,t,r,n){return wn(e,(function(e,i,o){t(n,r(e),i,o)})),n}(r,e,t(n),{})}}function Mi(e,t){return function(r,n){var o;if(r===i&&n===i)return t;if(r!==i&&(o=r),n!==i){if(o===i)return n;"string"==typeof r||"string"==typeof n?(r=ai(r),n=ai(n)):(r=si(r),n=si(n)),o=e(r,n)}return o}}function Hi(e){return eo((function(t){return t=It(t,qt(so())),zn((function(r){var n=this;return e(t,(function(e){return mt(e,n,r)}))}))}))}function Ki(e,t){var r=(t=t===i?" ":ai(t)).length;if(r<2)return r?$n(t,e):t;var n=$n(t,ur(e/ir(t)));return Xt(t)?wi(or(n),0,e).join(""):n.slice(0,e)}function qi(e){return function(t,r,o){return o&&"number"!=typeof o&&vo(t,r,o)&&(r=o=i),t=fa(t),r===i?(r=t,t=0):r=fa(r),function(e,t,r,i){for(var o=-1,s=yr(ur((t-e)/(r||1)),0),a=n(s);s--;)a[i?s:++o]=e,e+=r;return a}(t,r,o=o===i?t<r?1:-1:fa(o),e)}}function Vi(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=ma(t),r=ma(r)),e(t,r)}}function Ji(e,t,r,n,o,s,a,u,l,d){var h=8&t;t|=h?c:64,4&(t&=~(h?64:c))||(t&=-4);var p=[e,t,o,h?s:i,h?a:i,h?i:s,h?i:a,u,l,d],f=r.apply(i,p);return bo(e)&&To(f,p),f.placeholder=n,Po(f,e,t)}function Wi(e){var t=Ee[e];return function(e,r){if(e=ma(e),(r=null==r?0:mr(ga(r),292))&&pr(e)){var n=(wa(e)+"e").split("e");return+((n=(wa(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}var $i=Ir&&1/rr(new Ir([,-0]))[1]==l?function(e){return new Ir(e)}:uc;function zi(e){return function(t){var r=po(t);return r==S?Zt(t):r==k?nr(t):function(e,t){return It(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Gi(e,t,r,s,l,d,h,p){var f=2&t;if(!f&&"function"!=typeof e)throw new ke(o);var g=s?s.length:0;if(g||(t&=-97,s=l=i),h=h===i?h:yr(ga(h),0),p=p===i?p:ga(p),g-=l?l.length:0,64&t){var y=s,m=l;s=l=i}var v=f?i:no(e),w=[e,t,r,s,l,y,m,d,h,p];if(v&&function(e,t){var r=e[1],n=t[1],i=r|n,o=i<131,s=n==u&&8==r||n==u&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!o&&!s)return e;1&n&&(e[2]=t[2],i|=1&r?0:4);var c=t[3];if(c){var l=e[3];e[3]=l?Ii(l,c,t[4]):c,e[4]=l?tr(e[3],a):t[4]}(c=t[5])&&(l=e[5],e[5]=l?Ai(l,c,t[6]):c,e[6]=l?tr(e[5],a):t[6]),(c=t[7])&&(e[7]=c),n&u&&(e[8]=null==e[8]?t[8]:mr(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(w,v),e=w[0],t=w[1],r=w[2],s=w[3],l=w[4],!(p=w[9]=w[9]===i?f?0:e.length:yr(w[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||16==t?function(e,t,r){var o=Ni(e);return function s(){for(var a=arguments.length,c=n(a),u=a,l=oo(s);u--;)c[u]=arguments[u];var d=a<3&&c[0]!==l&&c[a-1]!==l?[]:tr(c,l);return(a-=d.length)<r?Ji(e,t,Ui,s.placeholder,i,c,d,i,i,r-a):mt(this&&this!==ot&&this instanceof s?o:e,this,c)}}(e,t,p):t!=c&&33!=t||l.length?Ui.apply(i,w):function(e,t,r,i){var o=1&t,s=Ni(e);return function t(){for(var a=-1,c=arguments.length,u=-1,l=i.length,d=n(l+c),h=this&&this!==ot&&this instanceof t?s:e;++u<l;)d[u]=i[u];for(;c--;)d[u++]=arguments[++a];return mt(h,o?r:this,d)}}(e,t,r,s);else var b=function(e,t,r){var n=1&t,i=Ni(e);return function t(){return(this&&this!==ot&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,t,r);return Po((v?Xn:To)(b,w),e,t)}function Yi(e,t,r,n){return e===i||Hs(e,Re[r])&&!Oe.call(n,r)?t:e}function Qi(e,t,r,n,o,s){return ta(e)&&ta(t)&&(s.set(t,e),Mn(e,t,i,Qi,s),s.delete(t)),e}function Xi(e){return oa(e)?i:e}function Zi(e,t,r,n,o,s){var a=1&r,c=e.length,u=t.length;if(c!=u&&!(a&&u>c))return!1;var l=s.get(e),d=s.get(t);if(l&&d)return l==t&&d==e;var h=-1,p=!0,f=2&r?new Wr:i;for(s.set(e,t),s.set(t,e);++h<c;){var g=e[h],y=t[h];if(n)var m=a?n(y,g,h,t,e,s):n(g,y,h,e,t,s);if(m!==i){if(m)continue;p=!1;break}if(f){if(!Tt(t,(function(e,t){if(!Jt(f,t)&&(g===e||o(g,e,r,n,s)))return f.push(t)}))){p=!1;break}}else if(g!==y&&!o(g,y,r,n,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function eo(e){return Co(Io(e,i,Wo),e+"")}function to(e){return En(e,Pa,lo)}function ro(e){return En(e,Oa,ho)}var no=Fr?function(e){return Fr.get(e)}:uc;function io(e){for(var t=e.name+"",r=Tr[t],n=Oe.call(Tr,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t}function oo(e){return(Oe.call(Ur,"placeholder")?Ur:e).placeholder}function so(){var e=Ur.iteratee||oc;return e=e===oc?jn:e,arguments.length?e(arguments[0],arguments[1]):e}function ao(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function co(e){for(var t=Pa(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Eo(i)]}return t}function uo(e,t){var r=function(e,t){return null==e?i:e[t]}(e,t);return On(r)?r:i}var lo=dr?function(e){return null==e?[]:(e=xe(e),St(dr(e),(function(t){return et.call(e,t)})))}:yc,ho=dr?function(e){for(var t=[];e;)At(t,lo(e)),e=We(e);return t}:yc,po=xn;function fo(e,t,r){for(var n=-1,i=(t=mi(t,e)).length,o=!1;++n<i;){var s=Uo(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&ea(i)&&mo(s,i)&&(Js(e)||Vs(e))}function go(e){return"function"!=typeof e.constructor||So(e)?{}:Br(We(e))}function yo(e){return Js(e)||Vs(e)||!!(it&&e&&e[it])}function mo(e,t){var r=typeof e;return!!(t=null==t?d:t)&&("number"==r||"symbol"!=r&&me.test(e))&&e>-1&&e%1==0&&e<t}function vo(e,t,r){if(!ta(r))return!1;var n=typeof t;return!!("number"==n?$s(r)&&mo(t,r.length):"string"==n&&t in r)&&Hs(r[t],e)}function wo(e,t){if(Js(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ua(e))||Z.test(e)||!X.test(e)||null!=t&&e in xe(t)}function bo(e){var t=io(e),r=Ur[t];if("function"!=typeof r||!(t in Kr.prototype))return!1;if(e===r)return!0;var n=no(r);return!!n&&e===n[0]}(Sr&&po(new Sr(new ArrayBuffer(1)))!=P||Er&&po(new Er)!=S||xr&&po(xr.resolve())!=I||Ir&&po(new Ir)!=k||Ar&&po(new Ar)!=R)&&(po=function(e){var t=xn(e),r=t==x?e.constructor:i,n=r?Bo(r):"";if(n)switch(n){case Rr:return P;case Cr:return S;case Pr:return I;case Or:return k;case jr:return R}return t});var _o=Ce?Xs:mc;function So(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Re)}function Eo(e){return e==e&&!ta(e)}function xo(e,t){return function(r){return null!=r&&r[e]===t&&(t!==i||e in xe(r))}}function Io(e,t,r){return t=yr(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=yr(i.length-t,0),a=n(s);++o<s;)a[o]=i[t+o];o=-1;for(var c=n(t+1);++o<t;)c[o]=i[o];return c[t]=r(a),mt(e,this,c)}}function Ao(e,t){return t.length<2?e:Sn(e,ti(t,0,-1))}function ko(e,t){for(var r=e.length,n=mr(t.length,r),o=ki(e);n--;){var s=t[n];e[n]=mo(s,r)?o[s]:i}return e}function Fo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var To=Oo(Xn),Ro=Ut||function(e,t){return ot.setTimeout(e,t)},Co=Oo(Zn);function Po(e,t,r){var n=t+"";return Co(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return wt(f,(function(r){var n="_."+r[0];t&r[1]&&!Et(e,n)&&e.push(n)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(ae):[]}(n),r)))}function Oo(e){var t=0,r=0;return function(){var n=vr(),o=16-(n-r);if(r=n,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function jo(e,t){var r=-1,n=e.length,o=n-1;for(t=t===i?n:t;++r<t;){var s=Wn(r,o),a=e[s];e[s]=e[r],e[r]=a}return e.length=t,e}var No,Do,Lo=(No=Ns((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,r,n,i){t.push(n?i.replace(le,"$1"):r||e)})),t}),(function(e){return 500===Do.size&&Do.clear(),e})),Do=No.cache,No);function Uo(e){if("string"==typeof e||ua(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Bo(e){if(null!=e){try{return Pe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Mo(e){if(e instanceof Kr)return e.clone();var t=new Hr(e.__wrapped__,e.__chain__);return t.__actions__=ki(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Ho=zn((function(e,t){return zs(e)?ln(e,yn(t,1,zs,!0)):[]})),Ko=zn((function(e,t){var r=Qo(t);return zs(r)&&(r=i),zs(e)?ln(e,yn(t,1,zs,!0),so(r,2)):[]})),qo=zn((function(e,t){var r=Qo(t);return zs(r)&&(r=i),zs(e)?ln(e,yn(t,1,zs,!0),i,r):[]}));function Vo(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:ga(r);return i<0&&(i=yr(n+i,0)),Pt(e,so(t,3),i)}function Jo(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n-1;return r!==i&&(o=ga(r),o=r<0?yr(n+o,0):mr(o,n-1)),Pt(e,so(t,3),o,!0)}function Wo(e){return null!=e&&e.length?yn(e,1):[]}function $o(e){return e&&e.length?e[0]:i}var zo=zn((function(e){var t=It(e,gi);return t.length&&t[0]===e[0]?Fn(t):[]})),Go=zn((function(e){var t=Qo(e),r=It(e,gi);return t===Qo(r)?t=i:r.pop(),r.length&&r[0]===e[0]?Fn(r,so(t,2)):[]})),Yo=zn((function(e){var t=Qo(e),r=It(e,gi);return(t="function"==typeof t?t:i)&&r.pop(),r.length&&r[0]===e[0]?Fn(r,i,t):[]}));function Qo(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Xo=zn(Zo);function Zo(e,t){return e&&e.length&&t&&t.length?Vn(e,t):e}var es=eo((function(e,t){var r=null==e?0:e.length,n=on(e,t);return Jn(e,It(t,(function(e){return mo(e,r)?+e:e})).sort(xi)),n}));function ts(e){return null==e?e:_r.call(e)}var rs=zn((function(e){return ci(yn(e,1,zs,!0))})),ns=zn((function(e){var t=Qo(e);return zs(t)&&(t=i),ci(yn(e,1,zs,!0),so(t,2))})),is=zn((function(e){var t=Qo(e);return t="function"==typeof t?t:i,ci(yn(e,1,zs,!0),i,t)}));function os(e){if(!e||!e.length)return[];var t=0;return e=St(e,(function(e){if(zs(e))return t=yr(e.length,t),!0})),Ht(t,(function(t){return It(e,Lt(t))}))}function ss(e,t){if(!e||!e.length)return[];var r=os(e);return null==t?r:It(r,(function(e){return mt(t,i,e)}))}var as=zn((function(e,t){return zs(e)?ln(e,t):[]})),cs=zn((function(e){return pi(St(e,zs))})),us=zn((function(e){var t=Qo(e);return zs(t)&&(t=i),pi(St(e,zs),so(t,2))})),ls=zn((function(e){var t=Qo(e);return t="function"==typeof t?t:i,pi(St(e,zs),i,t)})),ds=zn(os),hs=zn((function(e){var t=e.length,r=t>1?e[t-1]:i;return r="function"==typeof r?(e.pop(),r):i,ss(e,r)}));function ps(e){var t=Ur(e);return t.__chain__=!0,t}function fs(e,t){return t(e)}var gs=eo((function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,o=function(t){return on(t,e)};return!(t>1||this.__actions__.length)&&n instanceof Kr&&mo(r)?((n=n.slice(r,+r+(t?1:0))).__actions__.push({func:fs,args:[o],thisArg:i}),new Hr(n,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),ys=Ti((function(e,t,r){Oe.call(e,r)?++e[r]:nn(e,r,1)})),ms=Di(Vo),vs=Di(Jo);function ws(e,t){return(Js(e)?wt:dn)(e,so(t,3))}function bs(e,t){return(Js(e)?bt:hn)(e,so(t,3))}var _s=Ti((function(e,t,r){Oe.call(e,r)?e[r].push(t):nn(e,r,[t])})),Ss=zn((function(e,t,r){var i=-1,o="function"==typeof t,s=$s(e)?n(e.length):[];return dn(e,(function(e){s[++i]=o?mt(t,e,r):Tn(e,t,r)})),s})),Es=Ti((function(e,t,r){nn(e,r,t)}));function xs(e,t){return(Js(e)?It:Ln)(e,so(t,3))}var Is=Ti((function(e,t,r){e[r?0:1].push(t)}),(function(){return[[],[]]})),As=zn((function(e,t){if(null==e)return[];var r=t.length;return r>1&&vo(e,t[0],t[1])?t=[]:r>2&&vo(t[0],t[1],t[2])&&(t=[t[0]]),Kn(e,yn(t,1),[])})),ks=Rt||function(){return ot.Date.now()};function Fs(e,t,r){return t=r?i:t,t=e&&null==t?e.length:t,Gi(e,u,i,i,i,i,t)}function Ts(e,t){var r;if("function"!=typeof t)throw new ke(o);return e=ga(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=i),r}}var Rs=zn((function(e,t,r){var n=1;if(r.length){var i=tr(r,oo(Rs));n|=c}return Gi(e,n,t,r,i)})),Cs=zn((function(e,t,r){var n=3;if(r.length){var i=tr(r,oo(Cs));n|=c}return Gi(t,n,e,r,i)}));function Ps(e,t,r){var n,s,a,c,u,l,d=0,h=!1,p=!1,f=!0;if("function"!=typeof e)throw new ke(o);function g(t){var r=n,o=s;return n=s=i,d=t,c=e.apply(o,r)}function y(e){return d=e,u=Ro(v,t),h?g(e):c}function m(e){var r=e-l;return l===i||r>=t||r<0||p&&e-d>=a}function v(){var e=ks();if(m(e))return w(e);u=Ro(v,function(e){var r=t-(e-l);return p?mr(r,a-(e-d)):r}(e))}function w(e){return u=i,f&&n?g(e):(n=s=i,c)}function b(){var e=ks(),r=m(e);if(n=arguments,s=this,l=e,r){if(u===i)return y(l);if(p)return bi(u),u=Ro(v,t),g(l)}return u===i&&(u=Ro(v,t)),c}return t=ma(t)||0,ta(r)&&(h=!!r.leading,a=(p="maxWait"in r)?yr(ma(r.maxWait)||0,t):a,f="trailing"in r?!!r.trailing:f),b.cancel=function(){u!==i&&bi(u),d=0,n=l=s=u=i},b.flush=function(){return u===i?c:w(ks())},b}var Os=zn((function(e,t){return un(e,1,t)})),js=zn((function(e,t,r){return un(e,ma(t)||0,r)}));function Ns(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new ke(o);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Ns.Cache||Jr),r}function Ds(e){if("function"!=typeof e)throw new ke(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ns.Cache=Jr;var Ls=vi((function(e,t){var r=(t=1==t.length&&Js(t[0])?It(t[0],qt(so())):It(yn(t,1),qt(so()))).length;return zn((function(n){for(var i=-1,o=mr(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return mt(e,this,n)}))})),Us=zn((function(e,t){var r=tr(t,oo(Us));return Gi(e,c,i,t,r)})),Bs=zn((function(e,t){var r=tr(t,oo(Bs));return Gi(e,64,i,t,r)})),Ms=eo((function(e,t){return Gi(e,256,i,i,i,t)}));function Hs(e,t){return e===t||e!=e&&t!=t}var Ks=Vi(In),qs=Vi((function(e,t){return e>=t})),Vs=Rn(function(){return arguments}())?Rn:function(e){return ra(e)&&Oe.call(e,"callee")&&!et.call(e,"callee")},Js=n.isArray,Ws=dt?qt(dt):function(e){return ra(e)&&xn(e)==C};function $s(e){return null!=e&&ea(e.length)&&!Xs(e)}function zs(e){return ra(e)&&$s(e)}var Gs=hr||mc,Ys=ht?qt(ht):function(e){return ra(e)&&xn(e)==v};function Qs(e){if(!ra(e))return!1;var t=xn(e);return t==w||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!oa(e)}function Xs(e){if(!ta(e))return!1;var t=xn(e);return t==b||t==_||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Zs(e){return"number"==typeof e&&e==ga(e)}function ea(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=d}function ta(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ra(e){return null!=e&&"object"==typeof e}var na=pt?qt(pt):function(e){return ra(e)&&po(e)==S};function ia(e){return"number"==typeof e||ra(e)&&xn(e)==E}function oa(e){if(!ra(e)||xn(e)!=x)return!1;var t=We(e);if(null===t)return!0;var r=Oe.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Pe.call(r)==Le}var sa=ft?qt(ft):function(e){return ra(e)&&xn(e)==A},aa=gt?qt(gt):function(e){return ra(e)&&po(e)==k};function ca(e){return"string"==typeof e||!Js(e)&&ra(e)&&xn(e)==F}function ua(e){return"symbol"==typeof e||ra(e)&&xn(e)==T}var la=yt?qt(yt):function(e){return ra(e)&&ea(e.length)&&!!Xe[xn(e)]},da=Vi(Dn),ha=Vi((function(e,t){return e<=t}));function pa(e){if(!e)return[];if($s(e))return ca(e)?or(e):ki(e);if(st&&e[st])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[st]());var t=po(e);return(t==S?Zt:t==k?rr:Ha)(e)}function fa(e){return e?(e=ma(e))===l||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function ga(e){var t=fa(e),r=t%1;return t==t?r?t-r:t:0}function ya(e){return e?sn(ga(e),0,p):0}function ma(e){if("number"==typeof e)return e;if(ua(e))return h;if(ta(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ta(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Kt(e);var r=fe.test(e);return r||ye.test(e)?rt(e.slice(2),r?2:8):pe.test(e)?h:+e}function va(e){return Fi(e,Oa(e))}function wa(e){return null==e?"":ai(e)}var ba=Ri((function(e,t){if(So(t)||$s(t))Fi(t,Pa(t),e);else for(var r in t)Oe.call(t,r)&&Zr(e,r,t[r])})),_a=Ri((function(e,t){Fi(t,Oa(t),e)})),Sa=Ri((function(e,t,r,n){Fi(t,Oa(t),e,n)})),Ea=Ri((function(e,t,r,n){Fi(t,Pa(t),e,n)})),xa=eo(on),Ia=zn((function(e,t){e=xe(e);var r=-1,n=t.length,o=n>2?t[2]:i;for(o&&vo(t[0],t[1],o)&&(n=1);++r<n;)for(var s=t[r],a=Oa(s),c=-1,u=a.length;++c<u;){var l=a[c],d=e[l];(d===i||Hs(d,Re[l])&&!Oe.call(e,l))&&(e[l]=s[l])}return e})),Aa=zn((function(e){return e.push(i,Qi),mt(Na,i,e)}));function ka(e,t,r){var n=null==e?i:Sn(e,t);return n===i?r:n}function Fa(e,t){return null!=e&&fo(e,t,kn)}var Ta=Bi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),e[t]=r}),tc(ic)),Ra=Bi((function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=De.call(t)),Oe.call(e,t)?e[t].push(r):e[t]=[r]}),so),Ca=zn(Tn);function Pa(e){return $s(e)?zr(e):Nn(e)}function Oa(e){return $s(e)?zr(e,!0):function(e){if(!ta(e))return function(e){var t=[];if(null!=e)for(var r in xe(e))t.push(r);return t}(e);var t=So(e),r=[];for(var n in e)("constructor"!=n||!t&&Oe.call(e,n))&&r.push(n);return r}(e)}var ja=Ri((function(e,t,r){Mn(e,t,r)})),Na=Ri((function(e,t,r,n){Mn(e,t,r,n)})),Da=eo((function(e,t){var r={};if(null==e)return r;var n=!1;t=It(t,(function(t){return t=mi(t,e),n||(n=t.length>1),t})),Fi(e,ro(e),r),n&&(r=an(r,7,Xi));for(var i=t.length;i--;)ui(r,t[i]);return r})),La=eo((function(e,t){return null==e?{}:function(e,t){return qn(e,t,(function(t,r){return Fa(e,r)}))}(e,t)}));function Ua(e,t){if(null==e)return{};var r=It(ro(e),(function(e){return[e]}));return t=so(t),qn(e,r,(function(e,r){return t(e,r[0])}))}var Ba=zi(Pa),Ma=zi(Oa);function Ha(e){return null==e?[]:Vt(e,Pa(e))}var Ka=ji((function(e,t,r){return t=t.toLowerCase(),e+(r?qa(t):t)}));function qa(e){return Qa(wa(e).toLowerCase())}function Va(e){return(e=wa(e))&&e.replace(ve,Gt).replace(Je,"")}var Ja=ji((function(e,t,r){return e+(r?"-":"")+t.toLowerCase()})),Wa=ji((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()})),$a=Oi("toLowerCase"),za=ji((function(e,t,r){return e+(r?"_":"")+t.toLowerCase()})),Ga=ji((function(e,t,r){return e+(r?" ":"")+Qa(t)})),Ya=ji((function(e,t,r){return e+(r?" ":"")+t.toUpperCase()})),Qa=Oi("toUpperCase");function Xa(e,t,r){return e=wa(e),(t=r?i:t)===i?function(e){return Ge.test(e)}(e)?function(e){return e.match($e)||[]}(e):function(e){return e.match(ce)||[]}(e):e.match(t)||[]}var Za=zn((function(e,t){try{return mt(e,i,t)}catch(e){return Qs(e)?e:new _e(e)}})),ec=eo((function(e,t){return wt(t,(function(t){t=Uo(t),nn(e,t,Rs(e[t],e))})),e}));function tc(e){return function(){return e}}var rc=Li(),nc=Li(!0);function ic(e){return e}function oc(e){return jn("function"==typeof e?e:an(e,1))}var sc=zn((function(e,t){return function(r){return Tn(r,e,t)}})),ac=zn((function(e,t){return function(r){return Tn(e,r,t)}}));function cc(e,t,r){var n=Pa(t),i=_n(t,n);null!=r||ta(t)&&(i.length||!n.length)||(r=t,t=e,e=this,i=_n(t,Pa(t)));var o=!(ta(r)&&"chain"in r&&!r.chain),s=Xs(e);return wt(i,(function(r){var n=t[r];e[r]=n,s&&(e.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=e(this.__wrapped__),i=r.__actions__=ki(this.__actions__);return i.push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,At([this.value()],arguments))})})),e}function uc(){}var lc=Hi(It),dc=Hi(_t),hc=Hi(Tt);function pc(e){return wo(e)?Lt(Uo(e)):function(e){return function(t){return Sn(t,e)}}(e)}var fc=qi(),gc=qi(!0);function yc(){return[]}function mc(){return!1}var vc,wc=Mi((function(e,t){return e+t}),0),bc=Wi("ceil"),_c=Mi((function(e,t){return e/t}),1),Sc=Wi("floor"),Ec=Mi((function(e,t){return e*t}),1),xc=Wi("round"),Ic=Mi((function(e,t){return e-t}),0);return Ur.after=function(e,t){if("function"!=typeof t)throw new ke(o);return e=ga(e),function(){if(--e<1)return t.apply(this,arguments)}},Ur.ary=Fs,Ur.assign=ba,Ur.assignIn=_a,Ur.assignInWith=Sa,Ur.assignWith=Ea,Ur.at=xa,Ur.before=Ts,Ur.bind=Rs,Ur.bindAll=ec,Ur.bindKey=Cs,Ur.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Js(e)?e:[e]},Ur.chain=ps,Ur.chunk=function(e,t,r){t=(r?vo(e,t,r):t===i)?1:yr(ga(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,c=n(ur(o/t));s<o;)c[a++]=ti(e,s,s+=t);return c},Ur.compact=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},Ur.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return At(Js(r)?ki(r):[r],yn(t,1))},Ur.cond=function(e){var t=null==e?0:e.length,r=so();return e=t?It(e,(function(e){if("function"!=typeof e[1])throw new ke(o);return[r(e[0]),e[1]]})):[],zn((function(r){for(var n=-1;++n<t;){var i=e[n];if(mt(i[0],this,r))return mt(i[1],this,r)}}))},Ur.conforms=function(e){return function(e){var t=Pa(e);return function(r){return cn(r,e,t)}}(an(e,1))},Ur.constant=tc,Ur.countBy=ys,Ur.create=function(e,t){var r=Br(e);return null==t?r:rn(r,t)},Ur.curry=function e(t,r,n){var o=Gi(t,8,i,i,i,i,i,r=n?i:r);return o.placeholder=e.placeholder,o},Ur.curryRight=function e(t,r,n){var o=Gi(t,16,i,i,i,i,i,r=n?i:r);return o.placeholder=e.placeholder,o},Ur.debounce=Ps,Ur.defaults=Ia,Ur.defaultsDeep=Aa,Ur.defer=Os,Ur.delay=js,Ur.difference=Ho,Ur.differenceBy=Ko,Ur.differenceWith=qo,Ur.drop=function(e,t,r){var n=null==e?0:e.length;return n?ti(e,(t=r||t===i?1:ga(t))<0?0:t,n):[]},Ur.dropRight=function(e,t,r){var n=null==e?0:e.length;return n?ti(e,0,(t=n-(t=r||t===i?1:ga(t)))<0?0:t):[]},Ur.dropRightWhile=function(e,t){return e&&e.length?di(e,so(t,3),!0,!0):[]},Ur.dropWhile=function(e,t){return e&&e.length?di(e,so(t,3),!0):[]},Ur.fill=function(e,t,r,n){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&vo(e,t,r)&&(r=0,n=o),function(e,t,r,n){var o=e.length;for((r=ga(r))<0&&(r=-r>o?0:o+r),(n=n===i||n>o?o:ga(n))<0&&(n+=o),n=r>n?0:ya(n);r<n;)e[r++]=t;return e}(e,t,r,n)):[]},Ur.filter=function(e,t){return(Js(e)?St:gn)(e,so(t,3))},Ur.flatMap=function(e,t){return yn(xs(e,t),1)},Ur.flatMapDeep=function(e,t){return yn(xs(e,t),l)},Ur.flatMapDepth=function(e,t,r){return r=r===i?1:ga(r),yn(xs(e,t),r)},Ur.flatten=Wo,Ur.flattenDeep=function(e){return null!=e&&e.length?yn(e,l):[]},Ur.flattenDepth=function(e,t){return null!=e&&e.length?yn(e,t=t===i?1:ga(t)):[]},Ur.flip=function(e){return Gi(e,512)},Ur.flow=rc,Ur.flowRight=nc,Ur.fromPairs=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},Ur.functions=function(e){return null==e?[]:_n(e,Pa(e))},Ur.functionsIn=function(e){return null==e?[]:_n(e,Oa(e))},Ur.groupBy=_s,Ur.initial=function(e){return null!=e&&e.length?ti(e,0,-1):[]},Ur.intersection=zo,Ur.intersectionBy=Go,Ur.intersectionWith=Yo,Ur.invert=Ta,Ur.invertBy=Ra,Ur.invokeMap=Ss,Ur.iteratee=oc,Ur.keyBy=Es,Ur.keys=Pa,Ur.keysIn=Oa,Ur.map=xs,Ur.mapKeys=function(e,t){var r={};return t=so(t,3),wn(e,(function(e,n,i){nn(r,t(e,n,i),e)})),r},Ur.mapValues=function(e,t){var r={};return t=so(t,3),wn(e,(function(e,n,i){nn(r,n,t(e,n,i))})),r},Ur.matches=function(e){return Un(an(e,1))},Ur.matchesProperty=function(e,t){return Bn(e,an(t,1))},Ur.memoize=Ns,Ur.merge=ja,Ur.mergeWith=Na,Ur.method=sc,Ur.methodOf=ac,Ur.mixin=cc,Ur.negate=Ds,Ur.nthArg=function(e){return e=ga(e),zn((function(t){return Hn(t,e)}))},Ur.omit=Da,Ur.omitBy=function(e,t){return Ua(e,Ds(so(t)))},Ur.once=function(e){return Ts(2,e)},Ur.orderBy=function(e,t,r,n){return null==e?[]:(Js(t)||(t=null==t?[]:[t]),Js(r=n?i:r)||(r=null==r?[]:[r]),Kn(e,t,r))},Ur.over=lc,Ur.overArgs=Ls,Ur.overEvery=dc,Ur.overSome=hc,Ur.partial=Us,Ur.partialRight=Bs,Ur.partition=Is,Ur.pick=La,Ur.pickBy=Ua,Ur.property=pc,Ur.propertyOf=function(e){return function(t){return null==e?i:Sn(e,t)}},Ur.pull=Xo,Ur.pullAll=Zo,Ur.pullAllBy=function(e,t,r){return e&&e.length&&t&&t.length?Vn(e,t,so(r,2)):e},Ur.pullAllWith=function(e,t,r){return e&&e.length&&t&&t.length?Vn(e,t,i,r):e},Ur.pullAt=es,Ur.range=fc,Ur.rangeRight=gc,Ur.rearg=Ms,Ur.reject=function(e,t){return(Js(e)?St:gn)(e,Ds(so(t,3)))},Ur.remove=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=so(t,3);++n<o;){var s=e[n];t(s,n,e)&&(r.push(s),i.push(n))}return Jn(e,i),r},Ur.rest=function(e,t){if("function"!=typeof e)throw new ke(o);return zn(e,t=t===i?t:ga(t))},Ur.reverse=ts,Ur.sampleSize=function(e,t,r){return t=(r?vo(e,t,r):t===i)?1:ga(t),(Js(e)?Yr:Yn)(e,t)},Ur.set=function(e,t,r){return null==e?e:Qn(e,t,r)},Ur.setWith=function(e,t,r,n){return n="function"==typeof n?n:i,null==e?e:Qn(e,t,r,n)},Ur.shuffle=function(e){return(Js(e)?Qr:ei)(e)},Ur.slice=function(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&vo(e,t,r)?(t=0,r=n):(t=null==t?0:ga(t),r=r===i?n:ga(r)),ti(e,t,r)):[]},Ur.sortBy=As,Ur.sortedUniq=function(e){return e&&e.length?oi(e):[]},Ur.sortedUniqBy=function(e,t){return e&&e.length?oi(e,so(t,2)):[]},Ur.split=function(e,t,r){return r&&"number"!=typeof r&&vo(e,t,r)&&(t=r=i),(r=r===i?p:r>>>0)?(e=wa(e))&&("string"==typeof t||null!=t&&!sa(t))&&!(t=ai(t))&&Xt(e)?wi(or(e),0,r):e.split(t,r):[]},Ur.spread=function(e,t){if("function"!=typeof e)throw new ke(o);return t=null==t?0:yr(ga(t),0),zn((function(r){var n=r[t],i=wi(r,0,t);return n&&At(i,n),mt(e,this,i)}))},Ur.tail=function(e){var t=null==e?0:e.length;return t?ti(e,1,t):[]},Ur.take=function(e,t,r){return e&&e.length?ti(e,0,(t=r||t===i?1:ga(t))<0?0:t):[]},Ur.takeRight=function(e,t,r){var n=null==e?0:e.length;return n?ti(e,(t=n-(t=r||t===i?1:ga(t)))<0?0:t,n):[]},Ur.takeRightWhile=function(e,t){return e&&e.length?di(e,so(t,3),!1,!0):[]},Ur.takeWhile=function(e,t){return e&&e.length?di(e,so(t,3)):[]},Ur.tap=function(e,t){return t(e),e},Ur.throttle=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new ke(o);return ta(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Ps(e,t,{leading:n,maxWait:t,trailing:i})},Ur.thru=fs,Ur.toArray=pa,Ur.toPairs=Ba,Ur.toPairsIn=Ma,Ur.toPath=function(e){return Js(e)?It(e,Uo):ua(e)?[e]:ki(Lo(wa(e)))},Ur.toPlainObject=va,Ur.transform=function(e,t,r){var n=Js(e),i=n||Gs(e)||la(e);if(t=so(t,4),null==r){var o=e&&e.constructor;r=i?n?new o:[]:ta(e)&&Xs(o)?Br(We(e)):{}}return(i?wt:wn)(e,(function(e,n,i){return t(r,e,n,i)})),r},Ur.unary=function(e){return Fs(e,1)},Ur.union=rs,Ur.unionBy=ns,Ur.unionWith=is,Ur.uniq=function(e){return e&&e.length?ci(e):[]},Ur.uniqBy=function(e,t){return e&&e.length?ci(e,so(t,2)):[]},Ur.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ci(e,i,t):[]},Ur.unset=function(e,t){return null==e||ui(e,t)},Ur.unzip=os,Ur.unzipWith=ss,Ur.update=function(e,t,r){return null==e?e:li(e,t,yi(r))},Ur.updateWith=function(e,t,r,n){return n="function"==typeof n?n:i,null==e?e:li(e,t,yi(r),n)},Ur.values=Ha,Ur.valuesIn=function(e){return null==e?[]:Vt(e,Oa(e))},Ur.without=as,Ur.words=Xa,Ur.wrap=function(e,t){return Us(yi(t),e)},Ur.xor=cs,Ur.xorBy=us,Ur.xorWith=ls,Ur.zip=ds,Ur.zipObject=function(e,t){return fi(e||[],t||[],Zr)},Ur.zipObjectDeep=function(e,t){return fi(e||[],t||[],Qn)},Ur.zipWith=hs,Ur.entries=Ba,Ur.entriesIn=Ma,Ur.extend=_a,Ur.extendWith=Sa,cc(Ur,Ur),Ur.add=wc,Ur.attempt=Za,Ur.camelCase=Ka,Ur.capitalize=qa,Ur.ceil=bc,Ur.clamp=function(e,t,r){return r===i&&(r=t,t=i),r!==i&&(r=(r=ma(r))==r?r:0),t!==i&&(t=(t=ma(t))==t?t:0),sn(ma(e),t,r)},Ur.clone=function(e){return an(e,4)},Ur.cloneDeep=function(e){return an(e,5)},Ur.cloneDeepWith=function(e,t){return an(e,5,t="function"==typeof t?t:i)},Ur.cloneWith=function(e,t){return an(e,4,t="function"==typeof t?t:i)},Ur.conformsTo=function(e,t){return null==t||cn(e,t,Pa(t))},Ur.deburr=Va,Ur.defaultTo=function(e,t){return null==e||e!=e?t:e},Ur.divide=_c,Ur.endsWith=function(e,t,r){e=wa(e),t=ai(t);var n=e.length,o=r=r===i?n:sn(ga(r),0,n);return(r-=t.length)>=0&&e.slice(r,o)==t},Ur.eq=Hs,Ur.escape=function(e){return(e=wa(e))&&z.test(e)?e.replace(W,Yt):e},Ur.escapeRegExp=function(e){return(e=wa(e))&&re.test(e)?e.replace(te,"\\$&"):e},Ur.every=function(e,t,r){var n=Js(e)?_t:pn;return r&&vo(e,t,r)&&(t=i),n(e,so(t,3))},Ur.find=ms,Ur.findIndex=Vo,Ur.findKey=function(e,t){return Ct(e,so(t,3),wn)},Ur.findLast=vs,Ur.findLastIndex=Jo,Ur.findLastKey=function(e,t){return Ct(e,so(t,3),bn)},Ur.floor=Sc,Ur.forEach=ws,Ur.forEachRight=bs,Ur.forIn=function(e,t){return null==e?e:mn(e,so(t,3),Oa)},Ur.forInRight=function(e,t){return null==e?e:vn(e,so(t,3),Oa)},Ur.forOwn=function(e,t){return e&&wn(e,so(t,3))},Ur.forOwnRight=function(e,t){return e&&bn(e,so(t,3))},Ur.get=ka,Ur.gt=Ks,Ur.gte=qs,Ur.has=function(e,t){return null!=e&&fo(e,t,An)},Ur.hasIn=Fa,Ur.head=$o,Ur.identity=ic,Ur.includes=function(e,t,r,n){e=$s(e)?e:Ha(e),r=r&&!n?ga(r):0;var i=e.length;return r<0&&(r=yr(i+r,0)),ca(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Ot(e,t,r)>-1},Ur.indexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:ga(r);return i<0&&(i=yr(n+i,0)),Ot(e,t,i)},Ur.inRange=function(e,t,r){return t=fa(t),r===i?(r=t,t=0):r=fa(r),function(e,t,r){return e>=mr(t,r)&&e<yr(t,r)}(e=ma(e),t,r)},Ur.invoke=Ca,Ur.isArguments=Vs,Ur.isArray=Js,Ur.isArrayBuffer=Ws,Ur.isArrayLike=$s,Ur.isArrayLikeObject=zs,Ur.isBoolean=function(e){return!0===e||!1===e||ra(e)&&xn(e)==m},Ur.isBuffer=Gs,Ur.isDate=Ys,Ur.isElement=function(e){return ra(e)&&1===e.nodeType&&!oa(e)},Ur.isEmpty=function(e){if(null==e)return!0;if($s(e)&&(Js(e)||"string"==typeof e||"function"==typeof e.splice||Gs(e)||la(e)||Vs(e)))return!e.length;var t=po(e);if(t==S||t==k)return!e.size;if(So(e))return!Nn(e).length;for(var r in e)if(Oe.call(e,r))return!1;return!0},Ur.isEqual=function(e,t){return Cn(e,t)},Ur.isEqualWith=function(e,t,r){var n=(r="function"==typeof r?r:i)?r(e,t):i;return n===i?Cn(e,t,i,r):!!n},Ur.isError=Qs,Ur.isFinite=function(e){return"number"==typeof e&&pr(e)},Ur.isFunction=Xs,Ur.isInteger=Zs,Ur.isLength=ea,Ur.isMap=na,Ur.isMatch=function(e,t){return e===t||Pn(e,t,co(t))},Ur.isMatchWith=function(e,t,r){return r="function"==typeof r?r:i,Pn(e,t,co(t),r)},Ur.isNaN=function(e){return ia(e)&&e!=+e},Ur.isNative=function(e){if(_o(e))throw new _e("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return On(e)},Ur.isNil=function(e){return null==e},Ur.isNull=function(e){return null===e},Ur.isNumber=ia,Ur.isObject=ta,Ur.isObjectLike=ra,Ur.isPlainObject=oa,Ur.isRegExp=sa,Ur.isSafeInteger=function(e){return Zs(e)&&e>=-9007199254740991&&e<=d},Ur.isSet=aa,Ur.isString=ca,Ur.isSymbol=ua,Ur.isTypedArray=la,Ur.isUndefined=function(e){return e===i},Ur.isWeakMap=function(e){return ra(e)&&po(e)==R},Ur.isWeakSet=function(e){return ra(e)&&"[object WeakSet]"==xn(e)},Ur.join=function(e,t){return null==e?"":fr.call(e,t)},Ur.kebabCase=Ja,Ur.last=Qo,Ur.lastIndexOf=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var o=n;return r!==i&&(o=(o=ga(r))<0?yr(n+o,0):mr(o,n-1)),t==t?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,t,o):Pt(e,Nt,o,!0)},Ur.lowerCase=Wa,Ur.lowerFirst=$a,Ur.lt=da,Ur.lte=ha,Ur.max=function(e){return e&&e.length?fn(e,ic,In):i},Ur.maxBy=function(e,t){return e&&e.length?fn(e,so(t,2),In):i},Ur.mean=function(e){return Dt(e,ic)},Ur.meanBy=function(e,t){return Dt(e,so(t,2))},Ur.min=function(e){return e&&e.length?fn(e,ic,Dn):i},Ur.minBy=function(e,t){return e&&e.length?fn(e,so(t,2),Dn):i},Ur.stubArray=yc,Ur.stubFalse=mc,Ur.stubObject=function(){return{}},Ur.stubString=function(){return""},Ur.stubTrue=function(){return!0},Ur.multiply=Ec,Ur.nth=function(e,t){return e&&e.length?Hn(e,ga(t)):i},Ur.noConflict=function(){return ot._===this&&(ot._=Ue),this},Ur.noop=uc,Ur.now=ks,Ur.pad=function(e,t,r){e=wa(e);var n=(t=ga(t))?ir(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return Ki(lr(i),r)+e+Ki(ur(i),r)},Ur.padEnd=function(e,t,r){e=wa(e);var n=(t=ga(t))?ir(e):0;return t&&n<t?e+Ki(t-n,r):e},Ur.padStart=function(e,t,r){e=wa(e);var n=(t=ga(t))?ir(e):0;return t&&n<t?Ki(t-n,r)+e:e},Ur.parseInt=function(e,t,r){return r||null==t?t=0:t&&(t=+t),wr(wa(e).replace(ne,""),t||0)},Ur.random=function(e,t,r){if(r&&"boolean"!=typeof r&&vo(e,t,r)&&(t=r=i),r===i&&("boolean"==typeof t?(r=t,t=i):"boolean"==typeof e&&(r=e,e=i)),e===i&&t===i?(e=0,t=1):(e=fa(e),t===i?(t=e,e=0):t=fa(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var o=br();return mr(e+o*(t-e+tt("1e-"+((o+"").length-1))),t)}return Wn(e,t)},Ur.reduce=function(e,t,r){var n=Js(e)?kt:Bt,i=arguments.length<3;return n(e,so(t,4),r,i,dn)},Ur.reduceRight=function(e,t,r){var n=Js(e)?Ft:Bt,i=arguments.length<3;return n(e,so(t,4),r,i,hn)},Ur.repeat=function(e,t,r){return t=(r?vo(e,t,r):t===i)?1:ga(t),$n(wa(e),t)},Ur.replace=function(){var e=arguments,t=wa(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Ur.result=function(e,t,r){var n=-1,o=(t=mi(t,e)).length;for(o||(o=1,e=i);++n<o;){var s=null==e?i:e[Uo(t[n])];s===i&&(n=o,s=r),e=Xs(s)?s.call(e):s}return e},Ur.round=xc,Ur.runInContext=e,Ur.sample=function(e){return(Js(e)?Gr:Gn)(e)},Ur.size=function(e){if(null==e)return 0;if($s(e))return ca(e)?ir(e):e.length;var t=po(e);return t==S||t==k?e.size:Nn(e).length},Ur.snakeCase=za,Ur.some=function(e,t,r){var n=Js(e)?Tt:ri;return r&&vo(e,t,r)&&(t=i),n(e,so(t,3))},Ur.sortedIndex=function(e,t){return ni(e,t)},Ur.sortedIndexBy=function(e,t,r){return ii(e,t,so(r,2))},Ur.sortedIndexOf=function(e,t){var r=null==e?0:e.length;if(r){var n=ni(e,t);if(n<r&&Hs(e[n],t))return n}return-1},Ur.sortedLastIndex=function(e,t){return ni(e,t,!0)},Ur.sortedLastIndexBy=function(e,t,r){return ii(e,t,so(r,2),!0)},Ur.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var r=ni(e,t,!0)-1;if(Hs(e[r],t))return r}return-1},Ur.startCase=Ga,Ur.startsWith=function(e,t,r){return e=wa(e),r=null==r?0:sn(ga(r),0,e.length),t=ai(t),e.slice(r,r+t.length)==t},Ur.subtract=Ic,Ur.sum=function(e){return e&&e.length?Mt(e,ic):0},Ur.sumBy=function(e,t){return e&&e.length?Mt(e,so(t,2)):0},Ur.template=function(e,t,r){var n=Ur.templateSettings;r&&vo(e,t,r)&&(t=i),e=wa(e),t=Sa({},t,n,Yi);var o,s,a=Sa({},t.imports,n.imports,Yi),c=Pa(a),u=Vt(a,c),l=0,d=t.interpolate||we,h="__p += '",p=Ie((t.escape||we).source+"|"+d.source+"|"+(d===Q?de:we).source+"|"+(t.evaluate||we).source+"|$","g"),f="//# sourceURL="+(Oe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qe+"]")+"\n";e.replace(p,(function(t,r,n,i,a,c){return n||(n=i),h+=e.slice(l,c).replace(be,Qt),r&&(o=!0,h+="' +\n__e("+r+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),n&&(h+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=c+t.length,t})),h+="';\n";var g=Oe.call(t,"variable")&&t.variable;if(g){if(ue.test(g))throw new _e("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(K,""):h).replace(q,"$1").replace(V,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=Za((function(){return Se(c,f+"return "+h).apply(i,u)}));if(y.source=h,Qs(y))throw y;return y},Ur.times=function(e,t){if((e=ga(e))<1||e>d)return[];var r=p,n=mr(e,p);t=so(t),e-=p;for(var i=Ht(n,t);++r<e;)t(r);return i},Ur.toFinite=fa,Ur.toInteger=ga,Ur.toLength=ya,Ur.toLower=function(e){return wa(e).toLowerCase()},Ur.toNumber=ma,Ur.toSafeInteger=function(e){return e?sn(ga(e),-9007199254740991,d):0===e?e:0},Ur.toString=wa,Ur.toUpper=function(e){return wa(e).toUpperCase()},Ur.trim=function(e,t,r){if((e=wa(e))&&(r||t===i))return Kt(e);if(!e||!(t=ai(t)))return e;var n=or(e),o=or(t);return wi(n,Wt(n,o),$t(n,o)+1).join("")},Ur.trimEnd=function(e,t,r){if((e=wa(e))&&(r||t===i))return e.slice(0,sr(e)+1);if(!e||!(t=ai(t)))return e;var n=or(e);return wi(n,0,$t(n,or(t))+1).join("")},Ur.trimStart=function(e,t,r){if((e=wa(e))&&(r||t===i))return e.replace(ne,"");if(!e||!(t=ai(t)))return e;var n=or(e);return wi(n,Wt(n,or(t))).join("")},Ur.truncate=function(e,t){var r=30,n="...";if(ta(t)){var o="separator"in t?t.separator:o;r="length"in t?ga(t.length):r,n="omission"in t?ai(t.omission):n}var s=(e=wa(e)).length;if(Xt(e)){var a=or(e);s=a.length}if(r>=s)return e;var c=r-ir(n);if(c<1)return n;var u=a?wi(a,0,c).join(""):e.slice(0,c);if(o===i)return u+n;if(a&&(c+=u.length-c),sa(o)){if(e.slice(c).search(o)){var l,d=u;for(o.global||(o=Ie(o.source,wa(he.exec(o))+"g")),o.lastIndex=0;l=o.exec(d);)var h=l.index;u=u.slice(0,h===i?c:h)}}else if(e.indexOf(ai(o),c)!=c){var p=u.lastIndexOf(o);p>-1&&(u=u.slice(0,p))}return u+n},Ur.unescape=function(e){return(e=wa(e))&&$.test(e)?e.replace(J,ar):e},Ur.uniqueId=function(e){var t=++je;return wa(e)+t},Ur.upperCase=Ya,Ur.upperFirst=Qa,Ur.each=ws,Ur.eachRight=bs,Ur.first=$o,cc(Ur,(vc={},wn(Ur,(function(e,t){Oe.call(Ur.prototype,t)||(vc[t]=e)})),vc),{chain:!1}),Ur.VERSION="4.17.21",wt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Ur[e].placeholder=Ur})),wt(["drop","take"],(function(e,t){Kr.prototype[e]=function(r){r=r===i?1:yr(ga(r),0);var n=this.__filtered__&&!t?new Kr(this):this.clone();return n.__filtered__?n.__takeCount__=mr(r,n.__takeCount__):n.__views__.push({size:mr(r,p),type:e+(n.__dir__<0?"Right":"")}),n},Kr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),wt(["filter","map","takeWhile"],(function(e,t){var r=t+1,n=1==r||3==r;Kr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:so(e,3),type:r}),t.__filtered__=t.__filtered__||n,t}})),wt(["head","last"],(function(e,t){var r="take"+(t?"Right":"");Kr.prototype[e]=function(){return this[r](1).value()[0]}})),wt(["initial","tail"],(function(e,t){var r="drop"+(t?"":"Right");Kr.prototype[e]=function(){return this.__filtered__?new Kr(this):this[r](1)}})),Kr.prototype.compact=function(){return this.filter(ic)},Kr.prototype.find=function(e){return this.filter(e).head()},Kr.prototype.findLast=function(e){return this.reverse().find(e)},Kr.prototype.invokeMap=zn((function(e,t){return"function"==typeof e?new Kr(this):this.map((function(r){return Tn(r,e,t)}))})),Kr.prototype.reject=function(e){return this.filter(Ds(so(e)))},Kr.prototype.slice=function(e,t){e=ga(e);var r=this;return r.__filtered__&&(e>0||t<0)?new Kr(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),t!==i&&(r=(t=ga(t))<0?r.dropRight(-t):r.take(t-e)),r)},Kr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Kr.prototype.toArray=function(){return this.take(p)},wn(Kr.prototype,(function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),o=Ur[n?"take"+("last"==t?"Right":""):t],s=n||/^find/.test(t);o&&(Ur.prototype[t]=function(){var t=this.__wrapped__,a=n?[1]:arguments,c=t instanceof Kr,u=a[0],l=c||Js(t),d=function(e){var t=o.apply(Ur,At([e],a));return n&&h?t[0]:t};l&&r&&"function"==typeof u&&1!=u.length&&(c=l=!1);var h=this.__chain__,p=!!this.__actions__.length,f=s&&!h,g=c&&!p;if(!s&&l){t=g?t:new Kr(this);var y=e.apply(t,a);return y.__actions__.push({func:fs,args:[d],thisArg:i}),new Hr(y,h)}return f&&g?e.apply(this,a):(y=this.thru(d),f?n?y.value()[0]:y.value():y)})})),wt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Fe[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);Ur.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply(Js(i)?i:[],e)}return this[r]((function(r){return t.apply(Js(r)?r:[],e)}))}})),wn(Kr.prototype,(function(e,t){var r=Ur[t];if(r){var n=r.name+"";Oe.call(Tr,n)||(Tr[n]=[]),Tr[n].push({name:t,func:r})}})),Tr[Ui(i,2).name]=[{name:"wrapper",func:i}],Kr.prototype.clone=function(){var e=new Kr(this.__wrapped__);return e.__actions__=ki(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ki(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ki(this.__views__),e},Kr.prototype.reverse=function(){if(this.__filtered__){var e=new Kr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Kr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=Js(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=mr(t,e+s);break;case"takeRight":e=yr(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,c=a-s,u=n?a:s-1,l=this.__iteratees__,d=l.length,h=0,p=mr(c,this.__takeCount__);if(!r||!n&&i==c&&p==c)return hi(e,this.__actions__);var f=[];e:for(;c--&&h<p;){for(var g=-1,y=e[u+=t];++g<d;){var m=l[g],v=m.iteratee,w=m.type,b=v(y);if(2==w)y=b;else if(!b){if(1==w)continue e;break e}}f[h++]=y}return f},Ur.prototype.at=gs,Ur.prototype.chain=function(){return ps(this)},Ur.prototype.commit=function(){return new Hr(this.value(),this.__chain__)},Ur.prototype.next=function(){this.__values__===i&&(this.__values__=pa(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},Ur.prototype.plant=function(e){for(var t,r=this;r instanceof Mr;){var n=Mo(r);n.__index__=0,n.__values__=i,t?o.__wrapped__=n:t=n;var o=n;r=r.__wrapped__}return o.__wrapped__=e,t},Ur.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Kr){var t=e;return this.__actions__.length&&(t=new Kr(this)),(t=t.reverse()).__actions__.push({func:fs,args:[ts],thisArg:i}),new Hr(t,this.__chain__)}return this.thru(ts)},Ur.prototype.toJSON=Ur.prototype.valueOf=Ur.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},Ur.prototype.first=Ur.prototype.head,st&&(Ur.prototype[st]=function(){return this}),Ur}();ot._=cr,(n=function(){return cr}.call(t,r,t,e))===i||(e.exports=n)}.call(this)},9593:(e,t,r)=>{"use strict";const n=r(4411),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),c=Symbol("maxAge"),u=Symbol("dispose"),l=Symbol("noDisposeOnSet"),d=Symbol("lruList"),h=Symbol("cache"),p=Symbol("updateAgeOnGet"),f=()=>1,g=(e,t,r)=>{const n=e[h].get(t);if(n){const t=n.value;if(y(e,t)){if(v(e,n),!e[a])return}else r&&(e[p]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},y=(e,t)=>{if(!t||!t.maxAge&&!e[c])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[c]&&r>e[c]},m=e=>{if(e[o]>e[i])for(let t=e[d].tail;e[o]>e[i]&&null!==t;){const r=t.prev;v(e,t),t=r}},v=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[o]-=r.length,e[h].delete(r.key),e[d].removeNode(t)}};class w{constructor(e,t,r,n,i){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=i||0}}const b=(e,t,r,n)=>{let i=r.value;y(e,i)&&(v(e,r),e[a]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[s]="function"!=typeof t?f:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[c]=e.maxAge||0,this[u]=e.dispose,this[l]=e.noDisposeOnSet||!1,this[p]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,m(this)}get max(){return this[i]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,m(this)}get maxAge(){return this[c]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[s]&&(this[s]=e,this[o]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[o]+=e.length}))),m(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let r=this[d].tail;null!==r;){const n=r.prev;b(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[d].head;null!==r;){const n=r.next;b(this,e,r,t),r=n}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach((e=>this[u](e.key,e.value))),this[h]=new Map,this[d]=new n,this[o]=0}dump(){return this[d].map((e=>!y(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,r){if((r=r||this[c])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,a=this[s](t,e);if(this[h].has(e)){if(a>this[i])return v(this,this[h].get(e)),!1;const s=this[h].get(e).value;return this[u]&&(this[l]||this[u](e,s.value)),s.now=n,s.maxAge=r,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),m(this),!0}const p=new w(e,t,a,n,r);return p.length>this[i]?(this[u]&&this[u](e,t),!1):(this[o]+=p.length,this[d].unshift(p),this[h].set(e,this[d].head),m(this),!0)}has(e){if(!this[h].has(e))return!1;const t=this[h].get(e).value;return!y(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[d].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[h].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[h].forEach(((e,t)=>g(this,t,!1)))}}},4375:(e,t,r)=>{let n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):e=>(n||(n=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},7055:(e,t,r)=>{e.exports=r(9344)},2401:e=>{"use strict";e.exports=class e{constructor(e,t=new Map,r=0){this.prefix=e,this._existing=t,this.counter=r}clone(){const{prefix:t,_existing:r,counter:n}=this;return new e(t,new Map(r),n)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const r=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,r),r}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}}},5947:(e,t,r)=>{"use strict";r(4889);const n=self.crypto||self.msCrypto;e.exports=class{constructor(e){if(!n||!n.subtle)throw new Error("crypto.subtle not found.");if("sha256"===e)this.algorithm={name:"SHA-256"};else{if("sha1"!==e)throw new Error(`Unsupport algorithm "${e}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const e=(new TextEncoder).encode(this._content),t=new Uint8Array(await n.subtle.digest(this.algorithm,e));let r="";for(let e=0;e<t.length;++e)r+=t[e].toString(16).padStart(2,"0");return r}}},9980:e=>{"use strict";const t="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",r="http://www.w3.org/2001/XMLSchema#string",n="NamedNode",i="BlankNode",o="Literal",s="DefaultGraph",a={};a.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,a.empty=new RegExp("^[ \\t]*$"),a.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9])(?:(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀.])*(?:[A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_0-9-·̀-ͯ‿-⁀]))?))[ \\t]*\\.))[ \\t]*$'),e.exports=class e{static parse(e){const c=[],l={},d=e.split(a.eoln);let h=0;for(const e of d){if(h++,a.empty.test(e))continue;const d=e.match(a.quad);if(null===d)throw new Error("N-Quads parse error on line "+h+".");const g={subject:null,predicate:null,object:null,graph:null};if(void 0!==d[1]?g.subject={termType:n,value:d[1]}:g.subject={termType:i,value:d[2]},g.predicate={termType:n,value:d[3]},void 0!==d[4]?g.object={termType:n,value:d[4]}:void 0!==d[5]?g.object={termType:i,value:d[5]}:(g.object={termType:o,value:void 0,datatype:{termType:n}},void 0!==d[7]?g.object.datatype.value=d[7]:void 0!==d[8]?(g.object.datatype.value=t,g.object.language=d[8]):g.object.datatype.value=r,g.object.value=d[6].replace(u,(function(e,t,r,n){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(n)throw new Error("Unsupported U escape")}))),void 0!==d[9]?g.graph={termType:n,value:d[9]}:void 0!==d[10]?g.graph={termType:i,value:d[10]}:g.graph={termType:s,value:""},g.graph.value in l){let e=!0;const t=l[g.graph.value];for(const r of t)if(f=g,(p=r).subject.termType===f.subject.termType&&p.object.termType===f.object.termType&&p.subject.value===f.subject.value&&p.predicate.value===f.predicate.value&&p.object.value===f.object.value&&(p.object.termType!==o||p.object.datatype.termType===f.object.datatype.termType&&p.object.language===f.object.language&&p.object.datatype.value===f.object.datatype.value)){e=!1;break}e&&(t.push(g),c.push(g))}else l[g.graph.value]=[g],c.push(g)}var p,f;return c}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const r=[];for(const n of t)r.push(e.serializeQuad(n));return r.sort().join("")}static serializeQuad(e){const o=e.subject,s=e.predicate,a=e.object,u=e.graph;let l="";return o.termType===n?l+=`<${o.value}>`:l+=`${o.value}`,l+=` <${s.value}> `,a.termType===n?l+=`<${a.value}>`:a.termType===i?l+=a.value:(l+=`"${function(e){return e.replace(c,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(a.value)}"`,a.datatype.value===t?a.language&&(l+=`@${a.language}`):a.datatype.value!==r&&(l+=`^^<${a.datatype.value}>`)),u.termType===n?l+=` <${u.value}>`:u.termType===i&&(l+=` ${u.value}`),l+=" .\n",l}static legacyDatasetToQuads(e){const a=[],c={"blank node":i,IRI:n,literal:o};for(const u in e)e[u].forEach((e=>{const l={};for(const i in e){const s=e[i],a={termType:c[s.type],value:s.value};a.termType===o&&(a.datatype={termType:n},"datatype"in s&&(a.datatype.value=s.datatype),"language"in s?("datatype"in s||(a.datatype.value=t),a.language=s.language):"datatype"in s||(a.datatype.value=r)),l[i]=a}l.graph="@default"===u?{termType:s,value:""}:{termType:u.startsWith("_:")?i:n,value:u},a.push(l)}));return a}};const c=/["\\\n\r]/g,u=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},8326:e=>{"use strict";e.exports=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,r=e.slice();let n=null,i=0;const o=e.length;for(let r=0;r<o;++r){const s=e[r],a=t.get(s);(null===n||s>n)&&(a&&r>0&&s>e[r-1]||!a&&r<o-1&&s>e[r+1])&&(n=s,i=r)}if(null===n)this.done=!0;else{const r=t.get(n)?i-1:i+1;e[i]=e[r],e[r]=n;for(const r of e)r>n&&t.set(r,!t.get(r))}return r}}},3445:(e,t,r)=>{"use strict";const n=r(2401),i=r(5947),o=r(8326),s=r(9980);function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}e.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new n("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}async main(e){this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];let i=0;for(const e of r)++i%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const o=[...t.keys()].sort(),c=[];for(const e of o){const r=t.get(e);if(r.length>1){c.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of c){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new n("_:b");e.getId(r);const i=await this.hashNDegreeQuads(r,e);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const u=[];for(const e of this.quads){const t={...e};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),u.push(s.serializeQuad(t))}return u.sort(),u.join("")}async hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const o=new i(this.hashAlgorithm);for(const e of t)o.update(e);return r.hash=await o.digest(),r.hash}async hashRelatedBlankNode(e,t,r,n){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const s=new i(this.hashAlgorithm);return s.update(n),"g"!==n&&s.update(this.getRelatedPredicate(t)),s.update(o),s.digest()}async hashNDegreeQuads(e,t){const r=new i(this.hashAlgorithm),n=await this.createHashToRelated(e,t),s=[...n.keys()].sort();for(const e of s){r.update(e);let i,s="";const a=new o(n.get(e));let c=0;for(;a.hasNext();){const e=a.next();++c%3==0&&await this._yield();let r=t.clone(),n="";const o=[];let u=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?n+=this.canonicalIssuer.getId(t):(r.hasId(t)||o.push(t),n+=r.getId(t)),0!==s.length&&n>s){u=!0;break}if(!u){for(const e of o){const t=await this.hashNDegreeQuads(e,r);if(n+=r.getId(e),n+=`<${t.hash}>`,r=t.issuer,0!==s.length&&n>s){u=!0;break}}u||(0===s.length||n<s)&&(s=n,i=r)}}r.update(s),t=i}return{hash:await r.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:t,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=await this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const s=t.value,a=await this.hashRelatedBlankNode(s,e,i,r),c=o.get(a);c?c.push(s):o.set(a,[s])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise((e=>setImmediate(e)))}}},5643:(e,t,r)=>{"use strict";const n=r(2401),i=r(5947),o=r(8326),s=r(9980);function a(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}e.exports=class{constructor(){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new n("_:c14n"),this.hashAlgorithm="sha256",this.quads=null}main(e){this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];for(const e of r)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const i=[...t.keys()].sort(),o=[];for(const e of i){const r=t.get(e);if(r.length>1){o.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of o){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new n("_:b");e.getId(r);const i=this.hashNDegreeQuads(r,e);t.push(i)}t.sort(a);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const c=[];for(const e of this.quads){const t={...e};t.subject=this._useCanonicalId({component:t.subject}),t.object=this._useCanonicalId({component:t.object}),t.graph=this._useCanonicalId({component:t.graph}),c.push(s.serializeQuad(t))}return c.sort(),c.join("")}hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(s.serializeQuad(n))}t.sort();const o=new i(this.hashAlgorithm);for(const e of t)o.update(e);return r.hash=o.digest(),r.hash}hashRelatedBlankNode(e,t,r,n){let o;o=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const s=new i(this.hashAlgorithm);return s.update(n),"g"!==n&&s.update(this.getRelatedPredicate(t)),s.update(o),s.digest()}hashNDegreeQuads(e,t){const r=new i(this.hashAlgorithm),n=this.createHashToRelated(e,t),s=[...n.keys()].sort();for(const e of s){r.update(e);let i,s="";const a=new o(n.get(e));for(;a.hasNext();){const e=a.next();let r=t.clone(),n="";const o=[];let c=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?n+=this.canonicalIssuer.getId(t):(r.hasId(t)||o.push(t),n+=r.getId(t)),0!==s.length&&n>s){c=!0;break}if(!c){for(const e of o){const t=this.hashNDegreeQuads(e,r);if(n+=r.getId(e),n+=`<${t.hash}>`,r=t.issuer,0!==s.length&&n>s){c=!0;break}}c||(0===s.length||n<s)&&(s=n,i=r)}}r.update(s),t=i}return{hash:r.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:e,issuer:t,hashToRelated:r});return r}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const s=t.value,a=this.hashRelatedBlankNode(s,e,i,r),c=o.get(a);c?c.push(s):o.set(a,[s])}_useCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}}},9201:(e,t,r)=>{"use strict";const n=r(3445);e.exports=class extends n{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n){let n,s;if("BlankNode"===o.subject.termType&&o.subject.value!==e)s=o.subject.value,n="p";else{if("BlankNode"!==o.object.termType||o.object.value===e)continue;s=o.object.value,n="r"}++i%100==0&&await this._yield();const a=await this.hashRelatedBlankNode(s,o,t,n),c=r.get(a);c?c.push(s):r.set(a,[s])}return r}}},7702:(e,t,r)=>{"use strict";const n=r(5643);e.exports=class extends n{constructor(){super(),this.name="URGNA2012",this.hashAlgorithm="sha1"}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n){let n,o;if("BlankNode"===i.subject.termType&&i.subject.value!==e)o=i.subject.value,n="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;o=i.object.value,n="r"}const s=this.hashRelatedBlankNode(o,i,t,n),a=r.get(s);a?a.push(o):r.set(s,[o])}return r}}},9344:(e,t,r)=>{"use strict";const n=r(3445),i=r(9201),o=r(5643),s=r(7702);let a;try{a=r(7670)}catch(e){}const c={};e.exports=c,c.NQuads=r(9980),c.IdentifierIssuer=r(2401),c._rdfCanonizeNative=function(e){return e&&(a=e),a},c.canonize=async function(e,t){if(Array.isArray(e)||(e=c.NQuads.legacyDatasetToQuads(e)),t.useNative){if(!a)throw new Error("rdf-canonize-native not available");return new Promise(((r,n)=>a.canonize(e,t,((e,t)=>e?n(e):r(t)))))}if("URDNA2015"===t.algorithm)return new n(t).main(e);if("URGNA2012"===t.algorithm)return new i(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)},c._canonizeSync=function(e,t){if(Array.isArray(e)||(e=c.NQuads.legacyDatasetToQuads(e)),t.useNative){if(a)return a.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new o(t).main(e);if("URGNA2012"===t.algorithm)return new s(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},4889:function(e,t,r){!function(e,t){"use strict";if(!e.setImmediate){var r,n,i,o,s,a=1,c={},u=!1,l=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(o+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(n=l.documentElement,r=function(e){var t=l.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(p,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[a]=i,r(a),a++},d.clearImmediate=h}function h(e){delete c[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=c[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{h(e),u=!1}}}}}("undefined"==typeof self?void 0===r.g?this:r.g:self)},1614:(e,t,r)=>{"use strict";var n;r.r(t),r.d(t,{NIL:()=>R,parse:()=>y,stringify:()=>l,v1:()=>g,v3:()=>I,v4:()=>A,v5:()=>T,validate:()=>a,version:()=>C});var i=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&s.test(e)};for(var c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(r))throw TypeError("Stringified UUID is invalid");return r};var d,h,p=0,f=0;const g=function(e,t,r){var n=t&&r||0,i=t||new Array(16),s=(e=e||{}).node||d,a=void 0!==e.clockseq?e.clockseq:h;if(null==s||null==a){var c=e.random||(e.rng||o)();null==s&&(s=d=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=h=16383&(c[6]<<8|c[7]))}var u=void 0!==e.msecs?e.msecs:Date.now(),g=void 0!==e.nsecs?e.nsecs:f+1,y=u-p+(g-f)/1e4;if(y<0&&void 0===e.clockseq&&(a=a+1&16383),(y<0||u>p)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=u,f=g,h=a;var m=(1e4*(268435455&(u+=122192928e5))+g)%4294967296;i[n++]=m>>>24&255,i[n++]=m>>>16&255,i[n++]=m>>>8&255,i[n++]=255&m;var v=u/4294967296*1e4&268435455;i[n++]=v>>>8&255,i[n++]=255&v,i[n++]=v>>>24&15|16,i[n++]=v>>>16&255,i[n++]=a>>>8|128,i[n++]=255&a;for(var w=0;w<6;++w)i[n+w]=s[w];return t||l(i)},y=function(e){if(!a(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function m(e,t,r){function n(e,n,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=y(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),(s=r(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return l(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function v(e){return 14+(e+64>>>9<<4)+1}function w(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function b(e,t,r,n,i,o){return w((s=w(w(t,e),w(n,o)))<<(a=i)|s>>>32-a,r);var s,a}function _(e,t,r,n,i,o,s){return b(t&r|~t&n,e,t,i,o,s)}function S(e,t,r,n,i,o,s){return b(t&n|r&~n,e,t,i,o,s)}function E(e,t,r,n,i,o,s){return b(t^r^n,e,t,i,o,s)}function x(e,t,r,n,i,o,s){return b(r^(t|~n),e,t,i,o,s)}const I=m("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=e[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[v(t)-1]=t;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=r,c=n,u=i,l=o;r=_(r,n,i,o,e[s],7,-680876936),o=_(o,r,n,i,e[s+1],12,-389564586),i=_(i,o,r,n,e[s+2],17,606105819),n=_(n,i,o,r,e[s+3],22,-1044525330),r=_(r,n,i,o,e[s+4],7,-176418897),o=_(o,r,n,i,e[s+5],12,1200080426),i=_(i,o,r,n,e[s+6],17,-1473231341),n=_(n,i,o,r,e[s+7],22,-45705983),r=_(r,n,i,o,e[s+8],7,1770035416),o=_(o,r,n,i,e[s+9],12,-1958414417),i=_(i,o,r,n,e[s+10],17,-42063),n=_(n,i,o,r,e[s+11],22,-1990404162),r=_(r,n,i,o,e[s+12],7,1804603682),o=_(o,r,n,i,e[s+13],12,-40341101),i=_(i,o,r,n,e[s+14],17,-1502002290),r=S(r,n=_(n,i,o,r,e[s+15],22,1236535329),i,o,e[s+1],5,-165796510),o=S(o,r,n,i,e[s+6],9,-1069501632),i=S(i,o,r,n,e[s+11],14,643717713),n=S(n,i,o,r,e[s],20,-373897302),r=S(r,n,i,o,e[s+5],5,-701558691),o=S(o,r,n,i,e[s+10],9,38016083),i=S(i,o,r,n,e[s+15],14,-660478335),n=S(n,i,o,r,e[s+4],20,-405537848),r=S(r,n,i,o,e[s+9],5,568446438),o=S(o,r,n,i,e[s+14],9,-1019803690),i=S(i,o,r,n,e[s+3],14,-187363961),n=S(n,i,o,r,e[s+8],20,1163531501),r=S(r,n,i,o,e[s+13],5,-1444681467),o=S(o,r,n,i,e[s+2],9,-51403784),i=S(i,o,r,n,e[s+7],14,1735328473),r=E(r,n=S(n,i,o,r,e[s+12],20,-1926607734),i,o,e[s+5],4,-378558),o=E(o,r,n,i,e[s+8],11,-2022574463),i=E(i,o,r,n,e[s+11],16,1839030562),n=E(n,i,o,r,e[s+14],23,-35309556),r=E(r,n,i,o,e[s+1],4,-1530992060),o=E(o,r,n,i,e[s+4],11,1272893353),i=E(i,o,r,n,e[s+7],16,-155497632),n=E(n,i,o,r,e[s+10],23,-1094730640),r=E(r,n,i,o,e[s+13],4,681279174),o=E(o,r,n,i,e[s],11,-358537222),i=E(i,o,r,n,e[s+3],16,-722521979),n=E(n,i,o,r,e[s+6],23,76029189),r=E(r,n,i,o,e[s+9],4,-640364487),o=E(o,r,n,i,e[s+12],11,-421815835),i=E(i,o,r,n,e[s+15],16,530742520),r=x(r,n=E(n,i,o,r,e[s+2],23,-995338651),i,o,e[s],6,-198630844),o=x(o,r,n,i,e[s+7],10,1126891415),i=x(i,o,r,n,e[s+14],15,-1416354905),n=x(n,i,o,r,e[s+5],21,-57434055),r=x(r,n,i,o,e[s+12],6,1700485571),o=x(o,r,n,i,e[s+3],10,-1894986606),i=x(i,o,r,n,e[s+10],15,-1051523),n=x(n,i,o,r,e[s+1],21,-2054922799),r=x(r,n,i,o,e[s+8],6,1873313359),o=x(o,r,n,i,e[s+15],10,-30611744),i=x(i,o,r,n,e[s+6],15,-1560198380),n=x(n,i,o,r,e[s+13],21,1309151649),r=x(r,n,i,o,e[s+4],6,-145523070),o=x(o,r,n,i,e[s+11],10,-1120210379),i=x(i,o,r,n,e[s+2],15,718787259),n=x(n,i,o,r,e[s+9],21,-343485551),r=w(r,a),n=w(n,c),i=w(i,u),o=w(o,l)}return[r,n,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(v(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))})),A=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)};function k(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function F(e,t){return e<<t|e>>>32-t}const T=m("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var i=0;i<n.length;++i)e.push(n.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=e[64*c+4*l]<<24|e[64*c+4*l+1]<<16|e[64*c+4*l+2]<<8|e[64*c+4*l+3];a[c]=u}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<s;++d){for(var h=new Uint32Array(80),p=0;p<16;++p)h[p]=a[d][p];for(var f=16;f<80;++f)h[f]=F(h[f-3]^h[f-8]^h[f-14]^h[f-16],1);for(var g=r[0],y=r[1],m=r[2],v=r[3],w=r[4],b=0;b<80;++b){var _=Math.floor(b/20),S=F(g,5)+k(_,y,m,v)+w+t[_]+h[b]>>>0;w=v,v=m,m=F(y,30)>>>0,y=g,g=S}r[0]=r[0]+g>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+w>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),R="00000000-0000-0000-0000-000000000000",C=function(e){if(!a(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},9602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},4411:(e,t,r)=>{"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new a(r,null,t,e):new a(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function o(e,t){e.tail=new a(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function s(e,t){e.head=new a(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function a(e,t,r,n){if(!(this instanceof a))return new a(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)s(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,o=this.head;null!==o&&n<e;n++)o=o.next;var s=[];for(n=0;o&&n<t;n++)s.push(o.value),o=this.removeNode(o);for(null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev),n=0;n<r.length;n++)o=i(this,o,r[n]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(9602)(n)}catch(e){}},7670:()=>{},7289:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CompactEncrypt:()=>Ze,CompactSign:()=>tt,EmbeddedJWK:()=>ut,EncryptJWT:()=>st,FlattenedEncrypt:()=>Ue,FlattenedSign:()=>et,GeneralEncrypt:()=>Me,GeneralSign:()=>nt,SignJWT:()=>ot,UnsecuredJWT:()=>yt,base64url:()=>i,calculateJwkThumbprint:()=>ct,compactDecrypt:()=>Ce,compactVerify:()=>Ve,createLocalJWKSet:()=>pt,createRemoteJWKSet:()=>gt,decodeJwt:()=>bt,decodeProtectedHeader:()=>wt,errors:()=>n,exportJWK:()=>Ne,exportPKCS8:()=>je,exportSPKI:()=>Oe,flattenedDecrypt:()=>Re,flattenedVerify:()=>qe,generalDecrypt:()=>Pe,generalVerify:()=>Je,generateKeyPair:()=>St,generateSecret:()=>Et,importJWK:()=>Ie,importPKCS8:()=>xe,importSPKI:()=>Se,importX509:()=>Ee,jwtDecrypt:()=>Xe,jwtVerify:()=>Qe});var n={};r.r(n),r.d(n,{JOSEAlgNotAllowed:()=>E,JOSEError:()=>b,JOSENotSupported:()=>x,JWEDecryptionFailed:()=>I,JWEInvalid:()=>A,JWKInvalid:()=>T,JWKSInvalid:()=>R,JWKSMultipleMatchingKeys:()=>P,JWKSNoMatchingKey:()=>C,JWKSTimeout:()=>O,JWSInvalid:()=>k,JWSSignatureVerificationFailed:()=>j,JWTClaimValidationFailed:()=>_,JWTExpired:()=>S,JWTInvalid:()=>F});var i={};r.r(i),r.d(i,{decode:()=>vt,encode:()=>mt});const o=crypto;function s(e){try{return null!=e&&"boolean"==typeof e.extractable&&"string"==typeof e.algorithm.name&&"string"==typeof e.type}catch(e){return!1}}const a=async(e,t)=>{const r=`SHA-${e.slice(-3)}`;return new Uint8Array(await o.subtle.digest(r,t))},c=new TextEncoder,u=new TextDecoder,l=2**32;function d(...e){const t=e.reduce(((e,{length:t})=>e+t),0),r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(e,n),n+=e.length})),r}function h(e,t,r){if(t<0||t>=l)throw new RangeError(`value must be >= 0 and <= 4294967295. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function p(e){const t=Math.floor(e/l),r=e%l,n=new Uint8Array(8);return h(n,t,0),h(n,r,4),n}function f(e){const t=new Uint8Array(4);return h(t,e),t}function g(e){return d(f(e.length),e)}const y=e=>{let t=e;"string"==typeof t&&(t=c.encode(t));const r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))},m=e=>y(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),v=e=>new Uint8Array(atob(e).split("").map((e=>e.charCodeAt(0)))),w=e=>{let t=e;t instanceof Uint8Array&&(t=u.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return v(t)}catch(e){throw new TypeError("The input to be decoded is not correctly encoded.")}};class b extends Error{constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}static get code(){return"ERR_JOSE_GENERIC"}}class _ extends b{constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}}class S extends b{constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}static get code(){return"ERR_JWT_EXPIRED"}}class E extends b{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class x extends b{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class I extends b{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class A extends b{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}class k extends b{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}}class F extends b{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}}class T extends b{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}}class R extends b{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}}class C extends b{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}}class P extends b{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}class O extends b{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}}class j extends b{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}const N=o.getRandomValues.bind(o);function D(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new x(`Unsupported JWE Algorithm: ${e}`)}}const L=e=>N(new Uint8Array(D(e)>>3)),U=(e,t)=>{if(t.length<<3!==D(e))throw new A("Invalid Initialization Vector length")},B=(e,t)=>{if(e.length<<3!==t)throw new A("Invalid Content Encryption Key length")};function M(){return"function"==typeof WebSocketPair}function H(){try{return void 0!==process.versions.node}catch(e){return!1}}function K(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function q(e,t){return e.name===t}function V(e){return parseInt(e.name.slice(4),10)}function J(e,t){if(t.length&&!t.some((t=>e.usages.includes(t)))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}function W(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!q(e.algorithm,"AES-GCM"))throw K("AES-GCM");const r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw K(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!q(e.algorithm,"AES-KW"))throw K("AES-KW");const r=parseInt(t.slice(1,4),10);if(e.algorithm.length!==r)throw K(r,"algorithm.length");break}case"ECDH-ES":if(!q(e.algorithm,"ECDH"))throw K("ECDH");break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!q(e.algorithm,"PBKDF2"))throw K("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!q(e.algorithm,"RSA-OAEP"))throw K("RSA-OAEP");const r=parseInt(t.slice(9),10)||1;if(V(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}J(e,r)}const $=(e,...t)=>{let r="Key must be ";if(t.length>2){const e=t.pop();r+=`one of type ${t.join(", ")}, or ${e}.`}else 2===t.length?r+=`one of type ${t[0]} or ${t[1]}.`:r+=`of type ${t[0]}.`;return null==e?r+=` Received ${e}`:"function"==typeof e&&e.name?r+=` Received function ${e.name}`:"object"==typeof e&&null!=e&&e.constructor&&e.constructor.name&&(r+=` Received an instance of ${e.constructor.name}`),r},z=e=>s(e),G=["CryptoKey"],Y=async(e,t,r,n,i,a)=>{if(!(s(t)||t instanceof Uint8Array))throw new TypeError($(t,...G,"Uint8Array"));switch(U(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&B(t,parseInt(e.slice(-3),10)),async function(e,t,r,n,i,s){if(!(t instanceof Uint8Array))throw new TypeError($(t,"Uint8Array"));const a=parseInt(e.slice(1,4),10),c=await o.subtle.importKey("raw",t.subarray(a>>3),"AES-CBC",!1,["decrypt"]),u=await o.subtle.importKey("raw",t.subarray(0,a>>3),{hash:"SHA-"+(a<<1),name:"HMAC"},!1,["sign"]),l=d(s,n,r,p(s.length<<3)),h=new Uint8Array((await o.subtle.sign("HMAC",u,l)).slice(0,a>>3));let f,g;try{f=((e,t)=>{if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");if(e.length!==t.length)throw new TypeError("Input buffers must have the same length");const r=e.length;let n=0,i=-1;for(;++i<r;)n|=e[i]^t[i];return 0===n})(i,h)}catch(e){}if(!f)throw new I;try{g=new Uint8Array(await o.subtle.decrypt({iv:n,name:"AES-CBC"},c,r))}catch(e){}if(!g)throw new I;return g}(e,t,r,n,i,a);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&B(t,parseInt(e.slice(1,4),10)),async function(e,t,r,n,i,s){let a;t instanceof Uint8Array?a=await o.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(W(t,e,"decrypt"),a=t);try{return new Uint8Array(await o.subtle.decrypt({additionalData:s,iv:n,name:"AES-GCM",tagLength:128},a,d(r,i)))}catch(e){throw new I}}(e,t,r,n,i,a);default:throw new x("Unsupported JWE Content Encryption Algorithm")}},Q=async()=>{throw new x('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},X=async()=>{throw new x('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')},Z=(...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let r;for(const e of t){const t=Object.keys(e);if(r&&0!==r.size)for(const e of t){if(r.has(e))return!1;r.add(e)}else r=new Set(t)}return!0};function ee(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let r=e;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r}const te=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];function re(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${t}`)}function ne(e,t,r){if(s(e))return W(e,t,r),e;if(e instanceof Uint8Array)return o.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw new TypeError($(e,...G,"Uint8Array"))}const ie=async(e,t,r)=>{const n=await ne(t,e,"wrapKey");re(n,e);const i=await o.subtle.importKey("raw",r,...te);return new Uint8Array(await o.subtle.wrapKey("raw",i,n,"AES-KW"))},oe=async(e,t,r)=>{const n=await ne(t,e,"unwrapKey");re(n,e);const i=await o.subtle.unwrapKey("raw",r,n,"AES-KW",...te);return new Uint8Array(await o.subtle.exportKey("raw",i))};async function se(e,t,r,n,i=new Uint8Array(0),u=new Uint8Array(0)){if(!s(e))throw new TypeError($(e,...G));if(W(e,"ECDH-ES"),!s(t))throw new TypeError($(t,...G));W(t,"ECDH-ES","deriveBits","deriveKey");const l=d(g(c.encode(r)),g(i),g(u),f(n));if(!t.usages.includes("deriveBits"))throw new TypeError('ECDH-ES private key "usages" must include "deriveBits"');return async function(e,t,r){const n=Math.ceil((t>>3)/32);let i;for(let t=1;t<=n;t++){const n=new Uint8Array(4+e.length+r.length);n.set(f(t)),n.set(e,4),n.set(r,4+e.length),i=i?d(i,await a("sha256",n)):await a("sha256",n)}return i=i.slice(0,t>>3),i}(new Uint8Array(await o.subtle.deriveBits({name:"ECDH",public:e},t,Math.ceil(parseInt(t.algorithm.namedCurve.slice(-3),10)/8)<<3)),n,l)}function ae(e){if(!s(e))throw new TypeError($(e,...G));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)}async function ce(e,t,r,n){!function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new A("PBES2 Salt Input must be 8 or more octets")}(e);const i=function(e,t){return d(c.encode(e),new Uint8Array([0]),t)}(t,e),a=parseInt(t.slice(13,16),10),u={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:i},l={length:a,name:"AES-KW"},h=await function(e,t){if(e instanceof Uint8Array)return o.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(s(e))return W(e,t,"deriveBits","deriveKey"),e;throw new TypeError($(e,...G,"Uint8Array"))}(n,t);if(h.usages.includes("deriveBits"))return new Uint8Array(await o.subtle.deriveBits(u,h,a));if(h.usages.includes("deriveKey"))return o.subtle.deriveKey(u,h,l,!1,["wrapKey","unwrapKey"]);throw new TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}function ue(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new x(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}const le=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};function de(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new x(`Unsupported JWE Algorithm: ${e}`)}}const he=e=>N(new Uint8Array(de(e)>>3)),pe=(e,t)=>`-----BEGIN ${t}-----\n${(e.match(/.{1,64}/g)||[]).join("\n")}\n-----END ${t}-----`,fe=async(e,t,r)=>{if(!s(r))throw new TypeError($(r,...G));if(!r.extractable)throw new TypeError("CryptoKey is not extractable");if(r.type!==e)throw new TypeError(`key is not a ${e} key`);return pe(y(new Uint8Array(await o.subtle.exportKey(t,r))),`${e.toUpperCase()} KEY`)},ge=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let n=e.indexOf(t[0],r);if(-1===n)return!1;const i=e.subarray(n,n+t.length);return i.length===t.length&&(i.every(((e,r)=>e===t[r]))||ge(e,t,n+1))},ye=e=>{switch(!0){case ge(e,[42,134,72,206,61,3,1,7]):return"P-256";case ge(e,[43,129,4,0,34]):return"P-384";case ge(e,[43,129,4,0,35]):return"P-521";case(M()||H())&&ge(e,[43,101,112]):return"Ed25519";case H()&&ge(e,[43,101,113]):return"Ed448";default:throw new x("Invalid or unsupported EC Key Curve or OKP Key Sub Type")}},me=async(e,t,r,n,i)=>{var s;let a,c;const u=new Uint8Array(atob(r.replace(e,"")).split("").map((e=>e.charCodeAt(0)))),l="spki"===t;switch(n){case"PS256":case"PS384":case"PS512":a={name:"RSA-PSS",hash:`SHA-${n.slice(-3)}`},c=l?["verify"]:["sign"];break;case"RS256":case"RS384":case"RS512":a={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${n.slice(-3)}`},c=l?["verify"]:["sign"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":a={name:"RSA-OAEP",hash:`SHA-${parseInt(n.slice(-3),10)||1}`},c=l?["encrypt","wrapKey"]:["decrypt","unwrapKey"];break;case"ES256":a={name:"ECDSA",namedCurve:"P-256"},c=l?["verify"]:["sign"];break;case"ES384":a={name:"ECDSA",namedCurve:"P-384"},c=l?["verify"]:["sign"];break;case"ES512":a={name:"ECDSA",namedCurve:"P-521"},c=l?["verify"]:["sign"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":a={name:"ECDH",namedCurve:ye(u)},c=l?[]:["deriveBits"];break;case(M()||H())&&"EdDSA":const e=ye(u).toUpperCase();a={name:`NODE-${e}`,namedCurve:`NODE-${e}`},c=l?["verify"]:["sign"];break;default:throw new x('Invalid or unsupported "alg" (Algorithm) value')}return o.subtle.importKey(t,u,a,null!==(s=null==i?void 0:i.extractable)&&void 0!==s&&s,c)},ve=(e,t,r)=>me(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,"spki",e,t,r),we=async e=>{var t,r;const{algorithm:n,keyUsages:i}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new x(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case(M()||H())&&"OKP":if("EdDSA"!==e.alg)throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value');switch(e.crv){case"Ed25519":t={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},r=e.d?["sign"]:["verify"];break;case H()&&"Ed448":t={name:"NODE-ED448",namedCurve:"NODE-ED448"},r=e.d?["sign"]:["verify"];break;default:throw new x('Invalid or unsupported JWK "crv" (Subtype of Key Pair) Parameter value')}break;default:throw new x('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),s=[n,null!==(t=e.ext)&&void 0!==t&&t,null!==(r=e.key_ops)&&void 0!==r?r:i];if("PBKDF2"===n.name)return o.subtle.importKey("raw",w(e.k),...s);const a={...e};return delete a.alg,o.subtle.importKey("jwk",a,...s)};function be(e){let t=[],r=0;for(;r<e.length;){let n=_e(e.subarray(r));t.push(n),r+=n.byteLength}return t}function _e(e){let t=0,r=31&e[0];if(t++,31===r){for(r=0;e[t]>=128;)r=128*r+e[t]-128,t++;r=128*r+e[t]-128,t++}let n=0;if(e[t]<128)n=e[t],t++;else{let r=127&e[t];t++,n=0;for(let i=0;i<r;i++)n=256*n+e[t],t++}if(128===n){for(n=0;0!==e[t+n]||0!==e[t+n+1];)n++;const r=t+n+2;return{byteLength:r,contents:e.subarray(t,t+n),raw:e.subarray(0,r)}}const i=t+n;return{byteLength:i,contents:e.subarray(t,i),raw:e.subarray(0,i)}}async function Se(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw new TypeError('"spki" must be SPKI formatted string');return ve(e,t,r)}async function Ee(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw new TypeError('"x509" must be X.509 formatted string');const n=function(e){const t=e.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\s)/g,""),r=v(t);return pe(function(e){const t=be(be(_e(e).contents)[0].contents);return y(t[160===t[0].raw[0]?6:5].raw)}(r),"PUBLIC KEY")}(e);return ve(n,t,r)}async function xe(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw new TypeError('"pkcs8" must be PCKS8 formatted string');return((e,t,r)=>me(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,"pkcs8",e,t,r))(e,t,r)}async function Ie(e,t,r){if(!ee(e))throw new TypeError("JWK must be an object");if(t||(t=e.alg),"string"!=typeof t||!t)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');switch(e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return null!=r||(r=!0!==e.ext),r?we({...e,alg:t,ext:!1}):w(e.k);case"RSA":if(void 0!==e.oth)throw new x('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return we({...e,alg:t});default:throw new x('Unsupported "kty" (Key Type) Parameter value')}}const Ae=(e,t,r)=>{e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e)?(e=>{if(!(e instanceof Uint8Array)){if(!z(e))throw new TypeError($(e,...G,"Uint8Array"));if("secret"!==e.type)throw new TypeError(`${G.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}})(t):((e,t)=>{if(!z(e))throw new TypeError($(e,...G));if("secret"===e.type)throw new TypeError(`${G.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===t&&"public"===e.type)throw new TypeError(`${G.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===t&&"public"===e.type)throw new TypeError(`${G.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(e.algorithm&&"verify"===t&&"private"===e.type)throw new TypeError(`${G.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(e.algorithm&&"encrypt"===t&&"private"===e.type)throw new TypeError(`${G.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)})(t,r)},ke=async(e,t,r,n,i)=>{if(!(s(r)||r instanceof Uint8Array))throw new TypeError($(r,...G,"Uint8Array"));switch(U(e,n),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&B(r,parseInt(e.slice(-3),10)),async function(e,t,r,n,i){if(!(r instanceof Uint8Array))throw new TypeError($(r,"Uint8Array"));const s=parseInt(e.slice(1,4),10),a=await o.subtle.importKey("raw",r.subarray(s>>3),"AES-CBC",!1,["encrypt"]),c=await o.subtle.importKey("raw",r.subarray(0,s>>3),{hash:"SHA-"+(s<<1),name:"HMAC"},!1,["sign"]),u=new Uint8Array(await o.subtle.encrypt({iv:n,name:"AES-CBC"},a,t)),l=d(i,n,u,p(i.length<<3));return{ciphertext:u,tag:new Uint8Array((await o.subtle.sign("HMAC",c,l)).slice(0,s>>3))}}(e,t,r,n,i);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&B(r,parseInt(e.slice(1,4),10)),async function(e,t,r,n,i){let s;r instanceof Uint8Array?s=await o.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(W(r,e,"encrypt"),s=r);const a=new Uint8Array(await o.subtle.encrypt({additionalData:i,iv:n,name:"AES-GCM",tagLength:128},s,t)),c=a.slice(-16);return{ciphertext:a.slice(0,-16),tag:c}}(e,t,r,n,i);default:throw new x("Unsupported JWE Content Encryption Algorithm")}},Fe=function(e,t,r,n,i){if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some((e=>"string"!=typeof e||0===e.length)))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;o=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t;for(const t of n.crit){if(!o.has(t))throw new x(`Extension Header Parameter "${t}" is not recognized`);if(void 0===i[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(o.get(t)&&void 0===n[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(n.crit)},Te=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some((e=>"string"!=typeof e))))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function Re(e,t,r){var n;if(!ee(e))throw new A("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new A("JOSE Header missing");if("string"!=typeof e.iv)throw new A("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new A("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new A("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new A("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new A("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new A("JWE AAD incorrect type");if(void 0!==e.header&&!ee(e.header))throw new A("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!ee(e.unprotected))throw new A("JWE Per-Recipient Unprotected Header incorrect type");let i;if(e.protected){const t=w(e.protected);try{i=JSON.parse(u.decode(t))}catch(e){throw new A("JWE Protected Header is invalid")}}if(!Z(i,e.header,e.unprotected))throw new A("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");const a={...i,...e.header,...e.unprotected};if(Fe(A,new Map,null==r?void 0:r.crit,i,a),void 0!==a.zip){if(!i||!i.zip)throw new A('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==a.zip)throw new x('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}const{alg:l,enc:h}=a;if("string"!=typeof l||!l)throw new A("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof h||!h)throw new A("missing JWE Encryption Algorithm (enc) in JWE Header");const p=r&&Te("keyManagementAlgorithms",r.keyManagementAlgorithms),f=r&&Te("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(p&&!p.has(l))throw new E('"alg" (Algorithm) Header Parameter not allowed');if(f&&!f.has(h))throw new E('"enc" (Encryption Algorithm) Header Parameter not allowed');let g;void 0!==e.encrypted_key&&(g=w(e.encrypted_key));let y,m=!1;"function"==typeof t&&(t=await t(i,e),m=!0);try{y=await async function(e,t,r,n){switch(Ae(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new A("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new A("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!ee(n.epk))throw new A('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!ae(t))throw new x("ECDH-ES with the provided key is not allowed or not supported by your javascript runtime");const i=await Ie(n.epk,e);let o,s;if(void 0!==n.apu){if("string"!=typeof n.apu)throw new A('JOSE Header "apu" (Agreement PartyUInfo) invalid');o=w(n.apu)}if(void 0!==n.apv){if("string"!=typeof n.apv)throw new A('JOSE Header "apv" (Agreement PartyVInfo) invalid');s=w(n.apv)}const a=await se(i,t,"ECDH-ES"===e?n.enc:e,"ECDH-ES"===e?de(n.enc):parseInt(e.slice(-5,-2),10),o,s);if("ECDH-ES"===e)return a;if(void 0===r)throw new A("JWE Encrypted Key missing");return oe(e.slice(-6),a,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new A("JWE Encrypted Key missing");return(async(e,t,r)=>{if(!s(t))throw new TypeError($(t,...G));if(W(t,e,"decrypt","unwrapKey"),le(e,t),t.usages.includes("decrypt"))return new Uint8Array(await o.subtle.decrypt(ue(e),t,r));if(t.usages.includes("unwrapKey")){const n=await o.subtle.unwrapKey("raw",r,t,ue(e),...te);return new Uint8Array(await o.subtle.exportKey("raw",n))}throw new TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')})(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(void 0===r)throw new A("JWE Encrypted Key missing");if("number"!=typeof n.p2c)throw new A('JOSE Header "p2c" (PBES2 Count) missing or invalid');if("string"!=typeof n.p2s)throw new A('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return(async(e,t,r,n,i)=>{const o=await ce(i,e,n,t);return oe(e.slice(-6),o,r)})(e,t,r,n.p2c,w(n.p2s));case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new A("JWE Encrypted Key missing");return oe(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":if(void 0===r)throw new A("JWE Encrypted Key missing");if("string"!=typeof n.iv)throw new A('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof n.tag)throw new A('JOSE Header "tag" (Authentication Tag) missing or invalid');return async function(e,t,r,n,i){const o=e.slice(0,7);return Y(o,t,r,n,i,new Uint8Array(0))}(e,t,r,w(n.iv),w(n.tag));default:throw new x('Invalid or unsupported "alg" (JWE Algorithm) header value')}}(l,t,g,a)}catch(e){if(e instanceof TypeError)throw e;y=he(h)}const v=w(e.iv),b=w(e.tag),_=c.encode(null!==(n=e.protected)&&void 0!==n?n:"");let S;S=void 0!==e.aad?d(_,c.encode("."),c.encode(e.aad)):_;let I=await Y(h,y,w(e.ciphertext),v,b,S);"DEF"===a.zip&&(I=await((null==r?void 0:r.inflateRaw)||Q)(I));const k={plaintext:I};return void 0!==e.protected&&(k.protectedHeader=i),void 0!==e.aad&&(k.additionalAuthenticatedData=w(e.aad)),void 0!==e.unprotected&&(k.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(k.unprotectedHeader=e.header),m?{...k,key:t}:k}async function Ce(e,t,r){if(e instanceof Uint8Array&&(e=u.decode(e)),"string"!=typeof e)throw new A("Compact JWE must be a string or Uint8Array");const{0:n,1:i,2:o,3:s,4:a,length:c}=e.split(".");if(5!==c)throw new A("Invalid Compact JWE");const l=await Re({ciphertext:s||void 0,iv:o||void 0,protected:n||void 0,tag:a||void 0,encrypted_key:i||void 0},t,r),d={plaintext:l.plaintext,protectedHeader:l.protectedHeader};return"function"==typeof t?{...d,key:l.key}:d}async function Pe(e,t,r){if(!ee(e))throw new A("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(ee))throw new A("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new A("JWE Recipients has no members");for(const n of e.recipients)try{return await Re({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch(e){}throw new I}async function Oe(e){return(e=>fe("public","spki",e))(e)}async function je(e){return(e=>fe("private","pkcs8",e))(e)}async function Ne(e){return(async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:m(e)};if(!s(e))throw new TypeError($(e,...G,"Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:t,key_ops:r,alg:n,use:i,...a}=await o.subtle.exportKey("jwk",e);return a})(e)}const De=async function(e,t,r,n,i={}){let a,c,u;switch(Ae(e,r,"encrypt"),e){case"dir":u=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!ae(r))throw new x("ECDH-ES with the provided key is not allowed or not supported by your javascript runtime");const{apu:l,apv:d}=i;let{epk:h}=i;h||(h=(await async function(e){if(!s(e))throw new TypeError($(e,...G));return o.subtle.generateKey(e.algorithm,!0,["deriveBits"])}(r)).privateKey);const{x:p,y:f,crv:g,kty:y}=await Ne(h),v=await se(r,h,"ECDH-ES"===e?t:e,"ECDH-ES"===e?de(t):parseInt(e.slice(-5,-2),10),l,d);if(c={epk:{x:p,crv:g,kty:y}},"EC"===y&&(c.epk.y=f),l&&(c.apu=m(l)),d&&(c.apv=m(d)),"ECDH-ES"===e){u=v;break}u=n||he(t);const w=e.slice(-6);a=await ie(w,v,u);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":u=n||he(t),a=await(async(e,t,r)=>{if(!s(t))throw new TypeError($(t,...G));if(W(t,e,"encrypt","wrapKey"),le(e,t),t.usages.includes("encrypt"))return new Uint8Array(await o.subtle.encrypt(ue(e),t,r));if(t.usages.includes("wrapKey")){const n=await o.subtle.importKey("raw",r,...te);return new Uint8Array(await o.subtle.wrapKey("raw",n,t,ue(e)))}throw new TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')})(e,r,u);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{u=n||he(t);const{p2c:o,p2s:s}=i;({encryptedKey:a,...c}=await(async(e,t,r,n=Math.floor(2049*Math.random())+2048,i=N(new Uint8Array(16)))=>{const o=await ce(i,e,n,t);return{encryptedKey:await ie(e.slice(-6),o,r),p2c:n,p2s:m(i)}})(e,r,u,o,s));break}case"A128KW":case"A192KW":case"A256KW":u=n||he(t),a=await ie(e,r,u);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{u=n||he(t);const{iv:o}=i;({encryptedKey:a,...c}=await async function(e,t,r,n){const i=e.slice(0,7);n||(n=L(i));const{ciphertext:o,tag:s}=await ke(i,r,t,n,new Uint8Array(0));return{encryptedKey:o,iv:m(n),tag:m(s)}}(e,r,u,o));break}default:throw new x('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:u,encryptedKey:a,parameters:c}},Le=Symbol();class Ue{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new A("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!Z(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new A("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(Fe(A,new Map,null==t?void 0:t.crit,this._protectedHeader,r),void 0!==r.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new A('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==r.zip)throw new x('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}const{alg:n,enc:i}=r;if("string"!=typeof n||!n)throw new A('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof i||!i)throw new A('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let o,s,a,l,h,p,f;if("dir"===n){if(this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===n&&this._cek)throw new TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let r;({cek:s,encryptedKey:o,parameters:r}=await De(n,i,e,this._cek,this._keyManagementParameters)),r&&(t&&Le in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...r}:this.setUnprotectedHeader(r):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...r}:this.setProtectedHeader(r))}if(this._iv||(this._iv=L(i)),l=this._protectedHeader?c.encode(m(JSON.stringify(this._protectedHeader))):c.encode(""),this._aad?(h=m(this._aad),a=d(l,c.encode("."),c.encode(h))):a=l,"DEF"===r.zip){const e=await((null==t?void 0:t.deflateRaw)||X)(this._plaintext);({ciphertext:p,tag:f}=await ke(i,e,s,this._iv,a))}else({ciphertext:p,tag:f}=await ke(i,this._plaintext,s,this._iv,a));const g={ciphertext:m(p),iv:m(this._iv),tag:m(f)};return o&&(g.encrypted_key=m(o)),h&&(g.aad=h),this._protectedHeader&&(g.protected=u.decode(l)),this._sharedUnprotectedHeader&&(g.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(g.header=this._unprotectedHeader),g}}class Be{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}}class Me{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){const r=new Be(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,n;if(!this._recipients.length)throw new A("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){const[t]=this._recipients,r=await new Ue(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e});let n={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(n.aad=r.aad),r.protected&&(n.protected=r.protected),r.unprotected&&(n.unprotected=r.unprotected),r.encrypted_key&&(n.recipients[0].encrypted_key=r.encrypted_key),r.header&&(n.recipients[0].header=r.header),n}let i;for(let e=0;e<this._recipients.length;e++){const t=this._recipients[e];if(!Z(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new A("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:n}=r;if("string"!=typeof n||!n)throw new A('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===n||"ECDH-ES"===n)throw new A('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new A('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(i){if(i!==r.enc)throw new A('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else i=r.enc;if(Fe(A,new Map,t.options.crit,this._protectedHeader,r),!(void 0===r.zip||this._protectedHeader&&this._protectedHeader.zip))throw new A('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}const o=he(i);let s={ciphertext:"",iv:"",recipients:[],tag:""};for(let a=0;a<this._recipients.length;a++){const c=this._recipients[a],u={};if(s.recipients.push(u),0===a){const t=await new Ue(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(o).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(c.unprotectedHeader).encrypt(c.key,{...c.options,...e,[Le]:!0});s.ciphertext=t.ciphertext,s.iv=t.iv,s.tag=t.tag,t.aad&&(s.aad=t.aad),t.protected&&(s.protected=t.protected),t.unprotected&&(s.unprotected=t.unprotected),u.encrypted_key=t.encrypted_key,t.header&&(u.header=t.header);continue}const{encryptedKey:l,parameters:d}=await De((null===(t=c.unprotectedHeader)||void 0===t?void 0:t.alg)||(null===(r=this._protectedHeader)||void 0===r?void 0:r.alg)||(null===(n=this._unprotectedHeader)||void 0===n?void 0:n.alg),i,c.key,o);u.encrypted_key=m(l),(c.unprotectedHeader||d)&&(u.header={...c.unprotectedHeader,...d})}return s}}function He(e,t){const r=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:r,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:r,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:r,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:r,name:"ECDSA",namedCurve:t.namedCurve};case(M()||H())&&"EdDSA":const{namedCurve:n}=t;return{name:n,namedCurve:n};default:throw new x(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}function Ke(e,t,r){if(s(t))return function(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!q(e.algorithm,"HMAC"))throw K("HMAC");const r=parseInt(t.slice(2),10);if(V(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!q(e.algorithm,"RSASSA-PKCS1-v1_5"))throw K("RSASSA-PKCS1-v1_5");const r=parseInt(t.slice(2),10);if(V(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!q(e.algorithm,"RSA-PSS"))throw K("RSA-PSS");const r=parseInt(t.slice(2),10);if(V(e.algorithm.hash)!==r)throw K(`SHA-${r}`,"algorithm.hash");break}case H()&&"EdDSA":if("NODE-ED25519"!==e.algorithm.name&&"NODE-ED448"!==e.algorithm.name)throw K("NODE-ED25519 or NODE-ED448");break;case M()&&"EdDSA":if(!q(e.algorithm,"NODE-ED25519"))throw K("NODE-ED25519");break;case"ES256":case"ES384":case"ES512":{if(!q(e.algorithm,"ECDSA"))throw K("ECDSA");const r=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(e.algorithm.namedCurve!==r)throw K(r,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}J(e,r)}(t,e,r),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError($(t,...G));return o.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[r])}throw new TypeError($(t,...G,"Uint8Array"))}async function qe(e,t,r){var n;if(!ee(e))throw new k("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new k('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new k("JWS Protected Header incorrect type");if(void 0===e.payload)throw new k("JWS Payload missing");if("string"!=typeof e.signature)throw new k("JWS Signature missing or incorrect type");if(void 0!==e.header&&!ee(e.header))throw new k("JWS Unprotected Header incorrect type");let i={};if(e.protected){const t=w(e.protected);try{i=JSON.parse(u.decode(t))}catch(e){throw new k("JWS Protected Header is invalid")}}if(!Z(i,e.header))throw new k("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const s={...i,...e.header};let a=!0;if(Fe(k,new Map([["b64",!0]]),null==r?void 0:r.crit,i,s).has("b64")&&(a=i.b64,"boolean"!=typeof a))throw new k('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:l}=s;if("string"!=typeof l||!l)throw new k('JWS "alg" (Algorithm) Header Parameter missing or invalid');const h=r&&Te("algorithms",r.algorithms);if(h&&!h.has(l))throw new E('"alg" (Algorithm) Header Parameter not allowed');if(a){if("string"!=typeof e.payload)throw new k("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new k("JWS Payload must be a string or an Uint8Array instance");let p=!1;"function"==typeof t&&(t=await t(i,e),p=!0),Ae(l,t,"verify");const f=d(c.encode(null!==(n=e.protected)&&void 0!==n?n:""),c.encode("."),"string"==typeof e.payload?c.encode(e.payload):e.payload),g=w(e.signature);if(!await(async(e,t,r,n)=>{const i=await Ke(e,t,"verify");le(e,i);const s=He(e,i.algorithm);try{return await o.subtle.verify(s,i,r,n)}catch(e){return!1}})(l,t,g,f))throw new j;let y;y=a?w(e.payload):"string"==typeof e.payload?c.encode(e.payload):e.payload;const m={payload:y};return void 0!==e.protected&&(m.protectedHeader=i),void 0!==e.header&&(m.unprotectedHeader=e.header),p?{...m,key:t}:m}async function Ve(e,t,r){if(e instanceof Uint8Array&&(e=u.decode(e)),"string"!=typeof e)throw new k("Compact JWS must be a string or Uint8Array");const{0:n,1:i,2:o,length:s}=e.split(".");if(3!==s)throw new k("Invalid Compact JWS");const a=await qe({payload:i,protected:n,signature:o},t,r),c={payload:a.payload,protectedHeader:a.protectedHeader};return"function"==typeof t?{...c,key:a.key}:c}async function Je(e,t,r){if(!ee(e))throw new k("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(ee))throw new k("JWS Signatures missing or incorrect type");for(const n of e.signatures)try{return await qe({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch(e){}throw new j}const We=e=>Math.floor(e.getTime()/1e3),$e=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i,ze=e=>{const t=$e.exec(e);if(!t)throw new TypeError("Invalid time period format");const r=parseFloat(t[1]);switch(t[2].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(r);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*r);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*r);case"day":case"days":case"d":return Math.round(86400*r);case"week":case"weeks":case"w":return Math.round(604800*r);default:return Math.round(31557600*r)}},Ge=e=>e.toLowerCase().replace(/^application\//,""),Ye=(e,t,r={})=>{const{typ:n}=r;if(n&&("string"!=typeof e.typ||Ge(e.typ)!==Ge(n)))throw new _('unexpected "typ" JWT header value',"typ","check_failed");let i;try{i=JSON.parse(u.decode(t))}catch(e){}if(!ee(i))throw new F("JWT Claims Set must be a top-level JSON object");const{issuer:o}=r;if(o&&!(Array.isArray(o)?o:[o]).includes(i.iss))throw new _('unexpected "iss" claim value',"iss","check_failed");const{subject:s}=r;if(s&&i.sub!==s)throw new _('unexpected "sub" claim value',"sub","check_failed");const{audience:a}=r;if(a&&(l="string"==typeof a?[a]:a,!("string"==typeof(c=i.aud)?l.includes(c):Array.isArray(c)&&l.some(Set.prototype.has.bind(new Set(c))))))throw new _('unexpected "aud" claim value',"aud","check_failed");var c,l;let d;switch(typeof r.clockTolerance){case"string":d=ze(r.clockTolerance);break;case"number":d=r.clockTolerance;break;case"undefined":d=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:h}=r,p=We(h||new Date);if(void 0!==i.iat||r.maxTokenAge){if("number"!=typeof i.iat)throw new _('"iat" claim must be a number',"iat","invalid");if(void 0===i.exp&&i.iat>p+d)throw new _('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}if(void 0!==i.nbf){if("number"!=typeof i.nbf)throw new _('"nbf" claim must be a number',"nbf","invalid");if(i.nbf>p+d)throw new _('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==i.exp){if("number"!=typeof i.exp)throw new _('"exp" claim must be a number',"exp","invalid");if(i.exp<=p-d)throw new S('"exp" claim timestamp check failed',"exp","check_failed")}if(r.maxTokenAge){const e=p-i.iat;if(e-d>("number"==typeof r.maxTokenAge?r.maxTokenAge:ze(r.maxTokenAge)))throw new S('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-d)throw new _('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return i};async function Qe(e,t,r){var n;const i=await Ve(e,t,r);if((null===(n=i.protectedHeader.crit)||void 0===n?void 0:n.includes("b64"))&&!1===i.protectedHeader.b64)throw new F("JWTs MUST NOT use unencoded payload");const o={payload:Ye(i.protectedHeader,i.payload,r),protectedHeader:i.protectedHeader};return"function"==typeof t?{...o,key:i.key}:o}async function Xe(e,t,r){const n=await Ce(e,t,r),i=Ye(n.protectedHeader,n.plaintext,r),{protectedHeader:o}=n;if(void 0!==o.iss&&o.iss!==i.iss)throw new _('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==o.sub&&o.sub!==i.sub)throw new _('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==o.aud&&JSON.stringify(o.aud)!==JSON.stringify(i.aud))throw new _('replicated "aud" claim header parameter mismatch',"aud","mismatch");const s={payload:i,protectedHeader:o};return"function"==typeof t?{...s,key:n.key}:s}class Ze{constructor(e){this._flattened=new Ue(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){const r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}}class et{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new k("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!Z(this._protectedHeader,this._unprotectedHeader))throw new k("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...this._protectedHeader,...this._unprotectedHeader};let n=!0;if(Fe(k,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,r).has("b64")&&(n=this._protectedHeader.b64,"boolean"!=typeof n))throw new k('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:i}=r;if("string"!=typeof i||!i)throw new k('JWS "alg" (Algorithm) Header Parameter missing or invalid');Ae(i,e,"sign");let s,a=this._payload;n&&(a=c.encode(m(a))),s=this._protectedHeader?c.encode(m(JSON.stringify(this._protectedHeader))):c.encode("");const l=d(s,c.encode("."),a),h=await(async(e,t,r)=>{const n=await Ke(e,t,"sign");le(e,n);const i=await o.subtle.sign(He(e,n.algorithm),n,r);return new Uint8Array(i)})(i,e,l),p={signature:m(h),payload:""};return n&&(p.payload=u.decode(a)),this._unprotectedHeader&&(p.header=this._unprotectedHeader),this._protectedHeader&&(p.protected=u.decode(s)),p}}class tt{constructor(e){this._flattened=new et(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const r=await this._flattened.sign(e,t);if(void 0===r.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}}class rt{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}}class nt{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){const r=new rt(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new k("at least one signature must be added");const e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){const r=this._signatures[t],n=new et(this._payload);n.setProtectedHeader(r.protectedHeader),n.setUnprotectedHeader(r.unprotectedHeader);const{payload:i,...o}=await n.sign(r.key,r.options);if(0===t)e.payload=i;else if(e.payload!==i)throw new k("inconsistent use of JWS Unencoded Payload Option (RFC7797)");e.signatures.push(o)}return e}}class it{constructor(e){if(!ee(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return this._payload="number"==typeof e?{...this._payload,nbf:e}:{...this._payload,nbf:We(new Date)+ze(e)},this}setExpirationTime(e){return this._payload="number"==typeof e?{...this._payload,exp:e}:{...this._payload,exp:We(new Date)+ze(e)},this}setIssuedAt(e){return this._payload=void 0===e?{...this._payload,iat:We(new Date)}:{...this._payload,iat:e},this}}class ot extends it{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;const n=new tt(c.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new F("JWTs MUST NOT use unencoded payload");return n.sign(e,t)}}class st extends it{setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw new TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw new TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw new TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){const r=new Ze(c.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}}const at=(e,t)=>{if("string"!=typeof e||!e)throw new T(`${t} missing or invalid`)};async function ct(e,t="sha256"){if(!ee(e))throw new TypeError("JWK must be an object");if("sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let r;switch(e.kty){case"EC":at(e.crv,'"crv" (Curve) Parameter'),at(e.x,'"x" (X Coordinate) Parameter'),at(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":at(e.crv,'"crv" (Subtype of Key Pair) Parameter'),at(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":at(e.e,'"e" (Exponent) Parameter'),at(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":at(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new x('"kty" (Key Type) Parameter missing or unsupported')}const n=c.encode(JSON.stringify(r));return m(await a(t,n))}async function ut(e,t){const r={...e,...t.header};if(!ee(r.jwk))throw new k('"jwk" (JSON Web Key) Header Parameter must be a JSON object');const n=await Ie({...r.jwk,ext:!0},r.alg,!0);if(n instanceof Uint8Array||"public"!==n.type)throw new k('"jwk" (JSON Web Key) Header Parameter must be a public key');return n}function lt(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(dt)}function dt(e){return ee(e)}class ht{constructor(e){if(this._cached=new WeakMap,!lt(e))throw new R("JSON Web Key Set malformed");var t;this._jwks=(t=e,"function"==typeof structuredClone?structuredClone(t):JSON.parse(JSON.stringify(t)))}async getKey(e,t){const{alg:r,kid:n}={...e,...t.header},i=this._jwks.keys.filter((e=>{let t=e.kty===function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new x('Unsupported "alg" value for a JSON Web Key Set')}}(r);if(t&&"string"==typeof n&&(t=n===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t})),{0:o,length:s}=i;if(0===s)throw new C;if(1!==s)throw new P;const a=this._cached.get(o)||this._cached.set(o,{}).get(o);if(void 0===a[r]){const e=await Ie({...o,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new R("JSON Web Key Set members must be public keys");a[r]=e}return a[r]}}function pt(e){return ht.prototype.getKey.bind(new ht(e))}class ft extends ht{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw new TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4}coolingDown(){return!!this._cooldownStarted&&Date.now()<this._cooldownStarted+this._cooldownDuration}async getKey(e,t){this._jwks||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof C&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){if(this._pendingFetch&&M())return new Promise((e=>{const t=()=>{void 0===this._pendingFetch?e():setTimeout(t,5)};t()}));this._pendingFetch||(this._pendingFetch=(async(e,t)=>{let r,n,i=!1;"function"==typeof AbortController&&(r=new AbortController,n=setTimeout((()=>{i=!0,r.abort()}),t));const o=await fetch(e.href,{signal:r?r.signal:void 0,redirect:"manual",method:"GET",...M()?void 0:{referrerPolicy:"no-referrer",credentials:"omit",mode:"cors"}}).catch((e=>{if(i)throw new O;throw e}));if(void 0!==n&&clearTimeout(n),200!==o.status)throw new b("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await o.json()}catch(e){throw new b("Failed to parse the JSON Web Key Set HTTP response as JSON")}})(this._url,this._timeoutDuration,this._options).then((e=>{if(!lt(e))throw new R("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._cooldownStarted=Date.now(),this._pendingFetch=void 0})).catch((e=>{throw this._pendingFetch=void 0,e}))),await this._pendingFetch}}function gt(e,t){return ft.prototype.getKey.bind(new ft(e,t))}class yt extends it{encode(){return`${m(JSON.stringify({alg:"none"}))}.${m(JSON.stringify(this._payload))}.`}static decode(e,t){if("string"!=typeof e)throw new F("Unsecured JWT must be a string");const{0:r,1:n,2:i,length:o}=e.split(".");if(3!==o||""!==i)throw new F("Invalid Unsecured JWT");let s;try{if(s=JSON.parse(u.decode(w(r))),"none"!==s.alg)throw new Error}catch(e){throw new F("Invalid Unsecured JWT")}return{payload:Ye(s,w(n),t),header:s}}}const mt=m,vt=w;function wt(e){let t;if("string"==typeof e){const r=e.split(".");3!==r.length&&5!==r.length||([t]=r)}else if("object"==typeof e&&e){if(!("protected"in e))throw new TypeError("Token does not contain a Protected Header");t=e.protected}try{if("string"!=typeof t||!t)throw new Error;const e=JSON.parse(u.decode(vt(t)));if(!ee(e))throw new Error;return e}catch(e){throw new TypeError("Invalid Token or Protected Header formatting")}}function bt(e){if("string"!=typeof e)throw new F("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:r}=e.split(".");if(5===r)throw new F("Only JWTs using Compact JWS serialization can be decoded");if(3!==r)throw new F("Invalid JWT");if(!t)throw new F("JWTs must contain a payload");let n,i;try{n=vt(t)}catch(e){throw new F("Failed to parse the base64url encoded payload")}try{i=JSON.parse(u.decode(n))}catch(e){throw new F("Failed to parse the decoded payload as JSON")}if(!ee(i))throw new F("Invalid JWT Claims Set");return i}function _t(e){var t;const r=null!==(t=null==e?void 0:e.modulusLength)&&void 0!==t?t:2048;if("number"!=typeof r||r<2048)throw new x("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function St(e,t){return async function(e,t){var r,n;let i,s;switch(e){case"PS256":case"PS384":case"PS512":i={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:_t(t)},s=["sign","verify"];break;case"RS256":case"RS384":case"RS512":i={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:_t(t)},s=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":i={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:_t(t)},s=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":i={name:"ECDSA",namedCurve:"P-256"},s=["sign","verify"];break;case"ES384":i={name:"ECDSA",namedCurve:"P-384"},s=["sign","verify"];break;case"ES512":i={name:"ECDSA",namedCurve:"P-521"},s=["sign","verify"];break;case(M()||H())&&"EdDSA":switch(null==t?void 0:t.crv){case void 0:case"Ed25519":i={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},s=["sign","verify"];break;case H()&&"Ed448":i={name:"NODE-ED448",namedCurve:"NODE-ED448"},s=["sign","verify"];break;default:throw new x("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":i={name:"ECDH",namedCurve:null!==(r=null==t?void 0:t.crv)&&void 0!==r?r:"P-256"},s=["deriveKey","deriveBits"];break;default:throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return o.subtle.generateKey(i,null!==(n=null==t?void 0:t.extractable)&&void 0!==n&&n,s)}(e,t)}async function Et(e,t){return async function(e,t){var r;let n,i,s;switch(e){case"HS256":case"HS384":case"HS512":n=parseInt(e.slice(-3),10),i={name:"HMAC",hash:`SHA-${n}`,length:n},s=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n=parseInt(e.slice(-3),10),N(new Uint8Array(n>>3));case"A128KW":case"A192KW":case"A256KW":n=parseInt(e.slice(1,4),10),i={name:"AES-KW",length:n},s=["wrapKey","unwrapKey"];break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":n=parseInt(e.slice(1,4),10),i={name:"AES-GCM",length:n},s=["encrypt","decrypt"];break;default:throw new x('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return o.subtle.generateKey(i,null!==(r=null==t?void 0:t.extractable)&&void 0!==r&&r,s)}(e,t)}}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(r,n){if(1&n&&(r=this(r)),8&n)return r;if("object"==typeof r&&r){if(4&n&&r.__esModule)return r;if(16&n&&"function"==typeof r.then)return r}var o=Object.create(null);i.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&n&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,i.d(o,s),o},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=i(8825);i(6521).dataset;const t="https://inrupt.com/.well-known/sdk-local-node/",r=Object.freeze;function n(e){return e.substring(0,t.length)===t}function o(e){return e.substring(t.length)}function s(e){return"string"==typeof e&&"_:"===e.substring(0,2)}function a(e){return e.substring(2)}function c(e){return`_:${e.value}`}function u(e){return"string"==typeof e?e:e.value}const l="http://www.w3.org/2001/XMLSchema#boolean",d="http://www.w3.org/2001/XMLSchema#dateTime",h="http://www.w3.org/2001/XMLSchema#date",p="http://www.w3.org/2001/XMLSchema#time",f="http://www.w3.org/2001/XMLSchema#decimal",g="http://www.w3.org/2001/XMLSchema#integer",y="http://www.w3.org/2001/XMLSchema#string",m="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString";function v(e){return"true"===e||"1"===e||"false"!==e&&"0"!==e&&null}function w(e){if(!/-?\d{4,}-\d\d-\d\dT\d\d:\d\d:\d\d(\.\d+)?(Z|(\+|-)\d\d:\d\d)?/.test(e))return null;const[t,r]=e.split("T"),[n,i]="-"===t.charAt(0)?[-1,t.substring(1)]:[1,t],[o,s,a]=i.split("-"),c=Number.parseInt(o,10)*n,u=Number.parseInt(s,10)-1,l=Number.parseInt(a,10),[d,h]=b(r),[p,f]="string"==typeof h?_(h):[0,0],[g,y,m]=d.split(":"),v=Number.parseInt(g,10)+p,w=Number.parseInt(y,10)+f,[S,E]=m.split("."),x=Number.parseInt(S,10),I=E?Number.parseInt(E,10):0,A=new Date(Date.UTC(c,u,l,v,w,x,I));return c>=0&&c<100&&A.setUTCFullYear(A.getUTCFullYear()-1900),A}function b(e){if(e.endsWith("Z"))return[e.substring(0,e.length-1),"Z"];const t=e.split("+"),r=e.split("-");return 1===t.length&&1===r.length?[t[0],void 0]:t.length>r.length?[t[0],"+"+t[1]]:[r[0],"-"+r[1]]}function _(e){if("Z"===e)return[0,0];const t="+"===e.charAt(0)?1:-1,[r,n]=e.substring(1).split(":");return[Number.parseInt(r,10)*t,Number.parseInt(n,10)*t]}function S(e){const t=Number.parseFloat(e);return Number.isNaN(t)?null:t}function E(e){const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t}function x(e){return e.toLowerCase()}function I(e){return A(e)&&"NamedNode"===e.termType}function A(e){return null!==e&&"object"==typeof e&&"string"==typeof e.termType&&"string"==typeof e.value&&"function"==typeof e.equals}function k(e){return I(e)&&n(e.value)}function F(e){const t=u(e);if("function"!=typeof URL)return!0;try{new URL(t)}catch(e){return!1}return!0}function T(e,t){return C.namedNode(R(o(e.value),t))}function R(e,t){if("function"!=typeof URL)throw new Error("The URL interface is not available, so an IRI cannot be determined.");const r=new URL(t);return r.hash=e,r.href}const C=e;function P(e,t,n={}){var i;if(!["NamedNode","DefaultGraph"].includes(t.graph.termType))throw new Error(`Cannot parse Quads with nodes of type [${t.graph.termType}] as their Graph node.`);const o="DefaultGraph"===t.graph.termType?"default":t.graph.value,s=null!==(i=e.graphs[o])&&void 0!==i?i:{};return r(Object.assign(Object.assign({},e),{graphs:r(Object.assign(Object.assign({},e.graphs),{[o]:O(s,t,n)}))}))}function O(e,t,n){var i;if(!["NamedNode","BlankNode"].includes(t.subject.termType))throw new Error(`Cannot parse Quads with nodes of type [${t.subject.termType}] as their Subject node.`);const o="BlankNode"===t.subject.termType?`_:${t.subject.value}`:t.subject.value,s=null!==(i=e[o])&&void 0!==i?i:{type:"Subject",url:o,predicates:{}};return r(Object.assign(Object.assign({},e),{[o]:j(s,t,n)}))}function j(e,t,n){return r(Object.assign(Object.assign({},e),{predicates:N(e.predicates,t,n)}))}function N(e,t,n){var i;if(!["NamedNode"].includes(t.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${t.predicate.termType}] as their Predicate node.`);const o=t.predicate.value,s=null!==(i=e[o])&&void 0!==i?i:{};return r(Object.assign(Object.assign({},e),{[o]:D(s,t,n)}))}function D(e,t,n){var i,o,s,a,c,u,l,d;if("NamedNode"===t.object.termType){const n=r([...null!==(i=e.namedNodes)&&void 0!==i?i:[],t.object.value]);return r(Object.assign(Object.assign({},e),{namedNodes:n}))}if("Literal"===t.object.termType){if(t.object.datatype.value===m){const n=t.object.language.toLowerCase(),i=r([...null!==(s=null===(o=e.langStrings)||void 0===o?void 0:o[n])&&void 0!==s?s:[],t.object.value]),c=r(Object.assign(Object.assign({},null!==(a=e.langStrings)&&void 0!==a?a:{}),{[n]:i}));return r(Object.assign(Object.assign({},e),{langStrings:c}))}const n=r([...null!==(u=null===(c=e.literals)||void 0===c?void 0:c[t.object.datatype.value])&&void 0!==u?u:[],t.object.value]),i=r(Object.assign(Object.assign({},null!==(l=e.literals)&&void 0!==l?l:{}),{[t.object.datatype.value]:n}));return r(Object.assign(Object.assign({},e),{literals:i}))}if("BlankNode"===t.object.termType){const i=L(t.object,n),o=r([...null!==(d=e.blankNodes)&&void 0!==d?d:[],i]);return r(Object.assign(Object.assign({},e),{blankNodes:o}))}throw new Error(`Objects of type [${t.object.termType}] are not supported.`)}function L(e,t){var n,i;if(void 0===(null!==(n=t.chainBlankNodes)&&void 0!==n?n:[]).find((t=>t.equals(e))))return c(e);const o=(null!==(i=t.otherQuads)&&void 0!==i?i:[]).filter((t=>t.subject.equals(e))),s=o.filter((e=>!K(e.object))).reduce(((e,n)=>{var i;if(!["NamedNode"].includes(n.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${n.predicate.termType}] as their Predicate node.`);const o=null!==(i=e[n.predicate.value])&&void 0!==i?i:{};return r(Object.assign(Object.assign({},e),{[n.predicate.value]:D(o,n,t)}))}),{}),a=o.filter((e=>K(e.object)));return a.reduce(((e,n)=>{var i,o;if(!["NamedNode"].includes(n.predicate.termType))throw new Error(`Cannot parse Quads with nodes of type [${n.predicate.termType}] as their Predicate node.`);const s=null!==(i=e[n.predicate.value])&&void 0!==i?i:{},a=null!==(o=s.blankNodes)&&void 0!==o?o:[];return r(Object.assign(Object.assign({},e),{[n.predicate.value]:Object.assign(Object.assign({},s),{blankNodes:[...a,L(n.object,t)]})}))}),s)}function U(e){const t=e.map((e=>e.subject)).filter(K),r=e.map((e=>e.object)).filter(K),n=[];r.forEach((t=>{n.push(...H(t,e))}));const i=t.concat(r).filter((t=>{if(n.some((e=>e.equals(t))))return!1;const r=e.filter((e=>e.object.equals(t))).map((e=>e.subject));return r.length>0&&(i=r).every((e=>i.every((t=>e.equals(t)))));var i}));return i}function B(t,r={}){var n;const i=[],o=null!==(n=r.dataFactory)&&void 0!==n?n:e;return Object.keys(t.graphs).forEach((e=>{const n=t.graphs[e],c="default"===e?o.defaultGraph():o.namedNode(e);Object.keys(n).forEach((e=>{const t=n[e].predicates,u=s(e)?o.blankNode(a(e)):o.namedNode(e);i.push(...M(t,u,c,r))}))})),i}function M(t,r,n,i={}){var o;const c=[],u=null!==(o=i.dataFactory)&&void 0!==o?o:e;return Object.keys(t).forEach((e=>{var i,o,l,d;const h=u.namedNode(e),p=null!==(i=t[e].langStrings)&&void 0!==i?i:{},f=null!==(o=t[e].namedNodes)&&void 0!==o?o:[],g=null!==(l=t[e].literals)&&void 0!==l?l:{},y=null!==(d=t[e].blankNodes)&&void 0!==d?d:[];Object.keys(g).forEach((e=>{const t=u.namedNode(e);g[e].forEach((e=>{const i=u.literal(e,t);c.push(u.quad(r,h,i,n))}))})),Object.keys(p).forEach((e=>{p[e].forEach((t=>{const i=u.literal(t,e);c.push(u.quad(r,h,i,n))}))})),f.forEach((e=>{const t=u.namedNode(e);c.push(u.quad(r,h,t,n))})),y.forEach((e=>{if(s(e)){const t=u.blankNode(a(e));c.push(u.quad(r,h,t,n))}else{const t=u.blankNode(),i=u.quad(r,h,t,n),o=M(e,t,n);c.push(i),c.push(...o)}}))})),c}function H(e,t,r=[]){if(void 0!==r.find((t=>t.equals(e))))return r;const n=t.filter((t=>t.subject.equals(e)&&K(t.object))).map((e=>e.object));if(0===n.length)return[];const i=[...r,e],o=n.map((e=>H(e,t,i))),s=[];for(const e of o)s.push(...e);return s}function K(e){return"BlankNode"===e.termType}const q="http://www.w3.org/ns/auth/acl#Authorization",V="http://www.w3.org/ns/auth/acl#accessTo",J="http://www.w3.org/ns/auth/acl#agent",W="http://www.w3.org/ns/auth/acl#agentGroup",$="http://www.w3.org/ns/auth/acl#agentClass",z="http://www.w3.org/ns/auth/acl#default",G="http://www.w3.org/ns/auth/acl#defaultForNew",Y="http://www.w3.org/ns/auth/acl#mode",Q="http://www.w3.org/ns/auth/acl#origin",X="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",Z={AccessControlResource:"http://www.w3.org/ns/solid/acp#AccessControlResource",Policy:"http://www.w3.org/ns/solid/acp#Policy",AccessControl:"http://www.w3.org/ns/solid/acp#AccessControl",Read:"http://www.w3.org/ns/solid/acp#Read",Append:"http://www.w3.org/ns/solid/acp#Append",Write:"http://www.w3.org/ns/solid/acp#Write",Rule:"http://www.w3.org/ns/solid/acp#Rule",Matcher:"http://www.w3.org/ns/solid/acp#Matcher",accessControl:"http://www.w3.org/ns/solid/acp#accessControl",memberAccessControl:"http://www.w3.org/ns/solid/acp#memberAccessControl",apply:"http://www.w3.org/ns/solid/acp#apply",applyMembers:"http://www.w3.org/ns/solid/acp#applyMembers",allow:"http://www.w3.org/ns/solid/acp#allow",deny:"http://www.w3.org/ns/solid/acp#deny",allOf:"http://www.w3.org/ns/solid/acp#allOf",anyOf:"http://www.w3.org/ns/solid/acp#anyOf",noneOf:"http://www.w3.org/ns/solid/acp#noneOf",access:"http://www.w3.org/ns/solid/acp#access",accessMembers:"http://www.w3.org/ns/solid/acp#accessMembers",agent:"http://www.w3.org/ns/solid/acp#agent",group:"http://www.w3.org/ns/solid/acp#group",client:"http://www.w3.org/ns/solid/acp#client",PublicAgent:"http://www.w3.org/ns/solid/acp#PublicAgent",AuthenticatedAgent:"http://www.w3.org/ns/solid/acp#AuthenticatedAgent",CreatorAgent:"http://www.w3.org/ns/solid/acp#CreatorAgent"},ee="http://www.w3.org/1999/02/22-rdf-syntax-ns#",te="http://www.w3.org/2001/XMLSchema#",re="http://www.w3.org/2000/10/swap/",ne={xsd:{decimal:`${te}decimal`,boolean:`${te}boolean`,double:`${te}double`,integer:`${te}integer`,string:`${te}string`},rdf:{type:`${ee}type`,nil:`${ee}nil`,first:`${ee}first`,rest:`${ee}rest`,langString:`${ee}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${re}reify#forSome`,forAll:`${re}reify#forAll`},log:{implies:`${re}log#implies`}};var ie=i(4375),oe=i.n(ie);const{xsd:se}=ne,ae=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,ce={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},ue=/[\x00-\x20<>\\"\{\}\|\^\`]/,le={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},de=/$0^/;class he{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in le)&&this[e]instanceof RegExp&&(this[e]=de)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let r=this._input;const n=this._comments;for(;;){let o,s;for(;o=this._newline.exec(r);)n&&(s=this._comment.exec(o[0]))&&e(null,{line:this._line,type:"comment",value:s[1],prefix:""}),r=r.substr(o[0].length,r.length),this._line++;if(!o&&(o=this._whitespace.exec(r))&&(r=r.substr(o[0].length,r.length)),this._endOfFile.test(r))return t&&(n&&(s=this._comment.exec(r))&&e(null,{line:this._line,type:"comment",value:s[1],prefix:""}),e(r=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=r;const a=this._line,c=r[0];let u="",l="",d="",h=null,p=0,f=!1;switch(c){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(p=1,u="^");break}if(this._previousMarker="^^",r=r.substr(2),"<"!==r[0]){f=!0;break}case"<":if(h=this._unescapedIri.exec(r))u="IRI",l=h[1];else if(h=this._iri.exec(r)){if(l=this._unescape(h[1]),null===l||ue.test(l))return i(this);u="IRI"}else r.length>1&&"<"===r[1]?(u="<<",p=2):this._n3Mode&&r.length>1&&"="===r[1]&&(u="inverse",p=2,l=">");break;case">":r.length>1&&">"===r[1]&&(u=">>",p=2);break;case"_":((h=this._blank.exec(r))||t&&(h=this._blank.exec(`${r} `)))&&(u="blank",d="_",l=h[1]);break;case'"':if(h=this._simpleQuotedString.exec(r))l=h[1];else if(({value:l,matchLength:p}=this._parseLiteral(r)),null===l)return i(this);null===h&&0===p||(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(h=this._simpleApostropheString.exec(r))l=h[1];else if(({value:l,matchLength:p}=this._parseLiteral(r)),null===l)return i(this);null===h&&0===p||(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(h=this._variable.exec(r))&&(u="var",l=h[0]);break;case"@":"literal"===this._previousMarker&&(h=this._langcode.exec(r))?(u="langcode",l=h[1]):(h=this._keyword.exec(r))&&(u=h[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){u=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(h=this._number.exec(r)||t&&(h=this._number.exec(`${r} `)))&&(u="literal",l=h[0],d="string"==typeof h[1]?se.double:"string"==typeof h[2]?se.decimal:se.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(h=this._sparqlKeyword.exec(r))?u=h[0].toUpperCase():f=!0;break;case"f":case"t":(h=this._boolean.exec(r))?(u="literal",l=h[0],d=se.boolean):f=!0;break;case"a":(h=this._shortPredicates.exec(r))?(u="abbreviation",l="a"):f=!0;break;case"=":this._n3Mode&&r.length>1&&(u="abbreviation",">"!==r[1]?(p=1,l="="):(p=2,l=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(p=1,u=c);break;default:f=!0}if(f&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(h=this._prefix.exec(r))?((h=this._prefixed.exec(r))||t&&(h=this._prefixed.exec(`${r} `)))&&(u="prefixed",d=h[1]||"",l=this._unescape(h[2])):(u="prefix",l=h[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?i(this):this._input=r;const g={line:a,type:u,value:l,prefix:d};e(null,g),this.previousToken=g,this._previousMarker=u,r=r.substr(p||h[0].length,r.length)}function i(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){let t=!1;const r=e.replace(ae,((e,r,n,i)=>{if("string"==typeof r)return String.fromCharCode(Number.parseInt(r,16));if("string"==typeof n){let e=Number.parseInt(n,16);return e<=65535?String.fromCharCode(Number.parseInt(n,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return i in ce?ce[i]:(t=!0,"")}));return t?null:r}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],r=t.length;let n=Math.max(this._literalClosingPos,r);for(;(n=e.indexOf(t,n))>0;){let t=0;for(;"\\"===e[n-t-1];)t++;if(t%2==0){const t=e.substring(r,n),i=t.split(/\r\n|\r|\n/).length-1,o=n+r;if(1===r&&0!==i||3===r&&this._lineMode)break;return this._line+=i,{value:this._unescape(t),matchLength:o}}n++}this._literalClosingPos=e.length-r+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const e=[];let t;if(this._tokenizeToEnd(((r,n)=>r?t=r:e.push(n)),!0),t)throw t;return e}oe()((()=>this._tokenizeToEnd(t,!0)))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=Buffer.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(t,!1)))})),e.on("end",(()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)})),e.on("error",t)}}const{rdf:pe,xsd:fe}=ne;let ge,ye=0;const me={namedNode:function(e){return new we(e)},blankNode:function(e){return new _e(e||"n3-"+ye++)},variable:function(e){return new Se(e)},literal:function(e,t){if("string"==typeof t)return new be(`"${e}"@${t.toLowerCase()}`);let r=t?t.value:"";return""===r&&("boolean"==typeof e?r=fe.boolean:"number"==typeof e&&(Number.isFinite(e)?r=Number.isInteger(e)?fe.integer:fe.double:(r=fe.double,Number.isNaN(e)||(e=e>0?"INF":"-INF")))),""===r||r===fe.string?new be(`"${e}"`):new be(`"${e}"^^${r}`)},defaultGraph:function(){return ge},quad:xe,triple:xe};class ve{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof ve?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}toJSON(){return{termType:this.termType,value:this.value}}}class we extends ve{get termType(){return"NamedNode"}}class be extends ve{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new we(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,r=t<e.length?e[t]:"";return"^"===r?e.substr(t+2):"@"!==r?fe.string:pe.langString}equals(e){return e instanceof be?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}class _e extends ve{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}class Se extends ve{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}ge=new class extends ve{constructor(){return super(""),ge||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};class Ee extends ve{constructor(e,t,r,n){super(""),this._subject=e,this._predicate=t,this._object=r,this._graph=n||ge}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function xe(e,t,r,n){return new Ee(e,t,r,n)}let Ie=0;class Ae{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Fe(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(t),n=/trig/.test(t),i=/triple/.test(t),o=/quad/.test(t),s=this._n3Mode=/n3/.test(t),a=i||o;(this._supportsNamedGraphs=!(r||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||n||i||s),this._supportsRDFStar=""===t||/star|\*$/.test(t),a&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new he({lineMode:a,n3:s}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Ie=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,r,n,i){const o=this._n3Mode;this._contextStack.push({subject:r,predicate:n,object:i,graph:t,type:e,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.id.substr(2)}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(){const e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let r;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);r=this._namedNode(t);break;case"type":case"prefixed":const n=this._prefixes[e.prefix];if(void 0===n)return this._error(`Undefined prefix "${e.prefix}:"`,e);r=this._namedNode(n+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,r=null,n=this._readListItem;const i=this._subject,o=this._contextStack,s=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;r=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,n=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),n=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===r&&(this._subject=r=this._blankNode()),null===i?null===s.predicate?s.subject=r:s.object=r:this._emit(i,this.RDF_REST,r,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,t,this._graph)}return n}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const r=this._readEntity(e);if(void 0===r)return;t=this._literal(this._literalValue,r),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const r=this._completeLiteral(e);if(r)return this._object=r.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===r.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,r=this._graph;const n=this._subject,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==n){const e=this._predicate,t=this._object;i?this._emit(t,e,n,r):this._emit(n,e,t,r)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,r=t.length&&t[t.length-1];if(r&&"item"===r.type){const e=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,e,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,r;const n=this._blankNode();if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,r,n,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let r,n;if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(n=this._subject,this._subject=t):(n=this._object,this._object=t),this._emit(t,r,n,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext(),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,r,n){this._callback(null,this._quad(e,t,r,n||this.DEFAULTGRAPH))}_error(e,t){const r=new Error(`${e} on line ${t.line}.`);r.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=ke}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let r="",n=-1,i=-1,o=0,s="/";for(;n<t;){switch(s){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<t&&"/"!==e[i];)n=i;break;case"?":case"#":n=t;break;case"/":if("."===e[n+1])switch(s=e[1+ ++n],s){case"/":r+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return r+e.substring(o,n)+e.substr(n+1);case".":if(s=e[1+ ++n],void 0===s||"/"===s||"?"===s||"#"===s){if(r+=e.substring(o,n-2),(o=r.lastIndexOf("/"))>=i&&(r=r.substr(0,o)),"/"!==s)return`${r}/${e.substr(n+1)}`;o=n+1}}}s=e[++n]}return r+e.substring(o)}parse(e,t,r){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Ie++}_`,this._prefixCallback=r||ke,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let r;if(this._callback=(e,n)=>{e?r=e:n&&t.push(n)},this._lexer.tokenize(e).every((e=>this._readCallback=this._readCallback(e))),r)throw r;return t}this._callback=t,this._lexer.tokenize(e,((e,t)=>{null!==e?(this._callback(e),this._callback=ke):this._readCallback&&(this._readCallback=this._readCallback(t))}))}}function ke(){}function Fe(e,t){const r=t.namedNode;e._namedNode=r,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=r(ne.rdf.first),e.RDF_REST=r(ne.rdf.rest),e.RDF_NIL=r(ne.rdf.nil),e.N3_FORALL=r(ne.r.forAll),e.N3_FORSOME=r(ne.r.forSome),e.ABBREVIATIONS={a:r(ne.rdf.type),"=":r(ne.owl.sameAs),">":r(ne.log.implies)},e.QUANTIFIERS_GRAPH=r("urn:n3:quantifiers")}Fe(Ae.prototype,me);const Te=me.defaultGraph(),{rdf:Re,xsd:Ce}=ne,Pe=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,Oe=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,je={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class Ne extends ve{equals(){return!1}}class De{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,r,n){e+=t,n&&n()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=Te,this._baseIRI=t.baseIRI,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}get _inDefaultGraph(){return Te.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,r,n,i){try{n.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(Te.equals(n)?"":`${this._encodeIriOrBlank(n)} {\n`)),this._graph=n,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(r)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i)}catch(e){i&&i(e)}}_writeQuadLine(e,t,r,n,i){delete this._prefixMatch,this._write(this.quadToString(e,t,r,n),i)}quadToString(e,t,r,n){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(r)}${n&&n.value?` ${this._encodeIriOrBlank(n)} .\n`:" .\n"}`}quadsToString(e){return e.map((e=>this.quadToString(e.subject,e.predicate,e.object,e.graph))).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseIRI&&t.startsWith(this._baseIRI)&&(t=t.substr(this._baseIRI.length)),Pe.test(t)&&(t=t.replace(Oe,Le));const r=this._prefixRegex.exec(t);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(Pe.test(t)&&(t=t.replace(Oe,Le)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===Ce.string)return`"${t}"`}else switch(e.datatype.value){case Ce.string:return`"${t}"`;case Ce.boolean:if("true"===t||"false"===t)return t;break;case Ce.integer:if(/^[+-]?\d+$/.test(t))return t;break;case Ce.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case Ce.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===Re.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:r,graph:n}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(r)}${i=n,i&&"DefaultGraph"===i.termType?"":` ${this._encodeIriOrBlank(n)}`}>>`;var i}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,r,n,i){void 0===r?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof n?this._writeQuad(e,t,r,Te,n):this._writeQuad(e,t,r,n||Te,i)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,r){const n={};n[e]=t,this.addPrefixes(n,r)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let r=!1;for(let t in e){let n=e[t];"string"!=typeof n&&(n=n.value),r=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[n]=t+=":",this._write(`@prefix ${t} <${n}>.\n`)}if(r){let e="",t="";for(const r in this._prefixIRIs)e+=e?`|${r}`:r,t+=(t?"|":"")+this._prefixIRIs[r];e=e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(r?"\n":"",t)}blank(e,t){let r,n,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return new Ne("[]");case 1:if(r=i[0],!(r.object instanceof Ne))return new Ne(`[ ${this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)} ]`);default:let t="[";for(let o=0;o<n;o++)r=i[o],r.predicate.equals(e)?t+=`, ${this._encodeObject(r.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)}`,e=r.predicate);return new Ne(`${t}\n]`)}}list(e){const t=e&&e.length||0,r=new Array(t);for(let n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return new Ne(`(${r.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((r,n)=>{t=null,e(r,n)});if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}}function Le(e){let t=je[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function Ue(e){return"object"==typeof e&&"object"==typeof e.internal_resourceInfo}function Be(e){const t=e;return"object"==typeof t&&"object"==typeof t.internal_resourceInfo&&"object"==typeof t.internal_resourceInfo.linkedResources}function Me(e){const t=e;return"object"==typeof t.internal_changeLog&&Array.isArray(t.internal_changeLog.additions)&&Array.isArray(t.internal_changeLog.deletions)}class He extends Error{}var Ke=i(2475);function qe(e){var t,r,n;const i=null!==(r=null===(t=e.headers.get("Content-Type"))||void 0===t?void 0:t.split(";"))&&void 0!==r?r:[],o=i.length>0&&["text/turtle","application/ld+json"].includes(i[0]),s={sourceIri:e.url,isRawData:!o,contentType:null!==(n=e.headers.get("Content-Type"))&&void 0!==n?n:void 0,linkedResources:{}},a=e.headers.get("Link");if(a){const e=Ke.parse(a),t=e.get("rel","acl");1===t.length&&(s.aclUrl=new URL(t[0].uri,s.sourceIri).href),s.linkedResources=e.refs.reduce(((e,t)=>{var r,n;return null!==(r=e[n=t.rel])&&void 0!==r||(e[n]=[]),e[t.rel].push(new URL(t.uri,s.sourceIri).href),e}),s.linkedResources)}const c=e.headers.get("WAC-Allow");return c&&(s.permissions=function(e){function t(e){const t=e.split(" ");return t.includes("write")?{read:t.includes("read"),append:!0,write:!0,control:t.includes("control")}:{read:t.includes("read"),append:t.includes("append"),write:!1,control:t.includes("control")}}function r(e,t){const r=e.split(",").map((e=>e.split("="))).filter((e=>2===e.length&&e[0].trim()===t));if(1!==r.length)return"";const n=r[0][1].trim();return'"'!==n.charAt(0)||'"'!==n.charAt(n.length-1)?"":n.substring(1,n.length-1)}return{user:t(r(e,"user")),public:t(r(e,"public"))}}(c)),s}function Ve(e){return!e.ok}const Je={fetch:async(e,t)=>{if("object"==typeof window&&"function"!=typeof require)return await window.fetch(e,t);if("function"!=typeof require)return(0,(await Promise.resolve().then(i.t.bind(i,4098,19))).default)(e,t);let r;return r=require("cross-fetch"),await r(e,t)}};async function We(e,t=Object.assign(Object.assign({},Je),{ignoreAuthenticationErrors:!1})){var r;const n=Object.assign(Object.assign({},Je),t);return $e(await n.fetch(e,{method:"HEAD"}),{ignoreAuthenticationErrors:null!==(r=t.ignoreAuthenticationErrors)&&void 0!==r&&r})}function $e(e,t={ignoreAuthenticationErrors:!1}){if(Ve(e)&&(!function(e){return 401===e.status||403===e.status}(e)||!t.ignoreAuthenticationErrors))throw new Ye(`Fetching the metadata of the Resource at [${e.url}] failed: [${e.status}] [${e.statusText}].`,e);return{internal_resourceInfo:qe(e)}}function ze(e){return Ue(e)?e.internal_resourceInfo.sourceIri:null}const Ge=ze;class Ye extends He{constructor(e,t){super(e),this.response=t}get statusCode(){return this.response.status}get statusText(){return this.response.statusText}}const Qe=()=>{const e=[],t=[],r=[];return{onQuad:t=>{e.push(t)},onError:e=>{r.push(e)},onComplete:e=>{t.push(e)},parse:async(n,i)=>{(await async function(e){return new Ae({format:"text/turtle",baseIRI:e})}(ze(i))).parse(n,((n,i,o)=>{n?r.forEach((e=>e(n))):i?e.forEach((e=>e(i))):t.forEach((e=>e()))}))}}};async function Xe(e){const t=new De({format:"text/turtle"}),r=e.map((e=>C.quad(e.subject,e.predicate,e.object,void 0)));t.addQuads(r);const n=new Promise(((e,r)=>{t.end(((t,n)=>{if(t)return r(t);e(n)}))}));return await n}function Ze(e){var t,r,n,i,o,s,a,c;if(I(e))return`<${e.value}> (URL)`;if(function(e){return A(e)&&"Literal"===e.termType}(e)){if(!I(e.datatype))return`[${e.value}] (RDF/JS Literal of unknown type)`;let u;switch(e.datatype.value){case l:return u=null!==(r=null===(t=v(e.value))||void 0===t?void 0:t.valueOf())&&void 0!==r?r:`Invalid data: \`${e.value}\``,u+" (boolean)";case d:return u=null!==(i=null===(n=w(e.value))||void 0===n?void 0:n.toUTCString())&&void 0!==i?i:`Invalid data: \`${e.value}\``,u+" (datetime)";case f:return u=null!==(s=null===(o=S(e.value))||void 0===o?void 0:o.toString())&&void 0!==s?s:`Invalid data: \`${e.value}\``,u+" (decimal)";case g:return u=null!==(c=null===(a=E(e.value))||void 0===a?void 0:a.toString())&&void 0!==c?c:`Invalid data: \`${e.value}\``,u+" (integer)";case m:return`"${e.value}" (${e.language} string)`;case y:return`"${e.value}" (string)`;default:return`[${e.value}] (RDF/JS Literal of type: \`${e.datatype.value}\`)`}}return"BlankNode"===e.termType?`[${e.value}] (RDF/JS BlankNode)`:"Quad"===e.termType?"??? (nested RDF* Quad)":"Variable"===e.termType?`?${e.value} (RDF/JS Variable)`:e}function et(e){if(!pt(e))throw new yt(e)}function tt(e,t){const n=Me(e)?e.internal_changeLog:{additions:[],deletions:[]},[i,o]=t.filter((e=>!rt(e))).reduce((([e,t],r)=>void 0!==e.find((e=>e.equals(r)))?[e.filter((e=>!e.equals(r))),t]:[e,t.concat(r)]),[n.additions,n.deletions]);return r(Object.assign(Object.assign({},e),{internal_changeLog:{additions:i,deletions:o}}))}function rt(e){return"BlankNode"===e.subject.termType||"BlankNode"===e.object.termType}function nt(e,t){var r,i,s;if(et(e),!F(t))throw new mt(t);const a=u(t),c=null!==(s=null===(i=null===(r=e.predicates[a])||void 0===r?void 0:r.namedNodes)||void 0===i?void 0:i[0])&&void 0!==s?s:null;return null===c?null:n(c)?`#${o(c)}`:c}const it=nt,ot=function(e,t){var r,i,s;if(et(e),!F(t))throw new mt(t);const a=u(t);return null!==(s=null===(i=null===(r=e.predicates[a])||void 0===r?void 0:r.namedNodes)||void 0===i?void 0:i.map((e=>n(e)?`#${o(e)}`:e)))&&void 0!==s?s:[]};function st(e,t){return et(e),function(e,t,r){var n,i,o,s;if(!F(t))throw new mt(t);const a=u(t);return null!==(s=null===(o=null===(i=null===(n=e.predicates[a])||void 0===n?void 0:n.literals)||void 0===i?void 0:i[r])||void 0===o?void 0:o[0])&&void 0!==s?s:null}(e,t,y)}function at(e,t){var r,n;et(e);const i=function(e,t){return ot(e,t).map((e=>C.namedNode(e)))}(e,t),o=function(e,t){var r,n,i,o;if(et(e),!F(t))throw new mt(t);const s=u(t);let a=[];const c=null!==(n=null===(r=e.predicates[s])||void 0===r?void 0:r.langStrings)&&void 0!==n?n:{},l=Object.keys(c);for(const e of l){const t=c[e].map((t=>C.literal(t,e)));a=a.concat(t)}const d=null!==(o=null===(i=e.predicates[s])||void 0===i?void 0:i.literals)&&void 0!==o?o:{},h=Object.keys(d);for(const e of h){const t=d[e],r=C.namedNode(e),n=t.map((e=>C.literal(e,r)));a=a.concat(n)}return a}(e,t),c=u(t),l=(null!==(n=null===(r=e.predicates[c])||void 0===r?void 0:r.blankNodes)&&void 0!==n?n:[]).map((e=>{const t=s(e)?a(e):void 0;return C.blankNode(t)}));return i.concat(o).concat(l)}function ct(e,t,r={}){var i;if(!F(t))throw new wt(t);const s=void 0!==r.scope?u(r.scope):"default",a=null!==(i=e.graphs[s])&&void 0!==i?i:{},c=u(t),l=a[n(c)&&Be(e)?R(o(c),ze(e)):c];return void 0===l?null:l}function ut(e,t={acceptBlankNodes:!1}){var r;const n=void 0!==t.scope?u(t.scope):"default",i=null!==(r=e.graphs[n])&&void 0!==r?r:{};return Object.values(i).filter((e=>!s(e.url)||t.acceptBlankNodes))}function lt(e,t){var n;const i=gt(t)&&Be(e)?R(o(t.url),ze(e)):t.url,s=e.graphs.default,a=r(Object.assign(Object.assign({},s),{[i]:r(Object.assign(Object.assign({},t),{url:i}))})),c=r(Object.assign(Object.assign({},e.graphs),{default:a})),u=C.namedNode(i),l=null===(n=e.graphs.default[i])||void 0===n?void 0:n.predicates,d=void 0!==l?M(l,u,C.defaultGraph()):[],h=M(t.predicates,u,C.defaultGraph());return function(e,t){const n=Me(e)?e.internal_changeLog:{additions:[],deletions:[]},[i,o]=t.filter((e=>!rt(e))).reduce((([e,t],r)=>void 0!==t.find((e=>e.equals(r)))?[e,t.filter((e=>!e.equals(r)))]:[e.concat(r),t]),[n.additions,n.deletions]);return r(Object.assign(Object.assign({},e),{internal_changeLog:{additions:i,deletions:o}}))}(tt(r(Object.assign(Object.assign({},e),{graphs:c})),d),h)}function dt(e,t){var i;let s;s=I(t)?t.value:"string"==typeof t?n(t)&&Be(e)?R(o(t),ze(e)):t:gt(t)?t.url:ft(t);const a=e.graphs.default,c=Object.assign({},a);delete c[s];const u=r(Object.assign(Object.assign({},e.graphs),{default:r(c)})),l=C.namedNode(s),d=null===(i=e.graphs.default[s])||void 0===i?void 0:i.predicates,h=void 0!==d?M(d,l,C.defaultGraph()):[];return tt(r(Object.assign(Object.assign({},e),{graphs:u})),h)}function ht(e={}){var n;if(void 0!==e.url){const t=e.url;if(!F(t))throw new wt(t);return r({type:"Subject",predicates:r({}),url:t})}const i=null!==(n=e.name)&&void 0!==n?n:bt(),o=`${t}${i}`;return r({type:"Subject",predicates:r({}),url:o})}function pt(e){return"object"==typeof e&&null!==e&&"string"==typeof e.type&&"Subject"===e.type}const ft=function(e,t){if(gt(e)){if(void 0===t)throw new Error("The URL of a Thing that has not been persisted cannot be determined without a base URL.");return R(o(e.url),t)}return e.url};function gt(e){return n(e.url)}class yt extends He{constructor(e){super(`Expected a Thing, but received: [${e}].`),this.receivedValue=e}}class mt extends He{constructor(e){const t=I(e)?e.value:e;super(`Expected a valid URL to identify a property, but received: [${t}].`),this.receivedProperty=t}}class vt extends He{constructor(e){const t=I(e)?e.value:e;super(`Expected a valid URL value, but received: [${t}].`),this.receivedValue=t}}class wt extends He{constructor(e){const t=I(e)?e.value:e;super(`Expected a valid URL to identify a Thing, but received: [${t}].`),this.receivedValue=t}}const bt=()=>Date.now().toString()+Math.random().toString().substring("0.".length);function _t(e){const t=new URL(e);return t.hash="",t.href}function St(){return r({type:"Dataset",graphs:{default:{}}})}async function Et(e,t=Je){var n;e=u(e);const i=Object.assign(Object.assign({},Je),t),o=Object.keys(null!==(n=t.parsers)&&void 0!==n?n:{}),s=o.length>0?o.join(", "):"text/turtle",a=await i.fetch(e,{headers:{Accept:s}});if(Ve(a))throw new Ye(`Fetching the Resource at [${e}] failed: [${a.status}] [${a.statusText}].`,a);const c=await async function(e,t={}){if(Ve(e))throw new Ye(`Fetching the SolidDataset at [${e.url}] failed: [${e.status}] [${e.statusText}].`,e);const n=$e(e),i=Object.assign({"text/turtle":Qe()},t.parsers),o=null!==(s=n.internal_resourceInfo.contentType)&&void 0!==s?s:null;var s;if(null===o)throw new Error(`Could not determine the content type of the Resource at [${ze(n)}].`);const a=o.split(";")[0],c=i[a];if(void 0===c)throw new Error(`The Resource at [${ze(n)}] has a MIME type of [${a}], but the only parsers available are for the following MIME types: [${Object.keys(i).join(", ")}].`);const u=await e.text(),l=new Promise(((e,t)=>{let i=r({graphs:r({default:r({})}),type:"Dataset"});const s=[],a=[];c.onError((e=>{t(new Error(`Encountered an error parsing the Resource at [${ze(n)}] with content type [${o}]: ${e}`))})),c.onQuad((e=>{a.push(e),"BlankNode"===e.subject.termType||"BlankNode"===e.object.termType?s.push(e):i=P(i,e)})),c.onComplete((async()=>{const t=s.length<=20?U(s):[],o=s.filter((e=>t.every((t=>!t.equals(e.subject)))));i=o.reduce(((e,r)=>P(e,r,{otherQuads:a,chainBlankNodes:t})),i);const c=r(Object.assign(Object.assign({},i),n));e(c)})),c.parse(u,n)}));return await l}(a,t);return c}async function xt(e,t,i=Je){e=u(e);const s=Object.assign(Object.assign({},Je),i),a=function(e){return Me(e)?e:r(Object.assign(Object.assign({},e),{internal_changeLog:{additions:[],deletions:[]}}))}(t),c=Tt(a,e)?await async function(e){return{method:"PATCH",body:`${e.internal_changeLog.deletions.length>0?`DELETE DATA {${(await Xe(e.internal_changeLog.deletions.map(Rt))).trim()}};`:""} ${e.internal_changeLog.additions.length>0?`INSERT DATA {${(await Xe(e.internal_changeLog.additions.map(Rt))).trim()}};`:""}`,headers:{"Content-Type":"application/sparql-update"}}}(a):await async function(e){return{method:"PUT",body:await Xe(B(e).map(Rt)),headers:{"Content-Type":"text/turtle","If-None-Match":"*",Link:'<http://www.w3.org/ns/ldp#Resource>; rel="type"'}}}(a),l=await s.fetch(e,c);if(Ve(l)){const t=Tt(a,e)?"The changes that were sent to the Pod are listed below.\n\n"+function(e){if(!Ue(e))return"This is a newly initialized SolidDataset, so there is no source to compare it to.";if(!Me(e)||0===e.internal_changeLog.additions.length&&0===e.internal_changeLog.deletions.length)return`## Changes compared to ${ze(e)}\n\nThis SolidDataset has not been modified since it was fetched from ${ze(e)}.\n`;let t=`## Changes compared to ${ze(e)}\n`;const r=function(e){const t={};return e.internal_changeLog.deletions.forEach((r=>{var n,i,o;const s=k(r.subject)?T(r.subject,ze(e)):r.subject;if(!I(s)||!I(r.predicate))return;const a=u(s),c=u(r.predicate);null!==(n=t[a])&&void 0!==n||(t[a]={}),null!==(i=(o=t[a])[c])&&void 0!==i||(o[c]={added:[],deleted:[]}),t[a][c].deleted.push(r.object)})),e.internal_changeLog.additions.forEach((r=>{var n,i,o;const s=k(r.subject)?T(r.subject,ze(e)):r.subject;if(!I(s)||!I(r.predicate))return;const a=u(s),c=u(r.predicate);null!==(n=t[a])&&void 0!==n||(t[a]={}),null!==(i=(o=t[a])[c])&&void 0!==i||(o[c]={added:[],deleted:[]}),t[a][c].added.push(r.object)})),t}(e);return Object.keys(r).forEach((e=>{t+=`\n### Thing: ${e}\n`;const n=r[e];Object.keys(n).forEach((e=>{t+=`\nProperty: ${e}\n`;const r=n[e].deleted,i=n[e].added;r.length>0&&(t+="- Removed:\n",r.forEach((e=>t+=`  - ${Ze(e)}\n`))),i.length>0&&(t+="- Added:\n",i.forEach((e=>t+=`  - ${Ze(e)}\n`)))}))})),t}(a):"The SolidDataset that was sent to the Pod is listed below.\n\n"+function(e){let t="";Ue(e)?t+=`# SolidDataset: ${ze(e)}\n`:t+="# SolidDataset (no URL yet)\n";const r=ut(e);return 0===r.length?t+="\n<empty>\n":r.forEach((r=>{t+="\n"+function(e){let t="";gt(e)?t+=`## Thing (no URL yet — identifier: \`#${o(e.url)}\`)\n`:t+=`## Thing: ${e.url}\n`;const r=Object.keys(e.predicates);if(0===r.length)t+="\n<empty>\n";else for(const n of r)t+=`\nProperty: ${n}\n`,at(e,n).forEach((e=>{t+=`- ${Ze(e)}\n`}));return t}(r),Me(e)&&(t+="\n"+function(e,t){const r=C.namedNode(t.url),n=e.internal_changeLog.additions.reduce(((e,t)=>t.subject.equals(r)?e+1:e),0),i=e.internal_changeLog.deletions.reduce(((e,t)=>t.subject.equals(r)?e+1:e),0);return`(${1===n?"1 new value added":n+" new values added"} / ${1===i?"1 value removed":i+" values removed"})`}(e,r)+"\n")})),t}(a);throw new Ye(`Storing the Resource at [${e}] failed: [${l.status}] [${l.statusText}].\n\n`+t,l)}const d=Object.assign(Object.assign({},qe(l)),{isRawData:!1});return function(e){const t=ze(e),i=e.graphs.default,s=Object.keys(i).reduce(((e,i)=>{const s=function(e,t){const i=Object.keys(e.predicates).reduce(((e,i)=>{var s;const a=null!==(s=e[i].namedNodes)&&void 0!==s?s:[];if(a.every((e=>!n(e))))return e;const c=r(a.map((e=>n(e)?`${t}#${o(e)}`:e))),u=r(Object.assign(Object.assign({},e[i]),{namedNodes:c}));return r(Object.assign(Object.assign({},e),{[i]:u}))}),e.predicates);return r(Object.assign(Object.assign({},e),{predicates:i,url:n(e.url)?`${t}#${o(e.url)}`:e.url}))}(e[i],t),a=n(i)?`${t}#${o(i)}`:i,c=Object.assign({},e);return delete c[i],c[a]=s,r(c)}),i),a=r(Object.assign(Object.assign({},e.graphs),{default:s}));return r(Object.assign(Object.assign({},e),{graphs:a}))}(r(Object.assign(Object.assign({},t),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:d})))}async function It(e,t=Je){const r=Object.assign(Object.assign({},Je),t),n=Ue(e)?u(ze(e)):u(e),i=await r.fetch(n,{method:"DELETE"});if(Ve(i))throw new Ye(`Deleting the SolidDataset at [${n}] failed: [${i.status}] [${i.statusText}].`,i)}async function At(e,t=Je){var n;e=(e=u(e)).endsWith("/")?e:e+"/";const i=Object.assign(Object.assign({},Je),t),o=await i.fetch(e,{method:"PUT",body:i.initialContent?await Xe(B(i.initialContent).map(Rt)):void 0,headers:{Accept:"text/turtle","Content-Type":"text/turtle","If-None-Match":"*",Link:'<http://www.w3.org/ns/ldp#BasicContainer>; rel="type"'}});if(Ve(o)){if(409===o.status&&"Conflict"===o.statusText&&(await o.text()).trim()===kt)return Ft(e,t);const r=void 0===i.initialContent?"empty":"non-empty";throw new Ye(`Creating the ${r} Container at [${e}] failed: [${o.status}] [${o.statusText}].`,o)}const s=qe(o);return r(Object.assign(Object.assign({},null!==(n=t.initialContent)&&void 0!==n?n:St()),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:s}))}const kt="Can't write file: PUT not supported on containers, use POST instead",Ft=async(e,t)=>{e=u(e);const n=Object.assign(Object.assign({},Je),t);let i;try{i=await We(e,t)}catch(e){if(!(e instanceof Ye)||404!==e.statusCode)throw e}if(void 0!==i)throw new Error(`The Container at [${e}] already exists, and therefore cannot be created again.`);const o=e+".dummy",s=await n.fetch(o,{method:"PUT",headers:{Accept:"text/turtle","Content-Type":"text/turtle"}});if(Ve(s))throw new Ye(`Creating the empty Container at [${e}] failed: [${s.status}] [${s.statusText}].`,s);await n.fetch(o,{method:"DELETE"});const a=qe(await n.fetch(e,{method:"HEAD"}));return r(Object.assign(Object.assign({},St()),{internal_changeLog:{additions:[],deletions:[]},internal_resourceInfo:a}))};function Tt(e,t){return Me(e)&&Ue(e)&&"string"==typeof e.internal_resourceInfo.sourceIri&&(r=t,_t(e.internal_resourceInfo.sourceIri)===_t(r));var r}function Rt(e){const t=I(e.subject)?Ct(e.subject):e.subject,r=I(e.object)?Ct(e.object):e.object;return C.quad(t,e.predicate,r,e.graph)}function Ct(e){return n(e.value)?C.namedNode("#"+o(e.value)):e}function Pt(e,t){if(et(e),!F(t))throw new mt(t);const n=u(t),i=Object.assign({},e.predicates);return delete i[n],r(Object.assign(Object.assign({},e),{predicates:r(i)}))}const Ot=(e,t,n)=>{var i,o,s;if(et(e),!F(t))throw new mt(t);const a=u(t);if(!pt(n)&&!F(n))throw new vt(n);const c=I(n)?n.value:"string"==typeof n?n:ft(n),l=r(null!==(s=null===(o=null===(i=e.predicates[a])||void 0===i?void 0:i.namedNodes)||void 0===o?void 0:o.filter((e=>e.toLowerCase()!==c.toLowerCase())))&&void 0!==s?s:[]),d=r(Object.assign(Object.assign({},e.predicates[a]),{namedNodes:l})),h=r(Object.assign(Object.assign({},e.predicates),{[a]:d}));return r(Object.assign(Object.assign({},e),{predicates:h}))},jt=Ot,Nt=(e,t,r)=>(et(e),Jt(e,t,l,(e=>v(e)===r))),Dt=(e,t,r)=>(et(e),Jt(e,t,d,(e=>{var t;return(null===(t=w(e))||void 0===t?void 0:t.getTime())===r.getTime()}))),Lt=(e,t,r)=>(et(e),Jt(e,t,h,(function(e){const t=function(e){if(!/-?\d{4,}-\d\d-\d\d(Z|(\+|-)\d\d:\d\d)?/.test(e))return null;const t=e,[r,n]="-"===t.charAt(0)?[-1,t.substring(1)]:[1,t],[i,o,s]=n.split("-"),a=s.length>2?s.substring(0,2):s,c=Number.parseInt(i,10)*r,u=Number.parseInt(o,10)-1,l=Number.parseInt(a,10),d=new Date(Date.UTC(c,u,l,12));return c>=0&&c<100&&d.setUTCFullYear(d.getUTCFullYear()-1900),d}(e);return!!t&&t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}))),Ut=(e,t,r)=>(et(e),Jt(e,t,p,(function(e){const t=function(e){if(!/\d\d:\d\d:\d\d(\.\d+)?(Z|(\+|-)\d\d:\d\d)?/.test(e))return null;const[t,r]=b(e),[n,i,o]=t.split(":");let s=Number.parseInt(n,10),a=Number.parseInt(i,10);const[c,u]=o.split("."),l=Number.parseInt(c,10),d=u?Number.parseInt(u,10):void 0;a>=60&&(s+=1,a-=60);const h={hour:s,minute:a,second:l};if("number"==typeof d&&(h.millisecond=d),"string"==typeof r){const[e,t]=_(r);if("number"!=typeof e||e>24||"number"!=typeof t||t>59)return null;h.timezoneHourOffset=e,h.timezoneMinuteOffset=t}return h}(e);return!!t&&t.hour===r.hour&&t.minute===r.minute&&t.second===r.second&&t.millisecond===r.millisecond&&t.timezoneHourOffset===r.timezoneHourOffset&&t.timezoneMinuteOffset===r.timezoneMinuteOffset}))),Bt=(e,t,r)=>(et(e),Jt(e,t,f,(e=>S(e)===r))),Mt=(e,t,r)=>(et(e),Jt(e,t,g,(e=>E(e)===r)));function Ht(e,t,n,i){var o,s;if(et(e),!F(t))throw new mt(t);const a=u(t),c=null!==(s=null===(o=e.predicates[a])||void 0===o?void 0:o.langStrings)&&void 0!==s?s:{},l=Object.keys(c).find((e=>x(e)===x(i)&&Array.isArray(c[e])&&c[e].length>0));if("string"!=typeof l)return e;const d=c[l],h=r(d.filter((e=>e!==n))),p=r(Object.assign(Object.assign({},c),{[l]:h})),f=r(Object.assign(Object.assign({},e.predicates[a]),{langStrings:p})),g=r(Object.assign(Object.assign({},e.predicates),{[a]:f}));return r(Object.assign(Object.assign({},e),{predicates:g}))}const Kt=(e,t,r)=>(et(e),Jt(e,t,y,(e=>e===r)));function qt(e,t,r){return Ot(e,t,r.value)}function Vt(e,t,n){var i,o,s;if(et(e),!F(t))throw new mt(t);const a=n.datatype.value;if(a===m)return Ht(e,t,n.value,n.language);const c=u(t),l=null!==(i=e.predicates[c])&&void 0!==i?i:{},d=null!==(o=l.literals)&&void 0!==o?o:{},h=null!==(s=d[a])&&void 0!==s?s:[],p=r(h.filter((e=>e!==n.value))),f=r(Object.assign(Object.assign({},d),{[a]:p})),g=r(Object.assign(Object.assign({},l),{literals:f})),y=r(Object.assign(Object.assign({},e.predicates),{[c]:g}));return r(Object.assign(Object.assign({},e),{predicates:y}))}function Jt(e,t,n,i){var o,s,a;if(!F(t))throw new mt(t);const c=u(t),l=null!==(o=e.predicates[c])&&void 0!==o?o:{},d=null!==(s=l.literals)&&void 0!==s?s:{},h=null!==(a=d[n])&&void 0!==a?a:[],p=r(h.filter((e=>!i(e)))),f=r(Object.assign(Object.assign({},d),{[n]:p})),g=r(Object.assign(Object.assign({},l),{literals:f})),y=r(Object.assign(Object.assign({},e.predicates),{[c]:g}));return r(Object.assign(Object.assign({},e),{predicates:y}))}const Wt=(e,t,n)=>{var i,o;if(et(e),!F(t))throw new mt(t);if(!pt(n)&&!F(n))throw new vt(n);const s=u(t),a=null!==(i=e.predicates[s])&&void 0!==i?i:{},c=null!==(o=a.namedNodes)&&void 0!==o?o:[];let l;l=I(n)?n.value:"string"==typeof n?n:gt(n)?n.url:ft(n);const d=r(c.concat(u(l))),h=r(Object.assign(Object.assign({},a),{namedNodes:d})),p=r(Object.assign(Object.assign({},e.predicates),{[s]:h}));return r(Object.assign(Object.assign({},e),{predicates:p}))},$t=Wt,zt=(e,t,r)=>(et(e),or(e,t,function(e){return e?"true":"false"}(r),l)),Gt=(e,t,r)=>(et(e),or(e,t,function(e){return e.toISOString()}(r),d)),Yt=(e,t,r)=>(et(e),or(e,t,function(e){const t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),[i,o]=b(e.toISOString());return`${t}-${String(r).padStart(2,"0")}-${String(n).padStart(2,"0")}${o}`}(r),h)),Qt=(e,t,r)=>(et(e),or(e,t,function(e){let t,r;if(e.millisecond&&(t=e.millisecond<10?"00"+e.millisecond:e.millisecond<100?"0"+e.millisecond:e.millisecond),"number"==typeof e.timezoneHourOffset){const t=Math.abs(e.timezoneHourOffset)<10?"0"+Math.abs(e.timezoneHourOffset):Math.abs(e.timezoneHourOffset);r=e.timezoneHourOffset>=0?"+"+t:"-"+t,e.timezoneMinuteOffset?r=r+":"+(e.timezoneMinuteOffset<10?"0"+e.timezoneMinuteOffset:e.timezoneMinuteOffset):r+=":00"}return(e.hour<10?"0"+e.hour:e.hour)+":"+(e.minute<10?"0"+e.minute:e.minute)+":"+(e.second<10?"0"+e.second:e.second)+(e.millisecond?"."+t:"")+(r||"")}(r),p)),Xt=(e,t,r)=>(et(e),or(e,t,function(e){return e.toString()}(r),f)),Zt=(e,t,r)=>(et(e),or(e,t,function(e){return e.toString()}(r),g));function er(e,t,n,i){var o,s,a;if(et(e),!F(t))throw new mt(t);const c=u(t),l=x(i),d=null!==(o=e.predicates[c])&&void 0!==o?o:{},h=null!==(s=d.langStrings)&&void 0!==s?s:{},p=null!==(a=h[l])&&void 0!==a?a:[],f=r(p.concat(n)),g=r(Object.assign(Object.assign({},h),{[l]:f})),y=r(Object.assign(Object.assign({},d),{langStrings:g})),m=r(Object.assign(Object.assign({},e.predicates),{[c]:y}));return r(Object.assign(Object.assign({},e),{predicates:m}))}const tr=(e,t,r)=>(et(e),or(e,t,r,y));function rr(e,t,r){return Wt(e,t,r.value)}function nr(e,t,r){if(et(e),!F(t))throw new mt(t);return r.datatype.value===m?er(e,t,r.value,r.language):or(e,t,r.value,r.datatype.value)}function ir(e,t,n){var i,o;if("NamedNode"===n.termType)return rr(e,t,n);if("Literal"===n.termType)return nr(e,t,n);if("BlankNode"===n.termType){if(et(e),!F(t))throw new mt(t);const s=u(t),a=null!==(i=e.predicates[s])&&void 0!==i?i:{},l=null!==(o=a.blankNodes)&&void 0!==o?o:[],d=r(l.concat(c(n))),h=r(Object.assign(Object.assign({},a),{blankNodes:d})),p=r(Object.assign(Object.assign({},e.predicates),{[s]:h}));return r(Object.assign(Object.assign({},e),{predicates:p}))}throw new Error(`Term type [${n.termType}] is not supported by @inrupt/solid-client.`)}function or(e,t,n,i){var o,s,a;if(et(e),!F(t))throw new mt(t);const c=u(t),l=null!==(o=e.predicates[c])&&void 0!==o?o:{},d=null!==(s=l.literals)&&void 0!==s?s:{},h=null!==(a=d[i])&&void 0!==a?a:[],p=r(h.concat(n)),f=r(Object.assign(Object.assign({},d),{[i]:p})),g=r(Object.assign(Object.assign({},l),{literals:f})),y=r(Object.assign(Object.assign({},e.predicates),{[c]:g}));return r(Object.assign(Object.assign({},e),{predicates:y}))}const sr=(e,t,r)=>{if(et(e),!F(t))throw new mt(t);if(!pt(r)&&!F(r))throw new vt(r);return Wt(Pt(e,t),t,r)},ar=sr,cr=(e,t,r)=>(et(e),zt(Pt(e,t),t,r)),ur=(e,t,r)=>(et(e),Gt(Pt(e,t),t,r)),lr=(e,t,r)=>(et(e),Yt(Pt(e,t),t,r)),dr=(e,t,r)=>(et(e),Qt(Pt(e,t),t,r)),hr=(e,t,r)=>(et(e),Xt(Pt(e,t),t,r)),pr=(e,t,r)=>(et(e),Zt(Pt(e,t),t,r));function fr(e,t,r,n){return et(e),er(Pt(e,t),t,r,n)}const gr=(e,t,r)=>(et(e),tr(Pt(e,t),t,r));function yr(e,t,r){return et(e),rr(Pt(e,t),t,r)}function mr(e,t,r){return et(e),nr(Pt(e,t),t,r)}function vr(e,t,r){if(et(e),!F(t))throw new mt(t);return ir(Pt(e,t),t,r)}var wr=i(4305);const br=[{label:"Audiology"},{label:"Cardiology"},{label:"Dermatology"},{label:"Ear nose and throat (ENT)"},{label:"Endocrinology"},{label:"Endoscopy"},{label:"Gastroenterology"},{label:"Gynaecology"},{label:"Haematology"},{label:"Hepatology"},{label:"Histopathology"},{label:"Microbiology"},{label:"Oncology"},{label:"Ophthalmology"},{label:"Phlebotomy"},{label:"Psychiatry"},{label:"Psychology"},{label:"Radiology"},{label:"Rheumatology"},{label:"Urology"}];function _r(e){const t=(r=e,r.internal_resourceInfo.linkedResources).type;var r;return Array.isArray(t)&&t.includes(Z.AccessControlResource)}async function Sr(e,t=Je){if(!Wr(e))return{resourceAcl:null,fallbackAcl:null};try{const r=await Er(e,t);return null===r?{resourceAcl:null,fallbackAcl:await xr(e,t)}:{resourceAcl:r,fallbackAcl:null}}catch(e){if(e instanceof Ur)return{resourceAcl:null,fallbackAcl:null};throw e}}async function Er(e,t=Je){if(!Wr(e))return null;try{const n=await Et(e.internal_resourceInfo.aclUrl,t);if(_r(n))throw new Ur(e,n);return r(Object.assign(Object.assign({},n),{internal_accessTo:ze(e)}))}catch(e){if(e instanceof Ur)throw e;return null}}async function xr(e,t=Je){const r=new URL(ze(e)),n=r.pathname;if("/"===n)return null;const i=function(e){const t="/"===e.substring(e.length-1)?e.substring(0,e.length-1):e;return e.substring(0,t.lastIndexOf("/"))+"/"}(n),o=new URL(i,r.origin).href,s=await We(o,t);if(!Wr(s))return null;const a=await Er(s,t);return null===a?xr(s,t):a}function Ir(e){return ut(e).filter(Ar)}function Ar(e){return ot(e,X).includes(q)}function kr(e,t){return e.filter((e=>function(e,t){return ot(e,V).includes(t)}(e,t)))}function Fr(e,t){return e.filter((e=>function(e,t){return ot(e,z).includes(t)||ot(e,G).includes(t)}(e,t)))}function Tr(e){const t=ot(e,Y);return t.includes(Pr.write)?{read:t.includes(Pr.read),append:!0,write:!0,control:t.includes(Pr.control)}:{read:t.includes(Pr.read),append:t.includes(Pr.append),write:!1,control:t.includes(Pr.control)}}function Rr(e){return e.reduce(((e,t)=>e.write||t.write?{read:e.read||t.read,append:!0,write:!0,control:e.control||t.control}:{read:e.read||t.read,append:e.append||t.append,write:!1,control:e.control||t.control}),{read:!1,append:!1,write:!1,control:!1})}function Cr(e){return!M(e.predicates,C.namedNode(e.url),C.defaultGraph()).some((e=>!function(e){const t=e.predicate,r=e.object;return!(!t.equals(C.namedNode(X))||!r.equals(C.namedNode(q)))||(!!(t.equals(C.namedNode(V))||t.equals(C.namedNode(z))||t.equals(C.namedNode(G)))||(!(!t.equals(C.namedNode(Y))||!Object.values(Pr).some((e=>r.equals(C.namedNode(e)))))||(!!(t.equals(C.namedNode(J))||t.equals(C.namedNode(W))||t.equals(C.namedNode($)))||!!t.equals(C.namedNode(Q)))))}(e)))&&(null===it(e,V)&&null===it(e,z)&&null===it(e,G)||null===it(e,Y)||null===it(e,J)&&null===it(e,W)&&null===it(e,$))}const Pr={read:"http://www.w3.org/ns/auth/acl#Read",append:"http://www.w3.org/ns/auth/acl#Append",write:"http://www.w3.org/ns/auth/acl#Write",control:"http://www.w3.org/ns/auth/acl#Control"};function Or(e,t){const r={};return e.forEach((e=>{const n=ot(e,t),i=Tr(e);n.forEach((e=>{r[e]=void 0===r[e]?i:Rr([r[e],i])}))})),r}function jr(e){let t=ht();return t=ar(t,X,q),e.read&&(t=$t(t,Y,Pr.read)),e.append&&!e.write&&(t=$t(t,Y,Pr.append)),e.write&&(t=$t(t,Y,Pr.write)),e.control&&(t=$t(t,Y,Pr.control)),t}function Nr(e,t){return Object.assign(function(e){let t;return t="function"==typeof e.slice?Object.assign(e.slice(),Object.assign({},e)):Object.assign({},e),t}(e),{internal_acl:t})}const Dr=[J,$,W,Q];function Lr(e,t,r,n,i){let o=e;ut(e).forEach((t=>{const[s,a]=function(e,t,r,n,i){if(!ot(e,r).includes(t))return[e,jr({read:!1,append:!1,write:!1,control:!1})];const o=jt(e,r,t);let s=function(e){let t=ht();function r(e,t,r){return ot(e,r).reduce(((e,t)=>$t(e,r,t)),t)}return t=ar(t,X,q),t=r(e,t,V),t=r(e,t,z),t=r(e,t,G),t=r(e,t,J),t=r(e,t,W),t=r(e,t,$),t=r(e,t,Q),t=r(e,t,Y),t}(e);return s=jt(s,"resource"===i?V:z,n),"default"===i&&(s=jt(s,G,n)),s=ar(s,r,t),Dr.filter((e=>e!==r)).forEach((e=>{s=Pt(s,e)})),[o,s]}(t,i,r,e.internal_accessTo,n);o=lt(o,s),o=lt(o,a)}));let s=jr(t);return s=ar(s,"resource"===n?V:z,e.internal_accessTo),s=ar(s,r,i),function(e){return Ir(e).filter(Cr).reduce(dt,e)}(lt(o,s))}class Ur extends Error{constructor(e,t){super(`[${Ge(e)}] is governed by Access Control Policies in [${Ge(t)}] rather than by Web Access Control.`)}}function Br(e){return null!==e.internal_acl.resourceAcl&&ze(e)===e.internal_acl.resourceAcl.internal_accessTo&&e.internal_resourceInfo.aclUrl===ze(e.internal_acl.resourceAcl)}async function Mr(e,t=Je){const r=await We(e,t);return Nr(r,await Sr(r,t))}function Hr(e){return Br(e)?e.internal_acl.resourceAcl:null}function Kr(e){return null!==e.internal_acl.fallbackAcl}function qr(e){return Kr(e)?e.internal_acl.fallbackAcl:null}function Vr(e){return r(Object.assign(Object.assign({},St()),{internal_accessTo:ze(e),internal_resourceInfo:{sourceIri:e.internal_resourceInfo.aclUrl,isRawData:!1,linkedResources:{}}}))}async function Jr(e,t,r=Je){if(!Wr(e))throw new Error(`Could not determine the location of the ACL for the Resource at [${ze(e)}]; possibly the current user does not have Control access to that Resource. Try calling \`hasAccessibleAcl()\` before calling \`saveAclFor()\`.`);const n=await xt(e.internal_resourceInfo.aclUrl,t,r);return Object.assign(Object.assign({},n),{internal_accessTo:ze(e)})}function Wr(e){return"string"==typeof e.internal_resourceInfo.aclUrl}function $r(e){if(!Yr(e))throw new Error(`An Access Control Resource for [${ze(e)}] is not available. This could be because the current user is not allowed to see it, or because their Pod Server does not support Access Control Resources.`);return e.internal_acp.acr}function zr(e){const t=function(e,t){const r=ut($r(e),t),n=r.filter((e=>ot(e,X).includes(Z.AccessControl))),i=r.filter((e=>ot(e,Z.accessControl).length>0)).map((e=>ht({url:ot(e,Z.accessControl)[0]})));return n.concat(i)}(e).map((e=>ot(e,Z.apply))),r=new Set;return t.forEach((e=>{e.forEach((e=>r.add(e)))})),Array.from(r)}async function Gr(e,t=Je){const r=u(e),n=Object.assign(Object.assign({},Je),t),i=await We(r,n),o=await async function(e,t){let r,n;if(function(e){return Be(e)&&Array.isArray(e.internal_resourceInfo.linkedResources[Z.accessControl])&&1===e.internal_resourceInfo.linkedResources[Z.accessControl].length}(e))r=e.internal_resourceInfo.linkedResources[Z.accessControl][0];else if(Wr(e)){const n=await We(e.internal_resourceInfo.aclUrl,t);_r(n)&&(r=ze(n))}if("string"!=typeof r)return{internal_acp:{acr:null}};try{n=await Et(r,t)}catch(e){return{internal_acp:{acr:null}}}return{internal_acp:{acr:Object.assign(Object.assign({},n),{accessTo:ze(e)})}}}(i,n);return Object.assign(Object.assign({},i),o)}function Yr(e){return"object"==typeof e.internal_acp&&null!==e.internal_acp&&"object"==typeof e.internal_acp.acr&&null!==e.internal_acp.acr}function Qr(e){const t=ot(e,Z.allow);return{read:t.includes(Z.Read),append:t.includes(Z.Append),write:t.includes(Z.Write)}}function Xr(e){const t=ot(e,Z.deny);return{read:t.includes(Z.Read),append:t.includes(Z.Append),write:t.includes(Z.Write)}}function Zr(e){return ot(e,Z.allOf)}function en(e){return ot(e,Z.anyOf)}function tn(e){return ot(e,Z.noneOf)}i(4098),i(6805);const rn=[Z.agent,Z.group];function nn(e,t,r){if(e.inaccessibleUrls.length>0)return null;const n=e.acrPolicies.filter((n=>on(n,t,r,e))),i=e.policies.filter((n=>on(n,t,r,e))),o=n.reduce(((e,t)=>{const r=Object.assign({},e),n=Qr(t);return n.read&&(r.controlRead=!0),n.write&&(r.controlWrite=!0),r}),{read:!1,append:!1,write:!1,controlRead:!1,controlWrite:!1}),s=i.reduce(((e,t)=>{const r=Object.assign({},e),n=Qr(t);return n.read&&(r.read=!0),n.append&&(r.append=!0),n.write&&(r.write=!0),r}),o),a=n.reduce(((e,t)=>{const r=Object.assign({},e),n=Xr(t);return!0===n.read&&(r.controlRead=!1),!0===n.write&&(r.controlWrite=!1),r}),s);return i.reduce(((e,t)=>{const r=Object.assign({},e),n=Xr(t);return!0===n.read&&(r.read=!1),!0===n.append&&(r.append=!1),!0===n.write&&(r.write=!1),r}),a)}function on(e,t,r,n){const i=ot(e,Z.allow),o=ot(e,Z.deny);if(i.length+o.length===0)return!1;const s=Zr(e).map((e=>n.rules.find((t=>ft(t)===e)))),a=en(e).map((e=>n.rules.find((t=>ft(t)===e)))),c=tn(e).map((e=>n.rules.find((t=>ft(t)===e))));return s.every((e=>sn(e,t,r)))&&(0===a.length||a.some((e=>sn(e,t,r))))&&0===c.length}function sn(e,t,r){let n=!0;return rn.forEach((t=>{n&&(n=null===it(e,t))})),n||ot(e,t).includes(r)}function an(e,t){if(e.inaccessibleUrls.length>0)return null;const r={},n=function(e,t){const r=new Set;return e.rules.forEach((e=>{ot(e,t).filter((e=>![Z.PublicAgent,Z.CreatorAgent,Z.AuthenticatedAgent].includes(e)||t!=Z.agent)).forEach((e=>r.add(e)))})),r}(e,t);return n.forEach((n=>{const i=nn(e,t,n);r[n]=i})),r}function cn(e){return null!==e}async function un(e,t=Je){const r=function(e){const t=$r(e),r=ct(t,ze(t));return null===r?[]:ot(r,Z.access)}(e),n=zr(e),i=dn(r).concat(dn(n)),o=await hn(i,t),s=pn(r,o).filter(cn),a=pn(n,o).filter(cn),c=new Set;s.forEach((e=>{fn(e).forEach((e=>{c.add(e)}))})),a.forEach((e=>{fn(e).forEach((e=>{c.add(e)}))}));const u=Array.from(c),l=u.map((e=>ln(e))).filter((e=>!i.includes(e))),d=await hn(l,t),h=Object.assign(Object.assign({},o),d),p=pn(u,h).filter(cn);return{inaccessibleUrls:Object.keys(h).filter((e=>null===h[e])),acrPolicies:s,policies:a,rules:p}}function ln(e){const t=new URL(e);return t.hash="",t.href}function dn(e){const t=[];return e.forEach((e=>{const r=ln(e);t.includes(r)||t.push(r)})),t}async function hn(e,t){const r=Array.from(new Set(e)),n={};return await Promise.all(r.map((async e=>{try{const r=await Et(e,t);n[e]=r}catch(t){n[e]=null}}))),n}function pn(e,t){return e.map((e=>{const r=ln(e),n=t[r];return n?ct(n,e):null}))}function fn(e){return Zr(e).concat(en(e)).concat(tn(e))}function gn(e,t){return Br(e)?function(e,t){return Rr(wn(kr(Ir(e),e.internal_accessTo),t).map(Tr))}(e.internal_acl.resourceAcl,t):Kr(e)?function(e,t){return Rr(wn(Fr(Ir(e),e.internal_accessTo),t).map(Tr))}(e.internal_acl.fallbackAcl,t):null}function yn(e){return Br(e)?Sn(bn(kr(Ir(t=Hr(e)),t.internal_accessTo))):Kr(e)?function(e){return Sn(bn(Fr(Ir(e),e.internal_accessTo)))}(qr(e)):null;var t}function mn(e,t,r){return Lr(e,r,J,"resource",t)}function vn(e,t,r){return Lr(e,r,J,"default",t)}function wn(e,t){return function(e,t,r){return e.filter((e=>ot(e,"http://www.w3.org/ns/auth/acl#agent").includes(t)))}(e,t)}function bn(e){return e.filter(_n)}function _n(e){return null!==it(e,J)}function Sn(e){return Or(e,J)}function En(e){return Br(e)?xn(kr(Ir(t=Hr(e)),t.internal_accessTo)):Kr(e)?function(e){return xn(Fr(Ir(e),e.internal_accessTo))}(qr(e)):null;var t}function xn(e){return Or(e,W)}function In(e){return{read:e.read,write:e.write,append:e.append,controlRead:e.control,controlWrite:e.control}}async function An(e,t,r){const n=t(Nr(e,await Sr(e,r)));if(null===n)return null;const i={};for(const[e,t]of Object.entries(n))i[e]=In(t);return i}async function kn(e,t,r=Je){const n=await Gr(e,r);return Yr(n)?function(e,t){return nn(e,Z.agent,t)}(await un(n,r),t):Wr(n)?await function(e,t,r=Je){return async function(e,t,r,n){const i=r(Nr(e,await Sr(e,n)),t);return null===i?null:In(i)}(e,t,gn,r)}(n,t,r):null}var Fn=i(6486);async function Tn(e,t){try{return await Et(t,{fetch:e.fetch}),!0}catch(e){if(e.message.includes("Fetching the Resource at ["+t+"] failed: [404]"))return!1;if(e.message.includes("Fetching the Resource at ["+t+"] failed: [403]"))return!1}}async function Rn(e,t){try{const n=await Et(t,{fetch:e.fetch}),i=await function(e){const t=ct(e,ze(e));return null!==t?ot(t,"http://www.w3.org/ns/ldp#contains"):[]}(n,e.fetch);for(var r=0;r<i.length;r++)"/"!=i[r].charAt(i[r].length-1)&&(i.splice(r,1),r--);return i}catch(e){console.log(e)}}async function Cn(e,t){try{const r=await Et(t,{fetch:e.fetch});return await ut(r,{fetch:e.fetch})}catch(e){if(e.response)throw e.response.status;return!1}}async function Pn(e,t){try{const r=await async function(e,t,r=Je){return"agent"===t?await async function(e,t=Je){const r=await Gr(e,t);return Yr(r)?an(await un(r,t),Z.agent):Wr(r)?await function(e,t=Je){return An(e,yn,t)}(r,t):null}(e,r):"group"===t?await async function(e,t=Je){const r=await Gr(e,t);return Yr(r)?an(await un(r,t),Z.group):Wr(r)?await function(e,t=Je){return An(e,En,t)}(r,t):null}(e,r):null}(t,"agent",{fetch:e.fetch});return r}catch(e){if(e.response)throw e.response.status;return!1}}async function On(e,t,r,n){const i=await kn(t,r,{fetch:e.fetch});return!!Fn.isEqual(i,n)}function jn(e=ht()){let t=pt(e)?e:ht(e);function r(e){return(r,n)=>(t=e(t,r,n),o)}function n(e){return(r,n)=>(t=e(t,r,n),o)}function i(e){return(r,n)=>(t=e(t,r,n),o)}const o={build:()=>t,addUrl:r(Wt),addIri:r($t),addBoolean:r(zt),addDatetime:r(Gt),addDate:r(Yt),addTime:r(Qt),addDecimal:r(Xt),addInteger:r(Zt),addStringNoLocale:r(tr),addStringEnglish:(e,r)=>(t=er(t,e,r,"en"),o),addStringWithLocale:(e,r,n)=>(t=er(t,e,r,n),o),addNamedNode:r(rr),addLiteral:r(nr),addTerm:r(ir),setUrl:n(sr),setIri:n(ar),setBoolean:n(cr),setDatetime:n(ur),setDate:n(lr),setTime:n(dr),setDecimal:n(hr),setInteger:n(pr),setStringNoLocale:n(gr),setStringEnglish:(e,r)=>(t=fr(t,e,r,"en"),o),setStringWithLocale:(e,r,n)=>(t=fr(t,e,r,n),o),setNamedNode:n(yr),setLiteral:n(mr),setTerm:n(vr),removeAll:e=>(t=Pt(t,e),o),removeUrl:i(Ot),removeIri:i(jt),removeBoolean:i(Nt),removeDatetime:i(Dt),removeDate:i(Lt),removeTime:i(Ut),removeDecimal:i(Bt),removeInteger:i(Mt),removeStringNoLocale:i(Kt),removeStringEnglish:(e,r)=>jn(Ht(t,e,r,"en")),removeStringWithLocale:(e,r,n)=>jn(Ht(t,e,r,n)),removeNamedNode:i(qt),removeLiteral:i(Vt)};return o}function Nn(e){return"http://www.w3.org/ns/auth/acl#"+e}Nn("Access"),Nn("Append"),Nn("Write"),Nn("AuthenticatedAgent"),Nn("Authorization"),Nn("Control"),Nn("Origin"),Nn("Read"),Nn("accessControl"),Nn("accessTo"),Nn("accessToClass"),Nn("agent"),Nn("agentClass"),Nn("agentGroup"),Nn("default"),Nn("defaultForNew"),Nn("delegates"),Nn("mode"),Nn("origin"),Nn("owner");function Dn(e){return"http://www.w3.org/ns/dx/conneg/altr#"+e}Dn("Representation"),Dn("hasRepresentation"),Dn("hasDefaultRepresentation");function Ln(e){return"https://www.w3.org/ns/activitystreams#"+e}Ln("Activity"),Ln("Object"),Ln("Link"),Ln("OrderedItems"),Ln("Collection"),Ln("CollectionPage"),Ln("Image"),Ln("Document"),Ln("Relationship"),Ln("Question"),Ln("IntransitiveActivity"),Ln("Profile"),Ln("Tombstone"),Ln("Place"),Ln("OrderedCollectionPage"),Ln("OrderedCollection"),Ln("Accept"),Ln("Block"),Ln("Ignore"),Ln("Add"),Ln("Announce"),Ln("Application"),Ln("Arrive"),Ln("Article"),Ln("Audio"),Ln("Create"),Ln("Delete"),Ln("Dislike"),Ln("Event"),Ln("Flag"),Ln("Follow"),Ln("Group"),Ln("Invite"),Ln("Offer"),Ln("Join"),Ln("Leave"),Ln("Like"),Ln("View"),Ln("Listen"),Ln("Read"),Ln("Move"),Ln("Travel"),Ln("Mention"),Ln("Note"),Ln("Page"),Ln("Person"),Ln("Organization"),Ln("Reject"),Ln("Remove"),Ln("Service"),Ln("TentativeAccept"),Ln("TentativeReject"),Ln("Undo"),Ln("Update"),Ln("Video"),Ln("actor"),Ln("attributedTo"),Ln("attachment"),Ln("attachments"),Ln("author"),Ln("bcc"),Ln("bto"),Ln("cc"),Ln("context"),Ln("current"),Ln("first"),Ln("generator"),Ln("icon"),Ln("image"),Ln("inReplyTo"),Ln("items"),Ln("last"),Ln("location"),Ln("next"),Ln("object"),Ln("oneOf"),Ln("anyOf"),Ln("prev"),Ln("preview"),Ln("provider"),Ln("replies"),Ln("result"),Ln("audience"),Ln("partOf"),Ln("tag"),Ln("tags"),Ln("target"),Ln("origin"),Ln("instrument"),Ln("to"),Ln("url"),Ln("subject"),Ln("relationship"),Ln("describes"),Ln("formerType"),Ln("accuracy"),Ln("altitude"),Ln("content"),Ln("name"),Ln("downstreamDuplicates"),Ln("duration"),Ln("endTime"),Ln("height"),Ln("href"),Ln("hreflang"),Ln("id"),Ln("latitude"),Ln("longitude"),Ln("mediaType"),Ln("objectType"),Ln("published"),Ln("radius"),Ln("rating"),Ln("rel"),Ln("startIndex"),Ln("startTime"),Ln("summary"),Ln("totalItems"),Ln("units"),Ln("updated"),Ln("upstreamDuplicates"),Ln("verb"),Ln("width"),Ln("deleted");function Un(e){return"http://www.w3.org/2002/01/bookmark#"+e}Un("Topic"),Un("Shortcut"),Un("Bookmark"),Un("hasTopic"),Un("leadsTo"),Un("bookmarks"),Un("recalls"),Un("subTopicOf");function Bn(e){return"https://www.w3.org/2018/credentials#"+e}Bn("VerifiableCredential"),Bn("JsonSchemaValidator2018"),Bn("ManualRefreshService2018"),Bn("VerifiablePresentation"),Bn("verifiableCredential"),Bn("credentialSchema"),Bn("credentialStatus"),Bn("credentialSubject"),Bn("evidence"),Bn("expirationDate"),Bn("holder"),Bn("issued"),Bn("issuer"),Bn("issuanceDate"),Bn("refreshService"),Bn("termsOfUse"),Bn("validFrom"),Bn("validUntil");function Mn(e){return"http://www.w3.org/ns/dcat#"+e}Mn("Catalog"),Mn("Dataset"),Mn("Resource"),Mn("CatalogRecord"),Mn("DataService"),Mn("Distribution"),Mn("Relationship"),Mn("Role"),Mn("hadRole"),Mn("accessService"),Mn("accessURL"),Mn("endpointURL"),Mn("bbox"),Mn("byteSize"),Mn("catalog"),Mn("centroid"),Mn("compressFormat"),Mn("contactPoint"),Mn("dataset"),Mn("distribution"),Mn("downloadURL"),Mn("endDate"),Mn("endpointDescription"),Mn("keyword"),Mn("landingPage"),Mn("mediaType"),Mn("packageFormat"),Mn("qualifiedRelation"),Mn("record"),Mn("servesDataset"),Mn("service"),Mn("spatialResolutionInMeters"),Mn("startDate"),Mn("temporalResolution"),Mn("theme"),Mn("themeTaxonomy");function Hn(e){return"http://purl.org/dc/terms/"+e}Hn("Agent"),Hn("AgentClass"),Hn("BibliographicResource"),Hn("FileFormat"),Hn("MediaType"),Hn("MediaTypeOrExtent"),Hn("Frequency"),Hn("Jurisdiction"),Hn("LocationPeriodOrJurisdiction"),Hn("LicenseDocument"),Hn("RightsStatement"),Hn("LinguisticSystem"),Hn("Location"),Hn("MethodOfAccrual"),Hn("MethodOfInstruction"),Hn("PeriodOfTime"),Hn("PhysicalMedium"),Hn("PhysicalResource"),Hn("Policy"),Hn("ProvenanceStatement"),Hn("SizeOrDuration"),Hn("Standard"),Hn("modified"),Hn("publisher"),Hn("title"),Hn("hasVersion"),Hn("issued"),Hn("date"),Hn("description"),Hn("relation"),Hn("Box"),Hn("ISO3166"),Hn("ISO639-2"),Hn("ISO639-3"),Hn("Period"),Hn("Point"),Hn("RFC1766"),Hn("RFC3066"),Hn("RFC4646"),Hn("RFC5646"),Hn("URI"),Hn("W3CDTF"),Hn("abstract"),Hn("accessRights"),Hn("rights"),Hn("accrualMethod"),Hn("accrualPeriodicity"),Hn("accrualPolicy"),Hn("alternative"),Hn("audience"),Hn("available"),Hn("bibliographicCitation"),Hn("identifier"),Hn("conformsTo"),Hn("contributor"),Hn("coverage"),Hn("created"),Hn("creator"),Hn("dateAccepted"),Hn("dateCopyrighted"),Hn("dateSubmitted"),Hn("educationLevel"),Hn("extent"),Hn("format"),Hn("hasFormat"),Hn("hasPart"),Hn("instructionalMethod"),Hn("isFormatOf"),Hn("isPartOf"),Hn("isReferencedBy"),Hn("isReplacedBy"),Hn("isRequiredBy"),Hn("isVersionOf"),Hn("language"),Hn("license"),Hn("mediator"),Hn("medium"),Hn("provenance"),Hn("references"),Hn("replaces"),Hn("requires"),Hn("rightsHolder"),Hn("source"),Hn("spatial"),Hn("subject"),Hn("tableOfContents"),Hn("temporal"),Hn("type"),Hn("valid");function Kn(e){return"http://usefulinc.com/ns/doap#"+e}Kn("Project"),Kn("Version"),Kn("Specification"),Kn("Repository"),Kn("SVNRepository"),Kn("GitRepository"),Kn("BKRepository"),Kn("CVSRepository"),Kn("ArchRepository"),Kn("BazaarBranch"),Kn("GitBranch"),Kn("HgRepository"),Kn("DarcsRepository"),Kn("name"),Kn("homepage"),Kn("old-homepage"),Kn("created"),Kn("shortdesc"),Kn("description"),Kn("release"),Kn("mailing-list"),Kn("support-forum"),Kn("developer-forum"),Kn("category"),Kn("license"),Kn("repository"),Kn("repositoryOf"),Kn("anon-root"),Kn("browse"),Kn("module"),Kn("location"),Kn("download-page"),Kn("download-mirror"),Kn("revision"),Kn("file-release"),Kn("wiki"),Kn("bug-database"),Kn("screenshots"),Kn("maintainer"),Kn("developer"),Kn("documenter"),Kn("translator"),Kn("tester"),Kn("helper"),Kn("programming-language"),Kn("os"),Kn("implements"),Kn("service-endpoint"),Kn("language"),Kn("vendor"),Kn("platform"),Kn("audience"),Kn("blog");function qn(e){return"http://www.w3.org/ns/earl#"+e}qn("Assertion"),qn("Assertor"),qn("TestSubject"),qn("TestCriterion"),qn("TestRequirement"),qn("TestCase"),qn("TestResult"),qn("TestMode"),qn("OutcomeValue"),qn("Pass"),qn("Fail"),qn("CannotTell"),qn("NotApplicable"),qn("NotTested"),qn("Software"),qn("assertedBy"),qn("subject"),qn("test"),qn("result"),qn("mode"),qn("mainAssertor"),qn("outcome"),qn("pointer"),qn("info");function Vn(e){return"http://xmlns.com/foaf/0.1/"+e}Vn("Agent"),Vn("Document"),Vn("Organization"),Vn("Project"),Vn("Person"),Vn("Group"),Vn("Image"),Vn("LabelProperty"),Vn("OnlineAccount"),Vn("OnlineChatAccount"),Vn("OnlineEcommerceAccount"),Vn("OnlineGamingAccount"),Vn("PersonalProfileDocument"),Vn("account"),Vn("accountName"),Vn("accountServiceHomepage"),Vn("age"),Vn("aimChatID"),Vn("nick"),Vn("based_near"),Vn("birthday"),Vn("currentProject"),Vn("depiction"),Vn("depicts"),Vn("dnaChecksum"),Vn("familyName"),Vn("family_name"),Vn("firstName"),Vn("focus"),Vn("fundedBy"),Vn("geekcode"),Vn("gender"),Vn("givenName"),Vn("givenname"),Vn("holdsAccount"),Vn("homepage"),Vn("page"),Vn("isPrimaryTopicOf"),Vn("topic"),Vn("primaryTopic"),Vn("icqChatID"),Vn("img"),Vn("interest"),Vn("jabberID"),Vn("knows"),Vn("lastName"),Vn("logo"),Vn("made"),Vn("maker"),Vn("mbox"),Vn("mbox_sha1sum"),Vn("member"),Vn("membershipClass"),Vn("msnChatID"),Vn("myersBriggs"),Vn("name"),Vn("openid"),Vn("pastProject"),Vn("phone"),Vn("plan"),Vn("publications"),Vn("schoolHomepage"),Vn("sha1"),Vn("skypeID"),Vn("status"),Vn("surname"),Vn("theme"),Vn("thumbnail"),Vn("tipjar"),Vn("title"),Vn("topic_interest"),Vn("weblog"),Vn("workInfoHomepage"),Vn("workplaceHomepage"),Vn("yahooChatID");function Jn(e){return"http://www.w3.org/2011/http#"+e}Jn("Connection"),Jn("EntityHeader"),Jn("MessageHeader"),Jn("GeneralHeader"),Jn("HeaderElement"),Jn("HeaderName"),Jn("Message"),Jn("Method"),Jn("Parameter"),Jn("Request"),Jn("RequestHeader"),Jn("Response"),Jn("ResponseHeader"),Jn("StatusCode"),Jn("absoluteURI"),Jn("requestURI"),Jn("absolutePath"),Jn("authority"),Jn("body"),Jn("connectionAuthority"),Jn("elementName"),Jn("elementValue"),Jn("fieldName"),Jn("fieldValue"),Jn("headerElements"),Jn("hdrName"),Jn("headers"),Jn("httpVersion"),Jn("mthd"),Jn("methodName"),Jn("paramName"),Jn("params"),Jn("paramValue"),Jn("reasonPhrase"),Jn("requests"),Jn("resp"),Jn("sc"),Jn("statusCodeNumber"),Jn("statusCodeValue");function Wn(e){return"http://www.w3.org/2007/ont/httph#"+e}Wn("content-type"),Wn("accept"),Wn("accept-language");function $n(e){return"http://www.w3.org/ns/hydra/core#"+e}$n("Class"),$n("Link"),$n("ApiDocumentation"),$n("TemplatedLink"),$n("Error"),$n("Collection"),$n("PartialCollectionView"),$n("BaseUriSource"),$n("HeaderSpecification"),$n("property"),$n("required"),$n("readable"),$n("writable"),$n("writeable"),$n("method"),$n("statusCode"),$n("title"),$n("description"),$n("manages"),$n("totalItems"),$n("freetextQuery"),$n("template"),$n("Rfc6570Template"),$n("variableRepresentation"),$n("mapping"),$n("variable"),$n("resolveRelativeUsing"),$n("offset"),$n("limit"),$n("pageIndex"),$n("pageReference"),$n("returnsHeader"),$n("expectsHeader"),$n("headerName"),$n("possibleValue"),$n("closedSet"),$n("extension");function zn(e){return"https://www.w3.org/2002/12/cal/ical#"+e}zn("Valarm"),zn("Value_DURATION"),zn("Value_CAL-ADDRESS"),zn("Value_DATE"),zn("Value_DATE-TIME"),zn("Value_PERIOD"),zn("Value_RECUR"),zn("Vevent"),zn("Vfreebusy"),zn("Vjournal"),zn("Vtimezone"),zn("Vtodo"),zn("attach"),zn("description"),zn("summary"),zn("duration"),zn("attendee"),zn("action"),zn("repeat"),zn("trigger"),zn("categories"),zn("class"),zn("comment"),zn("geo"),zn("location"),zn("priority"),zn("resources"),zn("status"),zn("dtend"),zn("dtstart"),zn("transp"),zn("contact"),zn("organizer"),zn("relatedTo"),zn("url"),zn("uid"),zn("exrule"),zn("rdate"),zn("rrule"),zn("created"),zn("dtstamp"),zn("lastModified"),zn("sequence"),zn("requestStatus"),zn("freebusy"),zn("tzid"),zn("tzname"),zn("tzoffsetfrom"),zn("tzoffsetto"),zn("tzurl"),zn("percentComplete"),zn("completed"),zn("due"),zn("X-"),zn("calscale"),zn("exdate"),zn("method"),zn("prodid"),zn("recurrenceId"),zn("version");function Gn(e){return"http://www.w3.org/ns/json-ld#"+e}Gn("Context"),Gn("PrefixDefinition"),Gn("TermDefinition"),Gn("base"),Gn("compacted"),Gn("container"),Gn("context"),Gn("definition"),Gn("direction"),Gn("expanded"),Gn("flattened"),Gn("frame"),Gn("framed"),Gn("id"),Gn("import"),Gn("language"),Gn("nest"),Gn("prefix"),Gn("propagate"),Gn("protected"),Gn("reverse"),Gn("streaming"),Gn("term"),Gn("type"),Gn("version"),Gn("vocab");function Yn(e){return"http://www.w3.org/ns/ldp#"+e}Yn("Resource"),Yn("RDFSource"),Yn("NonRDFSource"),Yn("Container"),Yn("BasicContainer"),Yn("DirectContainer"),Yn("IndirectContainer"),Yn("Page"),Yn("PageSortCriterion"),Yn("hasMemberRelation"),Yn("isMemberOfRelation"),Yn("membershipResource"),Yn("insertedContentRelation"),Yn("member"),Yn("contains"),Yn("constrainedBy"),Yn("pageSortCriteria"),Yn("pageSortPredicate"),Yn("pageSortOrder"),Yn("pageSortCollation"),Yn("pageSequence"),Yn("inbox");function Qn(e){return"http://www.w3.org/ns/odrl/2/"+e}Qn("Policy"),Qn("uid"),Qn("profile"),Qn("inheritFrom"),Qn("Rule"),Qn("relation"),Qn("function"),Qn("failure"),Qn("Asset"),Qn("Party"),Qn("ConflictTerm"),Qn("conflict"),Qn("perm"),Qn("prohibit"),Qn("invalid"),Qn("Agreement"),Qn("Offer"),Qn("Set"),Qn("Assertion"),Qn("Privacy"),Qn("Request"),Qn("Ticket"),Qn("AssetCollection"),Qn("target"),Qn("hasPolicy"),Qn("output"),Qn("PartyCollection"),Qn("assignee"),Qn("assigner"),Qn("assigneeOf"),Qn("assignerOf"),Qn("attributedParty"),Qn("attributingParty"),Qn("compensatedParty"),Qn("compensatingParty"),Qn("consentingParty"),Qn("consentedParty"),Qn("contractingParty"),Qn("contractedParty"),Qn("informedParty"),Qn("informingParty"),Qn("trackingParty"),Qn("trackedParty"),Qn("partOf"),Qn("source"),Qn("Action"),Qn("action"),Qn("includedIn"),Qn("implies"),Qn("Permission"),Qn("permission"),Qn("Prohibition"),Qn("Duty"),Qn("prohibition"),Qn("use"),Qn("transfer"),Qn("acceptTracking"),Qn("aggregate"),Qn("annotate"),Qn("anonymize"),Qn("archive"),Qn("attribute"),Qn("compensate"),Qn("concurrentUse"),Qn("delete"),Qn("derive"),Qn("digitize"),Qn("display"),Qn("distribute"),Qn("ensureExclusivity"),Qn("execute"),Qn("extract"),Qn("give"),Qn("grantUse"),Qn("include"),Qn("index"),Qn("inform"),Qn("install"),Qn("modify"),Qn("move"),Qn("nextPolicy"),Qn("obtainConsent"),Qn("play"),Qn("present"),Qn("print"),Qn("read"),Qn("reproduce"),Qn("reviewPolicy"),Qn("sell"),Qn("stream"),Qn("synchronize"),Qn("textToSpeech"),Qn("transform"),Qn("translate"),Qn("uninstall"),Qn("watermark"),Qn("obligation"),Qn("duty"),Qn("consequence"),Qn("remedy"),Qn("Constraint"),Qn("constraint"),Qn("refinement"),Qn("Operator"),Qn("operator"),Qn("RightOperand"),Qn("rightOperand"),Qn("rightOperandReference"),Qn("LeftOperand"),Qn("leftOperand"),Qn("dataType"),Qn("status"),Qn("LogicalConstraint"),Qn("operand"),Qn("absolutePosition"),Qn("absoluteSpatialPosition"),Qn("absoluteTemporalPosition"),Qn("absoluteSize"),Qn("count"),Qn("dateTime"),Qn("delayPeriod"),Qn("deliveryChannel"),Qn("elapsedTime"),Qn("event"),Qn("fileFormat"),Qn("industry"),Qn("language"),Qn("media"),Qn("meteredTime"),Qn("payAmount"),Qn("percentage"),Qn("product"),Qn("purpose"),Qn("recipient"),Qn("relativePosition"),Qn("relativeSpatialPosition"),Qn("relativeTemporalPosition"),Qn("relativeSize"),Qn("resolution"),Qn("spatial"),Qn("spatialCoordinates"),Qn("systemDevice"),Qn("timeInterval"),Qn("unitOfCount"),Qn("version"),Qn("virtualLocation"),Qn("device"),Qn("system"),Qn("or"),Qn("xone"),Qn("and"),Qn("andSequence"),Qn("eq"),Qn("gt"),Qn("gteq"),Qn("lt"),Qn("lteq"),Qn("neq"),Qn("isA"),Qn("hasPart"),Qn("isPartOf"),Qn("isAllOf"),Qn("isAnyOf"),Qn("isNoneOf"),Qn("policyUsage"),Qn("proximity"),Qn("append"),Qn("appendTo"),Qn("copy"),Qn("export"),Qn("lease"),Qn("license"),Qn("lend"),Qn("pay"),Qn("payeeParty"),Qn("preview"),Qn("secondaryUse"),Qn("write"),Qn("writeTo"),Qn("adHocShare"),Qn("extractChar"),Qn("extractPage"),Qn("extractWord"),Qn("timedCount"),Qn("inheritRelation"),Qn("inheritAllowed"),Qn("UndefinedTerm"),Qn("undefined"),Qn("ignore"),Qn("support"),Qn("AssetScope"),Qn("PartyScope"),Qn("scope"),Qn("Group"),Qn("Individual"),Qn("All"),Qn("AllConnections"),Qn("All2ndConnections"),Qn("AllGroups"),Qn("attachPolicy"),Qn("attachSource"),Qn("shareAlike"),Qn("commercialize"),Qn("share"),Qn("core"),Qn("unit");function Xn(e){return"http://purl.org/ontology/olo/core#"+e}Xn("OrderedList"),Xn("Slot"),Xn("length"),Xn("next"),Xn("index"),Xn("ordered_list"),Xn("previous"),Xn("slot"),Xn("item");function Zn(e){return"http://www.w3.org/2002/07/owl#"+e}Zn("Ontology"),Zn("OntologyProperty"),Zn("AnnotationProperty"),Zn("AllDifferent"),Zn("AllDisjointClasses"),Zn("AllDisjointProperties"),Zn("Annotation"),Zn("AsymmetricProperty"),Zn("ObjectProperty"),Zn("Axiom"),Zn("Class"),Zn("DataRange"),Zn("DatatypeProperty"),Zn("DeprecatedClass"),Zn("DeprecatedProperty"),Zn("FunctionalProperty"),Zn("InverseFunctionalProperty"),Zn("IrreflexiveProperty"),Zn("NamedIndividual"),Zn("Thing"),Zn("NegativePropertyAssertion"),Zn("Nothing"),Zn("ReflexiveProperty"),Zn("Restriction"),Zn("SymmetricProperty"),Zn("TransitiveProperty"),Zn("versionInfo"),Zn("allValuesFrom"),Zn("annotatedProperty"),Zn("annotatedSource"),Zn("annotatedTarget"),Zn("assertionProperty"),Zn("backwardCompatibleWith"),Zn("bottomDataProperty"),Zn("bottomObjectProperty"),Zn("cardinality"),Zn("complementOf"),Zn("datatypeComplementOf"),Zn("deprecated"),Zn("differentFrom"),Zn("disjointUnionOf"),Zn("disjointWith"),Zn("distinctMembers"),Zn("equivalentClass"),Zn("equivalentProperty"),Zn("hasKey"),Zn("hasSelf"),Zn("hasValue"),Zn("incompatibleWith"),Zn("intersectionOf"),Zn("inverseOf"),Zn("maxCardinality"),Zn("maxQualifiedCardinality"),Zn("members"),Zn("minCardinality"),Zn("minQualifiedCardinality"),Zn("onClass"),Zn("onDataRange"),Zn("onDatatype"),Zn("oneOf"),Zn("onProperties"),Zn("onProperty"),Zn("priorVersion"),Zn("propertyChainAxiom"),Zn("propertyDisjointWith"),Zn("qualifiedCardinality"),Zn("sameAs"),Zn("someValuesFrom"),Zn("sourceIndividual"),Zn("targetIndividual"),Zn("targetValue"),Zn("topDataProperty"),Zn("topObjectProperty"),Zn("unionOf"),Zn("withRestrictions");function ei(e){return"http://www.w3.org/ns/posix/stat#"+e}ei("atime"),ei("blksize"),ei("blocks"),ei("ctime"),ei("dev"),ei("gid"),ei("ino"),ei("mode"),ei("mtime"),ei("nlink"),ei("rdev"),ei("size"),ei("uid");function ti(e){return"http://www.w3.org/ns/prov#"+e}ti("Entity"),ti("Revision"),ti("Activity"),ti("InstantaneousEvent"),ti("ActivityInfluence"),ti("EntityInfluence"),ti("Influence"),ti("Agent"),ti("AgentInfluence"),ti("Association"),ti("Attribution"),ti("Bundle"),ti("Collection"),ti("Communication"),ti("Delegation"),ti("Derivation"),ti("EmptyCollection"),ti("End"),ti("Generation"),ti("Invalidation"),ti("Location"),ti("Organization"),ti("Person"),ti("Plan"),ti("PrimarySource"),ti("Quotation"),ti("Role"),ti("SoftwareAgent"),ti("Start"),ti("Usage"),ti("wasRevisionOf"),ti("specializationOf"),ti("category"),ti("component"),ti("wasDerivedFrom"),ti("inverse"),ti("qualifiedForm"),ti("qualifiedRevision"),ti("alternateOf"),ti("constraints"),ti("definition"),ti("dm"),ti("n"),ti("activity"),ti("editorsDefinition"),ti("influencer"),ti("editorialNote"),ti("entity"),ti("unqualifiedForm"),ti("wasInfluencedBy"),ti("hadActivity"),ti("sharesDefinitionWith"),ti("qualifiedInfluence"),ti("agent"),ti("wasAssociatedWith"),ti("qualifiedAssociation"),ti("wasAttributedTo"),ti("qualifiedAttribution"),ti("wasInformedBy"),ti("qualifiedCommunication"),ti("actedOnBehalfOf"),ti("qualifiedDelegation"),ti("qualifiedDerivation"),ti("wasEndedBy"),ti("qualifiedEnd"),ti("wasGeneratedBy"),ti("qualifiedGeneration"),ti("wasInvalidatedBy"),ti("qualifiedInvalidation"),ti("atLocation"),ti("hadPrimarySource"),ti("qualifiedPrimarySource"),ti("wasQuotedFrom"),ti("qualifiedQuotation"),ti("hadRole"),ti("wasStartedBy"),ti("qualifiedStart"),ti("used"),ti("qualifiedUsage"),ti("aq"),ti("atTime"),ti("endedAtTime"),ti("generatedAtTime"),ti("invalidatedAtTime"),ti("startedAtTime"),ti("generated"),ti("influenced"),ti("hadGeneration"),ti("hadMember"),ti("hadPlan"),ti("hadUsage"),ti("invalidated"),ti("order"),ti("todo"),ti("value");function ri(e){return"http://purl.org/linked-data/cube#"+e}ri("DataSet"),ri("Attachable"),ri("Observation"),ri("ObservationGroup"),ri("Slice"),ri("ComponentProperty"),ri("DimensionProperty"),ri("CodedProperty"),ri("MeasureProperty"),ri("AttributeProperty"),ri("DataStructureDefinition"),ri("ComponentSet"),ri("ComponentSpecification"),ri("SliceKey"),ri("HierarchicalCodeList"),ri("dataSet"),ri("observation"),ri("observationGroup"),ri("slice"),ri("measureType"),ri("structure"),ri("component"),ri("componentProperty"),ri("order"),ri("componentRequired"),ri("componentAttachment"),ri("dimension"),ri("measure"),ri("attribute"),ri("measureDimension"),ri("sliceStructure"),ri("sliceKey"),ri("concept"),ri("codeList"),ri("hierarchyRoot"),ri("parentChildProperty");var ni="http://www.w3.org/1999/02/22-rdf-syntax-ns#";function ii(e){return ni+e}var oi={PREFIX:"rdf",NAMESPACE:ni,PREFIX_AND_NAMESPACE:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#"},NS:ii,Property:ii("Property"),HTML:ii("HTML"),langString:ii("langString"),PlainLiteral:ii("PlainLiteral"),Statement:ii("Statement"),Bag:ii("Bag"),Seq:ii("Seq"),Alt:ii("Alt"),List:ii("List"),XMLLiteral:ii("XMLLiteral"),JSON:ii("JSON"),CompoundLiteral:ii("CompoundLiteral"),type:ii("type"),subject:ii("subject"),predicate:ii("predicate"),object:ii("object"),value:ii("value"),nil:ii("nil"),first:ii("first"),rest:ii("rest"),language:ii("language"),direction:ii("direction")};function si(e){return"http://www.w3.org/2000/01/rdf-schema#"+e}si("Resource"),si("Class"),si("Literal"),si("Container"),si("ContainerMembershipProperty"),si("Datatype"),si("seeAlso"),si("isDefinedBy"),si("label"),si("comment"),si("range"),si("domain"),si("subClassOf"),si("subPropertyOf"),si("member");function ai(e){return"http://persistence.uni-leipzig.org/nlp2rdf/ontologies/rlog#"+e}ai("Level"),ai("Entry"),ai("StatusCode"),ai("ALL"),ai("priority"),ai("DEBUG"),ai("ERROR"),ai("FATAL"),ai("INFO"),ai("OFF"),ai("TRACE"),ai("WARN"),ai("className"),ai("codeId"),ai("date"),ai("hasCode"),ai("level"),ai("message"),ai("resource");var ci="http://schema.org/";function ui(e){return ci+e}var li={PREFIX:"schema-inrupt",NAMESPACE:ci,PREFIX_AND_NAMESPACE:{"schema-inrupt":"http://schema.org/"},NS:ui,Person:ui("Person"),URL:ui("URL"),MedicalTherapy:ui("MedicalTherapy"),EducationalOccupationalCredential:ui("EducationalOccupationalCredential"),PostalAddress:ui("PostalAddress"),Product:ui("Product"),alternateName:ui("alternateName"),givenName:ui("givenName"),familyName:ui("familyName"),additionalName:ui("additionalName"),license:ui("license"),name:ui("name"),text:ui("text"),identifier:ui("identifier"),description:ui("description"),image:ui("image"),url:ui("url"),startTime:ui("startTime"),endTime:ui("endTime"),startDate:ui("startDate"),endDate:ui("endDate"),email:ui("email"),primaryPrevention:ui("primaryPrevention"),qualifications:ui("qualifications"),attendee:ui("attendee"),address:ui("address"),streetAddress:ui("streetAddress"),addressLocality:ui("addressLocality"),addressRegion:ui("addressRegion"),postalCode:ui("postalCode"),addressCountry:ui("addressCountry"),accessCode:ui("accessCode"),accountId:ui("accountId"),serialNumber:ui("serialNumber"),productID:ui("productID")};function di(e){return"http://www.w3.org/ns/sparql-service-description#"+e}di("Service"),di("Feature"),di("EntailmentRegime"),di("NamedGraph"),di("EntailmentProfile"),di("Function"),di("Aggregate"),di("Language"),di("Dataset"),di("GraphCollection"),di("Graph"),di("endpoint"),di("feature"),di("defaultEntailmentRegime"),di("entailmentRegime"),di("defaultSupportedEntailmentProfile"),di("supportedEntailmentProfile"),di("extensionFunction"),di("extensionAggregate"),di("languageExtension"),di("supportedLanguage"),di("propertyFeature"),di("defaultDataset"),di("availableGraphs"),di("resultFormat"),di("inputFormat"),di("defaultGraph"),di("namedGraph"),di("name"),di("graph");function hi(e){return"http://purl.org/linked-data/sdmx/2009/dimension#"+e}hi("age"),hi("civilStatus"),hi("currency"),hi("educationLev"),hi("freq"),hi("occupation"),hi("refArea"),hi("refPeriod"),hi("sex"),hi("timePeriod");function pi(e){return"https://w3id.org/security#"+e}pi("EcdsaSecp256k1Signature2019"),pi("EcdsaSecp256k1RecoverySignature2020"),pi("EcdsaSecp256k1VerificationKey2019"),pi("EcdsaSecp256k1RecoveryMethod2020"),pi("RsaSignature2018"),pi("RsaVerificationKey2018"),pi("SchnorrSecp256k1Signature2019"),pi("SchnorrSecp256k1VerificationKey2019"),pi("ServiceEndpointProxyService"),pi("Digest"),pi("EncryptedMessage"),pi("Signature"),pi("LinkedDataSignature2015"),pi("X25519KeyAgreementKey2019"),pi("Ed25519VerificationKey2018"),pi("BbsBlsSignature2020"),pi("BbsBlsSignatureProof2020"),pi("Bls12381G1Key2020"),pi("Bls12381G2Key2020"),pi("Key"),pi("cipherAlgorithm"),pi("cipherData"),pi("digestAlgorithm"),pi("digestValue"),pi("cipherKey"),pi("blockchainAccountId"),pi("ethereumAddress"),pi("expires"),pi("initializationVector"),pi("nonce"),pi("canonicalizationAlgorithm"),pi("owner"),pi("password"),pi("privateKeyPem"),pi("verificationMethod"),pi("publicKey"),pi("assertionMethod"),pi("authentication"),pi("capabilityDelegation"),pi("capabilityInvocation"),pi("keyAgreement"),pi("publicKeyBase58"),pi("publicKeyJwk"),pi("publicKeyPem"),pi("publicKeyHex"),pi("publicKeyMultibase"),pi("publicKeyService"),pi("revoked"),pi("proof"),pi("jws"),pi("proofPurpose"),pi("challenge"),pi("domain"),pi("expiration"),pi("proofValue"),pi("signature"),pi("signatureValue"),pi("signatureAlgorithm"),pi("service"),pi("serviceEndpoint"),pi("x509CertificateChain"),pi("x509CertificateFingerprint"),pi("allowedAction"),pi("capability"),pi("capabilityAction"),pi("capabilityChain"),pi("caveat"),pi("delegator"),pi("invocationTarget"),pi("invoker");function fi(e){return"http://www.w3.org/ns/shex#"+e}fi("Annotation"),fi("EachOf"),fi("TripleExpression"),fi("IriStem"),fi("Stem"),fi("IriStemRange"),fi("StemRange"),fi("Language"),fi("LanguageStem"),fi("LanguageStemRange"),fi("LiteralStem"),fi("LiteralStemRange"),fi("NodeConstraint"),fi("ShapeExpression"),fi("NodeKind"),fi("OneOf"),fi("Schema"),fi("SemAct"),fi("Shape"),fi("ShapeAnd"),fi("ShapeExternal"),fi("ShapeNot"),fi("ShapeOr"),fi("TripleConstraint"),fi("Wildcard"),fi("annotation"),fi("closed"),fi("code"),fi("datatype"),fi("exclusion"),fi("expression"),fi("expressions"),fi("extra"),fi("flags"),fi("fractiondigits"),fi("numericFacet"),fi("xsFacet"),fi("inverse"),fi("languageTag"),fi("length"),fi("stringFacet"),fi("max"),fi("maxexclusive"),fi("maxinclusive"),fi("maxlength"),fi("min"),fi("minexclusive"),fi("mininclusive"),fi("minlength"),fi("name"),fi("nodeKind"),fi("object"),fi("pattern"),fi("predicate"),fi("semActs"),fi("shapeExpr"),fi("shapeExprs"),fi("shapes"),fi("start"),fi("startActs"),fi("stem"),fi("totaldigits"),fi("valueExpr"),fi("values");function gi(e){return"http://www.w3.org/2004/02/skos/core#"+e}gi("Concept"),gi("ConceptScheme"),gi("Collection"),gi("OrderedCollection"),gi("definition"),gi("note"),gi("scopeNote"),gi("example"),gi("inScheme"),gi("hasTopConcept"),gi("topConceptOf"),gi("prefLabel"),gi("altLabel"),gi("hiddenLabel"),gi("notation"),gi("changeNote"),gi("editorialNote"),gi("historyNote"),gi("semanticRelation"),gi("broader"),gi("broaderTransitive"),gi("narrower"),gi("narrowerTransitive"),gi("related"),gi("member"),gi("memberList"),gi("mappingRelation"),gi("broadMatch"),gi("narrowMatch"),gi("relatedMatch"),gi("exactMatch"),gi("closeMatch");function yi(e){return"http://www.w3.org/2008/05/skos-xl#"+e}yi("Label"),yi("literalForm"),yi("prefLabel"),yi("altLabel"),yi("hiddenLabel"),yi("labelRelation");function mi(e){return"http://www.w3.org/ns/ui#"+e}mi("BooleanField"),mi("NumericField"),mi("ValueField"),mi("Form"),mi("Single"),mi("Group"),mi("Choice"),mi("Classifier"),mi("ColorField"),mi("TextField"),mi("Comment"),mi("DateField"),mi("DateTimeField"),mi("DecimalField"),mi("EmailField"),mi("Heading"),mi("SingleLineTextField"),mi("Options"),mi("IntegerField"),mi("FloatField"),mi("PhoneField"),mi("Multiple"),mi("MultiLineTextField"),mi("NamedNodeURIField"),mi("TriStateField"),mi("parts"),mi("creationForm"),mi("from"),mi("label"),mi("property"),mi("for"),mi("prompt"),mi("use"),mi("Color"),mi("contents"),mi("size"),mi("style"),mi("category"),mi("dependingOn"),mi("maxLength"),mi("part"),mi("TimeField"),mi("annotationForm"),mi("backgroundColor"),mi("backgroundImage"),mi("base"),mi("color"),mi("defaultError"),mi("initialProperties"),mi("maxDateOffset"),mi("maxDatetimeOffset"),mi("maxValue"),mi("minDateOffset"),mi("minDatetimeOffset"),mi("minLength"),mi("minValue"),mi("name"),mi("oldValue"),mi("parentProperty"),mi("partsClone"),mi("pattern"),mi("reference"),mi("required"),mi("requiredError"),mi("seqeunce"),mi("sortBy"),mi("sortPriority"),mi("tableProperties"),mi("valid"),mi("validationError"),mi("value"),mi("values");function vi(e){return"http://www.w3.org/ns/ui#"+e}vi("BooleanField"),vi("NumericField"),vi("ValueField"),vi("Form"),vi("Single"),vi("TextField"),vi("TriStateField"),vi("Group"),vi("Choice"),vi("Classifier"),vi("ColorField"),vi("Comment"),vi("DateField"),vi("DateTimeField"),vi("DecimalField"),vi("EmailField"),vi("Heading"),vi("SingleLineTextField"),vi("Options"),vi("IntegerField"),vi("FloatField"),vi("PhoneField"),vi("Multiple"),vi("MultiLineTextField"),vi("NamedNodeURIField"),vi("creationForm"),vi("parts"),vi("from"),vi("label"),vi("property"),vi("for"),vi("prompt"),vi("use"),vi("category"),vi("Color"),vi("contents"),vi("size"),vi("style"),vi("dependingOn"),vi("part"),vi("maxLength"),vi("TimeField"),vi("annotationForm"),vi("backgroundColor"),vi("backgroundImage"),vi("base"),vi("color"),vi("defaultError"),vi("initialProperties"),vi("maxDateOffset"),vi("maxDatetimeOffset"),vi("maxValue"),vi("minDateOffset"),vi("minDatetimeOffset"),vi("minLength"),vi("minValue"),vi("name"),vi("oldValue"),vi("parentProperty"),vi("partsClone"),vi("pattern"),vi("reference"),vi("required"),vi("requiredError"),vi("seqeunce"),vi("sortBy"),vi("sortPriority"),vi("tableProperties"),vi("valid"),vi("validationError"),vi("value"),vi("values");function wi(e){return"http://purl.org/vocab/vann/"+e}wi("preferredNamespacePrefix"),wi("preferredNamespaceUri"),wi("changes"),wi("example"),wi("termGroup"),wi("usageNote");function bi(e){return"http://www.w3.org/2006/vcard/ns#"+e}bi("Acquaintance"),bi("RelatedType"),bi("Agent"),bi("BBS"),bi("TelephoneType"),bi("Car"),bi("Cell"),bi("Child"),bi("Colleague"),bi("Contact"),bi("Coresident"),bi("Coworker"),bi("Crush"),bi("Date"),bi("Dom"),bi("Type"),bi("Emergency"),bi("Fax"),bi("Female"),bi("Gender"),bi("Friend"),bi("Home"),bi("ISDN"),bi("Internet"),bi("Intl"),bi("Kin"),bi("Label"),bi("Male"),bi("Me"),bi("Met"),bi("Modem"),bi("Msg"),bi("Muse"),bi("Neighbor"),bi("None"),bi("Other"),bi("PCS"),bi("Pager"),bi("Parcel"),bi("Parent"),bi("Postal"),bi("Pref"),bi("Sibling"),bi("Spouse"),bi("Sweetheart"),bi("Tel"),bi("Text"),bi("TextPhone"),bi("Unknown"),bi("Video"),bi("Voice"),bi("Work"),bi("X400"),bi("Address"),bi("Email"),bi("Group"),bi("Kind"),bi("Individual"),bi("Location"),bi("Organization"),bi("VCard"),bi("Name"),bi("adr"),bi("hasAddress"),bi("agent"),bi("anniversary"),bi("bday"),bi("category"),bi("class"),bi("email"),bi("hasEmail"),bi("extended-address"),bi("geo"),bi("hasGeo"),bi("hasAdditionalName"),bi("hasCalendarBusy"),bi("hasCalendarLink"),bi("hasCalendarRequest"),bi("hasCategory"),bi("hasCountryName"),bi("hasFN"),bi("hasFamilyName"),bi("hasGender"),bi("hasGivenName"),bi("hasHonorificPrefix"),bi("hasHonorificSuffix"),bi("hasInstantMessage"),bi("hasLanguage"),bi("hasLocality"),bi("hasNickname"),bi("nickname"),bi("hasNote"),bi("hasOrganizationName"),bi("hasOrganizationUnit"),bi("hasPostalCode"),bi("hasRegion"),bi("hasRelated"),bi("hasRole"),bi("hasSource"),bi("hasStreetAddress"),bi("hasTitle"),bi("hasUID"),bi("hasValue"),bi("label"),bi("language"),bi("latitude"),bi("longitude"),bi("mailer"),bi("note"),bi("org"),bi("organization-name"),bi("organization-unit"),bi("post-office-box"),bi("prodid"),bi("rev"),bi("role"),bi("sort-string"),bi("title"),bi("tz"),bi("value"),bi("country-name"),bi("locality"),bi("postal-code"),bi("region"),bi("street-address"),bi("fn"),bi("hasMember"),bi("additional-name"),bi("family-name"),bi("given-name"),bi("honorific-prefix"),bi("honorific-suffix"),bi("hasKey"),bi("key"),bi("hasLogo"),bi("logo"),bi("hasName"),bi("n"),bi("hasPhoto"),bi("photo"),bi("hasSound"),bi("sound"),bi("hasTelephone"),bi("tel"),bi("hasURL"),bi("url");function _i(e){return"http://rdfs.org/ns/void#"+e}_i("Dataset"),_i("Linkset"),_i("TechnicalFeature"),_i("DatasetDescription"),_i("feature"),_i("subset"),_i("target"),_i("sparqlEndpoint"),_i("linkPredicate"),_i("exampleResource"),_i("vocabulary"),_i("subjectsTarget"),_i("objectsTarget"),_i("dataDump"),_i("uriLookupEndpoint"),_i("uriRegexPattern"),_i("class"),_i("classes"),_i("classPartition"),_i("distinctObjects"),_i("distinctSubjects"),_i("documents"),_i("entities"),_i("inDataset"),_i("openSearchDescription"),_i("properties"),_i("property"),_i("propertyPartition"),_i("rootResource"),_i("triples"),_i("uriSpace");function Si(e){return"http://www.w3.org/2003/06/sw-vocab-status/ns#"+e}Si("term_status"),Si("moreinfo"),Si("userdocs");function Ei(e){return"http://www.w3.org/2001/XMLSchema#"+e}Ei("changes"),Ei("string"),Ei("boolean"),Ei("float"),Ei("double"),Ei("decimal"),Ei("dateTime"),Ei("duration"),Ei("hexBinary"),Ei("base64Binary"),Ei("anyURI"),Ei("ID"),Ei("IDREF"),Ei("ENTITY"),Ei("NOTATION"),Ei("normalizedString"),Ei("token"),Ei("language"),Ei("IDREFS"),Ei("ENTITIES"),Ei("NMTOKEN"),Ei("NMTOKENS"),Ei("Name"),Ei("QName"),Ei("NCName"),Ei("integer"),Ei("nonNegativeInteger"),Ei("positiveInteger"),Ei("nonPositiveInteger"),Ei("negativeInteger"),Ei("byte"),Ei("int"),Ei("long"),Ei("short"),Ei("unsignedByte"),Ei("unsignedInt"),Ei("unsignedLong"),Ei("unsignedShort"),Ei("date"),Ei("time"),Ei("gYearMonth"),Ei("gYear"),Ei("gMonthDay"),Ei("gDay"),Ei("gMonth");const xi="https://emergencyworker.solidcommunity.net/profile/card#me",Ii={read:!0,write:!1,append:!1,controlRead:!1,controlWrite:!1},Ai={read:!0,write:!1,append:!1,controlRead:!1,controlWrite:!1},ki={read:!0,write:!1,append:!1,controlRead:!1,controlWrite:!1},Fi={read:!0,write:!0,append:!0,control:!1},Ti={read:!0,write:!1,append:!1,control:!1},Ri={read:!0,write:!0,append:!0,control:!0},Ci={read:!0,append:!0,write:!0,control:!0},Pi={read:!0,append:!1,write:!1,control:!1};async function Oi(e,t,r,n,i){const o=await Mr(r,{fetch:e.fetch});let s;Br(o)?s=Hr(o):(Wr(o)||alert("The current user does not have permission to change access rights to this resource."),Kr(o)||alert("The current user does not have permission to see who currently has access to this resource."),s=function(e){const t=Vr(e);return Fr(Ir(e.internal_acl.fallbackAcl),e.internal_acl.fallbackAcl.internal_accessTo).map((t=>(t=Pt(t,z),t=Pt(t,G),t=ar(t,V,ze(e)),ar(t,z,ze(e))))).reduce(lt,t)}(o));let a=mn(s,t,n);1==i&&(a=vn(a,t,n)),await Jr(o,a,{fetch:e.fetch})}async function ji(e,t,r){try{let n=await Et(t,{fetch:e.fetch}),i=ht({name:r["https://schema.org/title"]});for(const[e,t]of Object.entries(r))i=tr(i,e,t);return i=Wt(i,oi.type,"https://schema.org/TextDigitalDocument"),n=lt(n,i),await xt(t,n,{fetch:e.fetch}),!0}catch(e){return console.log(e),!1}}async function Ni(e,t,r){let n=St();await xt(t,n,{fetch:e.fetch}),await Oi(e,r,t,{read:!0,write:!0,append:!0,control:!0},!0)}async function Di(e,t,r){let n=await Et(t,{fetch:e.fetch});n=lt(n,r),await xt(t,n,{fetch:e.fetch})}document.getElementById("solid_identity_provider").innerHTML='[<a target="_blank" href="https://solidcommunity.net">https://solidcommunity.net</a>]';var Li=new wr.Session,Ui="",Bi="",Mi="",Hi="",Ki="",qi={},Vi="",Ji=["public","private","GP"],Wi=["Public","Private","General Practitioner (GP)"],$i=[!1,!1,!1];async function zi(e){if(e){var t;e.includes("signedInUser")?t=Li.info.webId:"specifiedUser"==e&&(t=document.getElementById("podOwner").value.trim()),Ui=t,document.getElementById("podOwnerUrl").innerHTML=Ui,document.getElementById("podOwnerUrl").href=Ui,Bi=t.substring(0,t.length-16);let i=document.getElementById("accessHealthDataForm");for(var r=0;r<Ji.length;r++){var n=Bi+"/"+Ji[r]+"HealthData/Info";if(1==await Tn(Li,n)){let e=document.getElementById(Ji[r]+"Button");e.disabled=!1,e.onclick=async function(){Gi(e.id.substring(0,e.id.indexOf("Button")))},$i[r]=!0}}if(document.getElementById("accessPodForm").style.display="none",i.style.display="block",$i.includes(!0)){if("signedInUserNew"==e&&!document.getElementById("newInstitutionWarningMessage")){let e=[];for(r=0;r<Ji.length;r++)1==$i[r]&&e.push(Ji[r]);let t=document.createElement("p");t.style.color="red",t.id="newInstitutionWarningMessage",t.innerHTML="You currently have health data containers saved for the following types: ["+e+"], if you register a new institution of one of these types it will completely wipe all the data that is currently held in those containers.",document.getElementById("institutionTypeLabel").appendChild(t)}}else"signedInUser"==e?(alert("You have not created a dataset in your Solid pod to hold medical record information. Please create one by following the steps below."),document.getElementById("accessingPod").style.display="none",document.getElementById("registerNewMedicalInstitution").style.display="block"):(Yi(!0),alert("You have not been authorized to view medical records in the specified individual's pod, or they have no Health Data stored with the application.")),document.getElementById("podOwner").value=""}}async function Gi(e){Hi=e;var t=(Mi=Bi+"/"+e+"HealthData/")+"Info";document.getElementById("accessingPod").style.display="none";const r=await Et(t,{fetch:Li.fetch}),n=await ct(r,t+"#medicalInstitutionDetails");let i=await st(n,"http://schema.org/name"),o=await st(n,"http://schema.org/address"),s=await nt(n,"https://schema.org/member");Ki=s,Ui==Li.info.webId&&(document.getElementById("initiateInsuranceRequestButton").disabled=!1,document.getElementById("registerNewMedicalInstitutionButton").disabled=!1,document.getElementById("setAdministratorToEditable").style.display="block"),[Ui,Ki].includes(Li.info.webId)&&(document.getElementById("editInstitutionInfoLabel").style.display="block",document.getElementById("setNameToEditable").style.display="block",document.getElementById("setAddressToEditable").style.display="block",document.getElementById("registerNewAppointmentButton").disabled=!1,document.getElementById("registerNewAppointmentButton").title=""),document.getElementById("typeOfAccessedHealthData").innerHTML="<u>Accessing Health Data of type</u>: "+e,document.getElementById("ownerOfPod").innerHTML="<u>Currently accessing the pod belonging to</u>: "+Ui,document.getElementById("nameOfInstitution").innerHTML="<u>Who receives care at</u>: "+i,document.getElementById("addressOfInstitution").innerHTML="<u>Which is located at</u>: "+o,document.getElementById("administratorOfInstitution").innerHTML="<u>And the institution administrator is</u>: "+s,document.getElementById("accessingPod").style.display="none",document.getElementById("institutionInformation").style.display="block"}function Yi(e){1==e&&(document.getElementById("institutionInformation").style.display="none",document.getElementById("accessHealthDataForm").style.display="none",document.getElementById("accessingPod").style.display="block",document.getElementById("accessPodForm").style.display="block",document.getElementById("publicButton").disabled=!0,document.getElementById("privateButton").disabled=!0,document.getElementById("GPButton").disabled=!0,document.getElementById("publicHealthDataType").style.backgroundColor="grey",document.getElementById("publicHealthDataType").style.backgroundColor="grey",document.getElementById("GPHealthDataType").style.backgroundColor="grey",$i.fill(!1)),document.getElementById("uploadNewAppointmentDetails").style.display="none",document.getElementById("accessingRecordsDiv").style.display="none",document.getElementById("uploadNewMedicalRecordDiv").style.display="none",document.getElementById("registerNewMedicalInstitution").style.display="none",document.getElementById("createNewDiagnosisDiv").style.display="none",document.getElementById("createNewPrescriptionDiv").style.display="none",document.getElementById("createNewGeneralRecordDiv").style.display="none",document.getElementById("insuranceDiv").style.display="none",document.getElementById("podDiagramDiv").style.display="none",document.getElementById("containerForDisplayedRecords")&&document.getElementById("containerForDisplayedRecords").remove(),document.getElementById("containerForRecordAccess")&&document.getElementById("containerForRecordAccess").remove(),document.getElementById("selectedDepartment")&&document.getElementById("selectedDepartment").remove();let t=document.getElementById("registerNewAppointmentButton");t.classList.remove("clicked-button"),t.style.display="block";let r=document.getElementById("accessMedicalRecordsButton");r.classList.remove("clicked-button"),r.style.display="block";let n=document.getElementById("uploadMedicalRecordsButton");n.classList.remove("clicked-button"),n.style.display="block";let i=document.getElementById("initiateInsuranceRequestButton");i.classList.remove("clicked-button"),i.style.display="block";let o=document.getElementById("viewPodDiagramButton");o.classList.remove("clicked-button"),o.style.display="block";let s=document.getElementById("registerNewMedicalInstitutionButton");s.classList.remove("clicked-button"),s.style.display="block";let a=document.getElementById("departmentSelectionForm");for(;a.children.length>1;){let e=a.lastChild;a.removeChild(e)}for(var c=0;c<Ji.length;c++){let e=Ji[c]+"HealthDataType";document.getElementById(e).innerHTML=Wi[c]}document.getElementById("medicalRecordTypeSelection").style.display="block"}async function Qi(e,t){let r=Mi+"Info";var n=await Et(r,{fetch:Li.fetch});let i=await ct(n,r+"#medicalInstitutionDetails");"http://schema.org/name"==e||"http://schema.org/address"==e?i=await gr(i,e,t):"https://schema.org/member"==e&&(i=await sr(i,e,t)),n=await lt(n,i),await xt(r,n,{fetch:Li.fetch})}async function Xi(e,t){let r=await Rn(Li,Mi);if(0==r.length)return alert("The currently accessed pod owner has no medical records stored in their pod. Register details of an appointment to allow for the creation of records in the appointment department."),void Yi(!1);{let i="";if("uploadingNewRecord"==e)i=document.getElementById(t);else if("accessingRecords"==e&&(document.getElementById("accessingRecordsDiv").style.display="block",i=document.getElementById("departmentSelectionForm"),i.childNodes.length<4)){let e=document.createElement("select");e.id="selectedRecordType",e.style.margin="2%";let t=document.createElement("option");t.innerHTML="Appointments",e.appendChild(t);let r=document.createElement("option");r.innerHTML="Diagnoses",e.appendChild(r);let n=document.createElement("option");n.innerHTML="Prescriptions",e.appendChild(n);let o=document.createElement("option");o.innerHTML="Records",e.appendChild(o),i.appendChild(e)}if(i.childNodes.length<5){let e=document.createElement("select");e.id="selectedDepartment",e.style.margin="2%";for(var n=0;n<=r.length-1;n++){let t=document.createElement("option");t.innerHTML=r[n].substring(r[n].lastIndexOf("HealthData/")+12,r[n].length-1),e.appendChild(t)}i.appendChild(e)}if("accessingRecords"==e&&i.childNodes.length<6){let e=document.createElement("button");e.type="submit",e.id="viewRecordsButton",e.innerHTML="View records in selected dataset",e.style.margin="2%",e.classList.add("light-blue-button"),e.style.width="200px",i.appendChild(e);let t=document.getElementById("viewAccessButton");t||(t=document.createElement("button"),t.innerHTML="Manage access to selected dataset",t.classList.add("light-blue-button"),t.style.width="200px",t.onclick=async function(){let e=document.getElementById("selectedDepartment").value,t=document.getElementById("selectedRecordType").value;await Zi(t,e)}),i.append(t);let r=document.getElementById("buttonForViewingInsuranceDataset");r||(r=document.createElement("input"),r.type="button",r.value="View diagnoses for insurance",r.classList.add("light-blue-button"),r.style.width="200px",await Tn(Li,Mi+"InsuranceDiagnoses")||(r.disabled=!0,r.title="Initiate an insurance request to use this feature"),r.id="buttonForViewingInsuranceDataset",r.style.marginLeft="20%",r.onclick=async function(){await eo("","",!0)}),i.appendChild(r)}}}async function Zi(e,t){let r=Mi+t+"/"+e,n="";try{n=await Pn(Li,r)}catch(e){403==e?alert("You have not been granted permission to view who can access this dataset. Contact the pod owner to request access"):404==e&&alert("No access has been established for the current dataset.")}if(qi={...n},Vi=r,Object.entries(n).length>0){let e=document.getElementById("containerForDisplayedRecords");e&&e.remove();let t=document.getElementById("containerForRecordAccess");t&&t.remove();let r=document.createElement("div");r.id="containerForRecordAccess",r.className="panel";let s=document.createElement("h3");s.innerHTML="Currently permitted individuals of the selected dataset",s.className="section-header",r.appendChild(s);let a=document.createElement("h5");a.innerHTML="<u>Read:</u> Access to view the contents of the applicable Resource";let c=document.createElement("h5");c.innerHTML="<u>Write:</u> Access to add (i.e. append), update, and delete contents of Resource. Granting Write access automatically grants Append Access";let u=document.createElement("h5");u.innerHTML="<u>Append:</u> Access to add data to the applicable Resource";let l=document.createElement("h5");l.innerHTML="<u>Control:</u> Access to view and manage who has access to the applicable Resource. Applicable to the ACL authorization system.",r.append(a,c,u,l);let d=0,h=document.createElement("input"),p=document.createElement("label"),f=document.createElement("input"),g=document.createElement("label"),y=document.createElement("input"),m=document.createElement("label"),v=document.createElement("input"),w=document.createElement("label");for(const[e,t]of Object.entries(n)){let n=document.createElement("div");n.id="displayedAccess"+d,n.className="panel",d%2==1&&n.classList.add("alt-color");let i=document.createElement("h3");i.innerHTML="Individual's name: <u>"+e+"</u>",i.style.textAlign="center",h=document.createElement("input"),h.type="checkbox",h.id="readAccessFor"+d,h.style.marginBottom="5%",t.read&&(h.checked=!0),p=document.createElement("label"),p.innerHTML="Read",p.id="readAccessLabelFor"+d,p.style.marginRight="2%",f=document.createElement("input"),f.type="checkbox",f.id="writeAccessFor"+d,t.write&&(f.checked=!0),g=document.createElement("label"),g.innerHTML="Write",g.style.marginRight="2%",y=document.createElement("input"),y.type="checkbox",y.id="appendAccessFor"+d,t.append&&(y.checked=!0),m=document.createElement("label"),m.innerHTML="Append",m.style.marginRight="2%",v=document.createElement("input"),v.type="checkbox",v.id="controlAccessFor"+d,t.controlRead&&t.controlWrite&&(v.checked=!0),w=document.createElement("label"),w.innerHTML="Control",w.style.marginRight="2%";let o=document.createElement("button");o.style.float="right",o.style.display="none",o.style.marginTop="5%",o.style.width="200px",o.id="updateAccessFor"+d,o.classList.add("light-blue-button"),o.innerHTML="Make changes to access",n.append(i,h,p,f,g,y,m,v,w,o),r.appendChild(n),d++}document.getElementById("accessingRecordsDiv").appendChild(r);let b=document.getElementById("containerForRecordAccess");for(var i=0;i<b.childNodes.length;i++)for(var o=0;o<b.childNodes[i].childNodes.length;o++)if("LABEL"==b.childNodes[i].childNodes[o].nodeName)b.childNodes[i].childNodes[o].htmlFor=b.childNodes[i].childNodes[o-1].id;else if("INPUT"==b.childNodes[i].childNodes[o].nodeName){let e="updateAccessFor"+(i-1);b.childNodes[i].childNodes[o].onchange=function(){document.getElementById(e).style.display="block"}}else if("BUTTON"==b.childNodes[i].childNodes[o].nodeName){let e=b.childNodes[i].childNodes[o];b.childNodes[i].childNodes[o].onclick=function(){to(e.id)}}let _=document.createElement("button");_.innerHTML="+",_.className="addNewButton",_.id="addNewAccessButton",_.onclick=function(){_.style.display="none";let e=document.createElement("div");e.id="grantingNewAccessDiv",e.classList.add("panel","addingAccess");let t=document.createElement("div");t.className="row";let r=document.createElement("h3");r.innerHTML="New individual's WebID: ",r.style.float="left";let n=document.createElement("input");n.type="url",n.placeholder="Enter a new user's WebID",n.id="webIDNewAccess",n.pattern="https://.*",n.className="column-3",n.classList.add("text-input-box"),n.style.marginTop="2.5%",n.style.float="left",n.style.width="50%",t.append(r,n);let i=h.cloneNode(!1);i.id="readAccessForNew",i.checked=!1;let o=p.cloneNode(!0);o.htmlFor=i.id,o.id="readAccessLabelForNew";let s=f.cloneNode(!1);s.id="writeAccessForNew",s.checked=!1;let a=g.cloneNode(!0);a.htmlFor=s.id,a.id="writeAccessLabelForNew";let c=y.cloneNode(!1);c.id="appendAccessForNew",c.checked=!1;let u=m.cloneNode(!0);u.htmlFor=c.id,u.id="appendAccessLabelForNew";let l=v.cloneNode(!1);l.id="controlAccessForNew",l.checked=!1;let d=w.cloneNode(!0);d.htmlFor=l.id,d.id="controlAccessLabelForNew";let b=document.createElement("button");b.innerHTML="Submit changes",b.id="submitAccessButtonForNew",b.style.float="right",b.style.marginTop="5%",b.style.marginRight="2.5%",b.classList.add("green-button"),b.onclick=function(){!async function(){let e=document.getElementById("webIDNewAccess").value,t=document.getElementById("readAccessForNew").checked,r=document.getElementById("writeAccessForNew").checked,n=document.getElementById("appendAccessForNew").checked,i=document.getElementById("controlAccessForNew").checked;if(qi.hasOwnProperty(e))return alert("Individual has already been granted access."),void(document.getElementById("webIDNewAccess").value="");let o={read:t,write:r,append:n,control:i},s={read:!0,write:!1,append:!1,control:!1};await Oi(Li,e,Mi,s,!1),await Oi(Li,e,Mi+"Info",s,!1),await Oi(Li,e,Vi,o,!1),alert("Access granted to new individual successfully.");let a=document.getElementById("selectedDepartment").value,c=document.getElementById("selectedRecordType").value;document.getElementById("grantingNewAccessDiv").remove(),Zi(c,a)}()};let S=document.createElement("button");S.innerHTML="Cancel",S.id="cancelAccessButtonForNew",S.style.float="right",S.style.marginTop="5%",S.classList.add("red-button"),S.onclick=function(){document.getElementById("grantingNewAccessDiv").remove(),document.getElementById("addNewAccessButton").style.display="block"},e.append(t,i,o,s,a,c,u,l,d,S,b),document.getElementById("containerForRecordAccess").appendChild(e),document.getElementById("grantingNewAccessDiv").scrollIntoView()},document.getElementById("containerForRecordAccess").appendChild(_)}}async function eo(e,t,r){let n="";n=0==r?Mi+t+"/"+e:Mi+"InsuranceDiagnoses";let i="";try{i=await Cn(Li,n)}catch(e){403==e?alert("You have not been authorized to view the chosen record type. Contact the pod owner to request access"):404==e&&alert("The selected record type and department combination does not exist.")}if(Vi=n,i.length>0){let e=[];for(var o=0;o<=i.length-1;o++){let t={};t.title=i[o].url.substring(i[o].url.lastIndexOf("#")+1,i[o].url.length).replaceAll("%20"," "),t.url=i[o].url,t.details={};for(const[e,r]of Object.entries(i[o].predicates))for(const[n,i]of Object.entries(r))if(i[0]&&i[0].length>0)t.details[e]=i[0];else for(const[r,n]of Object.entries(i))n[0]&&n[0].length>0&&(t.details[e]=n[0]);e.push(t)}let t=document.getElementById("containerForRecordAccess");t&&t.remove();let n=document.getElementById("containerForDisplayedRecords");n&&n.remove();let a=document.createElement("div");a.id="containerForDisplayedRecords",a.className="panel";let c=document.createElement("h3");c.innerHTML=r?"Relevant diagnoses for life insurance":"Files in current dataset",c.className="section-header",a.appendChild(c);for(var s=0;s<e.length;s++){let t=document.createElement("div");t.id="displayedFile"+s,t.className="panel",s%2==1&&t.classList.add("alt-color");let r=document.createElement("h3");r.innerHTML="Title: "+e[s].title,r.style.textAlign="center";let n=document.createElement("h6");n.innerHTML="URL: "+e[s].url;let i=document.createElement("div");for(const[t,r]of Object.entries(e[s].details)){let e=document.createElement("p"),n=t.lastIndexOf("#");n<t.lastIndexOf("/")&&(n=t.lastIndexOf("/")),e.innerHTML="<u>"+t.substring(n+1,t.length)+"</u>: "+r,e.classList.add("fileProperty"),i.appendChild(e)}t.append(r,n,i),a.appendChild(t)}document.getElementById("accessingRecordsDiv").appendChild(a),a.scrollIntoView()}else alert("Dataset exists but no files are currently held in it.")}async function to(e){let t=e.substring(e.length-1,e.length),r=Object.keys(qi)[t],n=qi[r],i={read:document.getElementById("readAccessFor"+t).checked,write:document.getElementById("writeAccessFor"+t).checked,append:document.getElementById("appendAccessFor"+t).checked,controlRead:document.getElementById("controlAccessFor"+t).checked,controlWrite:document.getElementById("controlAccessFor"+t).checked};if(Fn.isEqual(i,n))alert("No change detected from initial access level. Change the values of checkboxes to make updates.");else try{let e=!1;r==Ui&&(e=!0);let t=i.controlRead;delete i.controlRead,delete i.controlWrite,i.control=t,await Oi(Li,r,Vi,i,e),alert("Individual's access updated successfully.");let n=document.getElementById("selectedDepartment").value;return void Zi(document.getElementById("selectedRecordType").value,n)}catch(e){console.log(e)}}async function ro(e){var t=document.getElementById("myDropdown");if(t.children.length<=1){let n={};if("administrator"==e)n=br;else if("standardUser"==e){n=await Rn(Li,Mi);for(var r=0;r<n.length;r++)n[r]={label:n[r].substring(n[r].lastIndexOf("HealthData/")+12,n[r].length-1)}}const i=n;for(r=0;r<=i.length-1;r++)if(i[r].label){let e=document.createElement("a");const n=i[r].label;e.innerHTML=n,e.onclick=function(){document.getElementById("selectedAppointmentDepartmentDropdown").value=n,document.getElementById("departmentDropdownButton").innerHTML=n,document.getElementById("myDropdown").classList.toggle("show")},t.appendChild(e)}}document.getElementById("myDropdown").classList.toggle("show")}!async function(){await Li.handleIncomingRedirect(window.location.href),Li.info.isLoggedIn&&(document.getElementById("labelStatus").innerHTML=`Your session is logged in with the WebID [<a target="_blank" href="${Li.info.webId}">${Li.info.webId}</a>].`,document.getElementById("labelStatus").setAttribute("role","alert"),document.getElementById("btnLogout").style.display="block",document.getElementById("loginButtonDiv").style.display="none",document.getElementById("accessingPod").style.display="block")}(),document.getElementById("btnLogin").onclick=function(){!async function(){Li.info.isLoggedIn||await Li.login({oidcIssuer:"https://solidcommunity.net",clientName:"Inrupt tutorial client app",redirectUrl:window.location.href})}()},document.getElementById("btnLogout").onclick=function(){!async function(){document.getElementById("webID").value="",document.getElementById("loginButtonDiv").style.display="block",document.getElementById("btnLogout").style.display="none",document.getElementById("labelStatus").innerHTML="",Yi(!0),await Li.logout(),document.getElementById("accessingPod").style.display="none",localStorage.clear(),document.cookie,document.cookie.split(";")}()},returnFromAccessingRecords.onclick=function(){Yi(!1)},returnFromUploadingAppointment.onclick=function(){Yi(!1)},returnFromUploadingMedicalRecord.onclick=function(){Yi(!1)},returnFromInsurance.onclick=function(){Yi(!1)},returnFromPodDiagram.onclick=function(){Yi(!1)},cancelRegisterNewInsitutionButton.onclick=function(){Yi(!0)},departmentSelectionForm.addEventListener("submit",(e=>{e.preventDefault();let t=document.getElementById("selectedDepartment").value;eo(document.getElementById("selectedRecordType").value,t,!1)})),document.getElementById("viewAccessButton").addEventListener("click",(e=>{e.preventDefault();let t=document.getElementById("selectedDepartment").value;Zi(document.getElementById("selectedRecordType").value,t)})),submitInsuranceRequestForm.addEventListener("submit",(e=>{e.preventDefault(),async function(e){let t=document.getElementById("insuranceDiv").getElementsByTagName("li"),r=[],n=!1,i=!1;for(var o=0;o<t.length;o++)r.push(t[o].innerText);await Tn(Li,Mi+"InsuranceDiagnoses")&&(i=!0);let s={read:!0,write:!1,append:!1,controlRead:!1,controlWrite:!1};for(o=0;o<r.length;o++){let t=Mi+r[o]+"/Diagnoses";if(await Tn(Li,t)){let r=await Cn(Li,t);for(var a=0;a<r.length;a++){var c=st(r[a],"https://schema.org/startDate");c=c.substring(3,5)+"/"+c.substring(0,2)+c.substring(5);var u=Date.parse(c+"Z");parseInt(Date.now()-u)/315576e5<=5&&(0==await Tn(Li,Mi+"InsuranceDiagnoses")&&(n=!0,await Ni(Li,Mi+"InsuranceDiagnoses",Ui)),0==await On(Li,Mi+"InsuranceDiagnoses",e,s)&&(await Oi(Li,e,Mi,s,!1),await Oi(Li,e,Mi+"Info",s,!1),await Oi(Li,e,Mi+"InsuranceDiagnoses",s,!1)),await Di(Li,Mi+"InsuranceDiagnoses",r[a]))}}}0==n&&0==i?alert("Sharing data access to insurer failed because no diagnoses from the required departments dated in the past 5 years."):0==n&&1==i?alert("Dataset for insurance existed previously but has now been shared with new insurer"):1==n&&0==i&&alert("Insurance diagnoses records created. Click the Access medical records button to view them."),document.getElementById("submitInsuranceRequestForm").reset()}(document.getElementById("insurerWebID").value)})),myPodButton.addEventListener("click",(e=>{e.preventDefault(),zi("signedInUser")})),otherUserPodButton.addEventListener("click",(e=>{e.preventDefault(),zi("specifiedUser")})),cancelSessionWithPodButton.addEventListener("click",(e=>{e.preventDefault(),Yi(!0)})),newGeneralRecordForm.addEventListener("submit",(e=>{e.preventDefault(),async function(){let e=document.getElementById("generalRecordDate").value,t=document.getElementById("generalRecordTitle").value,r=document.getElementById("newGeneralRecordDescription").value,n=document.getElementById("selectedDepartment").value,i={"https://schema.org/dateCreated":(new Date).toUTCString(),"https://schema.org/startDate":e,"https://schema.org/creator":Li.info.webId,"https://schema.org/title":t,"https://schema.org/description":r,"https://schema.org/department":n},o=Mi+n+"/Records";await ji(Li,o,i)?alert("General record uploaded successfully to pod"):alert("Error uploading general record to pod"),document.getElementById("newGeneralRecordForm").reset()}()})),newPrescriptionForm.addEventListener("submit",(e=>{e.preventDefault(),async function(){let e=document.getElementById("prescriptionStartDate").value,t=document.getElementById("prescriptionEndDate").value,r=document.getElementById("prescriptionTitle").value,n=document.getElementById("newPrescriptionDescription").value,i=document.getElementById("selectedDepartment").value,o={"https://schema.org/dateCreated":(new Date).toUTCString(),"https://schema.org/startDate":e,"https://schema.org/endDate":t,"https://schema.org/creator":Li.info.webId,"https://schema.org/title":r,"https://schema.org/description":n,"https://schema.org/department":i},s=Mi+i+"/Prescriptions";await ji(Li,s,o)?alert("Prescription uploaded successfully to pod"):alert("Error uploading prescription to pod");let a=document.getElementById("prescriptionPharmacist").value;if(""!=a)try{await Oi(Li,a,Mi,{read:!0,write:!1,append:!1,control:!1},!1),await Oi(Li,a,Mi+"Info",{read:!0,write:!1,append:!1,control:!1},!1),await Oi(Li,a,s,{read:!0,write:!1,append:!1,control:!1},!1)}catch(e){console.log(e)}document.getElementById("newPrescriptionForm").reset()}()})),newDiagnosisForm.addEventListener("submit",(e=>{e.preventDefault(),async function(){let e=document.getElementById("diagnosisDate").value,t=document.getElementById("diagnosisTitle").value,r=document.getElementById("newDiagnosisDescription").value,n=document.getElementById("selectedDepartment").value,i={"https://schema.org/dateCreated":(new Date).toUTCString(),"https://schema.org/startDate":e,"https://schema.org/creator":Li.info.webId,"https://schema.org/title":t,"https://schema.org/description":r,"https://schema.org/department":n},o=Mi+n+"/Diagnoses";await ji(Li,o,i)?alert("Diagnosis uploaded successfully to pod"):alert("Error uploading diagnosis to pod"),document.getElementById("newDiagnosisForm").reset()}()})),selectedDepartmentForm.addEventListener("submit",(e=>{e.preventDefault(),[Ki,Ui].includes(Li.info.webId)?ro("administrator"):ro("standardUser")})),saveNewAppointmentDetailsForm.addEventListener("submit",(e=>{e.preventDefault(),async function(){let e=document.getElementById("selectedAppointmentDepartmentDropdown").value,t=document.getElementById("newAppointmentTime").value,r=document.getElementById("newAppointmentDate").value,n=document.getElementById("newAppointmentDoctor").value,i=document.getElementById("newAppointmentNotes").value,o="20"+r.substring(6,8)+"-"+r.substring(3,5)+"-"+r.substring(0,2)+" "+t,s=new Date(o),a={podOwnerUrl:Ui,appointmentDepartment:e,appointmentTime:s,appointmentDoctor:n,appointmentNotes:i,institutionAdministrator:Ki};await async function(e,t,r){console.log(e),console.log(r);let n=t+r.appointmentDepartment;0==await Tn(e,n+"/Appointments")&&await async function(e,t,r,n,i){let o=St(),s=St(),a=St(),c=St();await At(r+"/",{fetch:e.fetch}),await xt(r+"/Appointments",o,{fetch:e.fetch}),await xt(r+"/Records",s,{fetch:e.fetch}),await xt(r+"/Diagnoses",a,{fetch:e.fetch}),await xt(r+"/Prescriptions",c,{fetch:e.fetch}),await Oi(e,e.info.webId,r+"/",Ci,!0),await Oi(e,e.info.webId,r+"/Appointments",Ci,!0),await Oi(e,e.info.webId,r+"/Records",Ci,!0),await Oi(e,e.info.webId,r+"/Diagnoses",Ci,!0),await Oi(e,e.info.webId,r+"/Prescriptions",Ci,!0),e.info.webId!=n&&(await Oi(e,n,r+"/",Ci,!0),await Oi(e,n,r+"/Appointments",Ci,!0),await Oi(e,n,r+"/Records",Ci,!0),await Oi(e,n,r+"/Diagnoses",Ci,!0),await Oi(e,n,r+"/Prescriptions",Ci,!0)),await Oi(e,xi,t,Pi,!1),await Oi(e,xi,t+"Info",Pi,!1),await Oi(e,xi,r+"/Prescriptions",Pi,!1)}(e,t,n,r.podOwnerUrl,r.institutionAdministrator),0==await On(e,t,r.appointmentDoctor,Ii)&&await Oi(e,r.appointmentDoctor,t,Ii,!1);let i=t+"Info";0==await On(e,i,r.appointmentDoctor,Ai)&&await Oi(e,r.appointmentDoctor,i,Ai,!1),0==await On(e,n+"/Appointments",r.appointmentDoctor,ki)&&(await Oi(e,r.appointmentDoctor,n+"/Appointments",Ti,!1),await Oi(e,r.appointmentDoctor,n+"/Records",Fi,!1),await Oi(e,r.appointmentDoctor,n+"/Diagnoses",Fi,!1),await Oi(e,r.appointmentDoctor,n+"/Prescriptions",Ri,!1));let o=await Et(n+"/Appointments",{fetch:e.fetch});o=lt(o,jn(ht({name:"Appointment @ "+r.appointmentTime.toDateString()})).addStringNoLocale("https://schema.org/dateCreated",(new Date).toUTCString()).addStringNoLocale("https://schema.org/startDate",r.appointmentTime).addStringNoLocale("https://schema.org/organizer",r.appointmentDoctor).addStringNoLocale("https://schema.org/about",r.appointmentNotes).addStringNoLocale("https://schema.org/creator",e.info.webId).addUrl(oi.type,"https://schema.org/Event").build()),await xt(n+"/Appointments",o,{fetch:e.fetch})}(Li,Mi,a),document.getElementById("saveNewAppointmentDetailsForm").reset(),alert("Appointment details saved successfully to pod")}()})),noInstitutionInformationForm.addEventListener("submit",(e=>{e.preventDefault(),document.getElementById("registerNewMedicalInstitution").style.display="block"})),newMedicalInstitutionForm.addEventListener("submit",(e=>{e.preventDefault(),async function(){const e=document.getElementById("institutionType").value,t=document.getElementById("institutionName").value,r=document.getElementById("institutionAddress").value;let n=document.getElementById("institutionSysAdmin").value;""==n&&(n=null);var i=Bi+"/"+e+"HealthData";let o={name:t,address:r,administrator:n};await async function(e,t,r){const n=(new Date).toUTCString();await Tn(e,t)&&await async function(e,t){try{let i=["Appointments","Diagnoses","Prescriptions","Records"],o=await Rn(e,t);for(var r=0;r<o.length;r++){for(var n=0;n<i.length;n++)await It(o[r]+i[n],{fetch:e.fetch});await It(o[r],{fetch:e.fetch})}await It(t,{fetch:e.fetch})}catch(e){console.log(e)}}(e,t);let i=await St();await At(t,{fetch:e.fetch});let o=jn(ht({name:"medicalInstitutionDetails"})).addStringNoLocale(li.name,r.name).addStringNoLocale(li.address,r.address).addStringNoLocale("https://schema.org/dateCreated",n).addUrl(oi.type,"https://schema.org/MedicalOrganization").build();r.administrator&&(o=Wt(o,"https://schema.org/member",r.administrator)),i=lt(i,o),await xt(t+"/Info",i,{fetch:e.fetch});const s=await Mr(t,{fetch:e.fetch});let a=mn(Vr(s),e.info.webId,{read:!0,append:!0,write:!0,control:!0});a=vn(a,e.info.webId,{read:!0,append:!0,write:!0,control:!0}),r.administrator&&(a=mn(a,r.administrator,{read:!0,append:!0,write:!0,control:!0}),a=vn(a,r.administrator,{read:!0,append:!0,write:!0,control:!0}));const c=await Mr(t+"/Info",{fetch:e.fetch});let u=mn(Vr(c),e.info.webId,{read:!0,append:!0,write:!0,control:!0});r.administrator&&(u=mn(u,r.administrator,{read:!0,append:!0,write:!0,control:!0})),u=vn(u,e.info.webId,{read:!0,append:!0,write:!0,control:!0});try{await Jr(s,a,{fetch:e.fetch}),await Jr(c,u,{fetch:e.fetch})}catch(e){console.log(e)}}(Li,i,o),await zi("signedInUser"),await Gi(e),Yi(!1),alert("Health data created successfully")}()})),registerNewAppointmentButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("accessMedicalRecordsButton").style.display="none",document.getElementById("uploadMedicalRecordsButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").style.display="none",document.getElementById("registerNewMedicalInstitutionButton").style.display="none",document.getElementById("viewPodDiagramButton").style.display="none",document.getElementById("registerNewAppointmentButton").classList.add("clicked-button"),document.getElementById("uploadNewAppointmentDetails").style.display="block",setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),accessMedicalRecordsButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("uploadMedicalRecordsButton").style.display="none",document.getElementById("registerNewAppointmentButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").style.display="none",document.getElementById("registerNewMedicalInstitutionButton").style.display="none",document.getElementById("viewPodDiagramButton").style.display="none",document.getElementById("accessMedicalRecordsButton").classList.add("clicked-button"),Xi("accessingRecords",""),setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),initiateInsuranceRequestButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("accessMedicalRecordsButton").style.display="none",document.getElementById("registerNewAppointmentButton").style.display="none",document.getElementById("uploadMedicalRecordsButton").style.display="none",document.getElementById("registerNewMedicalInstitutionButton").style.display="none",document.getElementById("viewPodDiagramButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").classList.add("clicked-button"),document.getElementById("insuranceDiv").style.display="block",setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),uploadMedicalRecordsButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("accessMedicalRecordsButton").style.display="none",document.getElementById("registerNewAppointmentButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").style.display="none",document.getElementById("registerNewMedicalInstitutionButton").style.display="none",document.getElementById("viewPodDiagramButton").style.display="none",document.getElementById("uploadMedicalRecordsButton").classList.add("clicked-button"),document.getElementById("uploadNewMedicalRecordDiv").style.display="block",setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),registerNewMedicalInstitutionButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("accessMedicalRecordsButton").style.display="none",document.getElementById("registerNewAppointmentButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").style.display="none",document.getElementById("uploadMedicalRecordsButton").style.display="none",document.getElementById("viewPodDiagramButton").style.display="none",document.getElementById("registerNewMedicalInstitutionButton").classList.add("clicked-button"),document.getElementById("registerNewMedicalInstitution").style.display="block",zi("signedInUserNew"),setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),viewPodDiagramButton.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("accessMedicalRecordsButton").style.display="none",document.getElementById("registerNewAppointmentButton").style.display="none",document.getElementById("initiateInsuranceRequestButton").style.display="none",document.getElementById("uploadMedicalRecordsButton").style.display="none",document.getElementById("registerNewMedicalInstitution").style.display="none",document.getElementById("viewPodDiagramButton").classList.add("clicked-button"),document.getElementById("podDiagramDiv").style.display="block",async function(){let e=["Appointments","Diagnoses","Prescriptions","Records"];for(var t=0;t<Ji.length;t++)if(1==$i[t]){let i=document.getElementById(Ji[t]+"HealthDataType");i.style.backgroundColor="green";let o=document.createElement("ul"),s=Bi+"/"+Ji[t]+"HealthData/";try{let t=await Rn(Li,s);for(var r=0;r<t.length;r++){let i=document.createElement("li");i.classList.add("diagram-outer-department");let a=t[r].substring(t[r].lastIndexOf("HealthData/")+12,t[r].length-1);i.innerText=a;for(var n=0;n<e.length;n++){let t=document.createElement("li");t.classList.add("diagram-inner-dataset");let r=s+a+"/"+e[n],o="";try{o=(await Cn(Li,r)).length+" files"}catch(e){console.log(e),o="Unauthorized to view contents"}t.innerText=e[n];let c=document.createElement("p");c.innerText=o,c.classList.add("diagram-things"),t.appendChild(c),i.appendChild(t)}o.appendChild(i)}}catch(e){let t=document.createElement("li");t.innerText="Error retrieving the department list for this department",o.appendChild(t)}i.appendChild(o)}}(),setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),500)})),setNameToEditable.addEventListener("click",(e=>{e.preventDefault();let t=document.getElementById("nameOfInstitution").innerHTML;t=t.substring(t.lastIndexOf(":")+2,t.length),document.getElementById("nameOfInstitution").style.display="none";let r=document.createElement("input");r.value=t,r.id="editableInstitutionName",r.style.width="50%",r.addEventListener("keydown",(e=>{"Enter"==e.key&&Qi("http://schema.org/name",document.getElementById("editableInstitutionName").value).then((async()=>{alert("Field updated successfully"),document.getElementById("setNameToReadOnly").style.display="none",document.getElementById("nameOfInstitution").style.display="block",document.getElementById("setNameToEditable").style.display="block",document.getElementById("editableInstitutionName").remove(),await Gi(Hi)}))})),document.getElementById("setNameToEditable").parentNode.appendChild(r),document.getElementById("setNameToEditable").style.display="none",document.getElementById("setNameToReadOnly").style.display="block"})),setNameToReadOnly.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("editableInstitutionName").remove(),document.getElementById("setNameToReadOnly").style.display="none",document.getElementById("nameOfInstitution").style.display="block",document.getElementById("setNameToEditable").style.display="block"})),setAddressToEditable.addEventListener("click",(e=>{e.preventDefault();let t=document.getElementById("addressOfInstitution").innerHTML;t=t.substring(t.lastIndexOf(":")+2,t.length),document.getElementById("addressOfInstitution").style.display="none";let r=document.createElement("input");r.value=t,r.id="editableInstitutionAddress",r.style.width="50%",r.addEventListener("keydown",(e=>{"Enter"==e.key&&Qi("http://schema.org/address",document.getElementById("editableInstitutionAddress").value).then((async()=>{alert("Field updated successfully"),document.getElementById("setAddressToReadOnly").style.display="none",document.getElementById("addressOfInstitution").style.display="block",document.getElementById("setAddressToEditable").style.display="block",document.getElementById("editableInstitutionAddress").remove(),await Gi(Hi)}))})),document.getElementById("setAddressToEditable").parentNode.appendChild(r),document.getElementById("setAddressToEditable").style.display="none",document.getElementById("setAddressToReadOnly").style.display="block"})),setAddressToReadOnly.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("editableInstitutionAddress").remove(),document.getElementById("setAddressToReadOnly").style.display="none",document.getElementById("addressOfInstitution").style.display="block",document.getElementById("setAddressToEditable").style.display="block"})),setAdministratorToEditable.addEventListener("click",(e=>{e.preventDefault();let t=document.getElementById("administratorOfInstitution").innerHTML;t=t.substring(t.indexOf(":")+2,t.length),document.getElementById("administratorOfInstitution").style.display="none";let r=document.createElement("input");r.value=t,r.id="editableInstitutionAdministrator",r.style.width="50%",r.addEventListener("keydown",(e=>{if("Enter"==e.key){try{new URL(document.getElementById("editableInstitutionAdministrator").value)}catch(e){return void alert("Value entered is not a valid URL")}Qi("https://schema.org/member",document.getElementById("editableInstitutionAdministrator").value).then((async()=>{let e={read:!0,append:!0,write:!0,control:!0};if("null"!=t){let e={read:!1,append:!1,write:!1,controlRead:!1,controlWrite:!1};await Oi(Li,t,Mi,e,!1),await Oi(Li,t,Mi+"Info",e,!1)}await Oi(Li,document.getElementById("editableInstitutionAdministrator").value,Mi,e,!0),await Oi(Li,document.getElementById("editableInstitutionAdministrator").value,Mi+"Info",e,!0),alert("Field updated successfully"),document.getElementById("setAdministratorToReadOnly").style.display="none",document.getElementById("administratorOfInstitution").style.display="block",document.getElementById("setAdministratorToEditable").style.display="block",document.getElementById("administratorTooltip").style.display="block",document.getElementById("warningMessageForUpdatingAdmin")&&document.getElementById("warningMessageForUpdatingAdmin").remove(),document.getElementById("editableInstitutionAdministrator").remove(),await Gi(Hi)}))}}));let n=document.createElement("p");n.id="warningMessageForUpdatingAdmin",n.innerText="WARNING: Changing the WebID of the administrator for this institution will remove all access that was assigned to the previous administrator",n.style.color="red",document.getElementById("setAdministratorToEditable").parentNode.appendChild(n),document.getElementById("setAdministratorToEditable").parentNode.appendChild(r),document.getElementById("setAdministratorToEditable").style.display="none",document.getElementById("administratorTooltip").style.display="none",document.getElementById("setAdministratorToReadOnly").style.display="block"})),setAdministratorToReadOnly.addEventListener("click",(e=>{e.preventDefault(),document.getElementById("warningMessageForUpdatingAdmin").remove(),document.getElementById("editableInstitutionAdministrator").remove(),document.getElementById("setAdministratorToReadOnly").style.display="none",document.getElementById("administratorTooltip").style.display="block",document.getElementById("administratorOfInstitution").style.display="block",document.getElementById("setAdministratorToEditable").style.display="block"})),continueWithSelectedRecordTypeButton.addEventListener("click",(e=>(e.preventDefault(),document.getElementById("diagnosisCheckbox").checked?(document.getElementById("medicalRecordTypeSelection").style.display="none",Xi("uploadingNewRecord","newDiagnosisDepartmentPlaceholderDiv"),document.getElementById("createNewDiagnosisDiv").style.display="block",void document.getElementById("createNewDiagnosisDiv").scrollIntoView()):document.getElementById("prescriptionCheckbox").checked?(document.getElementById("medicalRecordTypeSelection").style.display="none",Xi("uploadingNewRecord","newPrescriptionDepartmentPlaceholderDiv"),document.getElementById("createNewPrescriptionDiv").style.display="block",void document.getElementById("createNewPrescriptionDiv").scrollIntoView()):document.getElementById("recordCheckbox").checked?(document.getElementById("medicalRecordTypeSelection").style.display="none",Xi("uploadingNewRecord","newRecordDepartmentPlaceholderDiv"),document.getElementById("createNewGeneralRecordDiv").style.display="block",void document.getElementById("createNewGeneralRecordDiv").scrollIntoView()):void alert("No record type to upload has been selected. Please select one to continue."))))})()})();
=======
// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"node_modules/parcel-bundler/src/builtins/bundle-url.js":[function(require,module,exports) {
var bundleURL = null;

function getBundleURLCached() {
  if (!bundleURL) {
    bundleURL = getBundleURL();
  }

  return bundleURL;
}

function getBundleURL() {
  // Attempt to find the URL of the current script and use that as the base URL
  try {
    throw new Error();
  } catch (err) {
    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);

    if (matches) {
      return getBaseURL(matches[0]);
    }
  }

  return '/';
}

function getBaseURL(url) {
  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/, '$1') + '/';
}

exports.getBundleURL = getBundleURLCached;
exports.getBaseURL = getBaseURL;
},{}],"node_modules/parcel-bundler/src/builtins/css-loader.js":[function(require,module,exports) {
var bundle = require('./bundle-url');

function updateLink(link) {
  var newLink = link.cloneNode();

  newLink.onload = function () {
    link.remove();
  };

  newLink.href = link.href.split('?')[0] + '?' + Date.now();
  link.parentNode.insertBefore(newLink, link.nextSibling);
}

var cssTimeout = null;

function reloadCSS() {
  if (cssTimeout) {
    return;
  }

  cssTimeout = setTimeout(function () {
    var links = document.querySelectorAll('link[rel="stylesheet"]');

    for (var i = 0; i < links.length; i++) {
      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {
        updateLink(links[i]);
      }
    }

    cssTimeout = null;
  }, 50);
}

module.exports = reloadCSS;
},{"./bundle-url":"node_modules/parcel-bundler/src/builtins/bundle-url.js"}],"node_modules/parcel-bundler/src/builtins/hmr-runtime.js":[function(require,module,exports) {
var global = arguments[3];
var OVERLAY_ID = '__parcel__error__overlay__';
var OldModule = module.bundle.Module;

function Module(moduleName) {
  OldModule.call(this, moduleName);
  this.hot = {
    data: module.bundle.hotData,
    _acceptCallbacks: [],
    _disposeCallbacks: [],
    accept: function (fn) {
      this._acceptCallbacks.push(fn || function () {});
    },
    dispose: function (fn) {
      this._disposeCallbacks.push(fn);
    }
  };
  module.bundle.hotData = null;
}

module.bundle.Module = Module;
var checkedAssets, assetsToAccept;
var parent = module.bundle.parent;

if ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {
  var hostname = "" || location.hostname;
  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';
  var ws = new WebSocket(protocol + '://' + hostname + ':' + "64589" + '/');

  ws.onmessage = function (event) {
    checkedAssets = {};
    assetsToAccept = [];
    var data = JSON.parse(event.data);

    if (data.type === 'update') {
      var handled = false;
      data.assets.forEach(function (asset) {
        if (!asset.isNew) {
          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);

          if (didAccept) {
            handled = true;
          }
        }
      }); // Enable HMR for CSS by default.

      handled = handled || data.assets.every(function (asset) {
        return asset.type === 'css' && asset.generated.js;
      });

      if (handled) {
        console.clear();
        data.assets.forEach(function (asset) {
          hmrApply(global.parcelRequire, asset);
        });
        assetsToAccept.forEach(function (v) {
          hmrAcceptRun(v[0], v[1]);
        });
      } else if (location.reload) {
        // `location` global exists in a web worker context but lacks `.reload()` function.
        location.reload();
      }
    }

    if (data.type === 'reload') {
      ws.close();

      ws.onclose = function () {
        location.reload();
      };
    }

    if (data.type === 'error-resolved') {
      console.log('[parcel] ✨ Error resolved');
      removeErrorOverlay();
    }

    if (data.type === 'error') {
      console.error('[parcel] 🚨  ' + data.error.message + '\n' + data.error.stack);
      removeErrorOverlay();
      var overlay = createErrorOverlay(data);
      document.body.appendChild(overlay);
    }
  };
}

function removeErrorOverlay() {
  var overlay = document.getElementById(OVERLAY_ID);

  if (overlay) {
    overlay.remove();
  }
}

function createErrorOverlay(data) {
  var overlay = document.createElement('div');
  overlay.id = OVERLAY_ID; // html encode message and stack trace

  var message = document.createElement('div');
  var stackTrace = document.createElement('pre');
  message.innerText = data.error.message;
  stackTrace.innerText = data.error.stack;
  overlay.innerHTML = '<div style="background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;">' + '<span style="background: red; padding: 2px 4px; border-radius: 2px;">ERROR</span>' + '<span style="top: 2px; margin-left: 5px; position: relative;">🚨</span>' + '<div style="font-size: 18px; font-weight: bold; margin-top: 20px;">' + message.innerHTML + '</div>' + '<pre>' + stackTrace.innerHTML + '</pre>' + '</div>';
  return overlay;
}

function getParents(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return [];
  }

  var parents = [];
  var k, d, dep;

  for (k in modules) {
    for (d in modules[k][1]) {
      dep = modules[k][1][d];

      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {
        parents.push(k);
      }
    }
  }

  if (bundle.parent) {
    parents = parents.concat(getParents(bundle.parent, id));
  }

  return parents;
}

function hmrApply(bundle, asset) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (modules[asset.id] || !bundle.parent) {
    var fn = new Function('require', 'module', 'exports', asset.generated.js);
    asset.isNew = !modules[asset.id];
    modules[asset.id] = [fn, asset.deps];
  } else if (bundle.parent) {
    hmrApply(bundle.parent, asset);
  }
}

function hmrAcceptCheck(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (!modules[id] && bundle.parent) {
    return hmrAcceptCheck(bundle.parent, id);
  }

  if (checkedAssets[id]) {
    return;
  }

  checkedAssets[id] = true;
  var cached = bundle.cache[id];
  assetsToAccept.push([bundle, id]);

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    return true;
  }

  return getParents(global.parcelRequire, id).some(function (id) {
    return hmrAcceptCheck(global.parcelRequire, id);
  });
}

function hmrAcceptRun(bundle, id) {
  var cached = bundle.cache[id];
  bundle.hotData = {};

  if (cached) {
    cached.hot.data = bundle.hotData;
  }

  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {
    cached.hot._disposeCallbacks.forEach(function (cb) {
      cb(bundle.hotData);
    });
  }

  delete bundle.cache[id];
  bundle(id);
  cached = bundle.cache[id];

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    cached.hot._acceptCallbacks.forEach(function (cb) {
      cb();
    });

    return true;
  }
}
},{}]},{},["node_modules/parcel-bundler/src/builtins/hmr-runtime.js"], null)
//# sourceMappingURL=/index.js.map
>>>>>>> tempBranch
